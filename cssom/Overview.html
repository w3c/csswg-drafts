<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html lang=en-US>
 <head>
  <title>CSSOM</title>

  <style type="text/css">
   pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
   pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
   dfn { font-weight:bold; font-style:normal }
   div.example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
   div.example table code { color:inherit }
   td, th { padding:.1em }
   .note {  margin-left:2em; color:green; font-style:italic; font-weight:bold }
   p.note::before { content:"Note: " }
   .XXX { padding:.5em; border:solid red }
   p.XXX::before { content:"Issue: " }
   em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
   code { color:orangered }
   code :link, code :visited { color:inherit }
  </style>
  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel=stylesheet>

 <body class=draft>
  <div class=head>
   <h1 id=cssom>CSSOM</h1>

   <h2 class="no-num no-toc" id="">Editor's Draft 14 October 2009</h2>

   <dl>
    <dt>This Version:

    <dd><a
     href="http://www.w3.org/TR/2009/ED-cssom-20091014/">http://www.w3.org/TR/2009/ED-cssom-20091014/</a>

    <dt>Latest Version:

    <dd><a href="http://www.w3.org/TR/cssom/">http://www.w3.org/TR/cssom/</a>

    <dt>Latest Editor's draft:

    <dd><a
     href="http://dev.w3.org/csswg/cssom/">http://dev.w3.org/csswg/cssom/</a>

    <dt>Previous Version:

    <dd><a
     href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/">http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/</a>

    <dt>Editor:

    <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a> (<a
     href="http://www.opera.com/">Opera Software ASA</a>) &lt;<a
     href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;
   </dl>
  </div>

  <h2 class="no-num no-toc" id=abstract>Abstract</h2>

  <p>CSSOM defines how style sheets interact with the DOM and defines an API
   for CSS style sheets.

  <h2 class="no-num no-toc" id=sotd>Status of this Document</h2>

  <p class=XXX>The plan is that this document provides the successor to DOM
   Level 2 Style.</p>
  <!--begin-status-->

  <p>This is a public copy of the editors' draft. It is provided for
   discussion only and may change at any moment. It probably contains errors.
   Its publication here does not imply endorsement of its contents by W3C.
   <!--end-status-->

  <h2 class="no-num no-toc" id=toc>Table of Contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#introduction"><span class=secno>1 </span>Introduction</a>
    <ul class=toc>
     <li><a href="#history"><span class=secno>1.1 </span>History</a>
    </ul>

   <li><a href="#conformance"><span class=secno>2 </span>Conformance
    Requirements</a>

   <li><a href="#terminology"><span class=secno>3 </span>Terminology</a>

   <li><a href="#media-queries"><span class=secno>4 </span>Media Queries</a>
    <ul class=toc>
     <li><a href="#parsing-media-queries"><span class=secno>4.1
      </span>Parsing Media Queries</a>

     <li><a href="#serializing-media-queries"><span class=secno>4.2
      </span>Serializing Media Queries</a>
      <ul class=toc>
       <li><a href="#serializing-media-feature-values"><span
        class=secno>4.2.1 </span>Serializing Media Feature Values</a>
      </ul>

     <li><a href="#comparing-media-queries"><span class=secno>4.3
      </span>Comparing Media Queries</a>

     <li><a href="#the-medialist-interface"><span class=secno>4.4 </span>The
      <code title="">MediaList</code> Interface</a>
    </ul>

   <li><a href="#style-sheets"><span class=secno>5 </span>Style Sheets</a>
    <ul class=toc>
     <li><a href="#style-sheet0"><span class=secno>5.1 </span>Style Sheet</a>
      
      <ul class=toc>
       <li><a href="#the-stylesheet-interface"><span class=secno>5.1.1
        </span>The <code title="">StyleSheet</code> Interface</a>
      </ul>

     <li><a href="#style-sheet-collections"><span class=secno>5.2
      </span>Style Sheet Collections</a>
      <ul class=toc>
       <li><a href="#the-http-default-style-header"><span class=secno>5.2.1
        </span>The HTTP <code title="">Default-Style</code> Header</a>

       <li><a href="#the-stylesheetlist-sequence"><span class=secno>5.2.2
        </span>The <code title="">StyleSheetList</code> Sequence</a>

       <li><a href="#the-documentstyle-interface"><span class=secno>5.2.3
        </span>The <code title="">DocumentStyle</code> Interface</a>

       <li><a href="#interaction-with-the-user-interface"><span
        class=secno>5.2.4 </span>Interaction with the User Interface</a>
        <ul class=toc>
         <li><a href="#persisting-the-selected-style-sheet-set"><span
          class=secno>5.2.4.1. </span>Persisting the selected style sheet
          set</a>
        </ul>

       <li><a href="#examples"><span class=secno>5.2.5 </span>Examples</a>
      </ul>

     <li><a href="#style-sheet-assocation"><span class=secno>5.3 </span>Style
      Sheet Assocation</a>
      <ul class=toc>
       <li><a href="#the-linkstyle-interface"><span class=secno>5.3.1
        </span>The <code title="">LinkStyle</code> Interface</a>

       <li><a href="#requirements-on-specifications"><span class=secno>5.3.2
        </span>Requirements on specifications</a>

       <li><a href="#requirements-on-user-agents-implementing"><span
        class=secno>5.3.3 </span>Requirements on User Agents Implementing the
        <span title=""><code>xml-stylesheet</code> processing
        instruction</span></a>

       <li><a href="#requirements-on-user-agents-implementing0"><span
        class=secno>5.3.4 </span>Requirements on User Agents Implementing the
        HTTP <code title="">Link</code> Header</a>
      </ul>
    </ul>

   <li><a href="#cascading-style-sheets-apis"><span class=secno>6
    </span>Cascading Style Sheets APIs</a>
    <ul class=toc>
     <li><a href="#parsing-and-serializing-css-constructs"><span
      class=secno>6.1 </span>Parsing and Serializing CSS Constructs</a>
      <ul class=toc>
       <li><a href="#css-value-rules"><span class=secno>6.1.1 </span>CSS
        Value Rules</a>
        <ul class=toc>
         <li><a href="#examples-of-the-css-value-serializing-al"><span
          class=secno>6.1.1.1. </span>Examples of the CSS Value Serializing
          Algorithm </a>
        </ul>

       <li><a href="#selectors-rules"><span class=secno>6.1.2
        </span>Selectors Rules</a>

       <li><a href="#css-page-selectors-rules"><span class=secno>6.1.3
        </span>CSS Page Selectors Rules</a>

       <li><a href="#processing-css-statements"><span class=secno>6.1.4
        </span>Processing CSS Statements</a>
      </ul>

     <li><a href="#the-cssstylesheet-interface"><span class=secno>6.2
      </span>The <code title="">CSSStyleSheet</code> Interface</a>

     <li><a href="#the-cssrulelist-interface"><span class=secno>6.3
      </span>The <code title="">CSSRuleList</code> Interface</a>

     <li><a href="#interfaces-for-css-statements"><span class=secno>6.4
      </span>Interfaces for CSS Statements</a>
      <ul class=toc>
       <li><a href="#the-cssrule-interface"><span class=secno>6.4.1
        </span>The <code title="">CSSRule</code> Interface</a>
        <ul class=toc>
         <li><a href="#extensibility"><span class=secno>6.4.1.1.
          </span>Extensibility</a>
        </ul>

       <li><a href="#the-cssstylerule-interface"><span class=secno>6.4.2
        </span>The <code title="">CSSStyleRule</code> Interface</a>

       <li><a href="#the-cssimportrule-interface"><span class=secno>6.4.3
        </span>The <code title="">CSSImportRule</code> Interface</a>

       <li><a href="#the-cssmediarule-interface"><span class=secno>6.4.4
        </span>The <code title="">CSSMediaRule</code> Interface</a>

       <li><a href="#the-cssfontfacerule-interface"><span class=secno>6.4.5
        </span>The <code title="">CSSFontFaceRule</code> Interface</a>

       <li><a href="#the-csspagerule-interface"><span class=secno>6.4.6
        </span>The <code title="">CSSPageRule</code> Interface</a>

       <li><a href="#the-cssnamespacerule-interface"><span class=secno>6.4.7
        </span>The <code title="">CSSNamespaceRule</code> Interface</a>
      </ul>

     <li><a href="#accessing-declaration-blocks"><span class=secno>6.5
      </span>Accessing declaration blocks</a>
      <ul class=toc>
       <li><a href="#the-elementcssinlinestyle-interface"><span
        class=secno>6.5.1 </span>The <code>ElementCSSInlineStyle</code>
        Interface</a>

       <li><a href="#the-viewcss-interface"><span class=secno>6.5.2
        </span>The <code title="">ViewCSS</code> Interface</a>
      </ul>

     <li><a href="#css-declaration-blocks"><span class=secno>6.6 </span>CSS
      Declaration Blocks</a>
      <ul class=toc>
       <li><a href="#the-cssstyledeclaration-interface"><span
        class=secno>6.6.1 </span>The <code
        title="">CSSStyleDeclaration</code> Interface</a>

       <li><a href="#the-css2properties-interface"><span class=secno>6.6.2
        </span>The <code title="">CSS2Properties</code> Interface</a>
      </ul>
    </ul>

   <li class=no-num><a href="#iana-considerations">IANA Considerations</a>
    <ul class=toc>
     <li class=no-num><a href="#default-style-"><code>Default-Style</code>
      </a>
    </ul>

   <li class=no-num><a href="#references">References</a>

   <li class=no-num><a href="#acknowledgements">Acknowledgements</a>
  </ul>
  <!--end-toc-->

  <h2 id=introduction><span class=secno>1 </span>Introduction</h2>

  <p class=issue>...

  <h3 id=history><span class=secno>1.1 </span>History</h3>

  <p>Several interfaces from DOM Level 2 Style <a
   href="http://www.w3.org/mid/Pine.LNX.4.05.10310302134070.1173-100000@lanalana.inria.fr"
   title="[CSSOM] CSSValue and related interfaces (message from the CSS
   WG)">have been obsoleted</a> because they where thought to be too awkward
   for frequent use. This specification no longer contains those features.
   <code>DOMImplementationCSS</code> and <code>CSSCharsetRule</code> have
   been removed as well as they were not deemed necessary.

  <h2 id=conformance><span class=secno>2 </span>Conformance Requirements</h2>

  <p>Everything in this specification is normative except for diagrams,
   examples, notes and sections marked non-normative.

  <p>The key words <em class=ct>must</em>, <em class=ct>must not</em>, <em
   class=ct>required</em>, <em class=ct>shall</em>, <em class=ct>shall
   not</em>, <em class=ct>should</em>, <em class=ct>should not</em>, <em
   class=ct>recommended</em>, <em class=ct>may</em>, and <em
   class=ct>optional</em> in the normative parts of this document are to be
   interpreted as described in RFC 2119 <a href="#ref-rfc2119">[RFC2119]</a>.</p>
  <!-- XXX
  <p>The following conformance classes are defined (and considered) by this
  specification:</p>

  <dl>
   <dt><dfn id="conforming-implementation">conforming implementation</dfn></dt>

   <dd>A user agent that implements all interfaces described in this
   specification and follows all <em class="ct">must</em>-,
   <em class="ct">required</em>- and <em class="ct">shall</em>-level of criteria
   in this specification.</dd>

   <dt><dfn id="conforming-document">conforming document</dfn></dt>

   <dd>A document that follows all <em class="ct">must</em>-,
   <em class="ct">required</em>- and <em class="ct">shall</em>-level of criteria
   in this specification that apply to document authors.</dd>

   <dt><dfn id="conforming-authoring-tool">conforming authoring tool</dfn></dt>

   <dd>One that produces conforming documents.</dd>
  </dl>
-->

  <h2 id=terminology><span class=secno>3 </span>Terminology</h2>

  <p class=issue>Sort out: <dfn id=resolve-a-url>resolve a URL</dfn> <dfn
   id=url>URL</dfn> <dfn id=content-type-metadata>Content-Type metadata</dfn>
   <dfn id=supported-styling-language>supported styling language</dfn> <dfn
   id=xml-stylesheet-processing-instruction><code>xml-stylesheet</code>
   processing instruction</dfn> <dfn id=fetch>fetch</dfn>

  <p>A <dfn id=color-component-integer>color component integer</dfn> is a
   base-ten integer in the range 0-255 using digits 0-9, U+0030 to U+0039, in
   the shortest form possible.

  <p>A <dfn id=color-component-separator>color component separator</dfn> is a
   literal U+002C COMMA followed by a U+0020 SPACE.

  <p>When this specification talks about object <code><var>A</var></code>
   where <code><var>A</var></code> is actually an interface, it generally
   means an object implementing interface <code><var>A</var></code>.

  <p>The term <dfn id=whitespace>whitespace</dfn> is used as defined in CSS.
   <!--XXX <a href="#ref-css">[CSS]</a>-->

  <h2 id=media-queries><span class=secno>4 </span>Media Queries</h2>

  <p>Media queries are defined by the Media Queries specification. This
   section defines various concepts around media queries, including their API
   and serialization form.</p>
  <!-- XXX ref -->

  <h3 id=parsing-media-queries><span class=secno>4.1 </span>Parsing Media
   Queries</h3>

  <p>To <dfn id=parse-a-media-query>parse a media query</dfn> for a given
   string <var title="">s</var> means to follow the <a
   href="#parse-a-list-of-media-queries">parse a list of media queries</a>
   steps and return null if more than one media query is returned or a media
   query if a single media query is returned.

  <p>To <dfn id=parse-a-list-of-media-queries>parse a list of media
   queries</dfn> for a given string <var>s</var> into a list of media queries
   is defined in the Media Queries specification. Return the list of one or
   more media queries that the algorithm defined there gives.</p>
  <!-- XXX ref -->

  <p class=note>If everything ends up being ignored the list will contain the
   media query "<code title="">not all</code>".

  <h3 id=serializing-media-queries><span class=secno>4.2 </span>Serializing
   Media Queries</h3>

  <p>To <dfn id=serialize-a-media-query>serialize a media query</dfn> run
   these steps:

  <ol>
   <li>
    <p>Let <var title="">s</var> be the empty string.

   <li>
    <p>If the media query is negated append the literal string
     "<code>not</code>", followed by a U+0020 SPACE character, to <var
     title="">s</var>.

   <li>
    <p>Let <var title="">type</var> be the media query, <span>converted to
     ASCII lowercase</span>.

   <li>
    <p>If the media query does not contain media features append <var
     title="">type</var>, to <var>s</var>, then return <var>s</var> and
     terminate this algorithm.

   <li>
    <p>If <var title="">type</var> is not "<code>all</code>" or if the media
     query is negated append <var title="">type</var>, followed by a U+0020
     SPACE character, followed by "<code>and</code>", followed by a U+0020
     SPACE character, to <var title="">s</var>.

   <li>
    <p>Sort the media features in lexicographical order.

   <li>
    <p>Then, for each media feature:</p>

    <ol>
     <li>Append a U+0028 LEFT PARENTHESIS character, followed by the media
      feature name, <span>converted to ASCII lowercase</span>, to
      <var>s</var>.

     <li>
      <p>If a value is given append a U+003A COLON (:) character, followed by
       a U+0020 SPACE character, followed by the <a
       href="#serialize-a-media-feature-value" title="serialize a media
       feature value">serialized media feature value</a>, to <var>s</var>.</p>

     <li>
      <p>Append a U+0029 RIGHT PARENTHESIS character to <var>s</var>.

     <li>
      <p>If this is not the last media feature append a U+0020 SPACE
       character, followed by the literal string "<code>and</code>", followed
       by a U+0020 SPACE character, to <var>s</var>.</p>
    </ol>

   <li>
    <p>Return <var>s</var>.
  </ol>

  <div class=example>
   <p>Here are some examples of input (first column) and output (second
    column):</p>

   <table>
    <thead>
     <tr>
      <th>Input

      <th>Output

    <tbody>
     <tr>
      <td><code>not screen and (min-WIDTH:5px) AND (max-width:40px )</code>

      <td><code>not screen and (max-width: 40px) and (min-width: 5px)</code>

     <tr>
      <td><code>all and (color) and (color)</code>

      <td><code>(color)</code>
   </table>
  </div>

  <p>To <dfn id=serialize-a-list-of-media-queries>serialize a list of media
   queries</dfn> run these steps:

  <ol>
   <li>
    <p>Let <var>s</var> be the empty string.

   <li>
    <p>If the list is empty return <var>s</var> and terminate this algorithm.

   <li>
    <p>For each media query in the list:</p>

    <ol>
     <li>
      <p>Append the result of <span title=serializing-media-query>serializing
       the media query</span> to <var>s</var>.

     <li>
      <p>If this is not the last media query append a U+002C COMMA (,)
       character, followed by a U+0020 SPACE character to <var>s</var>.
    </ol>

   <li>
    <p>Return <var>s</var>.
  </ol>

  <h4 id=serializing-media-feature-values><span class=secno>4.2.1
   </span>Serializing Media Feature Values</h4>

  <p>To <dfn id=serialize-a-media-feature-value>serialize a media feature
   value</dfn> named <var title="">v</var> locate <var title="">v</var> in
   the first column of the table below and use the serialization format
   described in the second column:

  <table>
   <tbody>
    <tr>
     <th>Media Feature

     <th>Serialization

    <tr>
     <td><code title="">width</code>

     <td>...

    <tr>
     <td><code title="">height</code>

     <td>...

    <tr>
     <td><code title="">device-width</code>

     <td>...

    <tr>
     <td><code title="">device-height</code>

     <td>...

    <tr>
     <td><code title="">orientation</code>

     <td>
      <p>If the value is `<code title="">portrait</code>`: "<code
       title="">portrait</code>".</p>

      <p>If the value is `<code title="">landscape</code>`: "<code
       title="">landscape</code>".</p>

    <tr>
     <td><code title="">aspect-ratio</code>

     <td>...

    <tr>
     <td><code title="">device-aspect-ratio</code>

     <td>...

    <tr>
     <td><code title="">color</code>

     <td>...

    <tr>
     <td><code title="">color-index</code>

     <td>...

    <tr>
     <td><code title="">monochrome</code>

     <td>...

    <tr>
     <td><code title="">resolution</code>

     <td>...

    <tr>
     <td><code title="">scan</code>

     <td>
      <p>If the value is `<code title="">progressive</code>`: "<code
       title="">progressive</code>".</p>

      <p>If the value is `<code title="">interlace</code>`: "<code
       title="">interlace</code>".</p>

    <tr>
     <td><code title="">grid</code>

     <td>...
  </table>

  <p>Other specifications can extend this table and vendor-prefixed media
   features can have custom serialization formats as well.

  <h3 id=comparing-media-queries><span class=secno>4.3 </span>Comparing Media
   Queries</h3>

  <p>To <dfn id=compare-media-queries>compare media queries</dfn>
   <var>m1</var> and <var>m2</var> means to <span title="serializing media
   query">serialize</span> them both and return true if they are a
   <span>case-sensitive</span> match and false if they are not.

  <h3 id=the-medialist-interface><span class=secno>4.4 </span>The <code
   title="">MediaList</code> Interface</h3>
  <!--
  <p>creating a MediaList object?</p>
  -->

  <p>An object that implements the <code><a
   href="#medialist">MediaList</a></code> interface has an associated <dfn
   id=list-of-media-queries>list of media queries</dfn>.</p>
  <!-- http://dev.w3.org/2006/webapi/WebIDL/#idl-indexed-properties -->

  <pre class=idl>interface <dfn id=medialist>MediaList</dfn> {
  stringifier attribute DOMString <a href="#medialist-mediatext" title=medialist-mediatext>mediaText</a>;
  readonly attribute unsigned long <a href="#medialist-length" title=medialist-length>length</a>;
  getter DOMString <a href="#medialist-item" title=medialist-item>item</a>(unsigned long <var title="">index</var>);
  void <a href="#medialist-appendmedium" title=medialist-appendmedium>appendMedium</a>(DOMString <var title="">medium</var>)
  void <a href="#medialist-deletemedium" title=medialist-deletemedium>deleteMedium</a>(DOMString <var title="">medium</var>)
};</pre>

  <p>The <dfn id=medialist-mediatext
   title=medialist-mediatext><code>mediaText</code></dfn> attribute <em
   class=ct>must</em>, on getting, return a <a
   href="#serialize-a-list-of-media-queries" title="serialize a list of media
   queries">serialization</a> of the <span>list of media qeuries</span>.

  <p>On setting the <code title=medialist-mediatext><a
   href="#medialist-mediatext">mediaText</a></code> attribute these steps <em
   class=ct>must</em> be run:

  <ol>
   <li>
    <p>Empty the <a href="#list-of-media-queries">list of media queries</a>.

   <li>
    <p>If the given value is the empty string terminate these steps.

   <li>
    <p>Append all the media queries as a result of <a
     href="#parse-a-list-of-media-queries" title="parse a list of media
     queries">parsing</a> the given value to the <a
     href="#list-of-media-queries">list of media queries</a>.
  </ol>

  <p>The <dfn id=medialist-length
   title=medialist-length><code>length</code></dfn> attribute, on getting,
   <em class=ct>must</em> return the number of media queries in the <a
   href="#list-of-media-queries">list of media queries</a>.

  <p>The <dfn id=medialist-item title=medialist-item><code>item(<var
   title="">index</var>)</code></dfn> method, when invoked, <em
   class=ct>must</em> return the item in the list given by <var>index</var>,
   or <code>null</code>, if <var>index</var> is greater than or equal to the
   number of items in the list.</p>
  <!-- XXX need consistency here WebIDL? list of media queries? -->

  <p>The <dfn id=medialist-appendmedium
   title=medialist-appendmedium><code>appendMedium(<var
   title="">medium</var>)</code></dfn> method <em class=ct>must</em>, when
   invoked, run these steps:

  <ol>
   <li>
    <p>Let <var title="">m</var> be the result of <a
     href="#parse-a-media-query" title="parse a media query">parsing</a> the
     given value.

   <li>
    <p>If <var title="">m</var> is null terminate these steps.

   <li>
    <p>If <a href="#compare-media-queries" title="compare media
     queries">comparing</a> <var title="">m</var> with any of the media
     queries in the <a href="#list-of-media-queries">list of media
     queries</a> returns true terminate these steps.

   <li>
    <p>Append <var title="">m</var> to the <a
     href="#list-of-media-queries">list of media queries</a>.
  </ol>

  <p>The <dfn id=medialist-deletemedium
   title=medialist-deletemedium><code>deleteMedium(<var
   title="">medium</var>)</code></dfn> method <em class=ct>must</em>, when
   invoked, run these steps:

  <ol>
   <li>
    <p>Let <var title="">m</var> be the result of <a
     href="#parse-a-media-query" title="parse a media query">parsing</a> the
     given value.

   <li>
    <p>If <var title="">m</var> is null terminate these steps.

   <li>
    <p>Remove any media query from the <a href="#list-of-media-queries">list
     of media queries</a> for which <a href="#compare-media-queries"
     title="compare media queries">comparing</a> the media query with <var
     title="">m</var> returns true.
  </ol>

  <h2 id=style-sheets><span class=secno>5 </span>Style Sheets</h2>

  <h3 id=style-sheet0><span class=secno>5.1 </span>Style Sheet</h3>

  <p>A <dfn id=style-sheet>style sheet</dfn> is an abstract concept that
   represents any kind of style sheet. In the DOM a <a
   href="#style-sheet">style sheet</a> is a <code><a
   href="#stylesheet">StyleSheet</a></code> object. A <a
   href="#style-sheet">style sheet</a> has a number of associated properties:

  <dl>
   <dt><dfn id=style-sheet-type>style sheet type</dfn>

   <dd>
    <p>The <a href="#content-type-metadata">Content-Type metadata</a> of the
     <a href="#style-sheet">style sheet</a>.

   <dt><dfn id=style-sheet-location>style sheet location</dfn>

   <dd>
    <p>The <a href="#url">URL</a> of the <a href="#style-sheet">style
     sheet</a> or null if the <a href="#style-sheet">style sheet</a> was
     embedded.

   <dt><dfn id=style-sheet-node>style sheet node</dfn>

   <dd>
    <p>The DOM node associated with the <a href="#style-sheet">style
     sheet</a> or null if there is no associated DOM node.

   <dt><dfn id=style-sheet-parent>style sheet parent</dfn>

   <dd>
    <p>The <a href="#style-sheet">style sheet</a> that is the parent of the
     <a href="#style-sheet">style sheet</a>.
   </dd>
   <!-- XXX what if imported twice? -->

   <dt><dfn id=style-sheet-media>style sheet media</dfn>

   <dd>
    <p>The <code><a href="#medialist">MediaList</a></code> object associated
     with the <a href="#style-sheet">style sheet</a>.
   </dd>
   <!-- XXX explain what happens when passing a string -->

   <dt><dfn id=style-sheet-title>style sheet title</dfn>

   <dd>
    <p>The title of the <a href="#style-sheet">style sheet</a>. It is said to
     be empty if the title is the empty string.</p>

    <div class=example>
     <p>In these examples the <a href="#style-sheet-title">style sheet
      title</a> ends up being empty:</p>

     <pre>&lt;style title=""> body { background:papayawhip } &lt;/style></pre>

     <pre>&lt;style> body { background:orange } &lt;/style></pre>
    </div>

   <dt><dfn id=style-sheet-alternate-flag>style sheet alternate flag</dfn>

   <dd>
    <p>Either true or false. False by default.</p>

    <div class=example>
     <p>The following <a href="#style-sheet" title="style sheet">style
      sheets</a> have their <a href="#style-sheet-alternate-flag">style sheet
      alternate flag</a> set:</p>

     <pre><code>&lt;?xml-stylesheet alternate="yes" title="x" href="data:text/css,&hellip;"?></code></pre>

     <pre><code>&lt;link rel="alternate stylesheet" title="x" href="data:text/css,&hellip;"></code></pre>
    </div>

   <dt><dfn id=style-sheet-disabled-flag>style sheet disabled flag</dfn>

   <dd>
    <p>Either true or false. False by default.</p>

    <p class=note>Even when false it does not necessarily mean that the <a
     href="#style-sheet">style sheet</a> is actually rendered.</p>
  </dl>

  <p>When you are to <a href="#create-a-style-sheet">create a style sheet</a>
   the above properties are to be set to their proper values.</p>
  <!-- same-origin restrictions -->

  <h4 id=the-stylesheet-interface><span class=secno>5.1.1 </span>The <code
   title="">StyleSheet</code> Interface</h4>

  <p>In the DOM a <a href="#style-sheet">style sheet</a> is represented by an
   object that implements the <code><a
   href="#stylesheet">StyleSheet</a></code> interface.

  <pre class=idl>interface <dfn id=stylesheet>StyleSheet</dfn> {
  readonly attribute DOMString <a href="#stylesheet-type" title=stylesheet-type>type</a>;
  readonly attribute DOMString <a href="#stylesheet-href" title=stylesheet-href>href</a>;
  readonly attribute Node <a href="#stylesheet-ownernode" title=stylesheet-ownernode>ownerNode</a>;
  readonly attribute <a href="#stylesheet">StyleSheet</a> <a href="#stylesheet-parentstylesheet" title=stylesheet-parentstylesheet>parentStyleSheet</a>;
  readonly attribute DOMString <a href="#stylesheet-title" title=stylesheet-title>title</a>;
  [PutForwards=mediaText] readonly attribute <a href="#medialist">MediaList</a> <a href="#stylesheet-media" title=stylesheet-media>media</a>;
           attribute boolean <a href="#stylesheet-disabled" title=stylesheet-disabled>disabled</a>;
};</pre>

  <p>The <dfn id=stylesheet-type
   title=stylesheet-type><code>type</code></dfn> attribute <em
   class=ct>must</em> return the <a href="#style-sheet-type">style sheet
   type</a>.

  <p>The <dfn id=stylesheet-href
   title=stylesheet-href><code>href</code></dfn> attribute <em
   class=ct>must</em> return the <a href="#style-sheet-location">style sheet
   location</a>.

  <p>The <dfn id=stylesheet-ownernode
   title=stylesheet-ownernode><code>ownerNode</code></dfn> attribute <em
   class=ct>must</em> return the <a href="#style-sheet-node">style sheet
   node</a>.

  <p>The <dfn id=stylesheet-parentstylesheet
   title=stylesheet-parentstylesheet><code>parentStyleSheet</code></dfn>
   attribute <em class=ct>must</em> return the <a
   href="#style-sheet-parent">style sheet parent</a>.

  <p>The <dfn id=stylesheet-title
   title=stylesheet-title><code>title</code></dfn> attribute <em
   class=ct>must</em> return the <a href="#style-sheet-title">style sheet
   title</a>.

  <p>The <dfn id=stylesheet-media
   title=stylesheet-media><code>media</code></dfn> attribute <em
   class=ct>must</em> return the <a href="#style-sheet-media">style sheet
   media</a>.

  <p>The <dfn id=stylesheet-disabled
   title=stylesheet-disabled><code>disabled</code></dfn> attribute <em
   class=ct>must</em>, on getting, return the <a
   href="#style-sheet-disabled-flag">style sheet disabled flag</a>. On
   setting, it <em class=ct>must</em> set the <a
   href="#style-sheet-disabled-flag">style sheet disabled flag</a> to the
   given value.

  <h3 id=style-sheet-collections><span class=secno>5.2 </span>Style Sheet
   Collections</h3>

  <p>Below various new concepts are defined that are associated with each
   <code>Document</code> object.

  <p>Each <code>Document</code> has an associated list of zero or more <a
   href="#style-sheet" title="style sheet">style sheets</a>, named the <dfn
   id=document-style-sheets>document style sheets</dfn>. This is an ordered
   list that contains all <a href="#style-sheet" title="style sheet">style
   sheets</a> associated with the <code>Document</code>, in <span>tree
   order</span>, with <a href="#style-sheet" title="style sheet">style
   sheets</a> created from HTTP <code title=http-link>Link</code> headers
   first, if any, in header order.

  <p>To <dfn id=create-a-style-sheet>create a style sheet</dfn>, run these
   steps:

  <ol>
   <li>
    <p>Create a new <a href="#style-sheet">style sheet</a> object and set its
     properties as specified.

   <li>
    <p>Then run the <a href="#add-a-style-sheet">add a style sheet</a> steps
     for the newly created <a href="#style-sheet">style sheet</a>.
  </ol>

  <p>To <dfn id=add-a-style-sheet>add a style sheet</dfn>, run these steps:

  <ol>
   <li>
    <p>Add the <a href="#style-sheet">style sheet</a> to the list of <a
     href="#document-style-sheets">document style sheets</a> at the
     appropriate location. The remainder of these steps deal with the <a
     href="#style-sheet-disabled-flag">style sheet disabled flag</a>.

   <li>
    <p>If the <a href="#style-sheet-disabled-flag">style sheet disabled
     flag</a> is true terminate these steps.

   <li>
    <p>If the <a href="#style-sheet-title">style sheet title</a> is
     non-empty, the <a href="#style-sheet-alternate-flag">style sheet
     alternate flag</a> is false, and <a
     href="#preferred-style-sheet-set-name">preferred style sheet set
     name</a> is the empty string <a
     href="#change-the-preferred-style-sheet-set-name">change the preferred
     style sheet set name</a> to the <a href="#style-sheet-title">style sheet
     title</a>.

   <li>
    <p>If any of the following is true set the <a
     href="#style-sheet-disabled-flag">style sheet disabled flag</a> to false
     and terminate these steps:</p>

    <ul>
     <li>
      <p>The <a href="#style-sheet-title">style sheet title</a> is empty.

     <li>
      <p>The <a href="#last-style-sheet-set-name">last style sheet set
       name</a> is null and the <a href="#style-sheet-title">style sheet
       title</a> is a <span>case-sensitive</span> match for the <a
       href="#preferred-style-sheet-set-name">preferred style sheet set
       name</a>.

     <li>
      <p>The <a href="#style-sheet-title">style sheet title</a> is a
       <span>case-sensitive</span> match for the <a
       href="#last-style-sheet-set-name">last style sheet set name</a>.
    </ul>

   <li>
    <p>Set the <a href="#style-sheet-disabled-flag">style sheet disabled
     flag</a> to true.
  </ol>

  <p>A <dfn id=persistent-style-sheet>persistent style sheet</dfn> is a <a
   href="#style-sheet">style sheet</a> from the <a
   href="#document-style-sheets">document style sheets</a> whose <a
   href="#style-sheet-title">style sheet title</a> is the empty string and
   whose <a href="#style-sheet-alternate-flag">style sheet alternate flag</a>
   is false.

  <p>A <dfn id=style-sheet-set>style sheet set</dfn> is an ordered collection
   of one or more <a href="#style-sheet" title="style sheet">style sheets</a>
   from the <a href="#document-style-sheets">document style sheets</a> which
   have an identical <a href="#style-sheet-title">style sheet title</a> that
   is not the empty string.

  <p>A <dfn id=style-sheet-set-name>style sheet set name</dfn> is the <a
   href="#style-sheet-title">style sheet title</a> the <a
   href="#style-sheet-set">style sheet set</a> has in common.

  <p>An <dfn id=enabled-style-sheet-set>enabled style sheet set</dfn> is a <a
   href="#style-sheet-set">style sheet set</a> of which each <a
   href="#style-sheet">style sheet</a> has its <a
   href="#style-sheet-disabled-flag">style sheet disabled flag</a> set to
   false.

  <p>To <dfn id=enable-a-style-sheet-set>enable a style sheet set</dfn> with
   name <var title="">name</var>, run these steps:

  <ol>
   <li>
    <p>If <var title="">name</var> is the empty string set the <a
     href="#style-sheet-disabled-flag">style sheet disabled flag</a> for each
     <a href="#style-sheet">style sheet</a> that is in a <a
     href="#style-sheet-set">style sheet set</a> to true and terminate these
     steps.

   <li>
    <p>Set the <a href="#style-sheet-disabled-flag">style sheet disabled
     flag</a> for each <a href="#style-sheet">style sheet</a> in a <a
     href="#style-sheet-set">style sheet set</a> whose <a
     href="#style-sheet-set-name">style sheet set name</a> is a
     case-sensitive match for <var title="">name</var> to false and set it to
     false for all other <a href="#style-sheet" title="style sheet">style
     sheets</a> in a <a href="#style-sheet-set">style sheet set</a>.
  </ol>

  <p>To <dfn id=select-a-style-sheet-set>select a style sheet set</dfn> with
   name <var title="">name</var>, run these steps:

  <ol>
   <li>
    <p><a href="#enable-a-style-sheet-set">Enable a style sheet set</a> with
     name <var title="">name</var>.

   <li>
    <p>Set <a href="#last-style-sheet-set-name">last style sheet set name</a>
     to <var title="">name</var>.
  </ol>

  <p>A <dfn id=last-style-sheet-set-name>last style sheet set name</dfn> is a
   concept to determine what <a href="#style-sheet-set">style sheet set</a>
   was last <a href="#select-a-style-sheet-set" title="select a style sheet
   set">selected</a>. Initially its value is null.

  <p>A <dfn id=preferred-style-sheet-set-name>preferred style sheet set
   name</dfn> is a concept to determine which <span style="style sheet">style
   sheets</span> need to have their <a
   href="#style-sheet-disabled-flag">style sheet disabled flag</a> set to
   false. Initially its value is the empty string.

  <p>To <dfn id=change-the-preferred-style-sheet-set-name>change the
   preferred style sheet set name</dfn> with name <var title="">name</var>,
   run these steps:

  <ol>
   <li>
    <p>Let the <a href="#preferred-style-sheet-set-name">preferred style
     sheet set name</a> be <var title="">current</var>.

   <li>
    <p>Set <a href="#preferred-style-sheet-set-name">preferred style sheet
     set name</a> to <var title="">name</var>.

   <li>
    <p>If <var title="">name</var> is not a <span>case-sensitive</span> match
     for <var title="">current</var> and <a
     href="#last-style-sheet-set-name">last style sheet set name</a> is null
     <a href="#enable-a-style-sheet-set">enable a style sheet set</a> with
     name <var title="">new</var>.
  </ol>
  <!-- XXX ought to define "applied"
  
  thoughts:
    depends on disabled flag, alternate flag, media queries, sheesh
   -->

  <h4 id=the-http-default-style-header><span class=secno>5.2.1 </span>The
   HTTP <code title="">Default-Style</code> Header</h4>

  <p>The HTTP <code title=http-default-style><a
   href="#default-style">Default-Style</a></code> header can be used to set
   the <a href="#preferred-style-sheet-set-name">preferred style sheet set
   name</a> influencing which <a href="#style-sheet-set">style sheet set</a>
   is (initially) the <a href="#enabled-style-sheet-set">enabled style sheet
   set</a>.

  <p>For each HTTP <code title=http-default-style><a
   href="#default-style">Default-Style</a></code> header, in header order,
   the user agent <em class=ct>must</em> <a
   href="#change-the-preferred-style-sheet-set-name">change the preferred
   style sheet set name</a> with name being the value of the header.

  <h4 id=the-stylesheetlist-sequence><span class=secno>5.2.2 </span>The <code
   title="">StyleSheetList</code> Sequence</h4>

  <p>The sequence parameterized type represents an ordered collection of <a
   href="#style-sheet" title="style sheet">style sheets</a>.

  <pre
   class=idl>typedef sequence<<span>StyleSheet> <dfn id=stylesheetlist>StyleSheetList</dfn>;</pre>
  <!--
  <pre class="idl">interface <dfn>StyleSheetList</dfn> {
  readonly attribute unsigned long <span title="stylesheetlist-length">length</span>;
  getter <span>StyleSheet</span> <span title="stylesheetlist-item">item</span>(in unsigned long <var title="">index</var>);
};</pre>

  <p>The
  <dfn id="stylesheetlist-length" title="stylesheetlist-length"><code>length</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the number of
  objects currently in the list.</p>

  <p>The
  <dfn id="stylesheetlist-item" title="stylesheetlist-item"><code>item(<var title="">index</var>)</code></dfn>
  method, when invoked, <em class="ct">must</em> return the
  <code>StyleSheet</code> object in the list given by <var>index</var>, or
  <code>null</code>, if <var>index</var> is greater than or equal to the
  number of items in the list.</p>
-->

  <h4 id=the-documentstyle-interface><span class=secno>5.2.3 </span>The <code
   title="">DocumentStyle</code> Interface</h4>
  <!-- https://bugzilla.mozilla.org/show_bug.cgi?id=200930 (FIXED) -->

  <pre class=idl>interface <dfn id=documentstyle>DocumentStyle</dfn> {
  readonly attribute <a href="#stylesheetlist">StyleSheetList</a> <a href="#documentstyle-stylesheets">styleSheets</a>;
           attribute DOMString? <a href="#documentstyle-selectedStyleSheetSet">selectedStyleSheetSet</a>;
  readonly attribute DOMString? <a href="#documentstyle-lastStyleSheetSet">lastStyleSheetSet</a>;
  readonly attribute DOMString? <a href="#documentstyle-preferredStyleSheetSet">preferredStyleSheetSet</a>;
  readonly attribute DOMStringList <a href="#documentstyle-styleSheetSets">styleSheetSets</a>;
  void <a href="#documentstyle-enablestylesheetsforset" title=documentstyle-enablestylesheetsforset>enableStylesheetsForSet</a>(DOMString? <var>name</var>);
};

<span>Document</span> implements <a href="#documentstyle">DocumentStyle</a>;</pre>
  <!-- XXX use Supplemental instead? -->

  <p>The <dfn id=documentstyle-stylesheets><code>styleSheets</code></dfn>
   attribute <em class=ct>must</em> return a <code><a
   href="#stylesheetlist">StyleSheetList</a></code> sequence representing the
   <a href="#document-style-sheets">document style sheets</a>.

  <p>The <dfn
   id=documentstyle-selectedStyleSheetSet><code>selectedStyleSheetSet</code></dfn>
   <em class=ct>must</em>, on getting, run these steps:

  <ol>
   <li>
    <p>If there is a single <a href="#enabled-style-sheet-set">enabled style
     sheet set</a> and no other <a href="#document-style-sheets">document
     style sheets</a> with a non-empty <a href="#style-sheet-title">style
     sheet title</a> have the <a href="#style-sheet-disabled-flag">style
     sheet disabled flag</a> set to false return the <a
     href="#style-sheet-set-name">style sheet set name</a> of the <a
     href="#enabled-style-sheet-set">enabled style sheet set</a> and
     terminate this set of steps.

   <li>
    <p>Otherwise, if <a href="#style-sheet" title="style sheet">style
     sheets</a> from different <a href="#style-sheet-set" title="style sheet
     set">style sheet sets</a> have their <a
     href="#style-sheet-disabled-flag">style sheet disabled flag</a> set to
     false return null and terminate this set of steps.

   <li>
    <p>Otherwise, return the empty string.</p>

    <p class=note>At this point either all <a href="#style-sheet"
     title="style sheet">style sheets</a> with a non-empty <a
     href="#style-sheet-title">style sheet title</a> have the <a
     href="#style-sheet-disabled-flag">style sheet disabled flag</a> set to
     true or there are no such <a href="#style-sheet" title="style
     sheet">style sheets</a>.</p>
  </ol>

  <p>On setting the <code><a
   href="#documentstyle-selectedStyleSheetSet">selectedStyleSheetSet</a></code>
   attribute these steps <em class=ct>must</em> be run:

  <ol>
   <li>
    <p>If the value is null terminate this set of steps.

   <li>
    <p>Otherwise, <a href="#select-a-style-sheet-set">select a style sheet
     set</a> with as name the value passed.
  </ol>

  <p>From the DOM's perspective, all views have the same <code><a
   href="#documentstyle-selectedStyleSheetSet">selectedStyleSheetSet</a></code>.
   If a user agent supports multiple views with different selected
   alternative style sheets, then this attribute (and the <code><a
   href="#stylesheet">StyleSheet</a></code> interface's <code>disabled</code>
   attribute) <em class=ct>must</em> return and set the value for the default
   view.</p>
  <!-- XXX clean up once we get rid of views -->

  <p>The <dfn
   id=documentstyle-lastStyleSheetSet><code>lastStyleSheetSet</code></dfn>
   attribute <em class=ct>must</em> return the <a
   href="#last-style-sheet-set-name">last style sheet set name</a>.

  <p class=note>This attribute is initially null.

  <p>The <dfn
   id=documentstyle-preferredStyleSheetSet><code>preferredStyleSheetSet</code></dfn>
   attribute <em class=ct>must</em> return the <a
   href="#preferred-style-sheet-set-name">preferred style sheet set name</a>.

  <p class=note>Unlike <code><a
   href="#documentstyle-lastStyleSheetSet">lastStyleSheetSet</a></code>, this
   attribute is initially the empty string.</p>
  <!-- XXX change? -->

  <p>The <dfn
   id=documentstyle-styleSheetSets><code>styleSheetSets</code></dfn>
   attribute <em class=ct>must</em> return a list of the <a
   href="#style-sheet-set-name" title="style sheet set name">style sheet set
   names</a> of the <a href="#style-sheet-set" title="style sheet set">style
   sheet sets</a>, in order of the <a href="#document-style-sheets">document
   style sheets</a>.

  <p>The <dfn id=documentstyle-enablestylesheetsforset
   title=documentstyle-enablestylesheetsforset><code>enableStylesheetsForSet(<var
   title="">name</var>)</code></dfn> method <em class=ct>must</em>, when
   invoked, run these steps:

  <ol>
   <li>
    <p>If <var title="">name</var> is null terminate these steps.

   <li>
    <p><a href="#enable-a-style-sheet-set">Enable a style sheet set</a> with
     name <var title="">name</var>.
  </ol>

  <p class=note><a href="#style-sheet" title="Style sheet">Style sheets</a>
   with an empty <a href="#style-sheet-title">style sheet title</a> are never
   affected by this method. This method does not change the values of the
   <code><a
   href="#documentstyle-lastStyleSheetSet">lastStyleSheetSet</a></code> or
   <code><a
   href="#documentstyle-preferredStyleSheetSet">preferredStyleSheetSet</a></code>
   attributes.

  <h4 id=interaction-with-the-user-interface><span class=secno>5.2.4
   </span>Interaction with the User Interface</h4>

  <p>The user interface of Web browsers that support style sheets <em
   class=ct>should</em> list the style sheet titles given in the <code><a
   href="#documentstyle-styleSheetSets">styleSheetSets</a></code> list,
   showing the <code><a
   href="#documentstyle-selectedStyleSheetSet">selectedStyleSheetSet</a></code>
   as the selected style sheet set, leaving none selected if it is
   <code>null</code> or the empty string, and selecting an extra option
   "Basic Page Style" (or similar) if it is the empty string and the <code><a
   href="#documentstyle-preferredStyleSheetSet">preferredStyleSheetSet</a></code>
   is the empty string as well.

  <p>Selecting a style sheet from this list <em class=ct>should</em> use the
   <a href="#select-a-style-sheet-set">select a style sheet set</a> set of
   steps. This (by definition) affects the <code><a
   href="#documentstyle-lastStyleSheetSet">lastStyleSheetSet</a></code>
   attribute.

  <h5 id=persisting-the-selected-style-sheet-set><span class=secno>5.2.4.1.
   </span>Persisting the selected style sheet set</h5>

  <p>If a user agent persist the selected style sheet set, they should use
   the value of the <code><a
   href="#documentstyle-selectedStyleSheetSet">selectedStyleSheetSet</a></code>
   attribute, or if that is <code>null</code>, the <code><a
   href="#documentstyle-lastStyleSheetSet">lastStyleSheetSet</a></code>
   attribute, when leaving the page (or at some other time) to determine the
   set name to store. If that is <code>null</code> then the style sheet set
   should not be persisted.

  <p>When re-setting the style sheet set to the persisted value (which can
   happen at any time, typically at the first time the style sheets are
   needed for styling the document, after the <code>&lt;head&gt;</code> of
   the document has been parsed, after any scripts that are not dependent on
   computed style have executed), the style sheet set <em
   class=ct>should</em> be set by using the <a
   href="#select-a-style-sheet-set">select a style sheet set</a> set of steps
   as if the user had selected the set manually.

  <p class=note>This specification does not give any suggestions on how user
   agents should decide to persist the style sheet set or whether or how to
   persist the selected set across pages.</p>
  <!-- XXX this UI section suggests we may want to introduce a few more
       idioms -->

  <h4 id=examples><span class=secno>5.2.5 </span>Examples</h4>

  <div class=example>
   <p>Thus, in the following HTML snippet:</p>

   <pre>&lt;link rel="alternate stylesheet" title="foo" href="a"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="b"&gt;
&lt;script&gt;

  document.selectedStyleSheetSet = 'foo';
  document.styleSheets[1].disabled = false;
&lt;/script&gt;
&lt;link rel="alternate stylesheet" title="foo" href="c"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="d"&gt;</pre>

   <p>...the style sheets that end up enabled are style sheets "a", "b", and
    "c", the <code><a
    href="#documentstyle-selectedStyleSheetSet">selectedStyleSheetSet</a></code>
    attribute would return null, <code><a
    href="#documentstyle-lastStyleSheetSet">lastStyleSheetSet</a></code>
    would return "foo", and <code><a
    href="#documentstyle-preferredStyleSheetSet">preferredStyleSheetSet</a></code>
    would return "".</p>

   <p>Similarly, in the following HTML snippet:</p>

   <pre>&lt;link rel="alternate stylesheet" title="foo" href="a"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="b"&gt;
&lt;script&gt;
  var before = document.preferredStyleSheetSet;
  document.styleSheets[1].disabled = false;
&lt;/script&gt;
&lt;link rel="stylesheet" title="foo" href="c"&gt;

&lt;link rel="alternate stylesheet" title="bar" href="d"&gt;
&lt;script&gt;
  var after = document.preferredStyleSheetSet;
&lt;/script&gt;</pre>

   <p>...the "before" variable will be equal to the empty string, the "after"
    variable will be equal to "foo", and style sheets "a" and "c" will be
    enabled. This is the case even though the first script block sets style
    sheet "b" to be enabled, because upon parsing the following
    <code>&lt;link&gt;</code> element, the <code><a
    href="#documentstyle-preferredStyleSheetSet">preferredStyleSheetSet</a></code>
    is set and the <code title=documentstyle-enablestylesheetsforset><a
    href="#documentstyle-enablestylesheetsforset">enableStylesheetsForSet()</a></code>
    method is called (since <code><a
    href="#documentstyle-selectedStyleSheetSet">selectedStyleSheetSet</a></code>
    was never set explicitly, leaving <code><a
    href="#documentstyle-lastStyleSheetSet">lastStyleSheetSet</a></code> at
    <code>null</code> throughout), which changes which style sheets are
    enabled and which are not.</p>
  </div>

  <h3 id=style-sheet-assocation><span class=secno>5.3 </span>Style Sheet
   Assocation</h3>

  <p>This section defines the interface a <a href="#style-sheet-node">style
   sheet node</a> of a <a href="#style-sheet">style sheet</a> has to
   implement and defines the requirements for <a
   href="#xml-stylesheet-processing-instruction" title="xml-stylesheet
   processing instruction">xml-stylesheet processing instructions</a> and
   HTTP <code title=http-link>Link</code> headers when the link releation
   type is an <span>ASCII case-insensitive</span> match for "<code
   title="">stylesheet</code>" since nobody else was interested in defining
   this.

  <p>The editor is in good hope that HTML and SVG will define the appropriate
   processing in their respective specifications, in terms of this
   specification, in due course.

  <h4 id=the-linkstyle-interface><span class=secno>5.3.1 </span>The <code
   title="">LinkStyle</code> Interface</h4>

  <p>The <dfn id=associated-style-sheet>associated style sheet</dfn> of a
   node is the <a href="#style-sheet">style sheet</a> in the list of <a
   href="#document-style-sheets">document style sheets</a> of which the <a
   href="#style-sheet-node">style sheet node</a> implements the <code><a
   href="#linkstyle">LinkStyle</a></code> interface.

  <pre class=idl>interface <dfn id=linkstyle>LinkStyle</dfn> {
  readonly attribute <a href="#stylesheet">StyleSheet</a> <a href="#linkstyle-sheet" title=linkstyle-sheet>sheet</a>;
};</pre>

  <p>The <dfn id=linkstyle-sheet
   title=linkstyle-sheet><code>sheet</code></dfn> attribute <em
   class=ct>must</em> return the <a href="#associated-style-sheet">associated
   style sheet</a> for the node, or null, if there is no <a
   href="#associated-style-sheet">associated style sheet</a>.

  <div class=example>
   <p>In the following HTML snippet the first HTML <code>style</code> element
    has a <code>sheet</code> attribute that returns a <code><a
    href="#stylesheet">StyleSheet</a></code> object representing the style
    sheet, but for the second <code>style</code> attribute it returns null.
    (Assuming the user agent supports CSS (<code>text/css</code>) and does
    not support ExampleSheets (<code>text/example-sheets</code>).</p>

   <pre>&lt;style type=text/css> body { background:lime } &lt;/style>
&lt;style type=text/example-sheets> $(body).background := lime &lt;/style></pre>
  </div>

  <p class=note>Whether or not the node refers to a style sheet is defined by
   the specification that defines the semantics of said node.

  <h4 id=requirements-on-specifications><span class=secno>5.3.2
   </span>Requirements on specifications</h4>

  <p>Specifications introducing new ways of associating style sheets through
   the DOM <em class=ct>should</em> define which nodes implement the <code><a
   href="#linkstyle">LinkStyle</a></code> interface. When doing so, they <em
   class=ct>must</em> also define when a <a href="#style-sheet">style
   sheet</a> is <a href="#create-a-style-sheet" title="create a style
   sheet">created</a>.

  <h4 id=requirements-on-user-agents-implementing><span class=secno>5.3.3
   </span>Requirements on User Agents Implementing the <span
   title=""><code>xml-stylesheet</code> processing instruction</span></h4>
  <!-- XXX ref, one day -->

  <pre
   class=idl><span>ProcessingInstruction</span> implements <a href="#linkstyle">LinkStyle</a>;</pre>

  <p>For each <a
   href="#xml-stylesheet-processing-instruction"><code>xml-stylesheet</code>
   processing instruction</a> with an <code title="">href</code>
   pseudo-attribute these steps <em class=ct>must</em> (unless otherwise
   stated) be run:

  <ol>
   <li>
    <p>If there is an <code title="">alternate</code> pseudo-attribute whose
     value is a <span>case-sensitive</span> match for "<code
     title="">yes</code>" and there is a <code title="">title</code>
     pseudo-attribute whose value is the empty string terminate these steps.

   <li>
    <p>If there is a <code title="">type</code> pseudo-attribute whose value
     is not a <a href="#supported-styling-language">supported styling
     language</a> the user agent <em class=ct>may</em> terminate these steps.

   <li>
    <p><a href="#resolve-a-url" title="Resolve a URL">Resolve</a> the <a
     href="#url">URL</a> specified by the <code title="">href</code>
     pseudo-attribute and then <a href="#fetch">fetch</a> it.

   <li>
    <p>When the resource is available, the document is in <span>quirks
     mode</span> and the <a href="#content-type-metadata">Content-Type
     metadata</a> of the resource is not a <a
     href="#supported-styling-language">supported styling language</a> change
     the <a href="#content-type-metadata">Content-Type metadata</a> of the
     resource to <code title="">text/css</code>.</p>

    <p class=note>This step might never actually happen, but is included here
     in case other specifications change, to keep things consistent.</p>

   <li>
    <p>If the resource is not in a <a
     href="#supported-styling-language">supported styling language</a>
     terminate these steps.

   <li>
    <p><a href="#create-a-style-sheet">Create a style sheet</a> with the
     following properties:</p>

    <dl>
     <dt><a href="#style-sheet-type">style sheet type</a>

     <dd>
      <p>The <code><a href="#content-type-metadata">Content-Type
       metadata</a></code> of the resource.

     <dt><a href="#style-sheet-location">style sheet location</a>

     <dd>
      <p>The <span>absolute URL</span> of the resource.

     <dt><a href="#style-sheet-node">style sheet node</a>

     <dd>
      <p>The node.

     <dt><a href="#style-sheet-parent">style sheet parent</a>

     <dd>
      <p>null

     <dt><a href="#style-sheet-media">style sheet media</a>

     <dd>
      <p>The value of the <code title="">media</code> pseudo-attribute if
       any, or the empty string otherwise.
     </dd>
     <!-- XXX turn this into a MediaList object -->

     <dt><a href="#style-sheet-title">style sheet title</a>

     <dd>
      <p>The value of the <code title="">title</code> pseudo-attribute, if
       any, or the empty string otherwise.

     <dt><a href="#style-sheet-alternate-flag">style sheet alternate flag</a>

     <dd>
      <p>True if the <code title="">alternate</code> pseudo-attribute value
       is a <span>case-sensitive</span> match for "<code>yes</code>".
       Otherwise, false.
    </dl>
  </ol>

  <h4 id=requirements-on-user-agents-implementing0><span class=secno>5.3.4
   </span>Requirements on User Agents Implementing the HTTP <code
   title="">Link</code> Header</h4>
  <!-- XXX ref, one day -->

  <p>For each HTTP <code title=http-link>Link</code> header of which one of
   the link relation types is an <span>ASCII case-insensitive</span> match
   for "<code title="">stylesheet</code>" these steps <em class=ct>must</em>
   be run:

  <ol>
   <li>
    <p>Let <var title="">title</var> be the value of the first of all the
     <code title="">title</code> and <code title="">title*</code> parameters.
     If there are no such parameters it is the empty string.

   <li>
    <p>If one of the (other) link relation types is an <span>ASCII
     case-insensitive</span> match for "<code title="">alternate</code>" and
     <var title="">title</var> is the empty string terminate these steps.

   <li>
    <p><a href="#resolve-a-url" title="Resolve a URL">Resolve</a> the
     specified <a href="#url">URL</a> and <a href="#fetch">fetch</a> it.

   <li>
    <p>When the resource is available, the document is in <span>quirks
     mode</span> and the <a href="#content-type-metadata">Content-Type
     metadata</a> of the resource is not a <a
     href="#supported-styling-language">supported styling language</a> change
     the <a href="#content-type-metadata">Content-Type metadata</a> of the
     resource to <code title="">text/css</code>.

   <li>
    <p>If the resource is not in a <a
     href="#supported-styling-language">supported styling language</a>
     terminate these steps.

   <li>
    <p><a href="#create-a-style-sheet">Create a style sheet</a> with the
     following properties:</p>

    <dl>
     <dt><a href="#style-sheet-type">style sheet type</a>

     <dd>
      <p>The <a href="#content-type-metadata">Content-Type metadata</a> of
       the resource.

     <dt><a href="#style-sheet-location">style sheet location</a>

     <dd>
      <p>The <span>absolute URL</span> of the resource.

     <dt><a href="#style-sheet-node">style sheet node</a>

     <dd>
      <p>null

     <dt><a href="#style-sheet-parent">style sheet parent</a>

     <dd>
      <p>null

     <dt><a href="#style-sheet-media">style sheet media</a>

     <dd>
      <p>The value of the first <code title="">media</code> parameter.
     </dd>
     <!-- XXX turn this into a MediaList object; register media parameter? bah -->

     <dt><a href="#style-sheet-title">style sheet title</a>

     <dd>
      <p><var title="">title</var>

     <dt><a href="#style-sheet-alternate-flag">style sheet alternate flag</a>

     <dd>
      <p>True if one of the specified link relation type for this HTTP <code
       title=http-link>Link</code> header is an <span>ASCII
       case-insensitive</span> match for "<code title="">alternate</code>".
       Otherwise, false.
    </dl>
  </ol>

  <h2 id=cascading-style-sheets-apis><span class=secno>6 </span>Cascading
   Style Sheets APIs</h2>

  <p><em>This section (and its subsections) are only applicable to user
   agents implementing CSS.</em>

  <p>The previous section provided a way of getting access to style sheets in
   a generic way. This section provides a way for getting access to the
   individual style rules within a Cascading Style Sheet as defined by the
   CSS specifications. [CSS]

  <h3 id=parsing-and-serializing-css-constructs><span class=secno>6.1
   </span>Parsing and Serializing CSS Constructs</h3>
  <!--
   statement "[S|CDO|CDC]* [ import [S|CDO|CDC]* ]* [ [ ruleset | media | page ] [S|CDO|CDC]* ]*" ??

   selectors "*"
   page selectors "S* pseudo_page? S*"

   declaration "S* declaration" (properties, property values, property priority)

   property value "S* expr"
  -->

  <p>This section (and its subsections) define rules for parsing and
   serialization of CSS constructs.

  <h4 id=css-value-rules><span class=secno>6.1.1 </span>CSS Value Rules</h4>

  <p>The rules for <dfn id=parsing-a-css-value title="CSS value
   parsing">parsing a CSS value</dfn> for a given <var
   title="">property</var> are as given in the following algorithm. The
   result is either a CSS value or "null" if the operation failed.

  <ol>
   <li>Parse the value using the <code>S* expr</code> production in
    combination with the allowed values for the given <var
    title="">property</var>. If this fails return "null". Otherwise return
    the parsed value.
  </ol>

  <p>The aforementioned production is defined in the CSS 2.1 specification.
   [CSS]

  <p>The rules for <dfn id=serializing-a-css-value title="CSS value
   serializing">serializing a CSS value</dfn> are as given in the following
   algorithm:

  <ol>
   <li>
    <p>Relative lengths (<code>em</code>, <code>ex</code>, <code>px</code>,
     all the font-size keywords and <code>%</code>) do not have their units
     changed. However, absolute lengths must be given in millimeters. For
     example, the canonical version of <code>+012.0pt</code> is
     <code>4.2333mm</code> (give or take a few significant figures). <span
     class=note><em>Computed</em> values may well be in different units than
     the specified value. User agents are to use <code>px</code> as their
     final units for computed length values.</span>

   <li>
    <p>When a <code>&lt;length></code> of zero is given, then any specified
     units <em class=ct>must</em> be removed.
   </li>
   <!-- apparently "0px" is better for interop -->

   <li>
    <p>A <code>&lt;color></code> value is canonicalized as follows:</p>

    <dl>
     <dt>It is a system color

     <dd>See below (you use the representation given in the specification
      that defines the keyword).

     <dt>Alpha component is equal to 1.0

     <dd>The color is an uppercase six-digit hexadecimal value, prefixed with
      a <code>#</code> character (U+0023 NUMBER SIGN), with the first two
      digits representing the red component, the next two digits representing
      the green component, and the last two digits representing the blue
      component, the digits being in the range 0-9 A-F (U+0030 to U+0039 and
      U+0041 to U+0046).

     <dt>Alpha component is less than 1.0

     <dd>The color is in the CSS <code>rgba()</code> functional-notation
      format: the literal string <code>rgba</code> (U+0072 U+0067 U+0062
      U+0061) followed by a U+0028 LEFT PARENTHESIS, a <a
      href="#color-component-integer">color component integer</a>
      representing the red component, a <a
      href="#color-component-separator">color component separator</a>, a <a
      href="#color-component-integer">color component integer</a> for the
      green component, a <a href="#color-component-separator">color component
      separator</a>, a <a href="#color-component-integer">color component
      integer</a> for the blue component, another <a
      href="#color-component-separator">color component separator</a> a
      U+0030 DIGIT ZERO, a U+002E FULL STOP (representing the decimal point),
      one or more digits in the range 0-9 (U+0030 to U+0039) representing the
      fractional part of the alpha value, and finally a U+0029 RIGHT
      PARENTHESIS.

     <dt>The keyword <code>transparent</code> is used

     <dd>The color is <code>rgba(0, 0, 0, 0)</code>.
    </dl>

   <li>
    <p>Angles are canonicalized to <code>deg</code> and normalized to the
     range of their property. For example, <code>azimuth: 700grad</code>
     would be canonicalized to <code>azimuth: 270deg</code>. This also
     applies to angle keywords as used in the <code>elevation</code> and
     <code>azimuth</code> properties, they are canonicalized to their value
     in degrees.

   <li>
    <p>Times are canonicalized to seconds (<code>s</code>).

   <li>
    <p>Frequencies are canonicalized to Hertz (<code>Hz</code>).

   <li>
    <p>For all integers and real numbers, including those with units, these
     canonicalization steps <em class=ct>must</em> be followed: If the number
     is <code>0</code>, the canonical result is the literal string
     <code>0</code> plus any units (for lengths, the unit identifier will
     have been removed before this step). Otherwise, leading
     <!--and trailing -->zeros <em class=ct>must</em> be omitted, any leading
     <code>+</code> <em class=ct>must</em> be omitted, the decimal point in a
     real number <em class=ct>must</em> be omitted unless there is a
     fractional part, and if the number is in the range <code>-1 &lt;
     <var>x</var> &lt; 1</code>, then one leading <code>0</code> <em
     class=ct>must</em> be inserted before the decimal point. The number of
     given significant figures is completely user agent dependent.

   <li>
    <p>Where multiple values may appear in any order without changing the
     meaning of the value (typically represented by a double bar
     <code>||</code> in the value syntax), user agents are to use the
     canonical order as given in the syntax (e.g. <code>&lt;border-width>
     &lt;border-style> &lt;color></code> for the <code>border</code>
     short-hand property).

   <li>
    <p>When repeated values may be omitted without changing the meaning of
     the value (e.g. as in the <code>margin</code> and <code>padding</code>
     properties), then the fewest number of values should be given.

   <li>
    <p>If whitespace may be removed without changing the meaning of the value
     it is to be removed.

   <li>
    <p><code>&lt;specific-voice></code> and <code>&lt;family-name</code>
     values are to be quoted.

   <li>
    <p>Double quotes (rather than single quotes) <em class=ct>shall</em> be
     used for string quotation. (When changing from single quotes to double
     quotes, double quotes already in the string are escaped.)

   <li>
    <p>The quotes in the <code>&lt;uri></code> form should be removed.
     (Parenthesises that were in the string, along with any other characters
     not legal when the string is not quoted (such as commas), must be
     escaped.)

   <li>
    <p>Unnecessary escapes should be removed. (For example, <code>\z</code>
     should be represented as <code>z</code>. This extends to unescaping
     UNICODE escapes, except, of course, if the encoding cannot contain those
     characters!)

   <li>
    <p>Where components of the value may be dropped without changing the
     meaning of the value (for example, initial values in shorthand
     properties), then they should be removed. If this would remove all the
     values, then the first allowed value must be given (For example, for
     <code>background</code> that would be <code>rgba(0, 0, 0, 0)</code>
     since <code>background-color</code> is the first component of the value;
     for <code>border</code> it would be <code>0</code> since the first
     component of that value is <code>border-width</code>).

   <li>
    <p>A single space should be added after each comma that is not part of a
     string, except where that would change the meaning of the value. For
     example:</p>

    <pre>foo,bar,baz</pre>

    <p>should become:</p>

    <pre>foo, bar, baz</pre>

   <li>
    <p>Whenever case is insensitive, for example in property or counter
     names, the text should be changed to the canonical case as given in the
     syntax definition. For example, the canonical value of:</p>

    <pre>COUNTER( PAR-NUM,UPPER-ROMAN ) DISC</pre>

    <p>is:</p>

    <pre>counter(par-num, upper-roman) disc</pre>

    <p>but the color <code>WINDOWTEXT</code> becomes <code>WindowText</code>.</p>
  </ol>

  <h5 id=examples-of-the-css-value-serializing-al><span class=secno>6.1.1.1.
   </span>Examples of the CSS Value Serializing Algorithm</h5>

  <p>The steps above should guarantee that there is no data loss, from a CSS
   point of
   view<!--, other than for color values on systems with colors stored
  with more than 32 bits-->.
   Here are some examples of before and after results on specified values.
   The before column could be what the author wrote in a stylesheet, while
   the after column shows what querying the DOM would return.

  <div class=example>
   <table>
    <thead>
     <tr>
      <th>Before

      <th>After

    <tbody>
     <tr>
      <td><code>background: none</code>

      <td><code>background: rgba(0, 0, 0, 0)</code>

     <tr>
      <td><code>outline: none</code>

      <td><code>outline: invert</code>

     <tr>
      <td><code>border: none</code>

      <td><code>border: medium</code>

     <tr>
      <td><code>list-style: none</code>

      <td><code>list-style: disc</code>

     <tr>
      <td><code>margin: 0px 1px 1px 1px</code>

      <td><code>margin: 0 1px 1px</code>

     <tr>
      <td><code>azimuth: behind left</code>

      <td><code>azimuth: 220deg</code>

     <tr>
      <td><code>font-family: a, 'b"', serif</code>

      <td><code>font-family: "a", "b\"", serif</code>

     <tr>
      <td><code>content: url('h)i') '\[\]'</code>

      <td><code>content: url(h\)i) "[]"</code>

     <tr>
      <td><code>azimuth: leftwards</code>

      <td><code>azimuth: leftwards</code>

     <tr>
      <td><code>color: rgb(18, 52, 86)</code>

      <td><code>color: #123456</code>

     <tr>
      <td><code>color: rgba(000001, 0, 0, 1)</code>

      <td><code>color: #000000</code>
   </table>
  </div>

  <h4 id=selectors-rules><span class=secno>6.1.2 </span>Selectors Rules</h4>

  <p>The rules for <dfn id=selectors-parsing title="selectors
   parsing">parsing a group of selectors</dfn> are as given in the following
   algorithm. The return value is either a group of selectors or "null" (if
   parsing failed).

  <ol>
   <li>Parse the value using the <code>selectors_group</code> production. If
    this fails return "null". Otherwise return the parsed value.
  </ol>

  <p>The aforementioned production is defined in the Selectors specification.
   [Selectors]

  <p>The rules for <dfn id=selectors-serializing title="selectors
   serializing">serializing a group of selectors</dfn> are as given in the
   following algorithm. The input is a a non-normalized group of selectors
   and the output is a normalized group of selectors.

  <ol>
   <li>
    <p>Replace one or more consecutive <a href="#whitespace">whitespace</a>
     characters with a single U+0020 character.

   <li>
    <p>Remove leading and trailing <a href="#whitespace">whitespace</a>.

   <li>
    <p>Make sure combinators other than the descendant combinator are
     preceded and followed by a single U+0020 character (and not more).

   <li>
    <p>Make sure each U+002C (<code>,</code>) character is followed by a
     single U+0020 character (and not more).

   <li>
    <p>Convert pseudo-classes and pseudo-elements to their canonical form as
     given in the specification. <span class=note><code>:HOver</code> becomes
     <code>:hover</code> and <code>:befoRe</code> becomes
     <code>::before</code> for example.</span>

   <li>
    <p class=issue>Hmm, what about pseudo-classes taking arguments? Attribute
     selectors? Namespace prefixes?
  </ol>

  <h4 id=css-page-selectors-rules><span class=secno>6.1.3 </span>CSS Page
   Selectors Rules</h4>

  <p class=issue>Need to define the rules for <dfn
   id=css-page-selectors-parsing title="CSS page selectors parsing">parsing a
   CSS page selector</dfn> and <dfn id=css-page-selectors-serializing
   title="CSS page selectors serializing">serializing a CSS page
   selector</dfn>.

  <h4 id=processing-css-statements><span class=secno>6.1.4 </span>Processing
   CSS Statements</h4>

  <p class=issue>Need to split this up in parsing and common algorithms.

  <p>The rules for <dfn id=inserting-a-statement title="insert a
   statement">inserting a statement</dfn> are as given in the following
   algorithm. The variables <var>rule</var>, <var>rule list</var> and
   <var>index</var> are to be considered equivalent to the identically named
   variables used when invoking this algorithm. If an exception is raised the
   algorithm is to be aborted. The steps <em class=ct>must</em> be followed
   in order, as follows:

  <ol>
   <li>
    <p>If <var>index</var> is negative or greater than the length of the
     <var>rule list</var> an <code>INDEX_SIZE_ERR</code> exception <em
     class=ct>must</em> be raised.

   <li>
    <p>Parse <var>rule</var> as a CSS statement. If the <var>rule</var> is
     ignored by the CSS parser abort this algorithm (don't raise an
     exception). Otherwise, create an object that implements one of the
     inherited interfaces of <code>CSSStyle</code> appropriate for the parsed
     <var>rule</var>. Let <var>object</var> be the newly created object.

   <li>
    <p>If <var>object</var> can't be inserted within the <var>rule list</var>
     at the given <var>index</var> because that's not allowed per the CSS
     specification a <code>HIERARCHY_REQUEST_ERR</code> exception <em
     class=ct>must</em> be raised.

   <li>
    <p>Insert <var>object</var> at the given <var>index</var> within the
     <var>rule list</var>.
  </ol>

  <p>The rules for <dfn id=removing-a-statement title="remove a
   statement">removing a statement</dfn> are as given in the following
   algorithm. The variables <var>index</var> and <var>rule list</var> are to
   be considered equivalent to the identically named variables used when
   invoking this algorithm. If an exception is raised this algorithm is to be
   aborted. The steps <em class=ct>must</em> be followed in order, as
   follows:

  <ol>
   <li>
    <p>If <var>index</var> is negative or greater than the length of the
     <var>rule list</var> an <code>INDEX_SIZE_ERR</code> exception <em
     class=ct>must</em> be raised.

   <li>
    <p>Remove the object at <var>index</var> from <var>rule list</var>.
  </ol>

  <p>The rules for <dfn id=replacing-a-statement title="replace a
   statement">replacing a statement</dfn> are as given in the following
   algorithm. The variable <var>rule</var> and <var>old object</var> are to
   be considered equivalent to the identically named variables used when
   invoking this algorithm. If an exception is raised this algorithm is to be
   aborted. The steps <em class=ct>must</em> be followed in order, as
   follows:

  <ol>
   <li>
    <p>Parse <var>rule</var> as a CSS statement. If the <var>rule</var> is
     ignored by the CSS parser abort this algorithm (don't raise an
     exception). Otherwise, create an object that implements one of the
     inherited interfaces of <code>CSSStyle</code> appropriate for the parsed
     <var>rule</var>. Let <var>object</var> be the newly created object.

   <li>
    <p>If the <code title=cssrule-type><a
     href="#cssrule-type">type</a></code> of <var>object</var> does not match
     the <code title=cssrule-type><a href="#cssrule-type">type</a></code> of
     <var>old object</var> it will replace user agents <em class=ct>must</em>
     raise an <code>INVALID_MODIFICATION_ERR</code> exception.

   <li>
    <p>Replace <var>old object</var> with <var>object</var>.
  </ol>

  <h3 id=the-cssstylesheet-interface><span class=secno>6.2 </span>The <code
   title="">CSSStyleSheet</code> Interface</h3>

  <p>The <code><a href="#cssstylesheet">CSSStyleSheet</a></code> interface
   represents a <span>CSS style sheet</span>.</p>
  <!--
   IE exposes:
   owningElement, pages, id, type, href, disabled, cssText, readOnly, title,
   parentStyleSheet, imports, rules, media
  -->

  <pre
   class=idl>interface <dfn id=cssstylesheet>CSSStyleSheet</dfn> : <a href="#stylesheet">StyleSheet</a> {
  readonly attribute <a href="#cssrule">CSSRule</a> <a href="#cssstylesheet-ownerrule">ownerRule</a>;
  readonly attribute <a href="#cssrulelist">CSSRuleList</a> <a href="#cssstylesheet-cssrules" title=cssstylesheet-cssrules>cssRules</a>;
  unsigned long <a href="#cssstylesheet-insertrule" title=cssstylesheet-insertrule>insertRule</a>(in DOMString <var>rule</var>, in unsigned long <var>index</var>);
  void <a href="#cssstylesheet-deleterule" title=cssstylesheet-deleterule>deleteRule</a>(in unsigned long <var>index</var>);
};</pre>

  <p>The <dfn id=cssstylesheet-ownerrule><code>ownerRule</code></dfn>
   attribute, on getting, <em class=ct>must</em> return the <code><a
   href="#cssimportrule">CSSImportRule</a></code> that caused this style
   sheet to be imported (if any). Otherwise, if no <code><a
   href="#cssimportrule">CSSImportRule</a></code> caused it to be imported
   the attribute <em class=ct>must</em> return <code>null</code>.

  <p>The <dfn id=cssstylesheet-cssrules
   title=cssstylesheet-cssrules><code>cssRules</code></dfn> attribute, on
   getting, <em class=ct>must</em> return a <code><a
   href="#cssrulelist">CSSRuleList</a></code> object consisting of a list of
   statements in order they were found in the <span>CSS style sheet</span>.

  <p class=note>Statements that were dropped during parsing can not be found
   using these APIs.

  <p>The <dfn id=cssstylesheet-insertrule
   title=cssstylesheet-insertrule><code>insertRule(<var title="">rule</var>,
   <var title="">index</var>)</code></dfn> method, when invoked, <em
   class=ct>must</em> <a href="#inserting-a-statement">insert a statement</a>
   where <var>rule</var> is <var>rule</var>, <var>index</var> is
   <var>index</var> and <var>rule list</var> is <code
   title=cssstylesheet-cssrules><a
   href="#cssstylesheet-cssrules">cssRules</a></code>.

  <p>The <dfn id=cssstylesheet-deleterule
   title=cssstylesheet-deleterule><code>deleteRule(<var
   title="">index</var>)</code></dfn> method, when invoked, <em
   class=ct>must</em> <a href="#removing-a-statement">remove a statement</a>
   where <var>index</var> is <var>index</var> and <var>rule list</var> is
   <code title=cssmediarule-cssrules><a
   href="#cssmediarule-cssrules">cssRules</a></code>.

  <h3 id=the-cssrulelist-interface><span class=secno>6.3 </span>The <code
   title="">CSSRuleList</code> Interface</h3>

  <p>The <code><a href="#cssrulelist">CSSRuleList</a></code> object
   represents an ordered collection of CSS statements. Items in this
   collection are accessible through an integral index, starting from zero.

  <pre class=idl>interface <dfn id=cssrulelist>CSSRuleList</dfn> {
  readonly attribute unsigned long <a href="#cssrulelist-length" title=cssrulelist-length>length</a>;
  <a href="#cssrule">CSSRule</a> <a href="#cssrulelist-item" title=cssrulelist-item>item</a>(in unsigned long <var title="">index</var>);
};</pre>

  <p>The <dfn id=cssrulelist-length
   title=cssrulelist-length><code>length</code></dfn> attribute, on getting,
   <em class=ct>must</em> return the number of items associated with the
   object.

  <p>The <dfn id=cssrulelist-item title=cssrulelist-item><code>item(<var
   title="">index</var>)</code></dfn> method, when invoked, <em
   class=ct>must</em> return the <code><a href="#cssrule">CSSRule</a></code>
   object in the list given by <var>index</var>, or <code>null</code>, if
   <var>index</var> is greater than or equal to the number of items in the
   list.

  <h3 id=interfaces-for-css-statements><span class=secno>6.4
   </span>Interfaces for CSS Statements</h3>

  <p>This section defines several specific interfaces for different types of
   CSS statements and one generic from which the more specific inherit.

  <h4 id=the-cssrule-interface><span class=secno>6.4.1 </span>The <code
   title="">CSSRule</code> Interface</h4>

  <p>The <code><a href="#cssrule">CSSRule</a></code> interface a base
   interface. Each specific CSS statement has an interface which inherits
   from this one.

  <pre class=idl>interface <dfn id=cssrule>CSSRule</dfn> {
  // CSS statement type
  const unsigned short <a href="#cssrule-style-rule">STYLE_RULE</a> = 1;
  const unsigned short <a href="#cssrule-import-rule">IMPORT_RULE</a> = 3;
  const unsigned short <a href="#cssrule-media-rule">MEDIA_RULE</a> = 4;
  const unsigned short <a href="#cssrule-font-face-rule">FONT_FACE_RULE</a> = 5;
  const unsigned short <a href="#cssrule-page-rule">PAGE_RULE</a> = 6;
  const unsigned short <a href="#cssrule-namespace-rule">NAMESPACE_RULE</a> = 7;
  readonly attribute unsigned short <a href="#cssrule-type" title=cssrule-type>type</a>;

  // Textual representation
           attribute DOMString <a href="#cssrule-csstext" title=cssrule-csstext>cssText</a>;
  
  // Context information
  readonly attribute <a href="#cssrule">CSSRule</a> <a href="#cssrule-parentrule" title=cssrule-parentrule>parentRule</a>;
  readonly attribute <a href="#cssstylesheet">CSSStyleSheet</a> <a href="#cssrule-parentstylesheet" title=cssrule-parentstylesheet>parentStyleSheet</a>;
};</pre>
  <!-- 0 is CSSUnknownRule and 2 is CSSCharsetRule, both dropped -->

  <p>The <dfn id=cssrule-type title=cssrule-type><code>type</code></dfn>
   attribute, on getting, <em class=ct>must</em> return the CSS statement
   type as detailed for each specific type.

  <p>The <dfn id=cssrule-csstext
   title=cssrule-csstext><code>cssText</code></dfn> attribute, on setting,
   <em class=ct>must</em> <a href="#replacing-a-statement">replace a
   statement</a> where <var>rule</var> is the value being set and <var>old
   object</var> is the object of which this attribute is set.

  <p>On getting the <code title=cssrule-csstext><a
   href="#cssrule-csstext">cssText</a></code> attribute, <span
   class=issue>...</span>.</p>
  <!-- XXX the serialization depends on the type -->

  <p>The <dfn id=cssrule-parentrule
   title=cssrule-parentrule><code>parentRule</code></dfn> attribute <em
   class=ct>must</em> return the nearest enclosing rule of the current rule
   or <code>null</code>, if there is no enclosing rule. For example, an <code
   title="">@media</code> block enclosing the current rule.

  <p>The <dfn id=cssrule-parentstylesheet
   title=cssrule-parentstylesheet><code>parentStyleSheet</code></dfn>
   attribute <em class=ct>must</em> return the <code><a
   href="#cssstylesheet">CSSStyleSheet</a></code> object that contains the
   the current rule.

  <h5 id=extensibility><span class=secno>6.4.1.1. </span>Extensibility</h5>

  <p>The constant values 0-1000 are reserved for future use by the CSS WG.

  <p>Vendors are encouraged to use reasonably unique values outside this
   range so that they do not clash with extensions from other vendors. For
   example, the first value for Mozilla could be
   <code>0x0<strong>8EC0</strong>001</code> and
   <code>0x<strong>09E8A</strong>001</code> could be the first for Opera.

  <p>Vendors are encouraged to prefix the new interface names with a vendor
   specific prefix. For example, "Example company" could have an interface
   called "ExampleCSSTestRule".

  <p>In general, vendors are encouraged to discuss extensions on a public
   forum, such as <code>www-style@w3.org</code>.

  <h4 id=the-cssstylerule-interface><span class=secno>6.4.2 </span>The <code
   title="">CSSStyleRule</code> Interface</h4>

  <p>The <code><a href="#cssstylerule">CSSStyleRule</a></code> object
   represents a ruleset specified (if any) in a <span>CSS style sheet</span>.
   It provides access to a declaration block as well as to the associated
   group of selectors.

  <p>Objects implementing the <code><a
   href="#cssstylerule">CSSStyleRule</a></code> interface can be identified
   by the <dfn id=cssrule-style-rule><code>STYLE_RULE</code></dfn> constant.
   On these objects the <code title=cssrule-type><a
   href="#cssrule-type">type</a></code> attribute <em class=ct>must</em>
   return the value of that constant.

  <pre
   class=idl>interface <dfn id=cssstylerule>CSSStyleRule</dfn> : <a href="#cssrule">CSSRule</a> {
           attribute DOMString <a href="#cssstylerule-selectortext" title=cssstylerule-selectortext>selectorText</a>;
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#cssstylerule-style" title=cssstylerule-style>style</a>;
};</pre>

  <p>The <dfn id=cssstylerule-selectortext
   title=cssstylerule-selectortext><code>selectorText</code></dfn> attribute,
   on getting, <em class=ct>must</em> return the result of <a
   href="#selectors-serializing" title="selectors serializing">serializing a
   group of selectors</a>. On setting, the setted value <em
   class=ct>must</em> be used as input for <a href="#selectors-parsing"
   title="selectors parsing">parsing a group of selectors</a> and if that
   returns a non-"null" value that is to be used as a selector for the CSS
   statement. If it returns "null" setting <em class=ct>must not</em> have an
   effect.

  <p>The <dfn id=cssstylerule-style
   title=cssstylerule-style><code>style</code></dfn> attribute <em
   class=ct>must</em> return a live <code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> object for the
   ruleset.

  <h4 id=the-cssimportrule-interface><span class=secno>6.4.3 </span>The <code
   title="">CSSImportRule</code> Interface</h4>

  <p>Objects implementing the <code><a
   href="#cssimportrule">CSSImportRule</a></code> interface can be identified
   by the <dfn id=cssrule-import-rule><code>IMPORT_RULE</code></dfn>
   constant. On these objects the <code title=cssrule-type><a
   href="#cssrule-type">type</a></code> attribute <em class=ct>must</em>
   return the value of that constant.

  <p>The <code><a href="#cssimportrule">CSSImportRule</a></code> object
   represents an <code>@import</code> rule specified (if any) in a <span>CSS
   style sheet</span>.

  <pre
   class=idl>interface <dfn id=cssimportrule>CSSImportRule</dfn> : <a href="#cssrule">CSSRule</a> {
  readonly attribute DOMString <a href="#cssimportrule-href" title=cssimportrule-href>href</a>;
  [PutForwards=mediaText] readonly attribute <a href="#medialist">MediaList</a> <a href="#cssimportrule-media" title=cssimportrule-media>media</a>;
  readonly attribute <a href="#cssstylesheet">CSSStyleSheet</a> <a href="#cssimportrule-stylesheet" title=cssimportrule-stylesheet>styleSheet</a>;
};</pre>

  <p>The <dfn id=cssimportrule-href
   title=cssimportrule-href><code>href</code></dfn> attribute, on getting,
   <em class=ct>must</em> return the <em>specified</em> URI of the style
   sheet referenced by the <code>@import</code> rule.

  <p>The <dfn id=cssimportrule-media
   title=cssimportrule-media><code>media</code></dfn> attribute, on getting,
   <em class=ct>must</em> return a live <code><a
   href="#medialist">MediaList</a></code> object containing a list of media
   queries applicable to the imported style sheet as specified by the
   <code>@import</code> rule.

  <p>The <dfn id=cssimportrule-stylesheet
   title=cssimportrule-stylesheet><code>styleSheet</code></dfn> attribute, on
   getting, <em class=ct>must</em> return the <code><a
   href="#cssstylesheet">CSSStyleSheet</a></code> object that represents the
   referenced (parsed) style sheet from the <code>@import</code> rule.

  <p class=note>If loading of the style sheet fails its <code
   title=cssstylesheet-cssrules><a
   href="#cssstylesheet-cssrules">cssRules</a></code> list is simply empty.

  <h4 id=the-cssmediarule-interface><span class=secno>6.4.4 </span>The <code
   title="">CSSMediaRule</code> Interface</h4>

  <p>Objects implementing the <code><a
   href="#cssmediarule">CSSMediaRule</a></code> interface can be identified
   by the <dfn id=cssrule-media-rule><code>MEDIA_RULE</code></dfn> constant.
   On these objects the <code title=cssrule-type><a
   href="#cssrule-type">type</a></code> attribute <em class=ct>must</em>
   return the value of that constant.

  <p>The <code><a href="#cssmediarule">CSSMediaRule</a></code> object
   represents an <code title="">@media</code> rule specified (if any) in a
   <span>CSS style sheet</span>. It is a single statement that contains zero
   or more rulesets which are contrained by one or more media queries (unless
   one happens to be <code>all</code>).

  <pre
   class=idl>interface <dfn id=cssmediarule>CSSMediaRule</dfn> : <a href="#cssrule">CSSRule</a> {
  [PutForwards=mediaText] readonly attribute <a href="#medialist">MediaList</a> <a href="#cssmediarule-media" title=cssmediarule-media>media</a>;
  readonly attribute <a href="#cssrulelist">CSSRuleList</a> <a href="#cssmediarule-cssrules" title=cssmediarule-cssrules>cssRules</a>;
  unsigned long <a href="#cssmediarule-insertrule" title=cssmediarule-insertrule>insertRule</a>(in DOMString <var>rule</var>, in unsigned long <var>index</var>);
  void <a href="#cssmediarule-deleterule" title=cssmediarule-deleterule>deleteRule</a>(in unsigned long <var>index</var>);
};</pre>

  <p>The <dfn id=cssmediarule-media
   title=cssmediarule-media><code>media</code></dfn> attribute, on getting,
   <em class=ct>must</em> return a <code><a
   href="#medialist">MediaList</a></code> object containing a list of media
   queries specified with the <code title="">@media</code> rule.

  <p>The <dfn id=cssmediarule-cssrules
   title=cssmediarule-cssrules><code>cssRules</code></dfn> attribute, on
   getting, <em class=ct>must</em> return a <code><a
   href="#cssrulelist">CSSRuleList</a></code> object containing a list of all
   the rulesets specified within the <code title="">@media</code> rule.

  <p>The <dfn id=cssmediarule-insertrule
   title=cssmediarule-insertrule><code>insertRule(<var title="">rule</var>,
   <var title="">index</var>)</code></dfn> method, when invoked, <em
   class=ct>must</em> <a href="#inserting-a-statement">insert a statement</a>
   where <var>rule</var> is <var>rule</var>, <var>index</var> is
   <var>index</var> and <var>rule list</var> is <code
   title=cssmediarule-cssrules><a
   href="#cssmediarule-cssrules">cssRules</a></code>.

  <p>The <dfn id=cssmediarule-deleterule
   title=cssmediarule-deleterule><code>deleteRule(<var
   title="">index</var>)</code></dfn> method, when invoked, <em
   class=ct>must</em> <a href="#removing-a-statement">remove a statement</a>
   where <var>index</var> is <var>index</var> and <var>rule list</var> is
   <code title=cssmediarule-cssrules><a
   href="#cssmediarule-cssrules">cssRules</a></code>.

  <h4 id=the-cssfontfacerule-interface><span class=secno>6.4.5 </span>The
   <code title="">CSSFontFaceRule</code> Interface</h4>

  <p>Objects implementing the <code><a
   href="#cssfontfacerule">CSSFontFaceRule</a></code> interface can be
   identified by the <dfn
   id=cssrule-font-face-rule><code>FONT_FACE_RULE</code></dfn> constant. On
   these objects the <code title=cssrule-type><a
   href="#cssrule-type">type</a></code> attribute <em class=ct>must</em>
   return the value of that constant.

  <p>The <code><a href="#cssfontfacerule">CSSFontFaceRule</a></code> object
   represents an <code>@font-face</code> rule specified (if any) in a
   <span>CSS style sheet</span>.

  <pre
   class=idl>interface <dfn id=cssfontfacerule>CSSFontFaceRule</dfn> : <a href="#cssrule">CSSRule</a> {
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#cssfontfacerule-style" title=cssfontfacerule-style>style</a>;
};</pre>

  <p>The <dfn id=cssfontfacerule-style
   title=cssfontfacerule-style><code>style</code></dfn> attribute <em
   class=ct>must</em> return a <code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> block that
   contains the property declarations specified within the
   <code>@font-face</code> rule.

  <h4 id=the-csspagerule-interface><span class=secno>6.4.6 </span>The <code
   title="">CSSPageRule</code> Interface</h4>

  <p>Objects implementing the <code><a
   href="#csspagerule">CSSPageRule</a></code> interface can be identified by
   the <dfn id=cssrule-page-rule><code>PAGE_RULE</code></dfn> constant. On
   these objects the <code title=cssrule-type><a
   href="#cssrule-type">type</a></code> attribute <em class=ct>must</em>
   return the value of that constant.

  <p>The <code><a href="#csspagerule">CSSPageRule</a></code> object
   represents an <code>@page</code> rule specified (if any) in a <span>CSS
   style sheet</span>.

  <pre
   class=idl>interface <dfn id=csspagerule>CSSPageRule</dfn> : <a href="#cssrule">CSSRule</a> {
           attribute DOMString <a href="#csspagerule-selectortext" title=csspagerule-selectortext>selectorText</a>;
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#csspagerule-style" title=csspagerule-style>style</a>;
};</pre>

  <p>The <dfn id=csspagerule-selectortext
   title=csspagerule-selectortext><code>selectorText</code></dfn> attribute,
   on getting, <em class=ct>must</em> return the result of <a
   href="#css-page-selectors-serializing" title="CSS page selectors
   serializing">serializing CSS page selectors</a>. On setting, the setted
   value <em class=ct>must</em> be used as input for <a
   href="#css-page-selectors-parsing" title="CSS page selectors
   parsing">parsing CSS page selectors</a> and if that returns a non-"null"
   value that is to be used as a selector for the <code>@page</code> rule. If
   it returns "null" setting <em class=ct>must not</em> have an effect.

  <p>The <dfn id=csspagerule-style
   title=csspagerule-style><code>style</code></dfn> attribute, on getting,
   <em class=ct>must</em> return a <code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> that contains
   the specified property declarations within the <code>@page</code> rule.

  <h4 id=the-cssnamespacerule-interface><span class=secno>6.4.7 </span>The
   <code title="">CSSNamespaceRule</code> Interface</h4>

  <p>Objects implementing the <code><a
   href="#cssnamespacerule">CSSNamespaceRule</a></code> interface can be
   identified by the <dfn
   id=cssrule-namespace-rule><code>NAMESPACE_RULE</code></dfn> constant. On
   these objects the <code title=cssrule-type><a
   href="#cssrule-type">type</a></code> attribute <em class=ct>must</em>
   return the value of that constant.

  <p>The <code><a href="#cssnamespacerule">CSSNamespaceRule</a></code> object
   represents an <code>@namespace</code> rule specified (if any) in a
   <span>CSS style sheet</span> that consists of a prefix and namespace.

  <pre
   class=idl>interface <dfn id=cssnamespacerule>CSSNamespaceRule</dfn> : <a href="#cssrule">CSSRule</a> {
  readonly attribute DOMString <a href="#cssnamespacerule-namespaceuri">namespaceURI</a>;
  readonly attribute DOMString <a href="#cssnamespacerule-prefix">prefix</a>;
};</pre>

  <p>The <dfn
   id=cssnamespacerule-namespaceuri><code>namespaceURI</code></dfn>
   attribute, on getting, <em class=ct>must</em> return specified namespace
   IRI from the <code>@namespace</code> rule.

  <p>The <dfn id=cssnamespacerule-prefix><code>prefix</code></dfn> attribute,
   on getting, <em class=ct>must</em> return the specified prefix from the
   <code>@namespace</code> rule or the empty string if there is no prefix.</p>
  <!-- XXX lowercased? -->

  <h3 id=accessing-declaration-blocks><span class=secno>6.5 </span>Accessing
   declaration blocks</h3>

  <h4 id=the-elementcssinlinestyle-interface><span class=secno>6.5.1
   </span>The <code><a
   href="#elementcssinlinestyle">ElementCSSInlineStyle</a></code> Interface</h4>

  <pre
   class=idl>interface <dfn id=elementcssinlinestyle>ElementCSSInlineStyle</dfn> {
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <span>style</span>;
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#elementcssinlinestyle-currentstyle" title=elementcssinlinestyle-currentstyle>currentStyle</a>;
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <span>runtimeStyle</span>;
};</pre>

  <p class=issue>...

  <p>The <dfn id=elementcssinlinestyle-currentstyle
   title=elementcssinlinestyle-currentstyle><code>currentStyle</code></dfn>
   attribute, on getting, <em class=ct>must</em> return a <a href="#readonly"
   title="readonly declaration">readonly <code>CSSStyleDeclaration</code></a>
   object which represents the computed style for the element on which it was
   called.

  <p class=issue>Serialization of the <code>style</code> attribute is not
   guaranteed to work.

  <h4 id=the-viewcss-interface><span class=secno>6.5.2 </span>The <code
   title="">ViewCSS</code> Interface</h4>

  <p>Objects implementing the <code>Window</code> interface <em
   class=ct>must</em> also implement the <code><a
   href="#viewcss">ViewCSS</a></code> interface.

  <pre class=idl>interface <dfn id=viewcss>ViewCSS</dfn> {
  <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#viewcss-getcomputedstyle">getComputedStyle</a>(in Element <var title="">elt</var>);
  <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#viewcss-getcomputedstyle">getComputedStyle</a>(in Element <var title="">elt</var>, in DOMString <var title="">pseudoElt</var>);
};</pre>

  <p>The <dfn id=viewcss-getcomputedstyle><code>getComputedStyle</code></dfn>
   method <em class=ct>must</em> return a live <code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> object that
   contains the computed style declaration block for <var title="">elt</var>,
   when the <var title="">pseudoElt</var> argument is <code>null</code>, the
   empty string or omitted. Otherwise, for the pseudo-element <var
   title="">pseudoElt</var> of <var title="">elt</var>. [CSS]

  <h3 id=css-declaration-blocks><span class=secno>6.6 </span>CSS Declaration
   Blocks</h3>

  <p>The interfaces described in this section provide generic and convenient
   attributes for manipulating CSS declaration blocks.

  <h4 id=the-cssstyledeclaration-interface><span class=secno>6.6.1 </span>The
   <code title="">CSSStyleDeclaration</code> Interface</h4>

  <p>The <code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code>
   interface gives access to read and manipulate CSS properties and their
   values within a declaration block.

  <p>If an attribute or method returns an object implementing the <code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> interface (and
   related interfaces) and says the object is <dfn id=readonly
   title="readonly declaration">readonly</dfn> user agents <em
   class=ct>must</em> raise a <code>NO_MODIFICATION_ALLOWED_ERR</code>
   exception on an attempt to modify the object.

  <p class=note>Invoking <code title=cssstyledeclaration-removeproperty><a
   href="#cssstyledeclaration-removeproperty">removeProperty</a></code> or
   setting <code title=cssstyledeclaration-csstext><a
   href="#cssstyledeclaration-csstext">cssText</a></code> would be examples
   of that.</p>
  <!-- XXX Or do we need to specify this independently for each attribute and
  method? -->

  <p class=issue><code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> can represent
   computed values and used values. (This also goes for interfaces
   implemented on top of <code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> objects
   obviously.)

  <p class=issue>This object stringifies to its cssText attribute. Or not?

  <pre
   class=idl>interface <dfn id=cssstyledeclaration>CSSStyleDeclaration</dfn> {
           attribute DOMString <a href="#cssstyledeclaration-csstext" title=cssstyledeclaration-csstext>cssText</a>;
  DOMString <a href="#cssstyledeclaration-getpropertyvalue" title=cssstyledeclaration-getpropertyvalue>getPropertyValue</a>(in DOMString <var title="">property</var>);
  DOMString <a href="#cssstyledeclaration-getpropertypriority" title=cssstyledeclaration-getpropertypriority>getPropertyPriority</a>(in DOMString <var title="">property</var>);
  DOMString <a href="#cssstyledeclaration-removeproperty" title=cssstyledeclaration-removeproperty>removeProperty</a>(in DOMString <var title="">property</var>);
  void <a href="#cssstyledeclaration-setproperty" title=cssstyledeclaration-setproperty>setProperty</a>(in DOMString <var title="">property</var>, in DOMString <var title="">value</var>);
  void <a href="#cssstyledeclaration-setproperty" title=cssstyledeclaration-setproperty>setProperty</a>(in DOMString <var title="">property</var>, in DOMString <var title="">value</var>, in DOMString <var title="">priority</var>);
  readonly attribute unsigned long <a href="#cssstyledeclaration-length" title=cssstyledeclaration-length>length</a>;
  DOMString <a href="#cssstyledeclaration-item" title=cssstyledeclaration-item>item</a>(in unsigned long <var title="">index</var>);
  readonly attribute <a href="#cssrule">CSSRule</a> <a href="#cssstyledeclaration-parentrule" title=cssstyledeclaration-parentrule>parentRule</a>;
};</pre>

  <p>The <dfn id=cssstyledeclaration-csstext
   title=cssstyledeclaration-csstext><code>cssText</code></dfn> attribute, on
   getting, <span class=issue>...</span>.

  <p>On setting the <code title="">cssText</code> attribute, user agents <em
   class=ct>must</em> remove all properties currently set on the object and
   then parse the given string as the contents of a declaration block and set
   each property / value pair that is not ignored on the <code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> block. [CSS]

  <p>The <dfn id=cssstyledeclaration-getpropertyvalue
   title=cssstyledeclaration-getpropertyvalue><code>getPropertyValue(<var
   title="">property</var>)</code></dfn> method, when invoked, <span
   class=issue>...</span>.</p>
  <!-- Once we have defined how everything will be canonicalized we can start
  thinking about this... -->

  <p>The <dfn id=cssstyledeclaration-getpropertypriority
   title=cssstyledeclaration-getpropertypriority><code>getPropertyPriority(<var
   title="">property</var>)</code></dfn> method, when invoked, if <var
   title="">property</var> case-insensitively matches a specified property
   that has a priority user agents <em class=ct>must</em> return the
   canonical priority of that property as given in the syntax definition.
   Otherwise, the empty string <em class=ct>must</em> be returned.

  <p class=note>For <code>background-color:lime !IMPORTANT</code> the return
   value would be <code>important</code>.

  <p>The <dfn id=cssstyledeclaration-removeproperty
   title=cssstyledeclaration-removeproperty><code>removeProperty(<var
   title="">property</var>)</code></dfn> method, when invoked, if <var
   title="">property</var> case-insensitively matches a specified property
   user agents <em class=ct>must</em> remove that property declaration.

  <p>The <dfn id=cssstyledeclaration-setproperty
   title=cssstyledeclaration-setproperty><code>setProperty(<var
   title="">property</var>, <var title="">value</var>, <var
   title="">priority</var>)</code></dfn> method gives a way to set a
   declaration. When invoked, user agents <em class=ct>must</em> run the
   following steps:

  <ol>
   <li>
    <p>If <var title="">property</var> does not case-insensitively match a
     supported property abort this algorithm.

   <li>
    <p>If <var title="">value</var> is <code>null</code> or the empty string
     invoke <code title=cssstyledeclaration-removeproperty><a
     href="#cssstyledeclaration-removeproperty">removeProperty</a></code>
     with <var title="">property</var> as argument and abort this algorithm.

   <li>
    <p>If the <var title="">priority</var> argument has been omitted let <var
     title="">priority</var> be <code>null</code>.

   <li>
    <p>If <var title="">priority</var> is neither a valid priority nor
     <code>null</code> or the empty string abort this algorithm.

   <li>
    <p>If <a href="#parsing-a-css-value" title="CSS value parsing">parsing
     the <var title="">value</var></a> returns "null" abort this algorithm.</p>

    <p class=note><var title="">value</var> can not include
     <code>!important</code>.</p>

   <li>
    <p>Finally, set <var title="">property</var> to <var title="">value</var>
     with priority <var title="">priority</var> when <var
     title="">priority</var> is not <code>null</code> or the empty string.
     Otherwise set <var title="">property</var> to <var title="">value</var>.
  </ol>

  <p>The <dfn id=cssstyledeclaration-length
   title=cssstyledeclaration-length><code>length</code></dfn> attribute <em
   class=ct>must</em> be the number of setted properties.

  <p>The <dfn id=cssstyledeclaration-item
   title=cssstyledeclaration-item><code>item(<var
   title="">index</var>)</code></dfn> method, when invoked, <span
   class=issue>...</span>.</p>
  <!-- returns the value of property x stored at position item. -->

  <p>The <dfn id=cssstyledeclaration-parentrule
   title=cssstyledeclaration-parentrule><code>parentRule</code></dfn>
   attribute, on getting, <em class=ct>must</em> return the <code><a
   href="#cssrule">CSSrule</a></code> object the <code><a
   href="#cssstyledeclaration">CSSStyleDeclaration</a></code> is object is
   associated with or <code>null</code> if it is not associated with a
   <code><a href="#cssrule">CSSrule</a></code> object.</p>
  <!--
  <h4>CSS Properties</h4>

  <p>The DOM attribute name of a CSS property can be found by using the
  following algorithm:</p>

  <ol>
   <li>Let <var title="">r</var> be the CSS property to be
   converted.</li>

   <li>Uppercase the first character after every U+002D (<code>-</code>) in
   <var title="">r</var>.</li>

   <li>Remove every U+002D (<code>-</code>) in <var title="">r</var>.</li>

   <li>Return <var title="">r</var>.</li>
  </ol>

  <p class="note">This means that
  <code>-<var title="">vendor</var>-<var title="">property</var></code>
  becomes
  <code><var title=""><strong>V</strong>endor</var><var title=""><strong>P</strong>roperty</var></code>
  for instance.</p>
-->

  <h4 id=the-css2properties-interface><span class=secno>6.6.2 </span>The
   <code title="">CSS2Properties</code> Interface</h4>

  <p class=issue>...

  <h2 class=no-num id=iana-considerations>IANA Considerations</h2>

  <h3 class=no-num id=default-style-><dfn id=default-style
   title=http-default-style><code>Default-Style</code></dfn></h3>

  <p>This section describes a header field for registration in the Permanent
   Message Header Field Registry. <!--<a href="XXX">[RFC3864]</a>-->

  <dl>
   <dt>Header field name

   <dd>Default-Style

   <dt>Applicable protocol

   <dd>http

   <dt>Status

   <dd>standard

   <dt>Author/Change controller

   <dd>W3C and WHATWG

   <dt>Specification document(s)

   <dd>This document is the relevant specification.

   <dt>Related information

   <dd>None.
  </dl>

  <h2 class=no-num id=references>References</h2>

  <p class=issue>This section will be done when going to Last Call. Before
   that state please ask the author whenever a reference is unclear.

  <h2 class=no-num id=acknowledgements>Acknowledgements</h2>

  <p>The editor would like to thank Alexey Feldgendler, Bjrn Hhrmann,
   David Baron, Hallvord R. M. Steen, Ian Hickson, Lachlan Hunt, Morten
   Stenshorne, Robert O'Callahan, Sjoerd Visscher, Simon Pieters, and Tarquin
   Wilton-Jones for contributing to this specification.

  <p>Even more thanks to Ian Hickson for writing up the the initial version
   of the alternative style sheets API and canonicalization rules for CSS
   values.</p>
  <!-- XXX NOTES

  <style type=text/css;charset=utf-8> does create a StyleSheet in Firefox
  and Opera, but does not create a StyleSheet in IE. I prefer IE.

  <style type=TEXT/CSS> sets the style sheet type to text/css in Firefox and
  TEXT/CSS in Opera and IE. I prefer Firefox.

  <style> sets the style sheet location to the document location Firefox,
  the empty string in IE, and null in Opera. I prefer Opera

  <style media="x"> invokes .sheet.media.mediaText = "x"

  <style title=""> does not "have" a title

  .cascadedStyle that returns less keywords than currentStyle, no inherit,
  etc.
  -->
