<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>CSS Region Styling Module Level 3</title>
  <link rel=contents href="#contents">
  <link rel=index href="#index">
  <link rel="stylesheet" type="text/css" href="../default.css">
  <link rel="stylesheet" type="text/css"
        href="http://www.w3.org/StyleSheets/TR/W3C-[STATUS].css">
	<style>
		.in-cards-demo {
			width: 13em;
			height: 8em;

			padding: 4px;
			border: medium solid blue;
			margin: 6px;

			font: medium/1.3 Times New Roman, Times, serif;
			white-space: nowrap;
		}
	</style>
</head>

<div class="head">
<!--logo-->

<h1>CSS Region Styling Module Level 3</h1>

<h2 class="no-num no-toc">[LONGSTATUS] [DATE]</h2>
<dl>
  <dt>This version:
    <dd><a href="[VERSION]">http://www.w3.org/TR/[YEAR]/ED-css3-region-styling-[CDATE]/</a>

  <dt>Latest version:
    <dd><a href="http://www.w3.org/TR/[SHORTNAME]/">http://www.w3.org/TR/[SHORTNAME]/</a>

  <dt>Editor's draft:
    <dd><a href="http://dev.w3.org/csswg/[SHORTNAME]/">http://dev.w3.org/csswg/[SHORTNAME]/</a>

<!--
  <dt>Previous version:
    <dd><a href="http://www.w3.org/PreviousVersionURI">
    http://www.w3.org/PreviousVersionURI</a>
-->

  <dt>Issue Tracking:</dt>
    <dd>Maintained in document (only editor's draft is current)

  <dt>Feedback:</dt>
    <dd><a href="http://lists.w3.org/Archives/Public/www-style/">www-style@w3.org</a> with subject line &ldquo;<kbd>[[SHORTNAME]] <var>&hellip; message topic &hellip;</var></kbd>&rdquo;

  <dt>Editors:
    <dd class="h-card vcard">
      <a class="p-name fn u-url url" rel="author"
         href="http://dbaron.org/">L. David Baron</a>,
      <a class="p-org org" href="http://www.mozilla.org/">Mozilla</a>
</dl>

<!--copyright-->

<hr title="Separator for header">
</div>

<h2 class="no-num no-toc" id="abstract">Abstract</h2>

	<p>
		<a href="http://www.w3.org/TR/CSS/">CSS</a> is
		a language for describing
		the rendering of structured documents (such as HTML and XML)
		on screen, on paper, in speech, etc.
		This module contains the features of CSS
		relating to new mechanisms of overflow handling in visual media (e.g., screen or paper).
		In interactive media,
		it describes features that allow the overflow
		from a fixed size container
		to be handled by pagination (displaying one page at a time).
		It also describes features, applying to all visual media,
		that allow the contents of an element
		to be spread across multiple containers,
		allowing the contents to flow across multiple regions of a page
		or to have different styles for different parts.
	</p>

<h2 class="no-num no-toc" id="status">Status of this document</h2>

<!--status-->

<p>The following features are at risk: &hellip;

<h2 class="no-num no-toc" id="contents">
Table of contents</h2>

<!--toc-->

<h2 id="intro">
Introduction</h2>

	<p>
		In CSS Level 1 [[CSS1]], placing more content than would fit
		inside an element with a specified size
		was generally an authoring error.
		Doing so caused the content to extend
		outside the bounds of the element,
		which would likely cause
		that content to overlap with other elements.
	</p>

	<p>
		CSS Level 2 [[CSS21]] introduced the 'overflow' property,
		which allows authors to have overflow be handled by scrolling,
		which means it is no longer an authoring error.
		It also allows authors to specify
		that overflow is handled by clipping,
		which makes sense when the author's intent
		is that the content not be shown.
	</p>

	<p>
		However, scrolling is not the only way
		to present large amounts of content,
		and may even not be the optimal way.
		After all, the codex replaced the scroll
		as the common format for large written works
		because of its advantages.
	</p>

	<p>
		This specification introduces
		a mechanism for Web pages to specify
		that a region of a page should handle overflow
		through pagination rather than through scrolling.
	</p>

	<p>
		This specification also extends the concept of overflow
		in another direction.
		Instead of requiring that authors specify a single region
		into which the content of an element must flow,
		this specification allows authors to specify multiple regions,
		each with their own dimensions and styles,
		so that the content of the element can flow from one to the next,
		using as many as needed to place the content without overflowing.
	</p>

	<p>
		In both of these cases, implementations must
		break the content in the block-progression dimension.
		Implementations must do this is described
		in the CSS Fragmentation Module [[!CSS3-BREAK]].
	</p>


<h2 id="paginated-overflow">Paginated overflow</h2>

<p class="issue">overflow:paginate or overflow:pages (or paged-x, paged-y, paged-x-controls, paged-y-controls as css3-gcpm has?)</p>

<p class="issue">Ability to display N pages at once
rather than just one page at once?</p>

<h2 id="region-overflow">Region overflow</h2>

	<p>
		This section introduces and defines the meaning of
		the new ''regions'' (<span class="issue">or ''repeat''?</span>)
		value of the 'overflow' property.
	</p>

	<p>
		When the computed value of 'overflow' for an element is ''regions'',
		and implementations would otherwise have created a box for the element,
		then implementations must create at least one box for that element.
		Each box created for the element is called a <dfn>region box</dfn>
		for that element.
		(If an element with ''overflow: regions'' generates only one box,
		that box is a <i>region box</i>.
		However, if an element's computed 'overflow' is not ''regions'',
		then its box is not a <i>region box</i>.)
		Every <i>region box</i> is a fragmentation container,
		and for each <i>region box</i> which ends with a fragmentation break,
		(which could happen
		because breakable content overflows in the block dimension
		or because of a forced break),
		there must be another <i>region box</i> created as a next sibling
		of the previous one.
		<span class="issue">Or is it as though it's a next sibling of
		the element?  Need to figure out exactly how this interacts with
		other box-level fixup.</span>
		(Breakable content might overflow in the box dimension either
		because of a specified size on the region box
		or because the region box is within a fragmentation context
		in which it is being broken.
		In other words, a single region box is never broken
		across columns or pages;
		the pieces that are in separate columns or pages
		are always distinct region boxes.)
	</p>

	<p class="issue">
		We also want ''::nth-region()'' pseudo-elements
		to be able to apply to the pieces of an element
		split within a fragmentation context.
		Should we require that authors who want to use
		''::nth-region()'' in this way specify ''overflow:regions''
		(even if they don't specify a constrained height),
		or should it work automatically for all elements
		even if they don't have ''overflow: regions''?
	</p>

	<div class="example">
		<table style="width: 100%"><tr><td><pre>
&lt;!DOCTYPE HTML&gt;
&lt;title&gt;Breaking content into
  equal-sized cards&lt;/title&gt;
&lt;style&gt;
  .in-cards {
    overflow: regions;

    width: 13em;
    height: 8em;

    padding: 4px;
    border: medium solid blue;
    margin: 6px;

    font: medium/1.3 Times New
      Roman, Times, serif;
  }
&lt;/style&gt;
&lt;div class="in-cards"&gt;
  In this example, the text in the div
  is broken into a series of cards.
  These cards all have the same style.
  The presence of enough content to
  overflow one of the cards causes
  another one to be created.  The second
  card is created just like it's the
  next sibling of the first.
&lt;/div&gt;
		</pre></td><td>
			<div class="in-cards-demo">In this example, the text in the<br>div is broken into a series of<br>cards.  These cards all have the<br>same style. The presence of<br>enough content to overflow<br>one of the cards causes another</div>
			<div class="in-cards-demo">one to be created.  The second<br>card is created just like it's the<br>next sibling of the first.</div>
		</td></tr></table>
	</div>

<h3 id="region-styling">Region styling</h3>

<h4 id="region-pseudo-element">The ::nth-region() pseudo-element</h4>

	<p>
		The ::nth-region() pseudo-element is a pseudo-element
		that describes some of the region boxes generated by an element.
		The argument to the pseudo-element takes the same syntax
		as the argument to the :nth-child() pseudo-class
		defined in [[!SELECT]], and has the same meaning
		except that the number is relative to
		<i>region boxes</i> generated by the element
		instead of siblings of the element.
	</p>

	<p class="issue">
		If we go with a name for the 'overflow' value other than
		''overflow: regions'',
		then we should probably rename this pseudo-element,
		perhaps to ::nth-piece(), ::nth-part(), or ::nth-instance().
	</p>

	<p class="note">
		Selectors that allow addressing regions
		by counting from the end rather than the start
		are intentionally not provided.
		Such selectors would interfere with determining
		the number of regions.
	</p>

<h4 id="style-of-regions">Styling of regions</h4>

	<p class="issue">
		Should this apply to region overflow only,
		or also to paginated overflow?
		(If it applies,
		then stricter property restrictions would be needed
		for paginated overflow.)
	</p>

	<p>
		In the absence of rules with ''::nth-region()'' pseudo-elements,
		the computed style for each <i>region box</i>
		is the computed style for the element
		for which the <i>region box</i> was created.
		However, the style for a <i>region box</i> is also influenced
		by rules whose selector's <i>subject</i> [[!SELECT]]
		has an ''::nth-region()'' pseudo-element,
		if the 1-based number of the region box matches
		that ''::nth-region()'' pseudo-element
		and the selector (excluding the ''::nth-region()'' pseudo-element)
		matches the element generating the regions.
	</p>

	<p>
		Styling an ''::nth-region()'' pseudo-element with the 'overflow'
		property has no effect;
		the computed value of 'overflow' for the region box
		remains the same as the computed value of overflow for the element.
	</p>

	<p>
		Specifying ''display: none'' for a region box causes
		the region box with that index not to be generated.
		However, in terms of the indices
		used for matching ''::nth-region()'' pseudo-elements
		of later region boxes,
		it still counts as though it was generated.
		However, since it is not generated, it does not contain any content.
	</p>

	<p class="issue">
		Would it make more sense to forbid ''display:none''?
		Or perhaps to forbid 'display', 'position', 'float',
		and similar (in addition to 'overflow')?
	</p>

	<p>
		To match the model for other pseudo-elements
		where the pseudo-elements live inside their corresponding element,
		declarations in ''::nth-region()'' pseudo-elements override
		declarations in rules without the pseudo-element.
		The relative priority within such declarations is determined
		by normal cascading order (see [[!CSS21]]).
	</p>

	<p>
		Styles specified on ''::nth-region()'' pseudo-elements
		do affect inheritance to content within the <i>region box</i>.
		In other words, the content within the <i>region box</i> must
		inherit from the region box's style (i.e., the pseudo-element style)
		rather than directly from the element.
		This means that elements split between region boxes may
		have different styles for different parts of the element.
	</p>

	<p class="issue">
		This inheritance rule allows specifying styles indirectly
		(by using explicit ''inherit'' or using default inheritance
		on properties that don't apply to '':first-letter'')
		that can't be specified directly
		(based on the rules in the next section).
		This is a problem.
		The restrictions that apply to styling inside regions
		should also apply to inheritance from regions.
	</p>

<h4 id="style-in-regions">Styling inside regions</h4>

	<p class="issue">
		Should this apply to region overflow only,
		or also to paginated overflow,
		or even to pagination across pages?
	</p>

	<p>
		The ''::nth-region()'' pseudo-element
		can also be used to style
		content inside of a <i>region box</i>.
		Unlike the ''::first-line'' and ''::first-letter'' pseudo-elements,
		the ''::nth-region()'' pseudo-element can be applied
		to parts of the selector other than the subject:
		in particular, it can match ancestors of the subject.
		However, the only CSS properties applied
		by rules with such selectors
		are those that apply
		to the ''::first-letter'' pseudo-element.
	</p>

	<p>
		To be more precise,
		when a rule's selector has ''::nth-region()'' pseudo-elements
		attached to parts of the selector other than the subject,
		the declarations in that rule apply to
		a fragment (or pseudo-element thereof) when:
	</p>
	<ol>
		<li>
			the declarations are for properties that apply to the
			''::first-letter'' pseudo-element,
		</li>
		<li>
			the declarations would apply to
			that fragment (or pseudo-element thereof)
			had those ''::nth-region()'' pseudo-elements been removed,
			with a particular association between
			each sequence of simple selectors and the element it matched,
			and
		</li>
		<li>
			for each removed ''::nth-region()'' pseudo-element,
			the fragment lives within a <i>region box</i>
			of the element associated in that association
			with the selector that the pseudo-element was attached to,
			and whose index matches the pseudo-element.
		</li>
	</ol>

<h3 id="max-lines">The 'max-lines' property</h3>

	<p>
		Authors may wish to style the opening lines of an element
		with different styles
		by putting those opening lines in a separate region.
		However, since it may be difficult to predict the exact height
		occupied by those lines
		in order to restrict the first region to that height,
		this specification introduces a 'max-lines' property
		that forces a region to break
		after a specified number of lines.
		This forces a break after the given number of lines
		contained within the element or its descendants,
		as long as those lines are in the same block formatting context.
	</p>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>max-lines</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>none | &lt;integer&gt;
		<tr>
			<th>Initial:
			<td>none
		<tr>
			<th>Applies to:
			<td>region boxes
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Percentages:
			<td>N/A
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed&nbsp;value:
			<td>specified value
		<tr>
			<th>Animatable:
			<td>as <a href="http://www.w3.org/TR/css3-transitions/#animatable-types">integer</a>
		<tr>
			<th>Canonical order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<dl>
		<dt>none
		<dd>
			<p>
				Breaks occur only as specified elsewhere.
			</p>
		</dd>

		<dt>&lt;integer&gt;
		<dd>
			<p>
				In addition to any breaks specified elsewhere,
				a break is forced before any line that would exceed
				the given number of lines
				being placed inside the element
				(excluding lines that are in
				a different block formatting context from
				the block formatting context to which
				an unstyled child of the element would belong).
			</p>

			<p class="issue">
				If there are multiple boundaries between this line
				and the previous, where exactly (in terms of element
				boundaries) is the break forced?
			</p>

			<p>
				Only positive integers are accepted.
				Zero or negative integers are a parse error.
			</p>
		</dd>
	</dl>

<p class="issue">Should this apply to regions overflow only, or also
to pagination?</p>

<h2 id="conformance">
Conformance</h2>

<h3 id="placement">
Module interactions</h3>

  <p>This module extends the 'overflow'
  feature defined in [[CSS21]] section 11.1.1.  It defines additional
  overflow handling mechanisms that implementations must implement as
  described in this module in order to conform to this module.</p>

  <p>No properties in this module apply to the <code>::first-line</code> or
  <code>::first-letter</code> pseudo-elements.</p>

<h3 id="values">
Values</h3>

  <p>This specification follows the
  <a href="http://www.w3.org/TR/CSS21/about.html#property-defs">CSS property
  definition conventions</a> from [[!CSS21]]. Value types not defined in
  this specification are defined in CSS Level 2 Revision 1 [[!CSS21]].
  Other CSS modules may expand the definitions of these value types: for
  example [[CSS3COLOR]], when combined with this module, expands the
  definition of the &lt;color&gt; value type as used in this specification.</p>
  
  <p>In addition to the property-specific values listed in their definitions,
  all properties defined in this specification also accept the
  <a href="http://www.w3.org/TR/CSS21/cascade.html#value-def-inherit">inherit</a>
  keyword as their property value. For readability it has not been repeated
  explicitly.


<h3 id="conventions">
Document conventions</h3>

  <p>Conformance requirements are expressed with a combination of
  descriptive assertions and RFC 2119 terminology. The key words “MUST”,
  “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
  “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
  document are to be interpreted as described in RFC 2119.
  However, for readability, these words do not appear in all uppercase
  letters in this specification.
  
  <p>All of the text of this specification is normative except sections
  explicitly marked as non-normative, examples, and notes. [[!RFC2119]]</p>
  
  <p>Examples in this specification are introduced with the words “for example”
  or are set apart from the normative text with <code>class="example"</code>,
  like this:
  
  <div class="example">
    <p>This is an example of an informative example.</p>
  </div>
  
  <p>Informative notes begin with the word “Note” and are set apart from the
  normative text with <code>class="note"</code>, like this:
  
  <p class="note">Note, this is an informative note.</p>

<h3 id="conformance-classes">
Conformance classes</h3>

  <p>Conformance to CSS Region Styling Module Level 3
  is defined for three conformance classes:
  <dl>
    <dt><dfn title="style sheet!!as conformance class">style sheet</dfn>
      <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
      style sheet</a>.
    <dt><dfn>renderer</dfn></dt>
      <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
      that interprets the semantics of a style sheet and renders
      documents that use them.
    <dt><dfn id="authoring-tool">authoring tool</dfn></dt>
      <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
      that writes a style sheet.
  </dl>
  
  <p>A style sheet is conformant to CSS Region Styling Module Level 3
  if all of its statements that use syntax defined in this module are valid
  according to the generic CSS grammar and the individual grammars of each
  feature defined in this module.
  
  <p>A renderer is conformant to CSS Region Styling Module Level 3
  if, in addition to interpreting the style sheet as defined by the
  appropriate specifications, it supports all the features defined
  by CSS Region Styling Module Level 3 by parsing them correctly
  and rendering the document accordingly. However, the inability of a
  UA to correctly render a document due to limitations of the device
  does not make the UA non-conformant. (For example, a UA is not
  required to render color on a monochrome monitor.)
  
  <p>An authoring tool is conformant to CSS Region Styling Module Level 3
  if it writes style sheets that are syntactically correct according to the
  generic CSS grammar and the individual grammars of each feature in
  this module, and meet all other conformance requirements of style sheets
  as described in this module.

<h3 id="partial">
Partial implementations</h3>

  <p>So that authors can exploit the forward-compatible parsing rules to
  assign fallback values, CSS renderers <strong>must</strong>
  treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
  as appropriate</a>) any at-rules, properties, property values, keywords,
  and other syntactic constructs for which they have no usable level of
  support. In particular, user agents <strong>must not</strong> selectively
  ignore unsupported component values and honor supported values in a single
  multi-value property declaration: if any value is considered invalid
  (as unsupported values must be), CSS requires that the entire declaration
  be ignored.</p>
  
<h3 id="experimental">
Experimental implementations</h3>

  <p>To avoid clashes with future CSS features, the CSS2.1 specification
  reserves a <a href="http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords">prefixed
  syntax</a> for proprietary and experimental extensions to CSS.
  
  <p>Prior to a specification reaching the Candidate Recommendation stage
  in the W3C process, all implementations of a CSS feature are considered
  experimental. The CSS Working Group recommends that implementations
  use a vendor-prefixed syntax for such features, including those in
  W3C Working Drafts. This avoids incompatibilities with future changes
  in the draft.
  </p>
 
<h3 id="testing">
Non-experimental implementations</h3>

  <p>Once a specification reaches the Candidate Recommendation stage,
  non-experimental implementations are possible, and implementors should
  release an unprefixed implementation of any CR-level feature they
  can demonstrate to be correctly implemented according to spec.
  
  <p>To establish and maintain the interoperability of CSS across
  implementations, the CSS Working Group requests that non-experimental
  CSS renderers submit an implementation report (and, if necessary, the
  testcases used for that implementation report) to the W3C before
  releasing an unprefixed implementation of any CSS features. Testcases
  submitted to W3C are subject to review and correction by the CSS
  Working Group.
  
  <p>Further information on submitting testcases and implementation reports
  can be found from on the CSS Working Group's website at
  <a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
  Questions should be directed to the
  <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
  mailing list.

<h3 id="cr-exit-criteria">
CR exit criteria</h3>

  <p class=issue>[Change or remove the following CR exit criteria if
  the spec is not a module, but, e.g., a Note or a profile. This text was <a
  href="http://www.w3.org/Style/CSS/Tracker/actions/44"> decided on 2008-06-04.</a>]</p>

  <p>
  For this specification to be advanced to Proposed Recommendation,
  there must be at least two independent, interoperable implementations
  of each feature. Each feature may be implemented by a different set of
  products, there is no requirement that all features be implemented by
  a single product. For the purposes of this criterion, we define the
  following terms:
  
  <dl>
    <dt>independent <dd>each implementation must be developed by a
    different party and cannot share, reuse, or derive from code
    used by another qualifying implementation. Sections of code that
    have no bearing on the implementation of this specification are
    exempt from this requirement.
  
    <dt>interoperable <dd>passing the respective test case(s) in the
    official CSS test suite, or, if the implementation is not a Web
    browser, an equivalent test. Every relevant test in the test
    suite should have an equivalent test created if such a user
    agent (UA) is to be used to claim interoperability. In addition
    if such a UA is to be used to claim interoperability, then there
    must one or more additional UAs which can also pass those
    equivalent tests in the same way for the purpose of
    interoperability. The equivalent tests must be made publicly
    available for the purposes of peer review.
  
    <dt>implementation <dd>a user agent which:
  
    <ol class=inline>
      <li>implements the specification.
  
      <li>is available to the general public. The implementation may
      be a shipping product or other publicly available version
      (i.e., beta version, preview release, or “nightly build”). 
      Non-shipping product releases must have implemented the
      feature(s) for a period of at least one month in order to
      demonstrate stability.
  
      <li>is not experimental (i.e., a version specifically designed
      to pass the test suite and is not intended for normal usage
      going forward).
    </ol>
  </dl>
  
  <p>The specification will remain Candidate Recommendation for at least
  six months.

<h2 class=no-num id="acknowledgments">
Acknowledgments</h2>

	<p>
		Thanks especially to the feedback from
		H&aring;kon Wium Lie,
		Florian Rivoal,
		Alan Stearns,
		and all the rest of the
		<a href="http://lists.w3.org/Archives/Public/www-style/">www-style</a> community.
	</p>

<h2 class=no-num id="references">
References</h2>

<h3 class="no-num" id="normative-references">
Normative references</h3>
<!--normative-->

<h3 class="no-num" id="other-references">
Other references</h3>
<!--informative-->

<h2 class="no-num" id="index">
Index</h2>
<!--index-->

<h2 class="no-num" id="property-index">
Property index</h2>
<!-- properties -->

</body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
 
