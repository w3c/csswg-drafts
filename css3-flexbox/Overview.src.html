<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head><title>CSS Flexible Box Layout Module</title>
  <link rel="stylesheet" type="text/css" href="../default.css">
<style type="text/css">
	p { margin: .5em 0; }
	dd > p { text-indent: 0; }
	a > b { font-weight: normal; color: #800; }
.auto-style1 {
	font-weight: 800;
}
</style>
  <link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED"> <!-- TODO: change before build -->
</head><body>

<div class="head">
	<!--logo-->

	<h1 id="head-box-flexible">CSS Flexible Box Layout Module</h1>
	<h2 class="no-num no-toc" id="w3c-working">[LONGSTATUS], [DATE]</h2>

	<dl>
		<dt>This version:
		<dd><!-- <a href="http://www.w3.org/TR/[YEAR]/WD-[SHORTNAME]-[CDATE]/">http://www.w3.org/TR/[YEAR]/WD-[SHORTNAME]-[CDATE]/</a></dd> -->
		<a href="http://dev.w3.org/csswg/[SHORTNAME]/">http://dev.w3.org/csswg/[SHORTNAME]/</a>

		<dt>Latest version:
		<dd><a href="http://www.w3.org/TR/css3-flexbox/">http://www.w3.org/TR/css3-flexbox/</a>

		<dt>Previous version:
		<dd><a href="http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/">http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/</a>

		<dt>Editors:
		<dd>Tab Atkins Jr. <a href="mailto:jackalmage@gmail.com">jackalmage@gmail.com</a>
		<dd>Alex Mogilevsky <a href="mailto:alexmog@microsoft.com">alexmog@microsoft.com</a>
		<dd>L. David Baron, Mozilla Corporation, <a href="mailto:dbaron@dbaron.org">dbaron@dbaron.org</a>

		<dt>Authors and former editors:
		<dd>Neil Deakin, Mozilla Corporation, <a href="mailto:enndeakin@gmail.com">enndeakin@gmail.com</a>
		<dd>Ian Hickson, formerly of Opera Software, <a href="mailto:ian@hixie.ch">ian@hixie.ch</a>
		<dd>David Hyatt, Apple, <a href="mailto:hyatt@apple.com">hyatt@apple.com</a>
	</dl>
	<!--copyright-->

	<hr title="Separator for header">
</div>

	<h2 class="no-num no-toc" id="abstract">Abstract</h2>

	<p>The specification describes a CSS box model optimized for user interface design.
	In flexbox layout model, the children of a box are laid out either 
	horizontally or vertically, and unused space can be assigned to a particular 
	child or distributed among the children by assignment of &quot;flex&quot; to the 
	children that should expand. Nesting of these boxes (horizontal inside 
	vertical, or vertical inside horizontal) can be used to build layouts in two 
	dimensions.</p>

	<h2 class="no-num no-toc" id="status">Status of this document</h2>
	<!--status-->

	<h2 class="no-num no-toc" id="table">Table of contents</h2>
	<!--toc-->

<!-- ====================================================================== -->

<h2 id="overview">
Overview</h2>

	<p>CSS 2.1 defined four layout modes, algorithms which determine the size and 
	position of boxes based on their relationships with their sibling and ancestor 
	boxes: block layout, designed for laying out documents and simple applications,
	inline layout, designed for laying out text,
	table layout, designed for laying out information in a tabular format, and 
	positioned layout, designed for very explicit positioning without much regard 
	for other elements in the document. This module introduces a new layout mode, 
	flexbox layout, which is designed for laying out more complex applications and 
	webpages.</p>

	<p>Flexbox layout is superficially similar to block layout.  It lacks many of 
	the more complex text or document-formatting properties that can be used in 
	block layout, such as 'float' and 'columns', but in return it gains more simple
	and powerful tools for aligning its contents in ways that webapps and complex
	web pages often need.  </p>
    
	<p>Flexbox layout operates exclusively on immediate block-level children, 
	which are referred to as<dfn> flexbox item</dfn>s. Flexbox may directly 
	contain inline children or out of flow content, in which case flexbox item 
	fixup is performed, as described below.</p>

    <p><em>Flexbox items </em>can be laid out in any direction,
	can have their order swapped around dynamically, and can "flex" their sizes
	and positions to respond to the available space.</p>
<p>If <dfn>multiline</dfn> option is enabled (by including one of &#39;wrap-&#39; keywords in 
&#39;flex-flow&#39; property), flexbox items flow in two dimensions, wrapping lines of 
items similarly to wrapping lines of text. The two-dimensional flow can have 
any combination of directions, matching current writing mode (logical), 
independent of writing mode (physical) or mixed. </p>
<p>In flexbox, the term <dfn>main axis</dfn> refers to the primary 
direction of flow of <i>flexbox item</i>s, the direction in which items are 
added to layout in a single line flexbox, or in one line of multiline flexbox. 
Main axis direction determines logical &#39;start&#39; and &#39;end&#39;.</p>
<p>The term <dfn>cross axis</dfn> refers to the direction orthogonal to main axis. 
Direction of defines logical &#39;before&#39; and &#39;after&#39; for alignment and direction of 
wrapping when wrapping is enabled.</p>

	<p>Similar to other layout modes such as table layout, a flexbox acts like a
	block when placed into other layout modes.  Inline flexboxes can also be declared, 
	which act like inline-blocks.</p>

	<div class="example">
		<p>For example:</p>

		<pre>
&lt;p style="width: 400px; display: flexbox;">
	&lt;button style="width: 200px;">Child 1&lt;/button>
	&lt;button style="width: 100px;">Child 2&lt;/button>
&lt;/p>
</pre>

		<p>In this example, the first button is 200 pixels wide and the second button is
		100 pixels wide. As the flexbox is 400 pixels wide, there is extra space left over
		which is placed after the two buttons but inside the flexbox. The placement of this
		extra space may be modified using the various flex properties described in the next
		sections. Neither the height of the buttons nor the height of the flexbox are specified,
		so the height is computed intrinsically from the content. In this case, the buttons
		will be the height needed to display the label and button border, and the flexbox will
		also be this height plus any margins around the buttons.</p>
	</div>
	
	<p class="issue">this needs a picture</p>

<!-- ====================================================================== -->

<h2 id=display-flexbox>
New values for 'display' property</h2>

	<table class="propdef">
		<tbody>
			<tr>
				<th>Name:
				<td>display
			<tr>
				<th>New value:
				<td>flexbox | inline-flexbox
		</tbody>
	</table>

	<p>You can declare that an element is a flexbox, and thus should use flexbox 
	layout, by setting the &#39;display&#39; property on the element to the value 
	&#39;flexbox&#39; or &#39;inline-flexbox&#39;.</p>
<p>Flexbox establishes a new block formatting context for its content.</p>

<!-- ====================================================================== -->

<h2 id=flex-items>
Flexbox Items</h2>
<p>Flexbox layout algorithm operates on <em>flexbox items.</em>

	<p>Flexbox items are:<ol>
	<li>Immediate block-level children of flexbox</li>
	<li>Atomic inline-level children of flexbox</li>
	<li>Contiguous run of non-replaced
	inline children, wrapped into an anonymous block</li>
</ol>

	<div class="example">
	Examples of flexbox items
	<pre>
&lt;div style=&quot;display:flexbox&quot;&gt;

    &lt;!-- flexbox item: block-level child --&gt;
    &lt;div id=&quot;item1&quot;&gt;block&lt;/div&gt;
    
    &lt;!-- flexbox item: block-level child --&gt;
    &lt;div id=&quot;item2&quot; style=&quot;display:table&quot;&gt;table&lt;/div&gt;
    
    &lt;!-- flexbox item: anonymous table wrapped around table-cell --&gt;
    &lt;div id=&quot;item3&quot; style=&quot;display:table-cell&quot;&gt;table-cell&lt;/div&gt; 

    &lt;!-- flexbox item: anonymous block around inline content --&gt;
    anonymous item 4                                            

    &lt;!-- flexbox item: block-level child --&gt;
    &lt;div id=&quot;item5&quot;&gt;block&lt;/div&gt;                                 

    &lt;!-- flexbox item: anonymous block around inline content --&gt;
    anonymous item 6.1
    &lt;span id=&quot;item6.1&quot;&gt;
        text 6.2
        &lt;div id=&quot;not-an-item6.3&quot;&gt;block&lt;/div&gt;
        text 6.4
    &lt;/span&gt;

    &lt;!-- flexbox item: block-level replaced element --&gt;
    &lt;img id=&quot;item7&quot;&gt;

    &lt;!-- flexbox item: inline-level replaced element --&gt;
    &lt;img id=&quot;item7&quot; style=&quot;display:inline&quot;&gt;

    &lt;!-- flexbox item: inline-level replaced element --&gt;
    &lt;button id=&quot;item8&quot;&gt;button&lt;/button&gt;

    &lt;!-- flexbox item: inline-table --&gt;
    &lt;div id=&quot;item9&quot; style=&quot;display:inline-table&quot;&gt;table&lt;/div&gt;     
&lt;/div&gt;
</pre>
	Notice that block element "not-an-item6.3" is not a separate flexbox item, because it is contained inside an inline element which is being wrapped into an anonymous flex item.
	</div>
<p>Out-of-flow elements like absolutely positioned elements
	leave behind a 'placeholder' inline element in their original position in the
	document <p class=issue>This needs to change. Placeholder is not fully hypothetical in this case, 
that element or line is detectable in &quot;flex-pack:justify&quot;. TODO: define the 
&quot;auto&quot; positoin without a placeholder.&nbsp;

	<p>Setting ''display:flexbox'' on an element forces it to use a new layout 
	algorithm, and so some properties that were designed with the assumption of 
	block layout don't make sense in a flexbox context.  In particular:</p>

	<ul>
		<li>all of the 'column-*' properties in the Multicol module compute to their initial 
		values on a flexbox ('break-before', 'break-inside', and 'break-after' are still 
		valid on a flexbox).</li>
		<li>'float' and 'clear' compute to their initial values on a flexbox item</li>
		<li>'vertical-align' has no effect on a flexbox item</li>
	</ul>
	<p class="issue">It has been proposed that vertical-align property applies to flex items 
	(simliar to table cells). Decide if it makes sense, or if it should instead apply broader (to any blocks). </p>

<p>
A flexbox item creates a new BFC.  The margins of a flexbox item 
	do not collapse with any other margin.  Flexboxes "shrinkwrap" their contents
	by default (when their 'width' or 'height' properties are ''auto''), similar
	to tables or floats.</p>

<!-- ====================================================================== -->

<h2>
Flexbox Flow Direction: the 'flex-flow' property</h2>

	<table class=propdef>
		<tbody>
			<tr>
				<th style="width: 143px">Name:</th>
				<td><dfn>flex-flow</dfn></td>
			<tr>
				<th style="width: 143px">Values:
				<td>
				<!-- TODO: remove PRE here if the default template has whitespace:pre -->
				<pre style="margin:0; font:inherit"
>[ row | row-reverse | column | column-reverse ] || [ wrap | wrap-reverse ] |

[ horizontal | horizontal-reverse | horizontal-ltr| horizontal-rtl ] &amp;&amp;
[ wrap| wrap-reverse | wrap-down| wrap-up ]? |

[ vertical| vertical-reverse| vertical-ttb| vertical-btt ] &amp;&amp;
[ wrap | wrap-reverse | wrap-left | wrap-right ]?
&nbsp;</pre>
                </td>
			<tr>
				<th style="width: 143px">Initial:
				<td>row</td>
	        </tr>
			<tr>
				<th style="width: 143px">Applies To:
				<td>flexboxes</td>
	        </tr>
			<tr>
				<th style="width: 143px">Inherited:
				<td>no</td>
	        </tr>
			<tr>
				<th style="width: 143px">Computed Value:
				<td>specified value</td>
	        </tr>
			<tr>
				<th style="width: 143px">Media:
				<td>visual</td>
	        </tr>
		</tbody>
	</table>

	<p>The 'flexbox-flow' property specifies how <i>flexbox item</i>s 
	are placed in the flexbox.  The value of the property can consist of one or 
	two keywords describing direction of main axis and direction of wrapping. The 
	keyowrds have the following 
	meanings:</p>
	
	<dl>
    	<dt><dfn id='flex-flow-horizontal'>horizontal</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed horizontally. 
    	In horizontal writing modes, items are added in inline direction of 
		current writing mode. In 
		vertical writing modes, items are added in block direction of current 
		writing mode.
    	</dd>

    	<dt><dfn id='flex-flow-horizontal-reverse'>horizontal-reverse</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed horizontally. Items are added in 
		direction opposite to the direction defined by &#39;horizontal&#39; value.</dd>

    	<dt><dfn id='flex-flow-horizontal-ltr'>horizontal-ltr</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed horizontally, from left to right.</dd>

    	<dt><dfn id='flex-flow-horizontal-rtl'>horizontal-rtl</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed horizontally, from right to left.</dd>
    	</dd>

    	<dt><dfn id='flex-flow-vertical'>vertical</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed vertically. 
    	In vertical writing modes, items are added in inline direction of 
		current writing mode. In 
		horizontal writing modes, items are added in block direction of current 
		writing mode.
    	</dd>

    	<dt><dfn id='flex-flow-vertical-reverse'>vertical-reverse</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed vertically. Items are added in 
		direction opposite to the direction defined by &#39;vertical&#39; value.</dd>

    	<dt><dfn id='flex-flow-vertical-ttb'>vertical-ttb</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed vertically, from top to bottom.</dd>

    	<dt><dfn id='flex-flow-row-vertical-btt'>vertical-btt</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed vertically, from bottom to top.</dd>

    	<dt><dfn id='flex-flow-row'>row</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed in same orientation and direction as inline content in current writing mode.
    	</dd>

    	<dt><dfn id='flex-flow-row-reverse'>row-reverse</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed in same orientation as inline content in current writing mode, 
    	but in opposite direction.
    	</dd>

    	<dt><dfn id='flex-flow-column'>column</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed in same orientation and direction as 
		block boxes in current writing mode.
    	</dd>

    	<dt><dfn id='flex-flow-column-reverse'>columns-reverse</dfn></dt>
    	<dd><i>Flexbox item</i>s are placed in same orientation as block boxes in current writing mode, 
    	but in opposite direction.
    	</dd>

    	<dt><dfn id='flex-flow-wrap'>wrap</dfn></dt>
    	<dd>Flow of <i>flexbox item</i>s is wrapped into multiple lines as needed. 
    	In horizontal writing modes, new lines are added in block direction.
    	In vertical writing modes, new lines are added in inline direction.
    	</dd>

    	<dt><dfn id='flex-flow-wrap-reverse'>wrap-reverse</dfn></dt>
    	<dd>Flow of <i>flexbox item</i>s is wrapped into multiple lines as needed. 
    	New lines are added in direction opposite to the direction defined by 'wrap' value.
    	</dd>

    	<dt><dfn id='flex-flow-wrap-up'>wrap-up</dfn></dt>
    	<dd>Flow of <i>flexbox item</i>s is wrapped into multiple lines as needed. 
    	New ines are added above.
    	</dd>

    	<dt><dfn id='flex-flow-wrap-right'>wrap-right</dfn></dt>
    	<dd>Flow of <i>flexbox item</i>s is wrapped into multiple lines as needed. 
    	New ines are added to the right.
    	</dd>

    	<dt><dfn id='flex-flow-wrap-down'>wrap-down</dfn></dt>
    	<dd>Flow of <i>flexbox item</i>s is wrapped into multiple lines as needed. 
    	New ines are added down.
    	</dd>

    	<dt><dfn id='flex-flow-wrap-left'>wrap-left</dfn></dt>
    	<dd>Flow of <i>flexbox item</i>s is wrapped into multiple lines as needed. 
    	New ines are added tp the left.
    	</dd>
</dl>

<p>Not all combinaiton of main-axis direction and flow direction are allowed, 
because some combinations don&#39;t make sense(for example &quot;flex-flow: horizontal 
wrap-right&quot; is not possible).</p>
<div class="example">
<p>Some examples of valid flows:</p><pre
>div { flex-flow:row }                     /* initial value. Main axis is inline,
	                                           no wrap. */
div { flex-flow:horizontal-ltr wrap-down } /* main axis is horizontal, flow left-to-right, 
                                              wrap down */
div { flex-flow:wrap }                     /* main axis is inline direction(default), 
                                              wrap in block direction */
div { writing-mode:tb-rl;                  /* main axis is vertical top-to-bottom (as line direction),
      flex-flow:vertical wrap-reverse }    /* wrap direction is left-to-right (opposite to block direction) */
</pre>
</div>
<p class="auto-style1">For details on wrapping into multiple lines, see
<a href="#multiline">Multi-line flexbox</a></p>

<!-- ====================================================================== -->

<h2 id='flex-order'>
Display Order: the 'flex-order' property</h2>

	<p><i>flexbox item</i>s are, by default, displayed and laid out in the same order
	as they appear in the source document.  The 'flex-order' property may be used
	to change this ordering.</p>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex-order</dfn>
		<tr>
			<th>Value:
			<td>&lt;integer>
		<tr>
			<th>Initial:
			<td>1
		<tr>
			<th>Applies to:
			<td><i>flexbox item</i>s</td>
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
	</table>

	<p><i>Flexbox item</i>s may be assigned to ordinal groups using the 'flex-order'
	property.  This property is an integer with an initial value of 1.</p>

	<p>Ordinal groups control the order in which <i>flexbox item</i>s appear.  A flexbox
	will lay out its content starting from the lowest numbered ordinal group and
	going up.  Items with the same ordinal group are laid out in the order they
	appear in the source document.

	<div class=example>
		<p>This example shows how ordinal groups might be used.</p>
		<pre><code>	div { display: flexbox; }
	#item1 { flex-order: 2; }
	#item3 { flex-order: 2; }
	#item4 { flex-order: 1; }

	&lt;div>
		&lt;div id="item1">item1&lt;/div>
		&lt;div id="item2">item2&lt;/div>
		&lt;div id="item3">item3&lt;/div>
		&lt;div id="item4">item4&lt;/div>
	&lt;/div></code></pre>

		<p>The first ordinal group, 1, contains item2 and item4. As item2 does not 
		specify an ordinal group, it will default to 1. The elements will be displayed 
		in document order, so item2 will be displayed before item4. The second ordinal 
		group, 2, contains the remaining two items. The resulting display order will 
		be:</p>

		<pre><code>item2 item4 item1 item3</code></pre>
	</div>

<!-- ====================================================================== -->

<h2 id='flexibility'>
Flexibility</h2>

	<p>The defining aspect of flexbox layout is the ability to make various lengths
	of the <i>flexbox item</i>s flexible.  The 'width', 'height', 'padding', and 
	'margin' properties of a <i>flexbox item</i> can all be made flexible.  Paddings
	and margins are made flexible by setting their value to ''auto'', while the
	width and height of a box can be controlled more precisely with the ''flex()'' function, defined below.</p>

	<div class=example>
		<p class=issue>TODO: Examples!</p>
	</div>

<h3 id='resolving-flexible-lengths'>
Resolving Flexible Lengths</h3>

	<p>Flexbox layout resolves a <i>flexible length</i> into a definite length by first collecting
	all the lengths, flexible or inflexible, that will share some space.  For example,
	for a horizontal flexbox, the lengths of the left and right margins, left and right
	borders, left and right paddings, and widths of all <i>flexbox item</i>s share
	the width of the flexbox itself.  Conversely, each 
	<i title="flexbox item">flexbox item's</i> vertical margins, borders, padding, 
	and height individually share the height of the flexbox.</p>

	<div class=figure>
		<p class="caption issue">TODO: Diagram showing the relevant lengths
		in each axis.</p>
	</div>

	<p>Flexbox layout then sums the <dfn>preflex size</dfn> of the lengths in each set.  The
	<i>preflex size</i> of an inflexible length is just the length itself.  The
	<i>preflex size</i> of a flexible length is its <i>preferred size</i>.  If the 
	sum of all the <i title="preflex size">preflex sizes</i> is less than the 
	available width/height of the flexbox, then the difference is split up among all the 
	<i title="flexible length">flexible lengths</i> with <dfn>positive flexibility</dfn>, 
	with the space divvied up proportionally to the flexibility of each length.  If 
	the sum is greater than the available width/height, then all the
	<i title="flexible length">flexible lengths</i> with <dfn>negative flexibility</dfn>
	shrink in proportion to their flexibility to try and make the sum equal the 
	available width/height.</p>
 
	<p>The 'flex-pack' and 'flex-align' properties offer additional options for free-space distribution.  The precise details of how free space is determined 
	and assigned to flexible lengths is detailed in a later chapter.</p>

<h3 id='flex-function'>
The ''flex()'' function</h3>
 
	<p>The ''flex()'' function is used to specify the parameters of a
	<i>flexible length</i>: the <i title="positive flexibility">positive</i> 
	and <i>negative flexibility</i>, and the <i>preferred size</i>.  The syntax
	of the ''flex()'' function is roughly (see following prose for a precise
	description):</p>

	<pre class=prod>flex( [ <i title="positive flexibility">&lt;pos-flex></i> || <!--
	--><i title="negative flexibility">&lt;neg-flex></i> || <!--
	--><i title="preferred size">&lt;preferred-size></i> ] )</pre>
<p>Applicable to 'width' and 'height'</p>
<p class="note">In the future this may be applicable to margin and padding</p>

	<dl>
		<dt>If the ''flex()'' function contains a single value:</dt>
		<dd>
			<ul>
				<li>If the value is a non-negative number, the <i>positive flexibility</i> 
				is set to that value, the <i>negative flexibility</i> is set to 
				''0'', and the <i>preferred size</i> is set to the initial value 
				of the property (&#39;auto&#39; for width and height).</li>

				<li>Otherwise, if the value is a &lt;length>, a &lt;percentage>,
				or a valid keyword, the <i>preferred size</i> 
				is set to that value, the <i>positive flexibility</i> and the <i>negative flexibility</i> 
				are set to initial value (zero)</li>

				<li>Otherwise, the ''flex()'' function is invalid.</li>
			</ul>
		</dd>

		<dt>If the ''flex()'' function contains two values:</dt>
		<dd>
			<ul>
				<li>If both values are non-negative numbers, the <i>positive flexibility</i>
				is set to the first value, the <i>negative flexibility</i> is set
				to the second value, and the <i>preferred size</i> is set to its 
				initial value.</li>

				<li>Otherwise, if one value is a non-negative number and the other 
				is a &lt;length>, a &lt;percentage>, or a valid keyword, the <i>positive flexibility</i> is set to the number, the
				<i>negative flexibility</i> is set to ''0'', and the <i>preferred size</i>
				is set to the other value.</li>

				<li>Otherwise, the ''flex()'' function is invalid.</li>
			</ul>
		</dd>

		<dt>If the ''flex()'' function contains three values:</dt>
		<dd>
			<ul>
				<li>If the first two values are non-negative numbers and the third
				value is ''0'', the <i>positive flexibility</i> is set to the first
				value, the <i>negative flexibility</i> is set to the second value,
				and the <i>preferred size</i> is set to ''0px''.</li>

				<li>Otherwise, If two of the values are non-negative numbers, and the other
				is a &lt;length> (with a unit suffix), a &lt;percentage>, or a 
				valid keyword, the <i>positive flexibility</i> 
				is set to the first number, the <i>negative flexibility</i> is set 
				to the second number, and the <i>preferred size</i> is set to the 
				other value.
				</li>

				<li>Otherwise, the ''flex()'' function is invalid.</li>
			</ul>
		</dl>

	<dl>

		<dt>If the ''flex()'' function contains less than one or more than three values:</dt>
		<dd>
			<ul>
				<li>The &quot;flex()&quot; function is invalid</li>

			</ul>
		<p class="issue">Note change from previous draft: default/unspecified are 
		the initial values: still &#39;auto&#39; for width/height, 0 if it is ever 
		applied to margings and padding; 0 for positive flexibility (was 1 in 
		previous draft).</p>
		<p class='note'>Note that, while ''0'' &lt;length> is normally allowed to 
	be specified without a unit suffix, in flex() function it is ambiguous, as 
		it is also an acceptable value for flexibility. All ambiguous cases are 
		resolved with preference to flexibility, thus unitless &quot;0&quot; can only be 
		applied to <em>preferred size </em>when three vaues are specified and 
		&quot;0&quot; is the last one.</p>
		<p>User agents that allow non-zero 
		length values without unit suffix in &quot;quirks mode&quot; may also 
		accept a non-zero positive number as the <em>preferred size </em>
		in pixels 
		when in &quot;quirks mode&quot; and when it is the third value in flex() function 
		with three values.</p>
<h3 id="flexible-margins">Flexible margins and paddings</h3>
			<p>Paddings and margins are made flexible by setting their value to 
			&#39;auto&#39;. </p>
			<p>When margin or padding size on a <em>flexbox item</em> is set to 
			&#39;auto&#39; in orientation of main axis, that margin or padding is 
			included in flexbox layout algorithm with flexibility of 1.</p>
			<p>&#39;Auto&#39; margin can also be used for alignment along the <em>
			cross-axis</em>, see <em><a href="#flex-align">&#39;flex-align&#39; property</a></em></p>
			<p class="issue">
			<a href="http://wiki.csswg.org/spec/css3-flexbox?&amp;#issue-15">
			(Issue 15)</a> Interpretation of 'auto' value for margins parallel to <i>
			main axis </i>appears incomplete because flex() doen&#39;t apply, and 
			also margin/padding can&#39;t have min/max values. Flex() could be 
			allowed there, but it would be more complicated.</p>
			<p class="issue">TODO: need solid use cases (and illustrations here) 
			for flexible margins and paddings.</p>
			
<!-- ====================================================================== -->

		<h2 id='flex-pack'>The 'flex-pack' property</h2>
		<table class=propdef>
			<tr>
				<th>Name:
				<td><dfn>flex-pack</dfn>
			<tr>
				<th>Value:
				<td>start | end | center | justify | inherit</td>
			<tr>
				<th>Initial:
				<td>start
			<tr>
				<th>Applies to:
				<td>flexboxes
			<tr>
				<th style="height: 20px">Inherited:
				<td style="height: 20px">no
			<tr>
				<th>Computed Value:
				<td>specified value
			<tr>
				<th>Media:
				<td>visual
		</table>
		<p>Between and around the margins of <i>flexbox item</i>s there are additional 
	flexible lengths, called <dfn>packing space</dfn>.  Packing space can absorb 
	leftover free space in a flexbox if there aren't any other <i>flexible length</i>s, 
	or if all the <i>flexible length</i>s have reached their maximum size.  The 
	'flex-pack' property defines the flexibility of these packing spaces:

		<dl>
			<dt><dfn id='flex-pack-start'>start</dfn></dt>
			<dd><i>flexbox item</i>s are packed toward the start of the flexbox.  The
		last packing space (between the margin of the last flexbox item and the 
		edge of the flexbox) must absorb all leftover free space; all other packing
		spaces must have a length of ''0''.</dd>
			<dt><dfn id='flex-pack-end'>end</dfn></dt>
			<dd><i>flexbox item</i>s are packed toward the end of the flexbox.  The
		first packing space (between the edge of the flexbox and the margin of the 
		first flexbox item) must absorb all leftover free space; all other packing
		spaces must have a length of ''0''.</dd>
			<dt><dfn id='flex-pack-center'>center</dfn></dt>
			<dd><i>flexbox item</i>s are packed toward the center of the flexbox.  The
		first and last packing spaces must equally split all leftover free space;
		all other packing spaces must have a length of ''0''.</dd>
			<dt><dfn id='flex-pack-justify'>justify</dfn></dt>
			<dd><i>flexbox item</i>s are evenly distributed through the flexbox.  The
		first and last packing spaces must have a length of ''0''; all other packing
		spaces must equally split all leftover free space.</dd>
		</dl>
		<div class=figure>
			<p class=caption><span class=issue>TODO: Provide a diagram showing packing
		spaces.</span></p>
		</div>
		<div class=example>
			<p class=issue>TODO: Examples showing the four values.</p>
		</div>
		
<!-- ====================================================================== -->

		<h2 id='flex-align'>The 'flex-align' property</h2>

		<p>Sizing and positioning of <em>flexbox item</em>s along the <em>cross 
		axis</em> of flexbox is controlled by the &#39;flex-align&#39; property.</p>

		<table class=propdef>
			<tr>
				<th>Name:
				<td><dfn id="propdef-flex-align">flex-align</dfn>
			<tr>
				<th style="height: 20px">Value:
				<td style="height: 20px">before | after | middle | stretch |&nbsp; baseline 
				| inherit
			<tr>
				<th>Initial:
				<td>stretch
			<tr>
				<th>Applies to:
				<td>flexbox items
			<tr>
				<th style="height: 20px">Inherited:
				<td style="height: 20px">no
			<tr>
				<th>Computed Value:
				<td>specified value
			<tr>
				<th>Media:
				<td>visual
		</table>
			</i>
			<p>When the size of the containing box along<em> cross axis </em>is 
			larger than the size of a child, extra space will be available. The 
			&#39;flex-align&#39; property specifies how flexbox item is placed along the
			<em>cross axis</em>, and where the extra space, if any, is 
			positioned. </p>
			<p>The values of this property have the following meanings. See text for more specifics as to how children are 
			positioned. /p>
			
			  <dl>
   <dt>before

   <dd>The &#39;before&#39; edge of the child box along<em> cross axis </em>is aligned with &#39;before&#39; edge of the 
   flexbox content box. See text for explanation of how direction of <em>cross 
   axis</em> is determined.<dd>
   <dt>after

   <dd>The &#39;after&#39; edge of the child box along<em> cross axis </em>is aligned with &#39;after&#39; edge of the 
   flexbox content box. See text for explanation of how direction of <em>cross 
   axis</em> is determined.<dt>middle

   <dd>Any extra space along the<em> cross axis </em>is divided evenly, with half placed 
   before the child
    and the other half placed after the child.

   <dt>baseline

   <dd>&nbsp;If this child&#39;s inline axis is parallel to <em>main axis</em> of 
   the flexbox, the baseline of the child box is aligned with baselined of all 
   other child boxes that meet the same criteria. Baseline of each child box is 
   determined in the same way as when it is placed inline (as inline-block, 
   inline-table, etc.).
				  <dd>The children participating in baseline alignment, once 
				  aligned on their baselines, should then be placed into the box 
				  so that the child with the earliest extent margin has its 
				  &#39;before&#39; margin edge flush with the &#39;before&#39; edge of flexbox&#39;s 
				  content area. If the flexbox does not have an &#39;<code
    class=property>auto</code>&#39; height, overflow will always be on the
    			  &#39;after&#39; edge.

   			      <dd>If the child box <em>inline axis </em>is orthognal to 
				  flexbox <em>main axis</em>, then <span >&#39;baseline&#39;</span> is
    interpreted as <span >&#39;center&#39;</span>.

   			   <dd>
				  
   <dt>stretch

   <dd>The height of each child is adjusted to that of the containing block.
    However, note the text below.
  </dl>

			<p>Direction of the <em>cross axis </em>is determined as follows:</p>
				<p>In multi-line flexbox, <em>cross axis </em>points in the 
				direction of wrapping (the side where lines are added)</p>
				<p>In single-line flexbox, the direction of <em>cross axis</em> is 
				determined by the computed value of writing mode of the flexbox 
				element.</p>
				<ul>
				<li> If flexbox&#39;s <em>main axis </em>is parallel to inline axis of 
				the writing mode, <em>cross axis</em> points in the direction of 
				block flow</li>
					<li> If flexbox&#39;s <em>main axis </em>is parallel to block flow 
					axis of the writing mode, <em>cross axis</em> points in the 
					direction of inline flow</li>
				</ul>
			</ul>
			<p>The following rules should be applied when determining the size of
   		 child boxes along the<em> cross axis</em>. Exceptions to these rules 
			are noted under each of the possible values of &#39;<code class=property><a
   href="#propdef-flex-align">flex-align</a></code>&#39; below.

  		  <p>First, the <em>cross axis </em>size of content box of the flexbox 
		  has to be calculated. If computed value of flexbox&#39;s width or height 
		  (whichever is along the<em> cross axis</em>), that value is used. If 
		  it is &#39;auto&#39;, the size is determined by flexbox items, as follows:<ol>
				<li><em>Cross-axis s</em>izes of margin boxes of all children in 
				are checked and the biggest is selected.</li>
				<li>If there are any children with baseline alignemnt, biggest 
				ascent (including its margin-before) and biggest descent 
				(including its margin-after) are found.</li>
				<li>Flexbox&#39;s content box size is the size its biggest child or 
				the sum of the biggest ascent and biggest descent, whichever is 
				larger</li>
			</ol>

  <p>All normal flow children of boxes will attempt to satisfy the following
   sizing equation when placed inside vertical boxes if and only if at least
   one of the specified values is auto:

  <p>&#39;<code class=property>margin-left</code>&#39; + &#39;<code
   class=property>border-left-width</code>&#39; + &#39;<code
   class=property>padding-left</code>&#39; + &#39;<code
   class=property>width</code>&#39; + &#39;<code
   class=property>padding-right</code>&#39; + &#39;<code
   class=property>border-right-width</code>&#39; + &#39;<code
   class=property>margin-right</code>&#39; = width of containing box

  <p>and a similar equation for height when placed inside horizontal boxes:

  <p>&#39;<code class=property>margin-top</code>&#39; + &#39;<code
   class=property>border-top-width</code>&#39; + &#39;<code
   class=property>padding-top</code>&#39; + &#39;<code
   class=property>height</code>&#39; + &#39;<code
   class=property>padding-bottom</code>&#39; + &#39;<code
   class=property>border-bottom-width</code>&#39; + &#39;<code
   class=property>margin-bottom</code>&#39; = height of containing box

  <p>If all the values in the equation are specified (i.e., if there are no
   auto values), then the equation above does not apply, and the specified
   values should be used. If applying the equation results in a negative
   value for width/height, then that value is set to 0, and those values
   should be used.

  <p>If the value of <span class=property>&#39;<code class=property><a
   href="#propdef-flex-align">flex-align</a></code>&#39;</span> is <span
   class=property>&#39;stretch&#39;</span>, then elements obey the sizing rules 
  specified above. This is the default value. If both width/height and one or 
  both margin values are &#39;<code class=property>auto</code>&#39;, the &#39;<code class=property>auto</code>&#39; 
  margins are set to 0 and the equation is used to find a value for 
  width/height. Otherwise, if both margins are &#39;<code class=property>auto</code>&#39;, then the
   equation is solved under the additional constraint that the two margins
   must get the same value. If neither the width/height or either margin is
   auto, then the extra space is positioned as if flex-align was &#39;before&#39;.

  <p>If the value of <span class=property>&#39;<code class=property><a
   href="#propdef-flex-align">flex-align</a></code>&#39;</span> is before, middle, 
  baseline or after, and a value of &#39;<code
   class=property>auto</code>&#39; is specified for width/height, then the
   intrinsic size (or shrink to fit size) of the element should be used. If
   one margin has the value of auto, then the equations above should be used.
   If both margins have a value of auto then the above equations should be
   used, with the space being divided evenly between the two margins. These
   rules are similar to the rules for replaced elements inside blocks.

  <p>If the above would cause the width or height to greater than the
   computed maximum width or height, then the width or height is set to the
   maximum width or height, and the auto margins increased by the extra
   amount left over. If both margins are auto, they should both be increased
   by the same amount. If neither margin is auto, the extra space is placed
   as necessary depending on the flex-align value.

  <p>Once the sizes are computed, the margin boxes of the elements should be
   aligned at the before, middle, baseline or after edge of the box.

<div class=example>   
				<p>A vertical flexbox can be used to emulate the functionality of HTML's
		''&lt;center>'' element:</p>
				<pre>&lt;div>
	&lt;span>foo foo foo foo&lt;/span>
	&lt;span>bar bar&lt;br>bar bar&lt;/span>
	&lt;span>foo foo foo foo foo foo foo foo foo foo foo foo&lt;/span>
&lt;/div>
&lt;style>
	div {
		display: flexbox;
		flex-direction: tb;
		width: 200px;
	}
	span {/* /*  */ */
		margin: 0 auto;
	}
&lt;/style>
		</pre>
				<p><img alt="" src="images/basic-vertical-flexbox.png"></p>
			</div>
<p class="issue">
			TODO: examples, with pictures
						<p class="issue">TODO: alignment rules should be compatible with css3-grid-layout, 
			if possible</p>

<!-- ====================================================================== -->

			<h2 id=multiline>Multi-line flexbox</h2>
			<p>If no &#39;wrap-&#39; keyword is included in &#39;flex-flow&#39;, flexbox lays out its 
  items in a single row or column; any items that don't fit will simply be considered
   overflow.

  	  	  <p>Adding any of the &#39;wrap-&#39; keywords to &#39;flex-flow&#39; enables multi-line mode. 
  Then flexbox is allowed to
   expand to multiple lines (that is, multiple rows or columns) in order to
   accommodate all of its items. Flexbox must attempt to fit its items
   on as few lines as possible by shrinking all items down to their
   minimum widths or heights if necessary.

  	  	  <p>If the items still do not fit on a line after
   being reduced to their minimum widths or heights, then items are moved one by one
   onto a new line, until the items remaining on the previous line fit.
   This process can repeat to an arbitrary number of lines. If a line
   contains only a single item that doesn't fit, then the item should
   stay on that line and overflow out of the box. The later lines are placed
   according to wrap direction specified in 'flex-flow'.

  	  	  <p>The cross-axis size of a line is the cross-axis size of the largest item
   in that line. No additional space appears between the lines apart from the
   margins on the largest items in each line. For calculating the cross-axis size
   of a line, margins with a computed value of auto should be treated as
   having a value of 0.

  	  	  <p>Once the number of lines has been determined, items with non-zero flexibility
   stretch as necessary in an attempt to fill
   the remaining space on the lines. Each line computes flexes independently,
   so only elements on that line are considered when evaluating flex. 
   The packing of elements in a line, as specified by the
   flex-pack property, is also computed independently for each line.

  	  	  <div class=example>
			  <p>This example shows four buttons that do not fit horizontally.</p>
			  <pre>    #div1 {
      display: flexbox;
      flex-flow: wrap;
      width: 300px;
    }
    button {
      width: flex(80px 1.0);
    }

    &lt;div id="div1"&gt;
      &lt;button id="button1"&gt;Elephant&lt;/button&gt;
      &lt;button id="button2"&gt;Tiger&lt;/button&gt;
      &lt;button id="button3"&gt;Antelope&lt;/button&gt;
      &lt;button id="button4"&gt;Wildebeest&lt;/button&gt;
    &lt;/div&gt;
</pre>
			  <p>The buttons are shrunk to their minimum widths, in this case 80 pixels. 
   This will allow the first three buttons to
    fit in 240 pixels with 60 pixels left over of remaining space. Because
    the box-lines property has a specified value of multiple, the fourth
    button may be moved onto a second line.</p>
			  <p>Flexibility is applied to each element, separately for each line. The
    first line has 60 pixels of remaining space, so each of the three buttons
    on that line will receive 20 pixels of extra width. The remaining button
    on a line of its own will stretch to the entire width of the containing
    box, or 300 pixels.</p>
			  <div style="width:300px; border:medium solid green">
				  <button style="width:100px">Elephant</button
      ><button style="width:100px">Tiger</button
      ><button style="width:100px">Antelope</button
      ><button style="width:300px">Wildebeest</button></div>
			  <p>If the box was resized, the buttons may rearrange onto different lines
    as necessary. If the style rules in the example above were changed to the
    following:</p>
			  <pre>    #div1 {
      display: flexbox;
      flex-flow: wrap;
      flex-pack: center;
      width: 300px;
    }
    button {
      width: flex(80px 1.0);
      max-width: 90px;
    }
</pre>
			  <p>Now, each of the buttons will only stretch to include an additional 10
    pixels of width, as the maximum width of 90 pixels is only 10 pixels
    larger than the minimum intrinsic width of the buttons. The remaining 30
    pixels of space left over is divided up and placed inside the box outside
    of the buttons, as the value of box-pack is center. The fourth button
    will also appear at 90 pixels wide, centered within the box.</p>
			  <div style="width:300px; border:medium solid green; text-align:center;">
				  <button style="width:90px">Elephant</button
      ><button style="width:90px">Tiger</button
      ><button style="width:90px">Antelope</button
      ><button style="width:90px">Wildebeest</button></div>
			</div>

<!-- ====================================================================== -->

  	  	  <h3 id=flex-line-pack>&#39;flex-line-pack&#39; property</h3>
  	  	  
		<table class=propdef>
			<tr>
				<th>Name:
				<td><dfn id="propdef-flex-line-pack">flex-line-pack</dfn>
			<tr>
				<th>Value:
				<td>before | after | middle | distribute | inherit</td>
			<tr>
				<th>Initial:
				<td>before
			<tr>
				<th>Applies to:
				<td>flexboxes
			<tr>
				<th style="height: 20px">Inherited:
				<td style="height: 20px">no
			<tr>
				<th>Computed Value:
				<td>specified value
			<tr>
				<th>Media:
				<td>visual
		</table>
  	  	  
  	  	  
  	  	  
  	  	  
  	  	  
			<p>The flex-line-pack property may be used to control the alignment of 
			lines in multi-line flexboxes. The values of this property have 
			the following meanings:
			<dl>
			<dt><dfn id='flex-line-pack-before'>before</dfn></dt>
    	<dd>
    	    The first line of child boxes is placed along the &#39;before&#39; edge of the 
			content box (as determined by direction of <em>cross axis</em>), and 
			additional lines are placed afterward with no extra spacing between 
			them.</dd>
			<dt>a<span class="auto-style1">fter</span></dt>
    	<dd>
    	    Lines of child boxes are placed with 
			no extra spacing between and 
			&#39;after&#39; edge of the last line is aligned with &#39;after&#39; edge of the 
			content box.</dd>
			<dt><span class="auto-style1">middle</span></dt>
    	<dd>
    	    Lines of child boxes are placed with no space between them and equal 
			amount of extra space left before first line and after last line.</dd>
				
			<dt><span class="auto-style1">distribute</span></dt>
    	<dd>
    	    The first line of child boxes is aligned with &#39;before&#39; edge of 
			conaining box. Lines of child boxes are spread with equal amout of 
			empty spaces between each two lines, and so that &#39;after&#39; edge of 
			last line of child boxes is aligned with &#39;after&#39; edge of conaining 
			box.
    	</dd>
			</dl>
			
			<p class="issue">TODO: examples</p>
			<h2 id='free-space-algorithm'>Free Space Calculation and Distribution</h2>
			<p class="issue">IS THIS SECTION NECESSARY? It may be useful for 
			implementors as guidance, but it is not normative. The spec 
			describes the result, this describes the process - one should be 
			enough, and the description of the result is not specific enough, it 
			needs to be fixed.</p>
			<p>The following algorithms detail precisely how to determine the dimensions
	and positions of a flexbox and its contents, and how to resolve flexible lengths
	used on <i>flexbox item</i>s into definite lengths.</p>
			<p>The algorithm described here is designed to be clear, but not necessarily
	efficient.  Implementations may use different algorithms, but they must generate
	the same results as this algorithm.</p>
			<p>This section defines several terms to clarify the operation of the algorithms
	described within:</p>
			<dl>
				<dt><dfn>relevant length</dfn></dt>
				<dd>The width, height, margin, border, or padding of a flexbox item.  Also,
		the <i>packing space</i>s of a flexbox.</dd>
				<dt><dfn>flex tuple</dfn></dt>
				<dd>A 5-tuple of information about a flexible length, containing a minimum
		size, a maximum size, a preferred size, a positive flexibility, and a 
		negative flexibility.</dd>
				<dt><dfn>total free space</dfn></dt>
				<dd>The inner width or height of the flexbox (depending on the distribution
		round), which will be used to calculate the sizes of the <i>flexbox item</i>s.</dd>
				<dt><dfn>available free space</dfn></dt>
				<dd>The <i>total free space</i> minus the sum of the preferred sizes of all 
		the relevant lengths, which is used to resolve <i>flex tuple</i>s into
		inflexible lengths.</dd>
			</dl>
			<p>Similarly, the <dfn>inner measure</dfn> is the width of the flexbox item in
	a horizontal flexbox, or the height in a vertical flexbox.  The <dfn>inner length</dfn>
	is the height of the flexbox item in a horizontal flexbox, or the width in a
	vertical flexbox.</p>
			<p class="issue">Definition of "inner measure" and "inner length" is not used anywhere, or is it? 
			Promote to general-use vocabulary or replace with existing terms.</p>
			<p class="issue">Suggestion: &quot;inner measure&quot; == &quot;extent along main 
			axis&quot;, &quot;inner length&quot; == &quot;extent along cross axis&quot;</p>
			<h3>Initial Computation</h3>
			<p>This step computes necessary information required to run the free-space 
	distribution algorithms.</p>
			<ol>
				<li>Determine the measure of the flexbox.  Flexboxes are sized like shrinkwrapped
		blocks (if ''display:flexbox'' is used) or inline-blocks (if ''display:inline-flexbox''
		is used).  A horizontal flexbox's measure is its width, while a vertical
		flexbox's measure is its height.  <span class=issue>This is wrong. In 
				vertical flexbox with auto sizing, height can&#39;t be calculated 
				before width (assuming horizontal flow). Calculation has to be 
				width-then-height, not measure-then-length.</span></li>
				<li>
				<p>Resolve all <i>relevant length</i>s on the flexbox and its 
			<i>flexbox item</i>s into <dfn>flex tuples</dfn> of [minimum size, 
			maximum size, preferred size, positive flex, negative flex].</p>
				<dl>
					<dt>For margins and padding:</dt>
					<dd>
					<p>Set the minimum size to 0 and the maximum size to infinity.</p>
					<p>If the length is inflexible, set the preferred size to the
					length itself and both positive and negative flexibility to 0.</p>
					<p>If the length is a margin with the value ''auto'', set the 
					preferred size to 0, the positive flexibility to 1, and the negative
					flexibility to 0.</p>
					</dd>
					<dt>For borders:</dt>
					<dd>
					<p>Borders are always inflexible.  Set the minimum size to 0, the
					maximum size to infinity, the preferred size to the border-width,
					and the positive and negative flexibility to 0.</p>
					</dd>
					<dt>For width and height:</dt>
					<dd>
					<p>Set the minimum size to the value of the 'min-width' or 'min-height',
					as appropriate.  Set the maximum size to the value of the 'max-width'
					or 'max-height' property, as appropriate, unless the value is ''none'',
					in which case set the maximum size to infinity.</p>
					<p>If the length is inflexible, set the preferred size to the length
					itself and both positive and negative flexibility to 0.</p>
					<p>Otherwise, if the length was specified with the ''flex()'' function, 
					set the positive and negative flexibility to the values specified 
					in the function.  If the preferred size argument specified in the 
					function is a &lt;length>, set the preferred size to that length.  
					If the argment is a &lt;percentage>, resolve it relative to the
					width or height of the flexbox, as appropriate, and set the preferred
					size to the resultant length.  If the argument is ''auto'', 
					set the preferred size to the item's intrinsic dimension in the
					appropriate axis.</p>
					<p>Otherwise, if the length was ''auto'', set the preferred size
					to the item's intrinsic dimension in the appropriate axis, the positive 
					flexibility to 1, and the negative flexibility to 0.</p>
					<p>If the preferred size is now less than the minimum size, set 
					it equal to the minimum size.  If the preferred size is now greater 
					than the maximum size, set it equal to the maximum size.</p>
					</dd>
					<dt>For <i>packing space</i>s:</dt>
					<dd>
					<p>If the flexbox's 'flex-pack' is <i title=flex-pack-start>start</i>, 
					the last <i>packing space</i> (between the final <i>flexbox item</i>, 
					after reordering by 'flex-order', and the end of the flexbox) has 
					a minimum size of 0, a maximum size of infinity, a preferred size 
					of 0, a positive flexibility of 1, and a negative flexibility of 
					0.  All other <i>packing space</i>s have minimum size, maximum size, 
					preferred size, positive flexibility, and negative flexibility of 
					0.</p>
					<p>If the flexbox's 'flex-pack' is <i title=flex-pack-end>end</i>, 
					the first <i>packing space</i> (between the first <i>flexbox item</i>, 
					after reordering by 'flex-order', and the start of the flexbox) 
					has a minimum size of 0, a maximum size of infinity, a preferred 
					size of 0, a positive flexibility of 1, and a negative flexibility 
					of 0.  All other <i>packing space</i>s have minimum size, maximum 
					size, preferred size, positive flexibility, and negative flexibility 
					of 0.</p>
					<p>If the flexbox's 'flex-pack' is <i title=flex-pack-center>center</i>, 
					the first and last <i>packing space</i>s (as defined above) have 
					a minimum size of 0, a maximum size of infinity, a preferred size 
					of 0, a positive flexibility of 1, and a negative flexibility of 
					0.  All other <i>packing space</i>s have minimum size, maximum size, 
					preferred size, positive flexibility, and negative flexibility of 
					0.</p>
					<p>If the flexbox's 'flex-pack' is 
					<i title=flex-pack-justify>justify</i>, 
					the first and last <i>packing space</i>s (as defined above) have
					a minimum size, maximum size, preferred size, positive flexibility,
					and negative flexibility of 0.  All other <i>packing space</i>s
					have a minimum size of 0, a maximum size of infinity, a preferred
					size of 0, a positive flexibility of 1, and a negative flexibility
					of 0.</p>
					</dd>
				</dl>
				</li>
			</ol>
			<h3 id='first-distribution-round'>First Distribution Round</h3>
			<p>This step distributes free space to the flexible lengths of the flexbox
	in the <i>measure axis</i>.</p>
			<p>Collect the set of <i>flex tuple</i>s that can participate in this step:</p>
			<ol>
				<li>If the flexbox is horizontal, collect the widths of every <i>flexbox item</i>.
		If the flexbox is vertical, instead collect the heights of every <i>flexbox item</i>.</li>
				<li>Collect the margins of every <i>flexbox item</i> that are in the flexbox's
		measure axis.</li>
				<li>Collect the borders of every <i>flexbox item</i> that are in the flexbox's
		measure axis, if the <i>flexbox item</i> has a 'box-sizing' value of ''content-box''
		or ''padding-box''.</li>
				<li>Collect the paddings of every <i>flexbox item</i> that are in the flexbox's
		measure axis, if the <i>flexbox item</i> has a 'box-sizing' value of ''content-box''.</li>
			</ol>
			<p>Invoke the <i>free space allocation algorithm</i> with the set of 
			<i>flex tuple</i>s
	collected above, and an <i>available free space</i> equal to the flexbox's 
	inner measure.</p>
			<h3 id='second-distribution-round'>Second Distribution Round</h3>
			<p>This step distributes any leftover available space to the <i>packing space</i>,
	so that the flexbox items are arranged within the flexbox as desired.</p>
			<p>Collect the same set of <i>flex tuple</i>s as in the first distribution round
	(now inflexible lengths), and additionally collect the flexbox's <i>packing space</i>s.</p>
			<p>Invoke the <i>free space allocation algorithm</i> with the set of 
			<i>flex tuple</i>s
	collected above, and an <i>available free space</i> equal to the flexbox's
	inner measure.</p>
			<h3 id='intermediate-computation'>Intermediate Computation</h3>
			<p>Determine the length of the flexbox, given the sizes that have already
	been determined.</p>
			<h3 id='third-distribution-round'>Third Distribution Round</h3>
			<p>This step distributes free space to the flexible lengths of each flexbox
	item in the <i>length axis</i>.  <strong>It is run for each <i>flexbox item</i>
	independently.</strong></p>
			<p class=issue>ISSUE: This step doesn't yet take 'flex-align' into account.
	I need to decide whether to always default to stretching or shrinking when
	doing baseline-alignment, or coming up with some heuristic for it.  Perhaps
	specify the behavior in the 'flex-align' values instead?  Once this decision
	is made, the behavior is relatively simple - either adjust margin (if shrunk)
	or padding (if stretched)

			<p>Collect the set of <i>flex tuple</i>s from the current <i>flexbox item</i>
	that can participate in this step:</p>
			<ol>
				<li>If the flexbox is horizontal, collect the height of the <i>flexbox item</i>.
		If the flexbox is vertical, instead collect the width of the <i>flexbox item</i>.</li>
				<li>Collect the margins of the <i>flexbox item</i> that are in the flexbox's 
		length axis.</li>
				<li>Collect the borders of the <i>flexbox item</i> that are in the flexbox's
		length axis, if the <i>flexbox item</i> has a 'box-sizing' value of ''content-box''
		or ''padding-box''.</li>
				<li>Collect the padding lengths of the <i>flexbox item</i> that are in the 
		flexbox's length axis, if the <i>flexbox item</i> has a 'box-sizing' value 
		of ''content-box''.</li>
			</ol>
			<p>Invoke the <i>free space allocation algorithm</i> with the set of 
			<i>flex tuple</i>s
	collected above, and an <i>available free space</i> equal to the flexbox's
	inner length.</p>
			<h3 id='free-space-allocation-algorithm'>Free Space Allocation Algorithm</h3>
			<p>This section describes the algorithm used to allocate free space to a set
	of flexible lengths.  The inputs to this algorithm are a set of <i>flex tuple</i>s
	and a length representing the <i>total free space</i>.  The output is a set 
	of inflexible lengths.</p>
			<p>Calculate the <i>available free space</i> by summing the preferred size
	of all the <i>flex tuple</i>s and subtracting that value from the <i>total free space</i>.</p>
			<p>If the <i>available free space</i> is 0, transform all the <i>flex tuple</i>s
	into inflexible lengths equal to their preferred size and return them.</p>
			<p>If the <i>available free space</i> is a positive length, it will be distributed
	between all the <i>flex tuple</i>s with positive flexibility:</p>
			<ol>
				<li>Sum the <i>positive flexibility</i> of all the <i>flex tuple</i>s.  This
		is the <i>total flexibility</i>.</li>
				<li>If the <i>total flexibility</i> is 0, transform all the <i>flex tuple</i>s
		into inflexible lengths equal to their preferred size and return them.</li>
				<li>
				<p>For each <i>flex tuple</i> with non-zero <i>positive flexibility</i>, 
			set its preferred size to:</p>
				<pre><code>[preferred size] + ( [available free space] * [positive flexibility] / [total flexibility] )</code></pre>
				</li>
				<li>If any <i>flex tuple</i>s now have a preferred size greater than their
		maximum size, set their preferred size to their maximum size, set their
		positive flexibility to 0, and restart this algorithm.</li>
				<li>Transform all the <i>flex tuple</i>s into inflexible lengths equal to
		their preferred size, and return them.</li>
			</ol>
			<p>If the <i>available free space</i> is a negative length, all the 
			<i>flex tuple</i>s
	with negative flexibility will shrink to attemp to fit the set of <i>flex tuple</i>s
	into the available space:</p>
			<ol>
				<li>Sum the <i>negative flexibility</i> of all the <i>flex tuple</i>s.  This
		is the <i>total flexibility</i>.</li>
				<li>If the <i>total flexibility</i> is 0, transform all the <i>flex tuple</i>s
		into inflexible lengths equal to their preferred size and return them.</li>
				<li>
				<p>For each <i>flex tuple</i> with non-zero <i>negative flexibility</i>, 
			set its preferred size to:</p>
				<pre><code>[preferred size] + ( [available free space] * [negative flexibility] / [total flexibility] )</code></pre>
				<p class=note>Note that the <i>available free space</i> is a negative
			length here, so the sum will result in a smaller length.</p>
				</li>
				<li>If any <i>flex tuple</i>s now have a preferred size lesser than their
		minimum size, set their preferred size to their minimum size, set their
		negative flexibility to 0, and restart this algorithm.</li>
				<li>Transform all the <i>flex tuple</i>s into inflexible lengths equal to
		their preferred size, and return them.</li>
			</ol>

<!-- ====================================================================== -->

			<h2 id="pagination">Page breaks in flexbox</h2>
			<p class="issue">TODO: define how flexbox should break on pages, columns, etc. 
			This may or may not be normative until there is more than one 
			implementation.</p>
			<p>Very roughly:</p>
		<ul>
		<li>Flexboxes can beak across pages between items, between rows of items 
		(in multi-line mode) and inside items, as long as &#39;break-&#39; property 
		allow that. All &#39;break-&#39; properties are supported on flexbox, on flexbox 
		items and inside flexbox items.</li>
			<li>Breaking behavior of a single-line vertical flexbox should be 
			identical to a block in normal flow where children have same sizes 
			and positions 
			(e.g. explicitly set to match computed values in flexbox), same content and 
			same breaking properties. <span class="issue">This is good goal or 
			guidance, but not necessarily good normative definition. Get 
			specific.</span> </li>
			<li>Breaking behavior of a horizontal single-line flexbox sholud be 
			similar (not necessarily identical) to that of a single-row table 
			with same sizing.</li>
			<li>In horizontal flexbox, a forced break within an items causes 
			subsequent content of that item to go to next container, but it 
			doesn&#39;t affect sibling items or their content.</li>
			<li>In horizontal multi-line flexbox, values of &#39;break-before&#39; and 
			&#39;break-after&#39; for each line are computed from combinatoin of 
			properties on children that fit in that line (or would have fit, 
			given available width and infinite height)</li>
			<li class="issue">TODO: define breaking of vertical multi-line 
			flexbox</li>
			<li class="issue">TODO: add more detail: how breaking affect sizing 
			(for broken boxes and boxes after the break) and alignment</li>
		</ul>
			<h2 id="layout-interface">Interface With Other Layout Algorithms</h2>
			<div class=issue>
				<p>This section seems necessary, but not the precise way it's written.  I
		need to identify precisely what data needs to be exposed both by the containing
		measure model (for the flexbox to use) and by the flexbox (for the containing
		measure model to use), and then write that up.  Then the other measure models
		we produce can re-use the same template.</p>
				<p>Need to define:</p>
				<ul>
					<li>The min/max/fit-content widths and heights of flexboxes in block contents</li>
					<li>Other stuff?</li>
				</ul>
			</div>
			<p>
			TODO: I have no idea what this is trying to say. Yes, it has to be 
			defined how auto sizing and min/max work on flexbox itself. That 
			could be a separate section. What else is meant to be here?<!--
  <p>
   A box placed in a block is considered a block level element and will be positioned
   and sized according to the rules for CSS 2.1 (section 10.3 for widths). Specifically,
   the following equation applies for calculating the width:
  </p>
  <blockquote>
  <p>'margin-left' + 'border-left-width' + 'padding-left' + 'width' + 'padding-right' + 'border-right-width' + 'margin-right' + scrollbar width (if any) = width of containing block
  </p>
  </blockquote>
  <p>All children of 'box' elements are block-level. If inline-level elements are nested
     inside boxes, they get wrapped in an anonymous block which then takes part in the
     box layout.

  </p><p>
     If the width of a child of a flexible box is computed as 'auto', then the used value
     is the shrink-to-fit width. This calculation is done similarly to how the width of
     a floating element is determined. Otherwise if the width has a computed value,
     then that value is used as the width.
  </p><p>

     In a horizontally oriented box, the flexibility is then applied which may increase
     or decrease the used width. In a vertically oriented box, the position and size
     of the child may be adjusted by the value of the container's
     <span class="property">'flex-align'</span> property.
  </p><p>

     The <span class="property">'min-width'</span>, <span class="property">'min-height'</span>,
     <span class="property">'max-width'</span>, and <span class="property">'max-height'</span>
     CSS properties act the same on boxes as on blocks.
  </p><p>

     The height of a child of a flexible box is determined in the same manner as specified
     in the CSS specification. The used height may further be adjusted by the container's
     <span class="property">'flex-align'</span> property in a horizontally
     oriented box, or the flexibility in a vertically oriented box.
  </p><p>

     Note that it is possible for a horizontally oriented box that the height of a
     flexible child containing an inline descendant will change when the flexibility is
     applied. Similarly, in a vertically oriented box, the height of a child may change
     based on the <span class="property">'flex-align'</span> property of the
     box.
  </p>
	--><hr title="Separator from footer">
			<h2>Changes</h2>
			<h3>Changes from ED 16-June-2011</h3>
			<ul type="disc">
				<li>Intro
				<ul type="circle">
					<li>Added definitions for main axis and 
					cross axis</li>
					<li>Added a pargraph on multiline</li>
				</ul>
				</li>
				<li>&#39;display&#39; property
				<ul type="circle">
					<li>Removed issue for &quot;display-inside&quot; 
					(now ACTION-342)</li>
				</ul>
				</li>
				<li>Flex-item
				<ul type="circle">
					<li>New section, adds detail for flex item 
					fixup</li>
					<li>Removed issue for &quot;other ignored properties&quot;</li>
					<li>Added issue on applicability of 
					&#39;vertical-align&#39;</li>
				</ul>
				</li>
				<li>&#39;flex-flow&#39; property
				<ul type="circle">
					<li>Renamed (was &#39;flex-direction&#39;)</li>
					<li>Values as in &quot;option 8&quot;
					<a href="http://wiki.csswg.org/spec/css3-flexbox#issue-2">
					http://wiki.csswg.org/spec/css3-flexbox#issue-2</a>
      </li>
					<li>Computed value: specified value
					(was lr/rl/tb/bt)</li>
					<li>Prose describing how the pair of 
					values work</li>
				</ul>
				</li>
				<li>&#39;flex-order&#39;
				<ul type="circle">
					<li>Removed &quot;flex-order vs. flex-index&quot; 
					issue. There is an issue at Wiki to finalize that, proposal 
					to not change:
					<a href="http://wiki.csswg.org/spec/css3-flexbox#issue-8">
					http://wiki.csswg.org/spec/css3-flexbox#issue-8</a></li>
				</ul>
				</li>
				<li>Flexibility
				<ul type="circle">
					<li>Removed &#39;fr&#39; unit</li>
					<li>Changed default/unspecified values to 
					&#39;initial&#39;, removed references to specifically &#39;width&#39; and &#39;height&#39;. No changes in what it applies to, but this way it 
					is more general, in case it does need to apply to something 
					else (for example to be part of grid rows/columns 
					declarations)</li>
					<li>Added a paragraph allowing (but not 
					requiring) accepting unitless non-zero length in quirks 
					mode, only when three values are specified.</li>
				</ul>
				</li>
				<li>Flexible margins
				<ul type="circle">
					<li>Added issue 15: &quot;margin:auto&quot;&nbsp;
					as flex of 1 is not as powerful as &quot;margin:flex(2, 
					20, 5)&quot;. Is it enough?<li>A good use case 
					would help (issue 16)</li>
				</ul>
				</li>
				<li>&#39;flex-align&#39; property
				<ul type="circle">
					<li>Adapted most of the definition of 
					&#39;flex-align&#39; from 2009 spec</li>
					<li>Note difference from 2009 spec remains 
					 &#39;flex-align&#39; applies to flexbox items, while &#39;box-align&#39; 
					of the old spec applied to flexbox.</li>
					<li>Added definition for where is &#39;before&#39; 
					and where is &#39;after&#39;</li>
					<li>Open issue 14 for before/after to 
					validate the definition.</li>
					<li>Included definition of how flexbox 
					cross-axis size is determined in case of baseline-aligned 
					children or mixed.</li>
					<li>Note: the core alignment algorithm 
					copied from 2009 spec describes how auto margins work 
					together with &#39;flex-align&#39;. That algrithm is copied 
					unchanged, proposed to adopt. It</li>
					<li>&nbsp;gives priority to margins over align 
					(if I am reading it correctly): &quot;flex-align:before; 
					margin-top:auto&quot; will end up being bottom-aligned in a 
					horizontal flexbox.</li>
				</ul>
				</li>
				<li>Multiline flexbox
				<ul type="circle">
					<li>Copied the section on multiline 
					flexbox from 2009 spec, adapted to fit into the current 
					draft</li>
				</ul>
				</li>
				<li>&#39;Flex-line-pack&#39; property</li>
				<li>Other
				<ul type="circle">
					<li>Replaced &quot;measure axis&quot; with &quot;main axis&quot;</li>
					<li>Removed commented out intro draft</li>
				</ul>
				</li>
			</ul>

			<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>
			<p>[This section will contain further acknowledgments.]</p>
			<p>Thanks for feedback from James Elmore and Shinichiro Hamaji.</p>
			<h2 class="no-num" id="references">References</h2>
			<h3 class="no-num" id="normative">Normative references</h3>
  <!--normative-->

  	  	  <h2 class="no-num" id="index">Index</h2>
  <!--index-->

  	  	  <h2 id="property" class="no-num">Property index</h2>
  	  </dd>
  <!--properties-->

  <!-- Keep this comment at the end of the file
    Local variables:
    mode: sgml
    sgml-declaration:"~/SGML/HTML4.decl"
    sgml-default-doctype-name:"html"
    sgml-minimize-attributes:t
    sgml-nofill-elements:("pre" "style" "br")
    sgml-live-element-indicator:t
    End:
    -->
		</dl>
</body></html>
