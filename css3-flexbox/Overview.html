<!DOCTYPE html>

<html lang=en>
 <head><meta content="text/html; charset=utf-8" http-equiv=Content-Type>

  <title>CSS Flexible Box Layout Module</title>
  <link href="http://dev.w3.org/csswg/css-module/default.css" rel=stylesheet
  type="text/css">
  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel=stylesheet
  type="text/css">

 <body>
  <div class=head> <!--begin-logo-->
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="http://www.w3.org/Icons/w3c_home" width=72></a> <!--end-logo-->

   <h1 id=head-box-flexible>CSS Flexible Box Layout Module</h1>

   <h2 class="no-num no-toc" id=w3c-working>Editor's Draft, 20 August 2011</h2>

   <dl>
    <dt>This version:

    <dd><!-- <a href="http://www.w3.org/TR/2011/WD-css3-flexbox-20110820/">http://www.w3.org/TR/2011/WD-css3-flexbox-20110820/</a></dd> -->
     <a
     href="http://dev.w3.org/csswg/css3-flexbox/">http://dev.w3.org/csswg/css3-flexbox/</a>
     

    <dt>Latest version:

    <dd><a
     href="http://www.w3.org/TR/css3-flexbox/">http://www.w3.org/TR/css3-flexbox/</a>
     

    <dt>Previous version:

    <dd><a
     href="http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/">http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/</a>
     

    <dt>Editors:

    <dd><a href="http://www.xanthir.com/contact">Tab Atkins Jr.</a>, Google
     Inc.

    <dd>Alex Mogilevsky, Microsoft Corporation, <a
     href="mailto:alexmog@microsoft.com">alexmog@microsoft.com</a>

    <dd>L. David Baron, Mozilla Corporation, <a
     href="mailto:dbaron@dbaron.org">dbaron@dbaron.org</a>

    <dt>Authors and former editors:

    <dd>Neil Deakin, Mozilla Corporation, <a
     href="mailto:enndeakin@gmail.com">enndeakin@gmail.com</a>

    <dd>Ian Hickson, formerly of Opera Software, <a
     href="mailto:ian@hixie.ch">ian@hixie.ch</a>

    <dd>David Hyatt, formerly of Netscape Corporation, <a
     href="mailto:hyatt@apple.com">hyatt@apple.com</a>
   </dl>
   <!--begin-copyright-->
   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"
    rel=license>Copyright</a> &copy; 2011 <a
    href="http://www.w3.org/"><acronym title="World Wide Web
    Consortium">W3C</acronym></a><sup>&reg;</sup> (<a
    href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute
    of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym
    title="European Research Consortium for Informatics and
    Mathematics">ERCIM</acronym></a>, <a
    href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
   <!--end-copyright-->
   <hr title="Separator for header">
  </div>

  <h2 class="no-num no-toc" id=abstract> Abstract</h2>

  <p>The specification describes a CSS box model optimized for user interface
   design. In flexbox layout model, the children of a box are laid out either
   horizontally or vertically, and unused space can be assigned to a
   particular child or distributed among the children by assignment of "flex"
   to the children that should expand. Nesting of these boxes (horizontal
   inside vertical, or vertical inside horizontal) can be used to build
   layouts in two dimensions.

  <h2 class="no-num no-toc" id=status>Status of this document</h2>
  <!--begin-status-->

  <p>This is a public copy of the editors' draft. It is provided for
   discussion only and may change at any moment. Its publication here does
   not imply endorsement of its contents by W3C. Don't cite this document
   other than as work in progress.

  <p>The (<a
   href="http://lists.w3.org/Archives/Public/www-style/">archived</a>) public
   mailing list <a
   href="mailto:www-style@w3.org?Subject=%5Bcss3-flexbox%5D%20PUT%20SUBJECT%20HERE">
   www-style@w3.org</a> (see <a
   href="http://www.w3.org/Mail/Request">instructions</a>) is preferred for
   discussion of this specification. When sending e-mail, please put the text
   &#8220;css3-flexbox&#8221; in the subject, preferably like this:
   &#8220;[<!---->css3-flexbox<!---->] <em>&hellip;summary of
   comment&hellip;</em>&#8221;

  <p>This document was produced by the <a href="/Style/CSS/members">CSS
   Working Group</a> (part of the <a href="/Style/">Style Activity</a>).

  <p>This document was produced by a group operating under the <a
   href="/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent
   Policy</a>. W3C maintains a <a href="/2004/01/pp-impl/32061/status"
   rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a
   href="/Consortium/Patent-Policy-20040205/#def-essential">Essential
   Claim(s)</a> must disclose the information in accordance with <a
   href="/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the
   W3C Patent Policy</a>.</p>
  <!--end-status-->

  <h2 class="no-num no-toc" id=table>Table of contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#intro"><span class=secno>1. </span> Introduction</a>

   <li><a href="#box-model"><span class=secno>2. </span> The Flexbox Box
    Model</a>
    <ul class=toc>
     <li><a href="#display-flexbox"><span class=secno>2.1. </span> New values
      for &lsquo;<code class=property>display</code>&rsquo; property</a>

     <li><a href="#flex-items"><span class=secno>2.2. </span> Flexbox
      Items</a>
    </ul>

   <li><a href="#flexbox-flow-direction-the-flex-flow-pro"><span
    class=secno>3. </span> Flexbox Flow Direction: the &lsquo;<code
    class=property>flex-flow</code>&rsquo; property</a>

   <li><a href="#flex-order"><span class=secno>4. </span> Display Order: the
    &lsquo;<code class=property>flex-order</code>&rsquo; property</a>

   <li><a href="#flexibility"><span class=secno>5. </span> Flexibility</a>
    <ul class=toc>
     <li><a href="#resolving-flexible-lengths"><span class=secno>5.1. </span>
      Resolving Flexible Lengths</a>

     <li><a href="#flex-function"><span class=secno>5.2. </span> The
      &lsquo;<code class=css>flex()</code>&rsquo; function</a>

     <li><a href="#flexible-margins"><span class=secno>5.3. </span> Flexible
      margins and paddings</a>
    </ul>

   <li><a href="#flex-pack"><span class=secno>6. </span> The &lsquo;<code
    class=property>flex-pack</code>&rsquo; property</a>

   <li><a href="#flex-align"><span class=secno>7. </span> The &lsquo;<code
    class=property>flex-align</code>&rsquo; property</a>

   <li><a href="#multiline"><span class=secno>8. </span> Multi-line
    flexbox</a>
    <ul class=toc>
     <li><a href="#flex-line-pack"><span class=secno>8.1. </span>
      &lsquo;<code class=property>flex-line-pack</code>&rsquo; property</a>
    </ul>

   <li><a href="#free-space-algorithm"><span class=secno>9. </span> Free
    Space Calculation and Distribution</a>
    <ul class=toc>
     <li><a href="#free-space-algorithm-initial"><span class=secno>9.1.
      </span> Initial Computation</a>

     <li><a href="#first-distribution-round"><span class=secno>9.2. </span>
      First Distribution Round</a>

     <li><a href="#second-distribution-round"><span class=secno>9.3. </span>
      Second Distribution Round</a>

     <li><a href="#intermediate-computation"><span class=secno>9.4. </span>
      Intermediate Computation</a>

     <li><a href="#third-distribution-round"><span class=secno>9.5. </span>
      Third Distribution Round</a>

     <li><a href="#free-space-allocation-algorithm"><span class=secno>9.6.
      </span> Free Space Allocation Algorithm</a>
    </ul>

   <li><a href="#pagination"><span class=secno>10. </span> Page breaks in
    flexbox</a>

   <li><a href="#layout-interface"><span class=secno>11. </span> Interface
    With Other Layout Algorithms</a>

   <li><a href="#changes"><span class=secno>12. </span>Changes</a>
    <ul class=toc>
     <li><a href="#changes-from-ed-16-june-2011"><span class=secno>12.1.
      </span>Changes from ED 16-June-2011</a>
    </ul>

   <li class=no-num><a href="#acknowledgments">Acknowledgments</a>

   <li class=no-num><a href="#references">References</a>
    <ul class=toc>
     <li class=no-num><a href="#normative">Normative references</a>

     <li class=no-num><a href="#informative">Other references</a>
    </ul>

   <li class=no-num><a href="#property">Property index</a>

   <li class=no-num><a href="#index">Index</a>
  </ul>
  <!--end-toc-->

  <h2 id=intro><span class=secno>1. </span> Introduction</h2>

  <p>CSS 2.1 defined four layout modes &mdash; algorithms which determine the
   size and position of boxes based on their relationships with their sibling
   and ancestor boxes: block layout, designed for laying out documents and
   simple applications; inline layout, designed for laying out text; table
   layout, designed for laying out information in a tabular format; and
   positioned layout, designed for very explicit positioning without much
   regard for other elements in the document. This module introduces a new
   layout mode, flexbox layout, which is designed for laying out more complex
   applications and webpages.

  <p>Flexbox layout is superficially similar to block layout. It lacks many
   of the more complex text or document-formatting properties that can be
   used in block layout, such as &lsquo;<code
   class=property>float</code>&rsquo; and &lsquo;<code
   class=property>columns</code>&rsquo;, but in return it gains more simple
   and powerful tools for aligning its contents in ways that webapps and
   complex web pages often need.

  <p>Flexbox layout operates exclusively on immediate block-level children,
   which are referred to as <dfn id=flexbox-item title="flexbox item|flexbox
   items">flexbox items</dfn>. If a flexbox's direct child is an inline
   element or text, it is wrapped in an anonymous block, as described below,
   which then functions as the <a href="#flexbox-item"><i>flexbox
   item</i></a> instead.

  <p><a href="#flexbox-item"><i>Flexbox items</i></a> can be laid out in any
   direction, can have their order swapped around dynamically, and can "flex"
   their sizes and positions to respond to the available space. If a flexbox
   is <i>multi-line</i>, the flexbox items flow in two dimensions, wrapping
   into separate lines in a fashion similar to how text is wrapped into
   multiple lines. The direction that these lines are stacked in can also be
   controlled explicitly, relative either to the current writing mode
   (logical directions) or explicit physical directions.

  <h2 id=box-model><span class=secno>2. </span> The Flexbox Box Model</h2>

  <p>In flexbox, the term <dfn id=main-axis>main axis</dfn> refers to the
   primary direction of flow of <a href="#flexbox-item"><i>flexbox
   items</i></a>, the direction in which items are added to layout in a
   single line flexbox, or in one line of multiline flexbox. Main axis
   direction determines logical &lsquo;<a href="#flex-pack-start"><code
   class=property>start</code></a>&rsquo; and &lsquo;<a
   href="#flex-pack-end"><code class=property>end</code></a>&rsquo;.

  <p>The term <dfn id=cross-axis>cross axis</dfn> refers to the direction
   orthogonal to main axis. Direction of defines logical &lsquo;<a
   href="#flex-line-pack-before"><code
   class=property>before</code></a>&rsquo; and &lsquo;<a
   href="#flex-line-pack-after"><code class=property>after</code></a>&rsquo;
   for alignment and direction of wrapping when wrapping is enabled.

  <p>Similar to other layout modes such as table layout, a flexbox acts like
   a block when placed into other layout modes. Inline flexboxes can also be
   declared, which act like inline-blocks.

  <div class=example>
   <p>For example:</p>

   <pre>
&lt;p style="width: 400px; display: flexbox;">
	&lt;button style="width: 200px;">Child 1&lt;/button>
	&lt;button style="width: 100px;">Child 2&lt;/button>
&lt;/p>
</pre>

   <p>In this example, the first button is 200 pixels wide and the second
    button is 100 pixels wide. As the flexbox is 400 pixels wide, there is
    extra space left over which is placed after the two buttons but inside
    the flexbox. The placement of this extra space may be modified using the
    various flex properties described in the next sections. Neither the
    height of the buttons nor the height of the flexbox are specified, so the
    height is computed intrinsically from the content. In this case, the
    buttons will be the height needed to display the label and button border,
    and the flexbox will also be this height plus any margins around the
    buttons.</p>
  </div>

  <p class=issue>this needs a picture

  <h3 id=display-flexbox><span class=secno>2.1. </span> New values for
   &lsquo;<code class=property>display</code>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td>display

    <tr>
     <th>New value:

     <td>flexbox | inline-flexbox
  </table>

  <p>You can declare that an element is a flexbox, and thus should use
   flexbox layout, by setting the &lsquo;<code
   class=property>display</code>&rsquo; property on the element to the value
   &lsquo;<code class=property>flexbox</code>&rsquo; or &lsquo;<code
   class=property>inline-flexbox</code>&rsquo;.

  <p>Flexbox establishes a new block formatting context for its content.

  <h3 id=flex-items><span class=secno>2.2. </span> Flexbox Items</h3>

  <p>Flexbox layout algorithm operates on <a href="#flexbox-item"><i>flexbox
   items</i></a>, which are boxes that satisfy at least one of the following
   criteria:

  <ol>
   <li>Immediate block-level children of flexbox

   <li>Atomic inline-level children of flexbox

   <li>Contiguous run of non-replaced inline children, wrapped into an
    anonymous block
  </ol>

  <div class=example>
   <p>Examples of flexbox items:</p>

   <pre>
&lt;div style="display:flexbox">

    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item1">block&lt;/div>
    
    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item2" style="display:table">table&lt;/div>
    
    &lt;!-- flexbox item: anonymous table wrapped around table-cell -->
    &lt;div id="item3" style="display:table-cell">table-cell&lt;/div> 

    &lt;!-- flexbox item: anonymous block around inline content -->
    anonymous item 4                                            

    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item5">block&lt;/div>                                 

    &lt;!-- flexbox item: anonymous block around inline content -->
    anonymous item 6.1
    &lt;span id="item6.1">
        text 6.2
        &lt;div id="not-an-item6.3">block&lt;/div>
        text 6.4
    &lt;/span>

    &lt;!-- flexbox item: block-level replaced element -->
    &lt;img id="item7">

    &lt;!-- flexbox item: inline-level replaced element -->
    &lt;img id="item7" style="display:inline">

    &lt;!-- flexbox item: inline-level replaced element -->
    &lt;button id="item8">button&lt;/button>

    &lt;!-- flexbox item: inline-table -->
    &lt;div id="item9" style="display:inline-table">table&lt;/div>     
&lt;/div></pre>

   <p>Notice that block element "not-an-item6.3" is not a separate flexbox
    item, because it is contained inside an inline element which is being
    wrapped into an anonymous flex item.</p>
  </div>

  <p>Out-of-flow elements like absolutely positioned elements leave behind a
   &lsquo;<code class=property>placeholder</code>&rsquo; inline element in
   their original position in the document

  <p class=issue>This needs to change. Placeholder is not fully hypothetical
   in this case, that element or line is detectable in "flex-pack:justify".
   TODO: define the "auto" position without a placeholder.

  <p>Setting &lsquo;<code class=css>display:flexbox</code>&rsquo; on an
   element forces it to use a new layout algorithm, and so some properties
   that were designed with the assumption of block layout don't make sense in
   a flexbox context. In particular:

  <ul>
   <li>all of the &lsquo;<code class=css>column-*</code>&rsquo; properties in
    the Multicol module compute to their initial values on a flexbox
    (&lsquo;<code class=property>break-before</code>&rsquo;, &lsquo;<code
    class=property>break-inside</code>&rsquo;, and &lsquo;<code
    class=property>break-after</code>&rsquo; are still valid on a flexbox).

   <li>&lsquo;<code class=property>float</code>&rsquo; and &lsquo;<code
    class=property>clear</code>&rsquo; compute to their initial values on a
    flexbox item

   <li>&lsquo;<code class=property>vertical-align</code>&rsquo; has no effect
    on a flexbox item
  </ul>

  <p class=issue>It has been proposed that vertical-align property applies to
   flex items (simliar to table cells). Decide if it makes sense, or if it
   should instead apply broader (to any blocks).

  <p>A flexbox item creates a new BFC. The margins of a flexbox item do not
   collapse with any other margin. Flexboxes "shrinkwrap" their contents by
   default (when their &lsquo;<code class=property>width</code>&rsquo; or
   &lsquo;<code class=property>height</code>&rsquo; properties are
   &lsquo;<code class=css>auto</code>&rsquo;), similar to tables or floats.

  <h2 id=flexbox-flow-direction-the-flex-flow-pro><span class=secno>3.
   </span> Flexbox Flow Direction: the &lsquo;<a href="#flex-flow"><code
   class=property>flex-flow</code></a>&rsquo; property</h2>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flex-flow>flex-flow</dfn>

    <tr>
     <th>Values:

     <td>
      <pre>  [ row | row-reverse | column | column-reverse ]
  [ wrap | wrap-reverse ]?
|
  [ horizontal | horizontal-reverse | horizontal-ltr | horizontal-rtl ] 
  [ wrap | wrap-reverse | wrap-down | wrap-up ]?
|
  [ vertical | vertical-reverse | vertical-ttb | vertical-btt ] 
  [ wrap | wrap-reverse | wrap-left | wrap-right ]?</pre>

    <tr>
     <th>Initial:

     <td>row

    <tr>
     <th>Applies To:

     <td>flexboxes

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed Value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>The &lsquo;<code class=property>flexbox-flow</code>&rsquo; property
   specifies how <a href="#flexbox-item"><i>flexbox items</i></a> are placed
   in the flexbox. The value consists of one or two keywords: the first sets
   the orientation and direction of the flexbox's <a
   href="#main-axis"><i>main axis</i></a>, while the second, if specified,
   marks the flexbox as being multiline and sets the direction in which new
   lines are stacked.

  <p>The main directions affect how <a href="#flexbox-item"><i>flexbox
   items</i></a> are arranged, and how they respond to the &lsquo;<a
   href="#flex-pack0"><code class=property>flex-pack</code></a>&rsquo;
   property. They can be set with either logical directions (relative to the
   writing mode) or physical directions:

  <dl>
   <dt>Logical Directions

   <dd>
    <dl>
     <dt><dfn id=flex-flow-row>row</dfn>

     <dd>The flexbox's <a href="#main-axis"><i>main axis</i></a> has the same
      orientation as the inline axis of the current writing mode (the
      direction that text is laid out in). The <i>main-start</i> and
      <i>main-end</i> directions are equivalent to the "start" and "end"
      directions, respectively, of the current writing mode.

     <dt><dfn id=flex-flow-row-reverse>row-reverse</dfn>

     <dd>Same as <a href="#flex-flow-row"><i>row</i></a>, except the
      <i>main-start</i> and <i>main-end</i> directions are swapped.

     <dt><dfn id=flex-flow-column>column</dfn>

     <dd>The flexbox's <a href="#main-axis"><i>main axis</i></a> has the same
      orientation as the block axis of the current writing mode (the
      direction that blocks are laid out in). The <i>main-start</i> and
      <i>main-end</i> directions are equivalent to the "before" and "after"
      directions, respectively, of the current writing mode.

     <dt><dfn id=flex-flow-column-reverse>column-reverse</dfn>

     <dd>Same as <a href="#flex-flow-column"><i>column</i></a>, except the
      <i>main-start</i> and <i>main-end</i> directions are swapped.
    </dl>

   <dt>Physical Directions

   <dd>
    <dl>
     <dt><dfn id=flex-flow-horizontal>horizontal</dfn>

     <dd>The flexbox's <a href="#main-axis"><i>main axis</i></a> is
      horizontal. The <i>main-start</i> direction is equivalent to either the
      "start" or "before" direction of the current writing mode, whichever is
      vertical, and the <i>main-end</i> direction is the opposite direction
      of <i>main-start</i>.

     <dt><dfn id=flex-flow-horizontal-reverse>horizontal-reverse</dfn>

     <dd>Same as <a href="#flex-flow-horizontal"><i>horizontal</i></a>,
      except the <i>main-start</i> and <i>main-end</i> directions are
      swapped.

     <dt><dfn id=flex-flow-horizontal-ltr>horizontal-ltr</dfn>

     <dd>Same as <a href="#flex-flow-horizontal"><i>horizontal</i></a>,
      except the <i>main-start</i> direction is to the left and the
      <i>main-end</i> direction is to the right.

     <dt><dfn id=flex-flow-horizontal-rtl>horizontal-rtl</dfn>

     <dd>Same as <a href="#flex-flow-horizontal"><i>horizontal</i></a>,
      except the <i>main-start</i> direction is to the right and the
      <i>main-end</i> direction is to the left.

     <dt><dfn id=flex-flow-vertical>vertical</dfn>

     <dd>The flexbox's <a href="#main-axis"><i>main axis</i></a> is vertical.
      The <i>main-start</i> direction is equivalent to either the "start" or
      "before" direction of the current writing mode, whichever is
      horizontal, and the <i>main-end</i> direction is the opposite direction
      of <i>main-start</i>.

     <dt><dfn id=flex-flow-vertical-reverse>vertical-reverse</dfn>

     <dd>Same as <a href="#flex-flow-vertical"><i>vertical</i></a>, except
      the <i>main-start</i> and <i>main-end</i> directions are swapped.

     <dt><dfn id=flex-flow-vertical-ttb>vertical-ttb</dfn>

     <dd>Same as <a href="#flex-flow-vertical"><i>vertical</i></a>, except
      the <i>main-start</i> direction is upwards and the <i>main-end</i>
      direction is downwards.

     <dt><dfn id=flex-flow-row-vertical-btt>vertical-btt</dfn>

     <dd>Same as <a href="#flex-flow-vertical"><i>vertical</i></a>, except
      the <i>main-start</i> direction is downwards and the <i>main-end</i>
      direction is upwards.
    </dl>
  </dl>

  <p class=note>Usually, the logical keywords are sufficient, which is why
   their names are purposely short. For example, if the page's writing mode
   is lr-tb, like it is when the primary language is English, the &lsquo;<a
   href="#flex-flow-row"><code class=css>row</code></a>&rsquo; value makes
   the flexbox horizontal and going from left to right, while the &lsquo;<a
   href="#flex-flow-column"><code class=css>column</code></a>&rsquo; value
   makes the flexbox vertical and going from top to bottom. If this were
   specified as part of a page template, and the page as a whole was switched
   to a tb-rl writing-mode like what Japanese uses, the flexboxes would
   automatically shift to vertical and horizontal, respectively, which is
   often what is desired.

  <p>The <a href="#cross-axis"><i>cross axis</i></a> is always perpendicular
   to the <a href="#main-axis"><i>main axis</i></a>. The second keyword, or
   the lack of it, sets the cross directions (<i>cross-start</i> and
   <i>cross-end</i>), and dictates whether the flexbox is single-line or
   multi-line. The cross directions affect how individual <a
   href="#flexbox-item"><i>flexbox items</i></a> respond to the &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   property, and the direction in which multiple lines are stacked and
   aligned by the &lsquo;<a href="#propdef-flex-line-pack"><code
   class=property>flex-line-pack</code></a>&rsquo; property.

  <p>If the second keyword is omitted, the flexbox is single-line, the
   <i>cross-start</i> direction is equivalent to either the "start" or
   "before" direction of the current writing mode, whichever is in the
   <i>cross-axis</i>, and the <i>cross-end</i> direction is the opposite
   direction of <i>cross-start</i>.

  <p>If the second keyword is provided, the flexbox is <a
   href="#multiline">multi-line</a>. The <i>cross-start</i> and
   <i>cross-end</i> directions are set as follows:

  <dl>
   <dt><dfn id=flex-flow-wrap>wrap</dfn>

   <dd>The <i>cross-start</i> direction is equivalent to either the "start"
    or "before" direction of the current writing mode, whichever is in the
    <i>cross-axis</i>, and the <i>cross-end</i> direction is the opposite
    direction of <i>cross-start</i>.

   <dt><dfn id=flex-flow-wrap-reverse>wrap-reverse</dfn>

   <dd>Same as <a href="#flex-flow-wrap"><i>wrap</i></a>, except the
    <i>cross-start</i> and <i>cross-end</i> directions are swapped.

   <dt><dfn id=flex-flow-wrap-up>wrap-up</dfn>

   <dd>The <i>cross-start</i> direction is downwards and the <i>cross-end</i>
    direction is upwards.

   <dt><dfn id=flex-flow-wrap-right>wrap-right</dfn>

   <dd>The <i>cross-start</i> direction is to the left and the
    <i>cross-end</i> direction is to the right.

   <dt><dfn id=flex-flow-wrap-down>wrap-down</dfn>

   <dd>The <i>cross-start</i> direction is upwards and the <i>cross-end</i>
    direction is downwards.

   <dt><dfn id=flex-flow-wrap-left>wrap-left</dfn>

   <dd>The <i>cross-start</i> direction is to the right and the
    <i>cross-end</i> direction is to the left.
  </dl>

  <p class=note>Note that not all combinations of first and second keyword
   are allowed by the property's syntax, as they don't all make sense. For
   example, &lsquo;<code class=css>flex-flow: horizontal
   wrap-right</code>&rsquo; is an invalid declaration.

  <div class=example>
   <p>Some examples of valid flows:</p>

   <pre>
div { flex-flow:row }                      /* initial value. Main axis is inline,
                                              no wrap. */
div { flex-flow:horizontal-ltr wrap-down } /* main axis is horizontal, flow left-to-right, 
                                              wrap down */
div { writing-mode:tb-rl;                  /* main axis is vertical top-to-bottom (as line direction),
      flex-flow:vertical wrap-reverse }    /* cross axis is left-to-right (opposite to block direction) */</pre>
  </div>

  <h2 id=flex-order><span class=secno>4. </span> Display Order: the &lsquo;<a
   href="#flex-order0"><code class=property>flex-order</code></a>&rsquo;
   property</h2>

  <p><a href="#flexbox-item"><i>flexbox items</i></a> are, by default,
   displayed and laid out in the same order as they appear in the source
   document. The &lsquo;<a href="#flex-order0"><code
   class=property>flex-order</code></a>&rsquo; property may be used to change
   this ordering.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flex-order0>flex-order</dfn>

    <tr>
     <th>Value:

     <td>&lt;integer>

    <tr>
     <th>Initial:

     <td>1

    <tr>
     <th>Applies to:

     <td><a href="#flexbox-item"><i>flexbox items</i></a>

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>The &lsquo;<a href="#flex-order0"><code
   class=property>flex-order</code></a>&rsquo; property assigns <a
   href="#flexbox-item"><i>flexbox items</i></a> to ordinal groups.

  <p>Ordinal groups control the order in which <a
   href="#flexbox-item"><i>flexbox items</i></a> appear. A flexbox will lay
   out its content starting from the lowest numbered ordinal group and going
   up. Items with the same ordinal group are laid out in the order they
   appear in the source document.

  <div class=example>
   <p>This example shows how ordinal groups might be used.</p>

   <pre><code>	div { display: flexbox; }
#item1 { flex-order: 2; }
#item3 { flex-order: 2; }
#item4 { flex-order: 1; }

&lt;div>
	&lt;div id="item1">item1&lt;/div>
	&lt;div id="item2">item2&lt;/div>
	&lt;div id="item3">item3&lt;/div>
	&lt;div id="item4">item4&lt;/div>
&lt;/div></code></pre>

   <p>The first ordinal group, 1, contains item2 and item4. As item2 does not
    specify an ordinal group, it will default to 1. The elements will be
    displayed in document order, so item2 will be displayed before item4. The
    second ordinal group, 2, contains the remaining two items. The resulting
    display order will be:</p>

   <pre><code>item2 item4 item1 item3</code></pre>
  </div>

  <h2 id=flexibility><span class=secno>5. </span> Flexibility</h2>

  <p>The defining aspect of flexbox layout is the ability to make various
   lengths of the <a href="#flexbox-item"><i>flexbox items</i></a> flexible.
   The &lsquo;<code class=property>width</code>&rsquo;, &lsquo;<code
   class=property>height</code>&rsquo;, &lsquo;<code
   class=property>padding</code>&rsquo;, and &lsquo;<code
   class=property>margin</code>&rsquo; properties of a <a
   href="#flexbox-item"><i>flexbox item</i></a> can all be made flexible.
   Paddings and margins are made flexible by setting their value to
   &lsquo;<code class=css>auto</code>&rsquo;, while the width and height of a
   box can be controlled more precisely with the &lsquo;<code
   class=css>flex()</code>&rsquo; function, defined below.

  <div class=example>
   <p class=issue>TODO: Examples!</p>
  </div>

  <h3 id=resolving-flexible-lengths><span class=secno>5.1. </span> Resolving
   Flexible Lengths</h3>

  <p>Flexbox layout resolves a <i>flexible length</i> into a definite length
   by first collecting all the lengths, flexible or inflexible, that will
   share some space. For example, for a horizontal flexbox, the lengths of
   the left and right margins, left and right borders, left and right
   paddings, and widths of all <a href="#flexbox-item"><i>flexbox
   items</i></a> share the width of the flexbox itself. Conversely, each <a
   href="#flexbox-item"><i title="flexbox item">flexbox item's</i></a>
   vertical margins, borders, padding, and height individually share the
   height of the flexbox.

  <div class=figure>
   <p class="caption issue">TODO: Diagram showing the relevant lengths in
    each axis.</p>
  </div>

  <p>Flexbox layout then sums the <dfn id=pre-flex-size>pre-flex size</dfn>
   of the lengths in each set. The <a href="#pre-flex-size"><i>pre-flex
   size</i></a> of an inflexible length is just the length itself. The <a
   href="#pre-flex-size"><i>pre-flex size</i></a> of a flexible length is its
   <i>preferred size</i>. If the sum of all the <a href="#pre-flex-size"><i
   title="pre-flex size">pre-flex sizes</i></a> is less than the available
   width/height of the flexbox, then the difference is split up among all the
   <i title="flexible length">flexible lengths</i> with <dfn
   id=positive-flexibility>positive flexibility</dfn>, with the space divvied
   up proportionally to the flexibility of each length. If the sum is greater
   than the available width/height, then all the <i title="flexible
   length">flexible lengths</i> with <dfn id=negative-flexibility>negative
   flexibility</dfn> shrink in proportion to their flexibility to try and
   make the sum equal the available width/height.

  <p>The &lsquo;<a href="#flex-pack0"><code
   class=property>flex-pack</code></a>&rsquo; and &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   properties offer additional options for free-space distribution. The
   precise details of how free space is determined and assigned to flexible
   lengths is detailed in a later chapter.

  <h3 id=flex-function><span class=secno>5.2. </span> The &lsquo;<code
   class=css>flex()</code>&rsquo; function</h3>

  <p>The &lsquo;<code class=css>flex()</code>&rsquo; function is used to
   specify the parameters of a <i>flexible length</i>: the <a
   href="#positive-flexibility"><i title="positive
   flexibility">positive</i></a> and <a
   href="#negative-flexibility"><i>negative flexibility</i></a>, and the
   <i>preferred size</i>. The syntax of the &lsquo;<code
   class=css>flex()</code>&rsquo; function is roughly (see following prose
   for a precise description):

  <pre
   class=prod>flex( [ <a href="#positive-flexibility"><i title="positive flexibility">&lt;pos-flex></i></a> || <!--
	--><a href="#negative-flexibility"><i title="negative flexibility">&lt;neg-flex></i></a> || <!--
	--><i title="preferred size">&lt;preferred-size></i> ] )</pre>

  <p>Applicable to &lsquo;<code class=property>width</code>&rsquo; and
   &lsquo;<code class=property>height</code>&rsquo;

  <p class=note>In the future this may be applicable to margin and padding

  <dl>
   <dt>If the &lsquo;<code class=css>flex()</code>&rsquo; function contains a
    single value:

   <dd>
    <ul>
     <li>If the value is a non-negative number, the <a
      href="#positive-flexibility"><i>positive flexibility</i></a> is set to
      that value, the <a href="#negative-flexibility"><i>negative
      flexibility</i></a> is set to &lsquo;<code class=css>0</code>&rsquo;,
      and the <i>preferred size</i> is set to the initial value of the
      property (&lsquo;<code class=property>auto</code>&rsquo; for width and
      height).

     <li>Otherwise, if the value is a &lt;length>, a &lt;percentage>, or a
      valid keyword, the <i>preferred size</i> is set to that value, the <a
      href="#positive-flexibility"><i>positive flexibility</i></a> and the <a
      href="#negative-flexibility"><i>negative flexibility</i></a> are set to
      initial value (zero)

     <li>Otherwise, the &lsquo;<code class=css>flex()</code>&rsquo; function
      is invalid.
    </ul>

   <dt>If the &lsquo;<code class=css>flex()</code>&rsquo; function contains
    two values:

   <dd>
    <ul>
     <li>If both values are non-negative numbers, the <a
      href="#positive-flexibility"><i>positive flexibility</i></a> is set to
      the first value, the <a href="#negative-flexibility"><i>negative
      flexibility</i></a> is set to the second value, and the <i>preferred
      size</i> is set to its initial value.

     <li>Otherwise, if one value is a non-negative number and the other is a
      &lt;length>, a &lt;percentage>, or a valid keyword, the <a
      href="#positive-flexibility"><i>positive flexibility</i></a> is set to
      the number, the <a href="#negative-flexibility"><i>negative
      flexibility</i></a> is set to &lsquo;<code class=css>0</code>&rsquo;,
      and the <i>preferred size</i> is set to the other value.

     <li>Otherwise, the &lsquo;<code class=css>flex()</code>&rsquo; function
      is invalid.
    </ul>

   <dt>If the &lsquo;<code class=css>flex()</code>&rsquo; function contains
    three values:

   <dd>
    <ul>
     <li>If the first two values are non-negative numbers and the third value
      is &lsquo;<code class=css>0</code>&rsquo;, the <a
      href="#positive-flexibility"><i>positive flexibility</i></a> is set to
      the first value, the <a href="#negative-flexibility"><i>negative
      flexibility</i></a> is set to the second value, and the <i>preferred
      size</i> is set to &lsquo;<code class=css>0px</code>&rsquo;.

     <li>Otherwise, If two of the values are non-negative numbers, and the
      other is a &lt;length> (with a unit suffix), a &lt;percentage>, or a
      valid keyword, the <a href="#positive-flexibility"><i>positive
      flexibility</i></a> is set to the first number, the <a
      href="#negative-flexibility"><i>negative flexibility</i></a> is set to
      the second number, and the <i>preferred size</i> is set to the other
      value.

     <li>Otherwise, the &lsquo;<code class=css>flex()</code>&rsquo; function
      is invalid.
    </ul>
  </dl>

  <dl>
   <dt>If the &lsquo;<code class=css>flex()</code>&rsquo; function contains
    less than one or more than three values:

   <dd>The "flex()" function is invalid.
  </dl>

  <p class=issue>Note change from previous draft: default/unspecified are the
   initial values: still &lsquo;<code class=property>auto</code>&rsquo; for
   width/height, 0 if it is ever applied to margins and padding; 0 for
   positive flexibility (was 1 in previous draft).

  <p class=note>Note that, while &lsquo;<code class=css>0</code>&rsquo;
   &lt;length> is normally allowed to be specified without a unit suffix, in
   flex() function it is ambiguous, as it is also an acceptable value for
   flexibility. All ambiguous cases are resolved with preference to
   flexibility, thus unitless "0" can only be applied to <i>preferred
   size</i> when three vaues are specified and "0" is the last one.

  <p>User agents that allow non-zero length values without unit suffix in
   "quirks mode" may also accept a non-zero positive number as the
   <i>preferred size</i> in pixels when in "quirks mode" and when it is the
   third value in flex() function with three values.

  <h3 id=flexible-margins><span class=secno>5.3. </span> Flexible margins and
   paddings</h3>

  <p>Paddings and margins are made flexible by setting their value to
   &lsquo;<code class=css>auto</code>&rsquo;.

  <p>When margin or padding size on a <a href="#flexbox-item"><i>flexbox
   item</i></a> is set to &lsquo;<code class=css>auto</code>&rsquo; in
   orientation of main axis, that margin or padding is included in flexbox
   layout algorithm with flexibility of 1.

  <p>&lsquo;<code class=css>auto</code>&rsquo; margin can also be used for
   alignment along the <i>cross-axis</i>, see &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   property.

  <p class=issue><a
   href="http://wiki.csswg.org/spec/css3-flexbox#issue-15">(Issue 15)</a>
   Interpretation of &lsquo;<code class=property>auto</code>&rsquo; value for
   margins parallel to <a href="#main-axis"><i>main axis</i></a>appears
   incomplete because flex() doen't apply, and also margin/padding can't have
   min/max values. Flex() could be allowed there, but it would be more
   complicated.

  <p class=issue>TODO: need solid use cases (and illustrations here) for
   flexible margins and paddings.

  <h2 id=flex-pack><span class=secno>6. </span> The &lsquo;<a
   href="#flex-pack0"><code class=property>flex-pack</code></a>&rsquo;
   property</h2>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flex-pack0>flex-pack</dfn>

    <tr>
     <th>Value:

     <td>start | end | center | justify | inherit

    <tr>
     <th>Initial:

     <td>start

    <tr>
     <th>Applies to:

     <td>flexboxes

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed Value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>Between and around the margins of <a href="#flexbox-item"><i>flexbox
   items</i></a> there are additional flexible lengths, called <dfn
   id=packing-space>packing space</dfn>. Packing space can absorb leftover
   free space in a flexbox if there aren't any other <i>flexible length</i>s,
   or if all the <i>flexible length</i>s have reached their maximum size. The
   &lsquo;<a href="#flex-pack0"><code
   class=property>flex-pack</code></a>&rsquo; property defines the
   flexibility of these packing spaces:

  <dl>
   <dt><dfn id=flex-pack-start>start</dfn>

   <dd><a href="#flexbox-item"><i>flexbox items</i></a> are packed toward the
    start of the flexbox. The last packing space (between the margin of the
    last flexbox item and the edge of the flexbox) must absorb all leftover
    free space; all other packing spaces must have a length of &lsquo;<code
    class=css>0</code>&rsquo;.

   <dt><dfn id=flex-pack-end>end</dfn>

   <dd><a href="#flexbox-item"><i>flexbox items</i></a> are packed toward the
    end of the flexbox. The first packing space (between the edge of the
    flexbox and the margin of the first flexbox item) must absorb all
    leftover free space; all other packing spaces must have a length of
    &lsquo;<code class=css>0</code>&rsquo;.

   <dt><dfn id=flex-pack-center>center</dfn>

   <dd><a href="#flexbox-item"><i>flexbox items</i></a> are packed toward the
    center of the flexbox. The first and last packing spaces must equally
    split all leftover free space; all other packing spaces must have a
    length of &lsquo;<code class=css>0</code>&rsquo;.

   <dt><dfn id=flex-pack-justify>justify</dfn>

   <dd><a href="#flexbox-item"><i>flexbox items</i></a> are evenly
    distributed through the flexbox. The first and last packing spaces must
    have a length of &lsquo;<code class=css>0</code>&rsquo;; all other
    packing spaces must equally split all leftover free space.
  </dl>

  <div class=figure>
   <p class=caption><span class=issue>TODO: Provide a diagram showing packing
    spaces.</span></p>
  </div>

  <div class=example>
   <p class=issue>TODO: Examples showing the four values.</p>
  </div>

  <h2 id=flex-align><span class=secno>7. </span> The &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   property</h2>

  <p>Sizing and positioning of <a href="#flexbox-item"><i>flexbox
   items</i></a> along the <a href="#cross-axis"><i>cross axis</i></a> of
   flexbox is controlled by the &lsquo;<a href="#flex-align0"><code
   class=property>flex-align</code></a>&rsquo; property.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flex-align0>flex-align</dfn>

    <tr>
     <th>Value:

     <td>before | after | middle | stretch | baseline

    <tr>
     <th>Initial:

     <td>stretch

    <tr>
     <th>Applies to:

     <td>flexbox items

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed Value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>When the size of the containing box along <a href="#cross-axis"><i>cross
   axis</i></a> is larger than the size of a child, extra space will be
   available. The &lsquo;<a href="#flex-align0"><code
   class=property>flex-align</code></a>&rsquo; property specifies how flexbox
   item is placed along the <a href="#cross-axis"><i>cross axis</i></a>, and
   where the extra space, if any, is positioned.

  <p>The values of this property have the following meanings. See text for
   more specifics as to how children are positioned.

  <dl>
   <dt><dfn id=flex-align-before>before</dfn>

   <dd>The &lsquo;<a href="#flex-line-pack-before"><code
    class=property>before</code></a>&rsquo; edge of the child box along <a
    href="#cross-axis"><i>cross axis</i></a>is aligned with &lsquo;<a
    href="#flex-line-pack-before"><code
    class=property>before</code></a>&rsquo; edge of the flexbox content box.
    See text for explanation of how direction of <a
    href="#cross-axis"><i>cross axis</i></a> is determined.

   <dt><dfn id=flex-align-after>after</dfn>

   <dd>The &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of the child box along <a
    href="#cross-axis"><i>cross axis</i></a>is aligned with &lsquo;<a
    href="#flex-line-pack-after"><code class=property>after</code></a>&rsquo;
    edge of the flexbox content box. See text for explanation of how
    direction of <a href="#cross-axis"><i>cross axis</i></a> is determined.

   <dt><dfn id=flex-align-middle>middle</dfn>

   <dd>Any extra space along the <a href="#cross-axis"><i>cross axis</i></a>
    is divided evenly, with half placed before the child and the other half
    placed after the child.

   <dt><dfn id=flex-align-baseline>baseline</dfn>

   <dd>
    <p>If this child's inline axis is parallel to <a
     href="#main-axis"><i>main axis</i></a> of the flexbox, the baseline of
     the child box is aligned with baselined of all other child boxes that
     meet the same criteria. Baseline of each child box is determined in the
     same way as when it is placed inline (as inline-block, inline-table,
     etc.).</p>

    <p>The children participating in baseline alignment, once aligned on
     their baselines, should then be placed into the box so that the child
     with the earliest extent margin has its &lsquo;<a
     href="#flex-line-pack-before"><code
     class=property>before</code></a>&rsquo; margin edge flush with the
     &lsquo;<a href="#flex-line-pack-before"><code
     class=property>before</code></a>&rsquo; edge of flexbox's content area.
     If the flexbox does not have an &lsquo;<code
     class=css>auto</code>&rsquo; height, overflow will always be on the
     &lsquo;<a href="#flex-line-pack-after"><code
     class=property>after</code></a>&rsquo; edge.

    <p>If the child box <i>inline axis</i> is orthogonal to flexbox <a
     href="#main-axis"><i>main axis</i></a>, then &lsquo;<a
     href="#flex-align-baseline"><code class=css>baseline</code></a>&rsquo;
     acts identically to &lsquo;<a href="#flex-pack-center"><code
     class=css>center</code></a>&rsquo;.</p>

   <dt><dfn id=flex-align-stretch>stretch</dfn>

   <dd>The height of each child is adjusted to that of the containing block.
    However, note the text below.
  </dl>

  <p>Direction of the <a href="#cross-axis"><i>cross axis</i></a> is
   determined as follows:

  <p>In multi-line flexbox, <a href="#cross-axis"><i>cross axis</i></a>
   points in the direction of wrapping (the side where lines are added)

  <p>In single-line flexbox, the direction of <a href="#cross-axis"><i>cross
   axis</i></a> is determined by the computed value of writing mode of the
   flexbox element.

  <ul>
   <li> If flexbox's <a href="#main-axis"><i>main axis</i></a> is parallel to
    inline axis of the writing mode, <a href="#cross-axis"><i>cross
    axis</i></a> points in the direction of block flow.

   <li> If flexbox's <a href="#main-axis"><i>main axis</i></a> is parallel to
    block flow axis of the writing mode, <a href="#cross-axis"><i>cross
    axis</i></a> points in the direction of inline flow
  </ul>

  <p>The following rules should be applied when determining the size of child
   boxes along the <a href="#cross-axis"><i> cross axis</i></a>. Exceptions
   to these rules are noted under each of the possible values of &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   below.

  <p>First, the <a href="#cross-axis"><i>cross axis</i></a> size of content
   box of the flexbox has to be calculated. If computed value of flexbox's
   width or height (whichever is along the <a href="#cross-axis"><i>cross
   axis</i></a>), that value is used. If it is &lsquo;<code
   class=property>auto</code>&rsquo;, the size is determined by flexbox
   items, as follows:

  <ol>
   <li><i>Cross-axis</i> sizes of margin boxes of all children in are checked
    and the biggest is selected.

   <li>If there are any children with baseline alignemnt, biggest ascent
    (including its margin-before) and biggest descent (including its
    margin-after) are found.

   <li>Flexbox's content box size is the size its biggest child or the sum of
    the biggest ascent and biggest descent, whichever is larger.
  </ol>

  <p>All normal flow children of boxes will attempt to satisfy the following
   sizing equation when placed inside vertical boxes if and only if at least
   one of the specified values is auto:

  <p>&lsquo;<code class=property>margin-left</code>&rsquo; + &lsquo;<code
   class=property>border-left-width</code>&rsquo; + &lsquo;<code
   class=property>padding-left</code>&rsquo; + &lsquo;<code
   class=property>width</code>&rsquo; + &lsquo;<code
   class=property>padding-right</code>&rsquo; + &lsquo;<code
   class=property>border-right-width</code>&rsquo; + &lsquo;<code
   class=property>margin-right</code>&rsquo; = width of containing box

  <p>and a similar equation for height when placed inside horizontal boxes:

  <p>&lsquo;<code class=property>margin-top</code>&rsquo; + &lsquo;<code
   class=property>border-top-width</code>&rsquo; + &lsquo;<code
   class=property>padding-top</code>&rsquo; + &lsquo;<code
   class=property>height</code>&rsquo; + &lsquo;<code
   class=property>padding-bottom</code>&rsquo; + &lsquo;<code
   class=property>border-bottom-width</code>&rsquo; + &lsquo;<code
   class=property>margin-bottom</code>&rsquo; = height of containing box

  <p>If all the values in the equation are specified (i.e., if there are no
   auto values), then the equation above does not apply, and the specified
   values should be used. If applying the equation results in a negative
   value for width/height, then that value is set to 0, and those values
   should be used.

  <p>If the value of &lsquo;<a href="#flex-align0"><code
   class=property>flex-align</code></a>&rsquo; is &lsquo;<a
   href="#flex-align-stretch"><code class=css>stretch</code></a>&rsquo;, then
   elements obey the sizing rules specified above. This is the default value.
   If both width/height and one or both margin values are &lsquo;<code
   class=property>auto</code>&rsquo;, the &lsquo;<code
   class=property>auto</code>&rsquo; margins are set to 0 and the equation is
   used to find a value for width/height. Otherwise, if both margins are
   &lsquo;<code class=property>auto</code>&rsquo;, then the equation is
   solved under the additional constraint that the two margins must get the
   same value. If neither the width/height or either margin is auto, then the
   extra space is positioned as if flex-align was &lsquo;<a
   href="#flex-line-pack-before"><code
   class=property>before</code></a>&rsquo;.

  <p>If the value of &lsquo;<a href="#flex-align0"><code
   class=property>flex-align</code></a>&rsquo; is &lsquo;<a
   href="#flex-line-pack-before"><code class=css>before</code></a>&rsquo;,
   &lsquo;<a href="#flex-line-pack-after"><code
   class=css>after</code></a>&rsquo;, &lsquo;<a
   href="#flex-line-pack-middle"><code class=css>middle</code></a>&rsquo;, or
   &lsquo;<a href="#flex-align-baseline"><code
   class=css>baseline</code></a>&rsquo;, and a value of &lsquo;<code
   class=css>auto</code>&rsquo; is specified for width/height, then the
   intrinsic size (or shrink to fit size) of the element should be used. If
   one margin has the value of auto, then the equations above should be used.
   If both margins have a value of auto then the above equations should be
   used, with the space being divided evenly between the two margins. These
   rules are similar to the rules for replaced elements inside blocks.

  <p>If the above would cause the width or height to greater than the
   computed maximum width or height, then the width or height is set to the
   maximum width or height, and the auto margins increased by the extra
   amount left over. If both margins are auto, they should both be increased
   by the same amount. If neither margin is auto, the extra space is placed
   as necessary depending on the flex-align value.

  <p>Once the sizes are computed, the margin boxes of the elements should be
   aligned at the before, middle, baseline or after edge of the box.

  <div class=example>
   <p>A vertical flexbox can be used to emulate the functionality of HTML's
    <code>&lt;center></code> element:</p>

   <pre>&lt;div>
	&lt;span>foo foo foo foo&lt;/span>
	&lt;span>bar bar&lt;br>bar bar&lt;/span>
	&lt;span>foo foo foo foo foo foo foo foo foo foo foo foo&lt;/span>
&lt;/div>
&lt;style>
	div {
		display: flexbox;
		flex-direction: tb;
		width: 200px;
	}
	span {/* /*  */ */
		margin: 0 auto;
	}
&lt;/style></pre>

   <p><img alt="" src="images/basic-vertical-flexbox.png"></p>
  </div>

  <p class=issue>TODO: examples, with pictures

  <p class=issue>TODO: alignment rules should be compatible with
   css3-grid-layout, if possible

  <h2 id=multiline><span class=secno>8. </span> Multi-line flexbox</h2>

  <p>If no &lsquo;<code class=property>wrap-</code>&rsquo; keyword is
   included in &lsquo;<a href="#flex-flow"><code
   class=property>flex-flow</code></a>&rsquo;, flexbox lays out its items in
   a single row or column; any items that don't fit will simply be considered
   overflow.

  <p>Adding any of the &lsquo;<code class=property>wrap-</code>&rsquo;
   keywords to &lsquo;<a href="#flex-flow"><code
   class=property>flex-flow</code></a>&rsquo; enables multi-line mode. Then
   flexbox is allowed to expand to multiple lines (that is, multiple rows or
   columns) in order to accommodate all of its items. Flexbox must attempt to
   fit its items on as few lines as possible by shrinking all items down to
   their minimum widths or heights if necessary.

  <p>If the items still do not fit on a line after being reduced to their
   minimum widths or heights, then items are moved one by one onto a new
   line, until the items remaining on the previous line fit. This process can
   repeat to an arbitrary number of lines. If a line contains only a single
   item that doesn't fit, then the item should stay on that line and overflow
   out of the box. The later lines are placed according to wrap direction
   specified in &lsquo;<a href="#flex-flow"><code
   class=property>flex-flow</code></a>&rsquo;.

  <p>The cross-axis size of a line is the cross-axis size of the largest item
   in that line. No additional space appears between the lines apart from the
   margins on the largest items in each line. For calculating the cross-axis
   size of a line, margins with a computed value of auto should be treated as
   having a value of 0.

  <p>Once the number of lines has been determined, items with non-zero
   flexibility stretch as necessary in an attempt to fill the remaining space
   on the lines. Each line computes flexes independently, so only elements on
   that line are considered when evaluating flex. The packing of elements in
   a line, as specified by the flex-pack property, is also computed
   independently for each line.

  <div class=example>
   <p>This example shows four buttons that do not fit horizontally.</p>

   <pre>&lt;style>
#div1 {
	display: flexbox;
	flex-flow: wrap;
	width: 300px;
}
button {
	width: flex(80px 1.0);
}
&lt;style>

&lt;div id="div1">
	&lt;button id="button1">Elephant&lt;/button>
	&lt;button id="button2">Tiger&lt;/button>
	&lt;button id="button3">Antelope&lt;/button>
	&lt;button id="button4">Wildebeest&lt;/button>
&lt;/div></pre>

   <p>The buttons are shrunk to their minimum widths, in this case 80 pixels.
    This will allow the first three buttons to fit in 240 pixels with 60
    pixels left over of remaining space. Because the box-lines property has a
    specified value of multiple, the fourth button may be moved onto a second
    line.</p>

   <p>Flexibility is applied to each element, separately for each line. The
    first line has 60 pixels of remaining space, so each of the three buttons
    on that line will receive 20 pixels of extra width. The remaining button
    on a line of its own will stretch to the entire width of the containing
    box, or 300 pixels.</p>

   <div style="width:300px; border:medium solid green">
    <button style="width:100px">Elephant</button>

    <button style="width:100px">Tiger</button>

    <button style="width:100px">Antelope</button>

    <button style="width:300px">Wildebeest</button>
   </div>

   <p>If the box was resized, the buttons may rearrange onto different lines
    as necessary. If the style rules in the example above were changed to the
    following:</p>

   <pre>
#div1 {
	display: flexbox;
	flex-flow: wrap;
	flex-pack: center;
	width: 300px;
}
button {
	width: flex(80px 1.0);
	max-width: 90px;
}</pre>

   <p>Now, each of the buttons will only stretch to include an additional 10
    pixels of width, as the maximum width of 90 pixels is only 10 pixels
    larger than the minimum intrinsic width of the buttons. The remaining 30
    pixels of space left over is divided up and placed inside the box outside
    of the buttons, as the value of box-pack is center. The fourth button
    will also appear at 90 pixels wide, centered within the box.</p>

   <div style="width:300px; border:medium solid green; text-align:center;">
    <button style="width:90px">Elephant</button>

    <button style="width:90px">Tiger</button>

    <button style="width:90px">Antelope</button>

    <button style="width:90px">Wildebeest</button>
   </div>
  </div>

  <h3 id=flex-line-pack><span class=secno>8.1. </span> &lsquo;<a
   href="#propdef-flex-line-pack"><code
   class=property>flex-line-pack</code></a>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=propdef-flex-line-pack>flex-line-pack</dfn>

    <tr>
     <th>Value:

     <td>before | after | middle | distribute | inherit

    <tr>
     <th>Initial:

     <td>before

    <tr>
     <th>Applies to:

     <td>flexboxes

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed Value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>The flex-line-pack property may be used to control the alignment of
   lines in multi-line flexboxes. The values of this property have the
   following meanings:

  <dl>
   <dt><dfn id=flex-line-pack-before>before</dfn>

   <dd>The first line of child boxes is placed along the &lsquo;<a
    href="#flex-line-pack-before"><code
    class=property>before</code></a>&rsquo; edge of the content box (as
    determined by direction of <a href="#cross-axis"><i>cross axis</i></a>),
    and additional lines are placed afterward with no extra spacing between
    them.

   <dt><dfn id=flex-line-pack-after>after</dfn>

   <dd>Lines of child boxes are placed with no extra spacing between and
    &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of the last line is aligned
    with &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of the content box.

   <dt><dfn id=flex-line-pack-middle>middle</dfn>

   <dd>Lines of child boxes are placed with no space between them and equal
    amount of extra space left before first line and after last line.

   <dt><dfn id=flex-line-pack-distribute>distribute</dfn>

   <dd>The first line of child boxes is aligned with &lsquo;<a
    href="#flex-line-pack-before"><code
    class=property>before</code></a>&rsquo; edge of containing box. Lines of
    child boxes are spread with equal amout of empty spaces between each two
    lines, and so that &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of last line of child boxes
    is aligned with &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of conaining box.
  </dl>

  <p class=issue>TODO: examples

  <h2 id=free-space-algorithm><span class=secno>9. </span> Free Space
   Calculation and Distribution</h2>

  <p class=issue>IS THIS SECTION NECESSARY? It may be useful for implementors
   as guidance, but it is not normative. The spec describes the result, this
   describes the process - one should be enough, and the description of the
   result is not specific enough, it needs to be fixed.

  <p>The following algorithms detail precisely how to determine the
   dimensions and positions of a flexbox and its contents, and how to resolve
   flexible lengths used on <a href="#flexbox-item"><i>flexbox items</i></a>
   into definite lengths.

  <p>The algorithm described here is designed to be clear, but not
   necessarily efficient. Implementations may use different algorithms, but
   they must generate the same results as this algorithm.

  <p>This section defines several terms to clarify the operation of the
   algorithms described within:

  <dl>
   <dt><dfn id=relevant-length>relevant length</dfn>

   <dd>The width, height, margin, border, or padding of a flexbox item. Also,
    the <a href="#packing-space"><i>packing space</i></a>s of a flexbox.

   <dt><dfn id=flex-tuple>flex tuple</dfn>

   <dd>A 5-tuple of information about a flexible length, containing a minimum
    size, a maximum size, a preferred size, a positive flexibility, and a
    negative flexibility.

   <dt><dfn id=total-free-space>total free space</dfn>

   <dd>The inner width or height of the flexbox (depending on the
    distribution round), which will be used to calculate the sizes of the <a
    href="#flexbox-item"><i>flexbox items</i></a>.

   <dt><dfn id=available-free-space>available free space</dfn>

   <dd>The <a href="#total-free-space"><i>total free space</i></a> minus the
    sum of the preferred sizes of all the relevant lengths, which is used to
    resolve <a href="#flex-tuple"><i>flex tuple</i></a>s into inflexible
    lengths.
  </dl>

  <p>Similarly, the <dfn id=inner-measure>inner measure</dfn> is the width of
   the flexbox item in a horizontal flexbox, or the height in a vertical
   flexbox. The <dfn id=inner-length>inner length</dfn> is the height of the
   flexbox item in a horizontal flexbox, or the width in a vertical flexbox.

  <div class=issue>
   <p>Definition of "inner measure" and "inner length" is not used anywhere,
    or is it? Promote to general-use vocabulary or replace with existing
    terms.</p>

   <p class=issue>Suggestion: "inner measure" == "extent along main axis",
    "inner length" == "extent along cross axis"</p>
  </div>

  <h3 id=free-space-algorithm-initial><span class=secno>9.1. </span> Initial
   Computation</h3>

  <p>This step computes necessary information required to run the free-space
   distribution algorithms.

  <ol>
   <li>Determine the measure of the flexbox. Flexboxes are sized like
    shrinkwrapped blocks (if &lsquo;<code
    class=css>display:flexbox</code>&rsquo; is used) or inline-blocks (if
    &lsquo;<code class=css>display:inline-flexbox</code>&rsquo; is used). A
    horizontal flexbox's measure is its width, while a vertical flexbox's
    measure is its height. <span class=issue>This is wrong. In vertical
    flexbox with auto sizing, height can't be calculated before width
    (assuming horizontal flow). Calculation has to be width-then-height, not
    measure-then-length.</span>

   <li>
    <p>Resolve all <a href="#relevant-length"><i>relevant length</i></a>s on
     the flexbox and its <a href="#flexbox-item"><i>flexbox items</i></a>
     into <dfn id=flex-tuples>flex tuples</dfn> of [minimum size, maximum
     size, preferred size, positive flex, negative flex].</p>

    <dl>
     <dt>For margins and padding:

     <dd>
      <p>Set the minimum size to 0 and the maximum size to infinity.</p>

      <p>If the length is inflexible, set the preferred size to the length
       itself and both positive and negative flexibility to 0.</p>

      <p>If the length is a margin with the value &lsquo;<code
       class=css>auto</code>&rsquo;, set the preferred size to 0, the
       positive flexibility to 1, and the negative flexibility to 0.</p>

     <dt>For borders:

     <dd>Borders are always inflexible. Set the minimum size to 0, the
      maximum size to infinity, the preferred size to the border-width, and
      the positive and negative flexibility to 0.

     <dt>For width and height:

     <dd>
      <p>Set the minimum size to the value of the &lsquo;<code
       class=property>min-width</code>&rsquo; or &lsquo;<code
       class=property>min-height</code>&rsquo;, as appropriate. Set the
       maximum size to the value of the &lsquo;<code
       class=property>max-width</code>&rsquo; or &lsquo;<code
       class=property>max-height</code>&rsquo; property, as appropriate,
       unless the value is &lsquo;<code class=css>none</code>&rsquo;, in
       which case set the maximum size to infinity.</p>

      <p>If the length is inflexible, set the preferred size to the length
       itself and both positive and negative flexibility to 0.</p>

      <p>Otherwise, if the length was specified with the &lsquo;<code
       class=css>flex()</code>&rsquo; function, set the positive and negative
       flexibility to the values specified in the function. If the preferred
       size argument specified in the function is a &lt;length>, set the
       preferred size to that length. If the argment is a &lt;percentage>,
       resolve it relative to the width or height of the flexbox, as
       appropriate, and set the preferred size to the resultant length. If
       the argument is &lsquo;<code class=css>auto</code>&rsquo;, set the
       preferred size to the item's intrinsic dimension in the appropriate
       axis.</p>

      <p>Otherwise, if the length was &lsquo;<code
       class=css>auto</code>&rsquo;, set the preferred size to the item's
       intrinsic dimension in the appropriate axis, the positive flexibility
       to 1, and the negative flexibility to 0.</p>

      <p>If the preferred size is now less than the minimum size, set it
       equal to the minimum size. If the preferred size is now greater than
       the maximum size, set it equal to the maximum size.</p>

     <dt>For <a href="#packing-space"><i>packing space</i></a>s:

     <dd>
      <p>If the flexbox's &lsquo;<a href="#flex-pack0"><code
       class=property>flex-pack</code></a>&rsquo; is <i
       title=flex-pack-start>start</i>,the last <a
       href="#packing-space"><i>packing space</i></a> (between the final <a
       href="#flexbox-item"><i>flexbox item</i></a>, after reordering by
       &lsquo;<a href="#flex-order0"><code
       class=property>flex-order</code></a>&rsquo;, and the end of the
       flexbox) has a minimum size of 0, a maximum size of infinity, a
       preferred size of 0, a positive flexibility of 1, and a negative
       flexibility of 0. All other <a href="#packing-space"><i>packing
       space</i></a>s have minimum size, maximum size, preferred size,
       positive flexibility, and negative flexibility of 0.</p>

      <p>If the flexbox's &lsquo;<a href="#flex-pack0"><code
       class=property>flex-pack</code></a>&rsquo; is <i
       title=flex-pack-end>end</i>, the first <a
       href="#packing-space"><i>packing space</i></a> (between the first <a
       href="#flexbox-item"><i>flexbox item</i></a>, after reordering by
       &lsquo;<a href="#flex-order0"><code
       class=property>flex-order</code></a>&rsquo;, and the start of the
       flexbox) has a minimum size of 0, a maximum size of infinity, a
       preferred size of 0, a positive flexibility of 1, and a negative
       flexibility of 0. All other <a href="#packing-space"><i>packing
       space</i></a>s have minimum size, maximum size, preferred size,
       positive flexibility, and negative flexibility of 0.</p>

      <p>If the flexbox's &lsquo;<a href="#flex-pack0"><code
       class=property>flex-pack</code></a>&rsquo; is <i
       title=flex-pack-center>center</i>, the first and last <a
       href="#packing-space"><i>packing space</i></a>s (as defined above)
       have a minimum size of 0, a maximum size of infinity, a preferred size
       of 0, a positive flexibility of 1, and a negative flexibility of 0.
       All other <a href="#packing-space"><i>packing space</i></a>s have
       minimum size, maximum size, preferred size, positive flexibility, and
       negative flexibility of 0.</p>

      <p>If the flexbox's &lsquo;<a href="#flex-pack0"><code
       class=property>flex-pack</code></a>&rsquo; is <i
       title=flex-pack-justify>justify</i>, the first and last <a
       href="#packing-space"><i>packing space</i></a>s (as defined above)
       have a minimum size, maximum size, preferred size, positive
       flexibility, and negative flexibility of 0. All other <a
       href="#packing-space"><i>packing space</i></a>s have a minimum size of
       0, a maximum size of infinity, a preferred size of 0, a positive
       flexibility of 1, and a negative flexibility of 0.</p>
    </dl>
  </ol>

  <h3 id=first-distribution-round><span class=secno>9.2. </span> First
   Distribution Round</h3>

  <p>This step distributes free space to the flexible lengths of the flexbox
   in the <i>measure axis</i>.

  <p>Collect the set of <a href="#flex-tuple"><i>flex tuple</i></a>s that can
   participate in this step:

  <ol>
   <li>If the flexbox is horizontal, collect the widths of every <a
    href="#flexbox-item"><i>flexbox item</i></a>. If the flexbox is vertical,
    instead collect the heights of every <a href="#flexbox-item"><i>flexbox
    item</i></a>.

   <li>Collect the margins of every <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's measure axis.

   <li>Collect the borders of every <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's measure axis, if the <a
    href="#flexbox-item"><i>flexbox item</i></a> has a &lsquo;<code
    class=property>box-sizing</code>&rsquo; value of &lsquo;<code
    class=css>content-box</code>&rsquo; or &lsquo;<code
    class=css>padding-box</code>&rsquo;.

   <li>Collect the paddings of every <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's measure axis, if the <a
    href="#flexbox-item"><i>flexbox item</i></a> has a &lsquo;<code
    class=property>box-sizing</code>&rsquo; value of &lsquo;<code
    class=css>content-box</code>&rsquo;.
  </ol>

  <p>Invoke the <i>free space allocation algorithm</i> with the set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s collected above, and an <a
   href="#available-free-space"><i>available free space</i></a> equal to the
   flexbox's inner measure.

  <h3 id=second-distribution-round><span class=secno>9.3. </span> Second
   Distribution Round</h3>

  <p>This step distributes any leftover available space to the <a
   href="#packing-space"><i>packing space</i></a>, so that the flexbox items
   are arranged within the flexbox as desired.

  <p>Collect the same set of <a href="#flex-tuple"><i>flex tuple</i></a>s as
   in the first distribution round (now inflexible lengths), and additionally
   collect the flexbox's <a href="#packing-space"><i>packing space</i></a>s.

  <p>Invoke the <i>free space allocation algorithm</i> with the set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s collected above, and an <a
   href="#available-free-space"><i>available free space</i></a> equal to the
   flexbox's inner measure.

  <h3 id=intermediate-computation><span class=secno>9.4. </span> Intermediate
   Computation</h3>

  <p>Determine the length of the flexbox, given the sizes that have already
   been determined.

  <h3 id=third-distribution-round><span class=secno>9.5. </span> Third
   Distribution Round</h3>

  <p>This step distributes free space to the flexible lengths of each flexbox
   item in the <i>length axis</i>. <strong>It is run for each <a
   href="#flexbox-item"><i>flexbox item</i></a> independently.</strong>

  <p class=issue>ISSUE: This step doesn't yet take &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo; into
   account. I need to decide whether to always default to stretching or
   shrinking when doing baseline-alignment, or coming up with some heuristic
   for it. Perhaps specify the behavior in the &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   values instead? Once this decision is made, the behavior is relatively
   simple - either adjust margin (if shrunk) or padding (if stretched)

  <p>Collect the set of <a href="#flex-tuple"><i>flex tuple</i></a>s from the
   current <a href="#flexbox-item"><i>flexbox item</i></a> that can
   participate in this step:

  <ol>
   <li>If the flexbox is horizontal, collect the height of the <a
    href="#flexbox-item"><i>flexbox item</i></a>. If the flexbox is vertical,
    instead collect the width of the <a href="#flexbox-item"><i>flexbox
    item</i></a>.

   <li>Collect the margins of the <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's length axis.

   <li>Collect the borders of the <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's length axis, if the <a
    href="#flexbox-item"><i>flexbox item</i></a> has a &lsquo;<code
    class=property>box-sizing</code>&rsquo; value of &lsquo;<code
    class=css>content-box</code>&rsquo; or &lsquo;<code
    class=css>padding-box</code>&rsquo;.

   <li>Collect the padding lengths of the <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's length axis, if the <a
    href="#flexbox-item"><i>flexbox item</i></a> has a &lsquo;<code
    class=property>box-sizing</code>&rsquo; value of &lsquo;<code
    class=css>content-box</code>&rsquo;.
  </ol>

  <p>Invoke the <i>free space allocation algorithm</i> with the set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s collected above, and an <a
   href="#available-free-space"><i>available free space</i></a> equal to the
   flexbox's inner length.

  <h3 id=free-space-allocation-algorithm><span class=secno>9.6. </span> Free
   Space Allocation Algorithm</h3>

  <p>This section describes the algorithm used to allocate free space to a
   set of flexible lengths. The inputs to this algorithm are a set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s and a length representing the <a
   href="#total-free-space"><i>total free space</i></a>. The output is a set
   of inflexible lengths.

  <p>Calculate the <a href="#available-free-space"><i>available free
   space</i></a> by summing the preferred size of all the <a
   href="#flex-tuple"><i>flex tuple</i></a>s and subtracting that value from
   the <a href="#total-free-space"><i>total free space</i></a>.

  <p>If the <a href="#available-free-space"><i>available free space</i></a>
   is 0, transform all the <a href="#flex-tuple"><i>flex tuple</i></a>s into
   inflexible lengths equal to their preferred size and return them.

  <p>If the <a href="#available-free-space"><i>available free space</i></a>
   is a positive length, it will be distributed between all the <a
   href="#flex-tuple"><i>flex tuple</i></a>s with positive flexibility:

  <ol>
   <li>Sum the <a href="#positive-flexibility"><i>positive
    flexibility</i></a> of all the <a href="#flex-tuple"><i>flex
    tuple</i></a>s. This is the <i>total flexibility</i>.

   <li>If the <i>total flexibility</i> is 0, transform all the <a
    href="#flex-tuple"><i>flex tuple</i></a>s into inflexible lengths equal
    to their preferred size and return them.

   <li>
    <p>For each <a href="#flex-tuple"><i>flex tuple</i></a> with non-zero <a
     href="#positive-flexibility"><i>positive flexibility</i></a>, set its
     preferred size to:</p>

    <pre><code>[preferred size] + ( [available free space] * [positive flexibility] / [total flexibility] )</code></pre>

   <li>If any <a href="#flex-tuple"><i>flex tuple</i></a>s now have a
    preferred size greater than their maximum size, set their preferred size
    to their maximum size, set their positive flexibility to 0, and restart
    this algorithm.

   <li>Transform all the <a href="#flex-tuple"><i>flex tuple</i></a>s into
    inflexible lengths equal to their preferred size, and return them.
  </ol>

  <p>If the <a href="#available-free-space"><i>available free space</i></a>
   is a negative length, all the <a href="#flex-tuple"><i>flex tuple</i></a>s
   with negative flexibility will shrink to attemp to fit the set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s into the available space:

  <ol>
   <li>Sum the <a href="#negative-flexibility"><i>negative
    flexibility</i></a> of all the <a href="#flex-tuple"><i>flex
    tuple</i></a>s. This is the <i>total flexibility</i>.

   <li>If the <i>total flexibility</i> is 0, transform all the <a
    href="#flex-tuple"><i>flex tuple</i></a>s into inflexible lengths equal
    to their preferred size and return them.

   <li>
    <p>For each <a href="#flex-tuple"><i>flex tuple</i></a> with non-zero <a
     href="#negative-flexibility"><i>negative flexibility</i></a>, set its
     preferred size to:</p>

    <pre><code>[preferred size] + ( [available free space] * [negative flexibility] / [total flexibility] )</code></pre>

    <p class=note>Note that the <a href="#available-free-space"><i>available
     free space</i></a> is a negative length here, so the sum will result in
     a smaller length.</p>

   <li>If any <a href="#flex-tuple"><i>flex tuple</i></a>s now have a
    preferred size lesser than their minimum size, set their preferred size
    to their minimum size, set their negative flexibility to 0, and restart
    this algorithm.

   <li>Transform all the <a href="#flex-tuple"><i>flex tuple</i></a>s into
    inflexible lengths equal to their preferred size, and return them.
  </ol>

  <h2 id=pagination><span class=secno>10. </span> Page breaks in flexbox</h2>

  <p class=issue>TODO: define how flexbox should break on pages, columns,
   etc. This may or may not be normative until there is more than one
   implementation.

  <p>Very roughly:

  <ul>
   <li>Flexboxes can beak across pages between items, between rows of items
    (in multi-line mode) and inside items, as long as &lsquo;<code
    class=property>break-</code>&rsquo; property allow that. All &lsquo;<code
    class=property>break-</code>&rsquo; properties are supported on flexbox,
    on flexbox items and inside flexbox items.

   <li>Breaking behavior of a single-line vertical flexbox should be
    identical to a block in normal flow where children have same sizes and
    positions (e.g. explicitly set to match computed values in flexbox), same
    content and same breaking properties. <span class=issue>This is good goal
    or guidance, but not necessarily good normative definition. Get
    specific.</span>

   <li>Breaking behavior of a horizontal single-line flexbox should be
    similar (not necessarily identical) to that of a single-row table with
    same sizing.

   <li>In horizontal flexbox, a forced break within an items causes
    subsequent content of that item to go to next container, but it doesn't
    affect sibling items or their content.

   <li>In horizontal multi-line flexbox, values of &lsquo;<code
    class=property>break-before</code>&rsquo; and &lsquo;<code
    class=property>break-after</code>&rsquo; for each line are computed from
    combinatoin of properties on children that fit in that line (or would
    have fit, given available width and infinite height)
  </ul>

  <p class=issue>TODO: define breaking of vertical multi-line flexbox

  <p class=issue>TODO: add more detail: how breaking affect sizing (for
   broken boxes and boxes after the break) and alignment

  <h2 id=layout-interface><span class=secno>11. </span> Interface With Other
   Layout Algorithms</h2>

  <div class=issue>
   <p>This section seems necessary, but not the precise way it's written. I
    need to identify precisely what data needs to be exposed both by the
    containing measure model (for the flexbox to use) and by the flexbox (for
    the containing measure model to use), and then write that up. Then the
    other measure models we produce can re-use the same template.</p>

   <p>Need to define:</p>

   <ul>
    <li>The min/max/fit-content widths and heights of flexboxes in block
     contents

    <li>Other stuff?
   </ul>
  </div>
  <!--
  <p>
   A box placed in a block is considered a block level element and will be positioned
   and sized according to the rules for CSS 2.1 (section 10.3 for widths). Specifically,
   the following equation applies for calculating the width:
  </p>
  <blockquote>
  <p>'margin-left' + 'border-left-width' + 'padding-left' + 'width' + 'padding-right' + 'border-right-width' + 'margin-right' + scrollbar width (if any) = width of containing block
  </p>
  </blockquote>
  <p>All children of 'box' elements are block-level. If inline-level elements are nested
     inside boxes, they get wrapped in an anonymous block which then takes part in the
     box layout.

  </p><p>
     If the width of a child of a flexible box is computed as 'auto', then the used value
     is the shrink-to-fit width. This calculation is done similarly to how the width of
     a floating element is determined. Otherwise if the width has a computed value,
     then that value is used as the width.
  </p><p>

     In a horizontally oriented box, the flexibility is then applied which may increase
     or decrease the used width. In a vertically oriented box, the position and size
     of the child may be adjusted by the value of the container's
     <span class="property">'flex-align'</span> property.
  </p><p>

     The <span class="property">'min-width'</span>, <span class="property">'min-height'</span>,
     <span class="property">'max-width'</span>, and <span class="property">'max-height'</span>
     CSS properties act the same on boxes as on blocks.
  </p><p>

     The height of a child of a flexible box is determined in the same manner as specified
     in the CSS specification. The used height may further be adjusted by the container's
     <span class="property">'flex-align'</span> property in a horizontally
     oriented box, or the flexibility in a vertically oriented box.
  </p><p>

     Note that it is possible for a horizontally oriented box that the height of a
     flexible child containing an inline descendant will change when the flexibility is
     applied. Similarly, in a vertically oriented box, the height of a child may change
     based on the <span class="property">'flex-align'</span> property of the
     box.
  </p>
	-->

  <hr title="Separator from footer">

  <h2 id=changes><span class=secno>12. </span>Changes</h2>

  <h3 id=changes-from-ed-16-june-2011><span class=secno>12.1. </span>Changes
   from ED 16-June-2011</h3>

  <ul>
   <li>Intro
    <ul>
     <li>Added definitions for main axis and cross axis

     <li>Added a pargraph on multiline
    </ul>

   <li>&lsquo;<code class=property>display</code>&rsquo; property
    <ul>
     <li>Removed issue for "display-inside" (now ACTION-342)
    </ul>

   <li>Flex-item
    <ul>
     <li>New section, adds detail for flex item fixup

     <li>Removed issue for "other ignored properties"

     <li>Added issue on applicability of &lsquo;<code
      class=property>vertical-align</code>&rsquo;
    </ul>

   <li>&lsquo;<a href="#flex-flow"><code
    class=property>flex-flow</code></a>&rsquo; property
    <ul>
     <li>Renamed (was &lsquo;<code
      class=property>flex-direction</code>&rsquo;)

     <li>Values as in "option 8" <a
      href="http://wiki.csswg.org/spec/css3-flexbox#issue-2">http://wiki.csswg.org/spec/css3-flexbox#issue-2</a>

     <li>Computed value: specified value (was lr/rl/tb/bt)

     <li>Prose describing how the pair of values work
    </ul>

   <li>&lsquo;<a href="#flex-order0"><code
    class=property>flex-order</code></a>&rsquo;
    <ul>
     <li>Removed "flex-order vs. flex-index" issue. There is an issue at Wiki
      to finalize that, proposal to not change: <a
      href="http://wiki.csswg.org/spec/css3-flexbox#issue-8">http://wiki.csswg.org/spec/css3-flexbox#issue-8</a>
    </ul>

   <li>Flexibility
    <ul>
     <li>Removed &lsquo;<code class=property>fr</code>&rsquo; unit

     <li>Changed default/unspecified values to &lsquo;<code
      class=css>initial</code>&rsquo;, removed references to specifically
      &lsquo;<code class=property>width</code>&rsquo; and &lsquo;<code
      class=property>height</code>&rsquo;. No changes to what it applies to,
      but this way it is more general, in case it does need to apply to
      something else (for example to be part of grid rows/columns
      declarations)

     <li>Added a paragraph allowing (but not requiring) accepting unitless
      non-zero length in quirks mode, only when three values are specified.
    </ul>

   <li>Flexible margins
    <ul>
     <li>Added issue 15: &lsquo;<code class=css>margin:auto</code>&rsquo; as
      flex of 1 is not as powerful as &lsquo;<code class=css>margin:flex(2,
      20, 5)</code>&rsquo;. Is it enough? A good use case would help (issue
      16)
    </ul>

   <li>&lsquo;<a href="#flex-align0"><code
    class=property>flex-align</code></a>&rsquo; property
    <ul>
     <li>Adapted most of the definition of &lsquo;<a
      href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
      from 2009 spec

     <li>Note difference from 2009 spec remains  &lsquo;<a
      href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
      applies to flexbox items, while &lsquo;<code
      class=property>box-align</code>&rsquo; of the old spec applied to
      flexbox.

     <li>Added definition for where is &lsquo;<a
      href="#flex-line-pack-before"><code
      class=property>before</code></a>&rsquo; and where is &lsquo;<a
      href="#flex-line-pack-after"><code
      class=property>after</code></a>&rsquo;

     <li>Open issue 14 for before/after to validate the definition.

     <li>Included definition of how flexbox cross-axis size is determined in
      case of baseline-aligned children or mixed.

     <li>Note: the core alignment algorithm copied from 2009 spec describes
      how auto margins work together with &lsquo;<a href="#flex-align0"><code
      class=property>flex-align</code></a>&rsquo;. That algorithm is copied
      unchanged, proposed to adopt. It gives priority to margins over align
      (if I am reading it correctly): "flex-align:before; margin-top:auto"
      will end up being bottom-aligned in a horizontal flexbox.
    </ul>

   <li>Multiline flexbox
    <ul>
     <li>Copied the section on multiline flexbox from 2009 spec, adapted to
      fit into the current draft
    </ul>

   <li>&lsquo;<a href="#propdef-flex-line-pack"><code
    class=property>Flex-line-pack</code></a>&rsquo; property

   <li>Other
    <ul>
     <li>Replaced "measure axis" with "main axis"

     <li>Removed commented out intro draft
    </ul>
  </ul>

  <h2 class=no-num id=acknowledgments>Acknowledgments</h2>

  <p>[This section will contain further acknowledgments.]

  <p>Thanks for feedback from James Elmore and Shinichiro Hamaji.

  <h2 class=no-num id=references>References</h2>

  <h3 class=no-num id=normative>Normative references</h3>
  <!--begin-normative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->
  </dl>
  <!--end-normative-->

  <h3 class=no-num id=informative>Other references</h3>
  <!--begin-informative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->
  </dl>
  <!--end-informative-->

  <h2 class=no-num id=property>Property index</h2>
  <!--begin-properties-->

  <table class=proptable>
   <thead>
    <tr>
     <th>Property

     <th>Values

     <th>Initial

     <th>Applies&nbsp;to

     <th>Inh.

     <th>Percentages

     <th>Media

   <tbody>
    <tr>
     <th><span class=property>display</span>

     <td>flexbox | inline-flexbox

    <tr>
     <th><a class=property href="#flex-align0">flex-align</a>

     <td>before | after | middle | stretch | baseline

     <td>stretch

     <td>flexbox items

     <td>no

     <td>specified value

     <td>visual

    <tr>
     <th><a class=property href="#flex-flow">flex-flow</a>

     <td>[ row | row-reverse | column | column-reverse ] [ wrap |
      wrap-reverse ]? | [ horizontal | horizontal-reverse | horizontal-ltr |
      horizontal-rtl ] [ wrap | wrap-reverse | wrap-down | wrap-up ]? | [
      vertical | vertical-reverse | vertical-ttb | vertical-btt ] [ wrap |
      wrap-reverse | wrap-left | wrap-right ]?

     <td>row

     <td>flexboxes

     <td>no

     <td>specified value

     <td>visual

    <tr>
     <th><a class=property href="#propdef-flex-line-pack">flex-line-pack</a>

     <td>before | after | middle | distribute | inherit

     <td>before

     <td>flexboxes

     <td>no

     <td>specified value

     <td>visual

    <tr>
     <th><a class=property href="#flex-order0">flex-order</a>

     <td>&lt;integer>

     <td>1

     <td>flexbox items

     <td>no

     <td>specified value

     <td>visual

    <tr>
     <th><a class=property href="#flex-pack0">flex-pack</a>

     <td>start | end | center | justify | inherit

     <td>start

     <td>flexboxes

     <td>no

     <td>specified value

     <td>visual
  </table>
  <!--end-properties-->

  <h2 class=no-num id=index>Index</h2>
  <!--begin-index-->

  <ul class=indexlist>
   <li>after, <a href="#flex-align-after"
    title=after><strong>7.</strong></a>, <a href="#flex-line-pack-after"
    title=after><strong>8.1.</strong></a>

   <li>available free space, <a href="#available-free-space" title="available
    free space"><strong>9.</strong></a>

   <li>baseline, <a href="#flex-align-baseline"
    title=baseline><strong>7.</strong></a>

   <li>before, <a href="#flex-align-before"
    title=before><strong>7.</strong></a>, <a href="#flex-line-pack-before"
    title=before><strong>8.1.</strong></a>

   <li>center, <a href="#flex-pack-center"
    title=center><strong>6.</strong></a>

   <li>column, <a href="#flex-flow-column"
    title=column><strong>3.</strong></a>

   <li>column-reverse, <a href="#flex-flow-column-reverse"
    title=column-reverse><strong>3.</strong></a>

   <li>cross axis, <a href="#cross-axis" title="cross
    axis"><strong>2.</strong></a>

   <li>distribute, <a href="#flex-line-pack-distribute"
    title=distribute><strong>8.1.</strong></a>

   <li>end, <a href="#flex-pack-end" title=end><strong>6.</strong></a>

   <li>flex-align, <a href="#flex-align0"
    title=flex-align><strong>7.</strong></a>

   <li>flexbox item, <a href="#flexbox-item" title="flexbox
    item"><strong>1.</strong></a>

   <li>flexbox items, <a href="#flexbox-item" title="flexbox
    items"><strong>1.</strong></a>

   <li>flex-flow, <a href="#flex-flow"
    title=flex-flow><strong>3.</strong></a>

   <li>flex-line-pack, <a href="#propdef-flex-line-pack"
    title=flex-line-pack><strong>8.1.</strong></a>

   <li>flex-order, <a href="#flex-order0"
    title=flex-order><strong>4.</strong></a>

   <li>flex-pack, <a href="#flex-pack0"
    title=flex-pack><strong>6.</strong></a>

   <li>flex tuple, <a href="#flex-tuple" title="flex
    tuple"><strong>9.</strong></a>

   <li>flex tuples, <a href="#flex-tuples" title="flex
    tuples"><strong>9.1.</strong></a>

   <li>horizontal, <a href="#flex-flow-horizontal"
    title=horizontal><strong>3.</strong></a>

   <li>horizontal-ltr, <a href="#flex-flow-horizontal-ltr"
    title=horizontal-ltr><strong>3.</strong></a>

   <li>horizontal-reverse, <a href="#flex-flow-horizontal-reverse"
    title=horizontal-reverse><strong>3.</strong></a>

   <li>horizontal-rtl, <a href="#flex-flow-horizontal-rtl"
    title=horizontal-rtl><strong>3.</strong></a>

   <li>inner length, <a href="#inner-length" title="inner
    length"><strong>9.</strong></a>

   <li>inner measure, <a href="#inner-measure" title="inner
    measure"><strong>9.</strong></a>

   <li>justify, <a href="#flex-pack-justify"
    title=justify><strong>6.</strong></a>

   <li>main axis, <a href="#main-axis" title="main
    axis"><strong>2.</strong></a>

   <li>middle, <a href="#flex-align-middle"
    title=middle><strong>7.</strong></a>, <a href="#flex-line-pack-middle"
    title=middle><strong>8.1.</strong></a>

   <li>negative flexibility, <a href="#negative-flexibility" title="negative
    flexibility"><strong>5.1.</strong></a>

   <li>packing space, <a href="#packing-space" title="packing
    space"><strong>6.</strong></a>

   <li>positive flexibility, <a href="#positive-flexibility" title="positive
    flexibility"><strong>5.1.</strong></a>

   <li>pre-flex size, <a href="#pre-flex-size" title="pre-flex
    size"><strong>5.1.</strong></a>

   <li>relevant length, <a href="#relevant-length" title="relevant
    length"><strong>9.</strong></a>

   <li>row, <a href="#flex-flow-row" title=row><strong>3.</strong></a>

   <li>row-reverse, <a href="#flex-flow-row-reverse"
    title=row-reverse><strong>3.</strong></a>

   <li>start, <a href="#flex-pack-start" title=start><strong>6.</strong></a>

   <li>stretch, <a href="#flex-align-stretch"
    title=stretch><strong>7.</strong></a>

   <li>total free space, <a href="#total-free-space" title="total free
    space"><strong>9.</strong></a>

   <li>vertical, <a href="#flex-flow-vertical"
    title=vertical><strong>3.</strong></a>

   <li>vertical-btt, <a href="#flex-flow-row-vertical-btt"
    title=vertical-btt><strong>3.</strong></a>

   <li>vertical-reverse, <a href="#flex-flow-vertical-reverse"
    title=vertical-reverse><strong>3.</strong></a>

   <li>vertical-ttb, <a href="#flex-flow-vertical-ttb"
    title=vertical-ttb><strong>3.</strong></a>

   <li>wrap, <a href="#flex-flow-wrap" title=wrap><strong>3.</strong></a>

   <li>wrap-down, <a href="#flex-flow-wrap-down"
    title=wrap-down><strong>3.</strong></a>

   <li>wrap-left, <a href="#flex-flow-wrap-left"
    title=wrap-left><strong>3.</strong></a>

   <li>wrap-reverse, <a href="#flex-flow-wrap-reverse"
    title=wrap-reverse><strong>3.</strong></a>

   <li>wrap-right, <a href="#flex-flow-wrap-right"
    title=wrap-right><strong>3.</strong></a>

   <li>wrap-up, <a href="#flex-flow-wrap-up"
    title=wrap-up><strong>3.</strong></a>
  </ul>
  <!--end-index-->
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
