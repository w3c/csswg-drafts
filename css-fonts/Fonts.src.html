<!DOCTYPE html public '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/TR/html4/strict.dtd'>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <title>CSS Fonts Module Level 3</title>
  <!--
      FIXME when publishing: copy the current default.css and link to
      "default.css" rather than "../default.css"
   -->
  <link rel="stylesheet" type="text/css" href="../default.css">
  <link rel="shortcut icon" type="image/x-icon" href="../csslogo.ico" />

  <style type="text/css">

  body, th, td, h1, h2, h3, h4, h5, h6 {
    font-family: "myriad-pro", sans-serif !important;
  }

  p + p, p.mtb {
    margin-top: 0.8em;
    text-indent: 0px;
  }

  #bolderlighter {
    width: 40%;
  }

  #bolderlighter th {
    text-align: center;
  }

  #fontformats td, #eventhandlers td, #fontformats th, #eventhandlers th {
    padding-right: 2em;
    text-align: left;
  }

  dd {
    margin-bottom: 1em;
  }

  #authors dd {
    margin-bottom: 0;
  }

  #fontstylematchingalg {
    list-style-type: lower-alpha;
  }

  #fontmatchingalg ul, #fontmatchingalg ol {
    margin-top: 0.8em;
  }

  #fontmatchingalg li + li {
    margin-top: 0.8em;
  }

  div.example {
    padding: 1em;
    margin-top: 1em;
  }

  div.example + div.example {
    margin-top: 2em;
  }

  div.figure {
    page-break-inside: avoid;
  }

  pre.prod { white-space: pre-wrap; margin: 1em 0 1em 2em }

  div.featex {
    width: 700px;
  }

  div.featex img {
    margin: auto;
    display: block;
  }

  span.tag {
    font-family: monospace;
    font-size: 120%;
  }

  ol ol {
    list-style-type: lower-alpha;
  }

  .idl-code {
    font-weight: bold;
    color: #c50;
  }

  #fonts ul.indexlist ul, #fonts ul.indexlist dl { font-size: inherit; }

  </style>

  <link href="https://www.w3.org/StyleSheets/TR/W3C-[STATUS].css" rel=stylesheet type="text/css">
  <script defer=defer
      src="https://test.csswg.org/harness/annotate.js#CSS3-FONTS_DEV"
      type="text/javascript"></script>

</head>

<body id="fonts">

<div class="head">
<!--logo-->

<h1>CSS Fonts Module Level 3</h1>

<h2 class="no-num no-toc">[LONGSTATUS] [DATE]</h2>
<dl id="authors">
  <dt>This version:</dt>
    <dd><a href="https://drafts.csswg.org/css-fonts/">https://drafts.csswg.org/css-fonts/</a>
    <!-- <dd><a href="https://www.w3.org/TR/[YEAR]/[STATUS]-css-fonts-3-[CDATE]/">https://www.w3.org/TR/[YEAR]/[STATUS]-css-fonts-3-[CDATE]/</a> -->
  <dt>Latest version:</dt>
    <dd><a href="https://www.w3.org/TR/css-fonts-3/">https://www.w3.org/TR/css-fonts-3/</a></dd>
  <dt>Latest editor's draft:</dt>
    <dd><a href="https://drafts.csswg.org/css-fonts/">https://drafts.csswg.org/css-fonts/</a>
    (<a href="https://hg.csswg.org/drafts/log/tip/css-fonts/Fonts.html">change log</a>)</dd>
  <dt>Previous version:</dt>
    <dd><a href="https://www.w3.org/TR/2013/CR-css-fonts-3-20131003/">https://www.w3.org/TR/2013/CR-css-fonts-3-20131003/</a></dd>
  <dt>Issues List:</dt>
    <dd><a href="https://www.w3.org/Style/CSS/Tracker/products/18">CSS3 Fonts issues in Tracker</a>
    <dd><a href="https://www.w3.org/Bugs/Public/buglist.cgi?query_format=advanced&amp;product=CSS&amp;component=Fonts&amp;bug_status=NEW&amp;bug_status=ASSIGNED&amp;bug_status=REOPENED">CSS3 Fonts issues in Bugzilla</a>
    <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-fonts-3">css-fonts-3 issues in github</a>
  <dt>Discussion:</dt>
    <dd><a href="mailto:www-style@w3.org?subject=%5Bcss-fonts%5D%20feedback">www-style@w3.org</a>
         with subject line “<kbd>[css-fonts]
         <var>… message topic …</var></kbd>”
         (<a rel="discussion" href="https://lists.w3.org/Archives/Public/www-style/">archives</a>)</dd>
  <dt>Test Suite:</dt>
    <dd><a href="https://test.csswg.org/suites/css3-fonts/nightly-unstable/">https://test.csswg.org/suites/css3-fonts/nightly-unstable/</a>
  <dt>Editors:</dt>
    <dd><a href="https://twitter.com/nattokirai">John Daggett (Invited Expert)</a></dd>
    <dd><a href="mailto:mmaxfield@apple.com">Myles C. Maxfield (Apple Inc.)</a></dd>
</dl>

<!--begin-copyright-->
<!--end-copyright-->

<hr title="Separator for header">
</div>

<h2 class="no-num no-toc" id=abstract>Abstract</h2>

<p>This CSS3 module describes how font properties are specified and how
font resources are loaded dynamically.  The contents of this
specification are a consolidation of content previously divided into
<a href="https://www.w3.org/TR/2002/WD-css3-fonts-20020802/">CSS3 Fonts</a> and
<a href="https://www.w3.org/TR/2002/WD-css3-webfonts-20020802/">CSS3 Web Fonts</a> modules.
The description of font load events was moved into the
<a href="https://drafts.csswg.org/css-font-load-events/">CSS3 Font Load Events</a> module.
</p>

<h2 class="no-num no-toc" id=status>Status of this document</h2>

<!--begin-status-->
<!--end-status-->

<p>See the section <a href="#cr-exit-criteria">CR Exit Criteria</a>
for details on advancing this specification to W3C Recommendation. The
specification will remain Candidate Recommendation at least until 3 April 2014.
A <a href="https://test.csswg.org/suites/css3-fonts/nightly-unstable/report/">test
suite and implementation report</a> are under development.</p>

<h3 class="no-num no-toc" id="atrisk">Features at risk</h3>

<p>The following features are at risk; if interoperable
implementations are not found, they may be removed to advance the other
features in this specification to Proposed Recommendation:</p>

<ul>
<li>fallback handling for text decoration in superscript/subscript variant glyphs ('font-variant-position')</li>
<li>'font-language-override' property</li>
<li>The <em>font specific</em> functions accepted by 'font-variant-alternates' and 'font-variant'. This includes the entire <code>@font-feature-values</code> at-rule, as well as the following functions:
<ul>
<li><a href="#stylistic">stylistic()</a></li>
<li><a href="#styleset">styleset()</a></li>
<li><a href="#character-variant">character-variant()</a></li>
<li><a href="#swash">swash()</a></li>
<li><a href="#ornaments">ornaments()</a></li>
<li><a href="#annotation">annotation()</a></li>
</ul>
</li>
<li>Synthesis of the 'font-variant-position' property</li>
</ul>

<nav id="toc">
<h2 class="no-num no-toc" id="contents">Table of contents</h2>

<!--begin-toc-->
<!--end-toc-->
</nav>

<h2 id="introduction">Introduction</h2>

<p>A font provides a resource containing the visual representation of
characters.  At the simplest level it contains information that maps character
codes to shapes (called glyphs) that represent these characters.  Fonts
sharing a common design style are commonly grouped into font families
classified by a set of standard font properties.  Within a family, the
shape displayed for a given character can vary by stroke weight, slant
or relative width, among others. An individual font face is described by a
unique combination of these properties. For a given range of text, CSS
font properties are used to select a font family and a specific font
face within that family to be used when rendering that text.  As a
simple example, to use the bold form of Helvetica one could use:
</p>

<pre>body {
    font-family: Helvetica;
    font-weight: bold;
}</pre>

<p>Font resources may be installed locally on the system on which a user
agent is running or downloadable.  For local font resources descriptive
information can be obtained directly from the font resource.  For
downloadable font resources (sometimes referred to as web fonts), the
descriptive information is included with the reference to the font
resource.
</p>

<p>Families of fonts typically don't contain a single face for each
possible variation of font properties.  The CSS font selection mechanism
describes how to match a given set of CSS font properties to a single
font face.
</p>

<h2 id="typography-background">Typography Background</h2>

<em>This section is non-normative.</em>

<p>
Typographic traditions vary across the globe, so there is no unique way
to classify all fonts across languages and cultures.  For even common
Latin letters, wide variations are possible:</p>

<div class="figure"><img alt="variations in glyphs for a single character" src="aaaaaa.png"><p class="caption">One character, many glyph variations</p></div>

<p>Differences in the anatomy of letterforms is one way to distinguish
fonts.  For Latin fonts, flourishes at the ends of a character's main
strokes, or serifs, can distinguish a font from those without.  Similar
comparisons exist in non-Latin fonts between fonts with tapered strokes
and those using primarily uniform strokes:</p>

<div class="figure"><img alt="serif vs. non-serifs" src="serifvssansserif.png" /><p class="caption">Letterforms with and without serifs</p></div>

<div class="figure"><img alt="serif vs. non-serifs for japanese" src="minchovsgothic.png" /><p class="caption">Similar groupings for Japanese typefaces</p></div>

<p>Fonts contain letterforms and the data needed to map characters to
these letterforms. Often this may be a simple one-to-one mapping, but
more complex mappings are also possible. The use of combining diacritic
marks creates many variations for an underlying letterform:</p>

<div class="figure"><img alt="diacritic marks" src="aaaaaa-diacritics.png" /><p class="caption">Variations with diacritic marks</p></div>

<p>A sequence of characters can be represented by a single glyph known as a ligature:</p>

<div class="figure"><img alt="example of a fi ligature" src="final-ligature.png" /><p class="caption">Ligature example</p></div>

<p>Visual transformations based on textual context are often
stylistic option in European languages.  They are required to correctly
render languages like Arabic, the lam and alef characters below
<em>must</em> be combined when they exist in sequence:</p>

<div class="figure"><img alt="lam alef ligature" src="lamaleflig.png" /><p class="caption">Required Arabic ligature</p></div>

<p>The relative complexity of these shaping transformations requires
additional data within the font.</p>

<p>Sets of font faces with various stylistic variations are often
grouped together into font families.  In the simplest case a regular
face is supplemented with bold and italic faces, but much more extensive
groupings are possible.  Variations in the thickness of letterform
strokes, the <dfn>weight</dfn>, and the overall proportions of the letterform,
the <dfn>width</dfn>, are most common. In the example below, each letter uses a
different font face within the Univers font family.  The width used
increases from top to bottom and the weight increases from left to
right: </p>

<div class="figure"><img alt="various width and weight variations within a single family" src="weightwidthvariations.png" /><p class="caption">Weight and width variations within a single font family</p></div>

<p>Creating fonts that support multiple scripts is a difficult task;
designers need to understand the cultural traditions surrounding the
use of type in different scripts and come up with letterforms that
somehow share a common theme.  Many languages often share a common
script and each of these languages may have noticeable stylistic
differences.  For example, the Arabic script, when used for Persian and
Urdu, exhibits significant and systematic differences in letterforms,
as does Cyrillic when used with languages such as Serbian and
Russian.</p>

<p>The <em>character map</em> of a font defines the mapping of characters
to glyphs for that font. If a document contains characters not
supported by the <em title="character map">character maps</em> of the fonts contained in a font
family list, a
user agent may use a <em>system font fallback</em> procedure to locate an
appropriate font that does.  If no appropriate font can be found,
some form of "missing glyph" character will be rendered by the
user agent.  System fallback can occur when the specified list of font families
does not include a font that supports a given character.
</p>

<p>Although the <em>character map</em> of a font maps a given character to a
glyph for that character, modern font technologies such as OpenType
and AAT (Apple Advanced Typography) provide ways of mapping a
character to different glyphs based upon feature settings. Fonts in
these formats allow these features to be embedded in the font itself
and controlled by applications.  Common typographic features which can
be specified this way include ligatures, swashes, contextual
alternates, proportional and tabular figures, and automatic fractions,
to list just a few.  For a visual overview of OpenType features, see
the [[OPENTYPE-FONT-GUIDE]].
</p>

<h2 id="basic-font-props">Basic Font Properties</h2>

<p>The particular font face used to render a character is determined by
the font family and other font properties that apply to a given element.
 This structure allows settings to be varied independent of each
other.</p>

<!-- prop: font-family -->

<h3 id="font-family-prop">Font family: the <a href="#propdef-font-family">font-family</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-family" title="font-family!!property">font-family</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>[ <var>&lt;family-name&gt;</var> | <var>&lt;generic-family&gt;</var> ] #</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>depends on user agent</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>This property specifies a prioritized list of font family names or
generic family names.  A font family defines a set of faces that vary
in weight, width or slope.  CSS uses the combination of a family name
with other style attributes to select an individual face.  Using this
selection mechanism, rather than selecting a face via the style name
as is often done in design applications, allows some degree of
regularity in textual display when fallback occurs.</p>

<p class="note">Designers should note that the CSS definition of font
attributes used for selection are explicitly not intended to define a
font taxonomy.  A type designer's idea of a family may often extend to
a set of faces that vary along axes other than just the standard axes
of weight, width and slope.  A family may extend to include both a set
of serif faces and a set of sans-serif faces or vary along axes that
are unique to that family. The CSS font selection mechanism merely
provides a way to determine the &ldquo;closest&rdquo; substitute when
substitution is necessary.</p>

<p>Unlike other CSS properties, component values are a comma-separated
list indicating alternatives.  A user agent iterates through the list
of family names until it matches an available font that contains a
glyph for the character to be rendered.  This allows for differences
in available fonts across platforms and for differences in the range
of characters supported by individual fonts.</p>

<p>A font family name only specifies a name given to a set of font
faces, it does not specify an individual face.  For example, given the availability
of the fonts below, Futura would match but Futura Medium would not:</p>

<div class="figure"><img alt="family and face names" src="familyvsfacename.png" /><p class="caption">Family and individual face names</p></div>

<p>Consider the example below:</p>

<div class="example">
<pre>body {
    font-family: Helvetica, Verdana, sans-serif;
}</pre>

<p>If Helvetica is available it will be used when rendering.  If
neither Helvetica nor Verdana is present, then the user-agent-defined
sans serif font will be used.</p>
</div>

<p>There are two types of font family names:</p>

<dl>
  <dt><dfn id="family-name-value"><var>&lt;family-name&gt;</var></dfn></dt>
  <dd>The name of a font family of choice such as Helvetica or Verdana in the previous example.
  </dd>
  <dt><dfn id="generic-family-value"><var>&lt;generic-family&gt;</var></dfn></dt>
  <dd>
    The following generic family keywords are defined: 'serif', 'sans-serif', 'cursive',
    'fantasy', and 'monospace'. These keywords can be used as a general fallback mechanism
    when an author's desired font choices are not available.  As keywords, they must not
    be quoted. Authors are encouraged to append a generic font family as a last alternative for
    improved robustness.
  </dd>
</dl>

<p>Font family names other than generic families must either be given quoted as <a
href="https://www.w3.org/TR/CSS21/syndata.html#strings">strings,</a>
or unquoted as a sequence of one or more
<a href="https://www.w3.org/TR/CSS21/syndata.html#value-def-identifier">identifiers.</a>
This means most punctuation characters and digits at the start of
each token must be escaped in unquoted font family names.</p>

<p>To illustrate this, the following declarations are invalid:

<pre>
font-family: Red/Black, sans-serif;
font-family: "Lucida" Grande, sans-serif;
font-family: Ahem!, sans-serif;
font-family: test@foo, sans-serif;
font-family: #POUND, sans-serif;
font-family: Hawaii 5-0, sans-serif;
</pre>

<p>If a sequence of identifiers is given as a font family name,
the computed value is the name converted to a string by joining
all the identifiers in the sequence by single spaces.</p>

<p>To avoid mistakes in escaping, it is recommended to quote font
family names that contain white space, digits, or punctuation
characters other than hyphens:</p>

<pre>
body { font-family: "New Century Schoolbook", serif }

&lt;BODY STYLE="font-family: '21st Century', fantasy">
</pre>

<p>Font family <em>names</em> that happen to be the same as  keyword
value ('inherit', 'serif', etc.) must be quoted to prevent confusion
with the keywords with the same names. UAs must not consider these
keywords as matching the <var>&lt;family-name&gt;</var> type. This
applies to any keyword across all of CSS.
</p>

<p>The precise way a set of fonts are grouped into font families
varies depending upon the platform font management API's.  The
Windows GDI API only allows four faces to be grouped into a family
while the DirectWrite API and API's on OSX and other platforms support
font families with a variety of weights, widths and slopes (see <a
href="#platform-props-to-css">Appendix A</a> for more details).</p>

<p>Some font formats allow fonts to carry multiple localizations
of the family name. User agents must recognize and correctly
match all of these names independent of the underlying platform
localization, system API used or document encoding:</p>

<div class="figure"><img alt="examples of localized family names" src="localizedfamilynames.png" /><p class="caption">Localized family names</p></div>

<p>The details of localized font family name matching and the
corresponding issues of case sensitivity are described below in the
<a href="#font-family-casing">font matching</a> section.</p>

<h4 id="generic-font-families">Generic font families</h4>

<p>All five generic font families are defined to exist in all CSS
implementations (they need not necessarily map to five distinct actual
fonts). User agents should provide reasonable default choices for the
generic font families, which express the characteristics of each family
as well as possible within the limits allowed by the underlying
technology. User agents are encouraged to allow users to select
alternative choices for the generic fonts.</p>

<h5 class="no-num no-toc"> <span class="index-def" title="serif, definition of"><a name="serif-def"><dfn>serif</dfn></a></span></h5>

<p>Serif fonts represent the formal text style for a script.
This often means but is not limited to glyphs that have finishing
strokes, flared or tapering ends, or have actual serifed endings
(including slab serifs). Serif fonts are typically
proportionately-spaced. They often display a greater variation between
thick and thin strokes than fonts from the 'sans-serif' generic font
family. CSS uses the term 'serif' to apply to a font for any script,
although other names may be more familiar for particular scripts, such
as Mincho (Japanese), Sung or Song (Chinese), Batang (Korean).
For Arabic, the Naskh style would correspond to 'serif' more due to
its typographic role rather than its actual design style.
Any font that is so described may be used to represent the
generic 'serif' family.

<div class="figure"><img alt="sample serif fonts" src="serifexamples.png" /><p class="caption">Sample serif fonts</p></div>

<h5 class="no-num no-toc"> <span class="index-def" title="sans-serif, definition of">
<a name="sans-serif-def"><dfn>sans-serif</dfn></a></span></h5>

<p>Glyphs in sans-serif fonts, as the term is used in CSS, are generally
low contrast (vertical and horizontal stems have the close to the same
thickness) and have stroke
endings that are plain -- without any flaring, cross stroke, or other
ornamentation. Sans-serif fonts are typically
proportionately-spaced. They often have little variation between thick
and thin strokes, compared to fonts from the 'serif' family. CSS uses
the term 'sans-serif' to apply to a font for any script, although
other names may be more familiar for particular scripts, such as
Gothic (Japanese), Hei (Chinese), or Gulim (Korean). Any font that
is so described may be used to represent the generic 'sans-serif'
family.

<div class="figure"><img alt="sample sans-serif fonts" src="sansserifexamples.png" /><p class="caption">Sample sans-serif fonts</p></div>

<h5 class="no-num no-toc"> <span class="index-def" title="cursive, definition of">
<a name="cursive-def"><dfn>cursive</dfn></a></span></h5>

<p>Glyphs in cursive fonts generally use a more informal script style,
and the result looks more like handwritten pen or brush writing than
printed letterwork. CSS uses the term 'cursive' to apply to a font for
any script, although other names such as Chancery, Brush, Swing and
Script are also used in font names.

<div class="figure"><img alt="sample cursive fonts" src="cursiveexamples.png" /><p class="caption">Sample cursive fonts</p></div>

<h5 class="no-num no-toc"> <span class="index-def" title="fantasy, definition of">
<a name="fantasy-def"><dfn>fantasy</dfn></a></span></h5>

<p>Fantasy fonts are primarily decorative or expressive fonts that contain decorative or
expressive representations of characters.
These do not include Pi or Picture fonts which do not represent actual characters.</p>

<div class="figure"><img alt="sample fantasy fonts" src="fantasyexamples.png" /><p class="caption">Sample fantasy fonts</p></div>

<h5 class="no-num no-toc"> <span class="index-def" title="monospace, definition of">
<a name="monospace-def"><dfn>monospace</dfn></a></span></h5>

<p>The sole criterion of a monospace font is that all glyphs have the same fixed width.  This is often used
to render samples of computer code.</p>

<div class="figure"><img alt="sample monospace fonts" src="monospaceexamples.png" /><p class="caption">Sample monospace fonts</p></div>


<!-- prop: font-weight -->

<h3 id="font-weight-prop">Font weight: the <a href="#propdef-font-weight">font-weight</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-weight" title="font-weight!!property">font-weight</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-weight">normal</span> | <span>bold</span> | <span>bolder</span> | <span>lighter</span> |
          <span title="100...900 weight values">100</span> | <span title="100...900 weight values">200</span> | <span title="100...900 weight values">300</span> |
          <span title="100...900 weight values">400</span> | <span title="100...900 weight values">500</span> | <span title="100...900 weight values">600</span> |
          <span title="100...900 weight values">700</span> | <span title="100...900 weight values">800</span> | <span title="100...900 weight values">900</span> </td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>numeric weight value (see description)</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>as <a href="https://drafts.csswg.org/css-transitions/#animtype-font-weight">font weight</a></td>
    </tr>
  </tbody>
</table>

<p>The <span title="font-weight!!property">'font-weight'</span></a>
property specifies the weight of glyphs in the font, their degree of blackness or stroke thickness.</p>

<p>Values have the following meanings:</p>

<dl>
<dt><dfn id="font-weight-numeric-values" title="100...900 weight values">100 to 900</dfn></dt>
<dd>These values form an ordered sequence, where each number indicates a weight that is
at least as dark as its predecessor.  These roughly correspond to the commonly used weight names below:</dd>
<ul>
<li>100 - Thin</li>
<li>200 - Extra Light (Ultra Light)</li>
<li>300 - Light</li>
<li>400 - Normal</li>
<li>500 - Medium</li>
<li>600 - Semi Bold (Demi Bold)</li>
<li>700 - Bold</li>
<li>800 - Extra Bold (Ultra Bold)</li>
<li>900 - Black (Heavy)</li>
</ul>
</dd>
<dt><dfn id="font-weight-normal-value" title="normal!!font-weight">normal</dfn></dt>
<dd>Same as '400'.</dd>
<dt><dfn>bold</dfn></dt>
<dd>Same as '700'.</dd>
<dt><dfn>bolder</dfn></dt>
<dd>Specifies a bolder weight than the inherited value.</dd>
<dt><dfn>lighter</dfn></dt>
<dd>Specifies a lighter weight than the inherited value.</dd>
</dl>

<p>Font formats that use a scale other than a nine-step scale should map
their scale onto the CSS scale so that 400 roughly corresponds with a
face that would be labeled as Regular, Book, Roman and 700 roughly
matches a face that would be labeled as Bold.  Or weights may be
inferred from the style names, ones that correspond roughly with the
scale above.  The scale is relative, so a face with a larger weight value
must never appear lighter.  If style names are used to infer weights,
care should be taken to handle variations in style names across locales.
</p>

<p>Quite often there are only a few weights available for a particular
font family.  When a weight is specified for which no face exists, a
face with a nearby weight is used. In general, bold weights map to faces
with heavier weights and light weights map to faces with lighter weights
(see the <a href="#font-matching-algorithm">font matching section
below</a> for a precise definition). The examples here illustrate which
face is used for different weights, grey indicates a face for that
weight does not exist so a face with a nearby weight is used:</p>

<div class="figure"><img alt="weight mappings for a family with 400, 700 and 900 weights" src="optimaweights.png" /><p class="caption">Weight mappings for a font family with 400, 700 and 900 weight faces</p></div>

<div class="figure"><img alt="weight mappings for a family with 300, 600 weights" src="hiraginoweights.png" /><p class="caption">Weight mappings for a font family with 300 and 600 weight faces</p></div>

<p>Although the practice is not well-loved by typographers, bold faces are often
synthesized by user agents for faces that lack actual bold faces. For
the purposes of style matching, these faces must be treated as if they
exist within the family.  Authors can explicitly avoid this behavior
by using the 'font-synthesis' property.
</p>

<p>Specified values of 'bolder' and 'lighter' indicate weights
relative to the weight of the parent element.  The computed weight is
calculated based on the inherited <span title="font-weight!!property">'font-weight'</span> value using the chart
below.</p>

<table id="bolderlighter" class="data" summary="Bolder/lighter mappings">
<thead>
<tr>
  <th>Inherited value</th>
  <th>bolder</th>
  <th>lighter</th>
</tr>
</thead>
<tbody>
<tr><th>100</th><td>400</td><td>100</td></tr>
<tr><th>200</th><td>400</td><td>100</td></tr>
<tr><th>300</th><td>400</td><td>100</td></tr>
<tr><th>400</th><td>700</td><td>100</td></tr>
<tr><th>500</th><td>700</td><td>100</td></tr>
<tr><th>600</th><td>900</td><td>400</td></tr>
<tr><th>700</th><td>900</td><td>400</td></tr>
<tr><th>800</th><td>900</td><td>700</td></tr>
<tr><th>900</th><td>900</td><td>700</td></tr>
</tbody>
</table>

<p>The table above is equivalent to selecting the next relative bolder or lighter face,
given a font family containing normal and bold faces along with a thin and a heavy face.
Authors who desire finer control over the exact weight values used for a given element
may use numerical values instead of relative weights.
</p>

<!-- prop: font-stretch -->

<h3 id="font-stretch-prop">Font width: the <a href="#propdef-font-stretch">font-stretch</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-stretch" title="font-stretch!!property">font-stretch</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td> <span title="normal!!font-stretch">normal</span> | <span>ultra-condensed</span> | <span>extra-condensed</span> | <span>condensed</span> |
          <span>semi-condensed</span>  | <span>semi-expanded</span> | <span>expanded</span> | <span>extra-expanded</span> |
          <span>ultra-expanded</span> </td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>as <a href="#font-stretch-animation">font stretch</a></td>
    </tr>
  </tbody>
</table>

<p>The <span title="font-stretch!!property">'font-stretch'</span> property selects a normal,
condensed, or expanded face from a font family. Absolute keyword values
have the following ordering, from narrowest to widest:
</p>

<ul>
  <li><dfn>ultra-condensed</dfn></li>
  <li><dfn>extra-condensed</dfn></li>
  <li><dfn>condensed</dfn></li>
  <li><dfn>semi-condensed </dfn></li>
  <li><dfn id="font-stretch-normal-value" title="normal!!font-stretch">normal</dfn></li>
  <li><dfn>semi-expanded</dfn></li>
  <li><dfn>expanded</dfn></li>
  <li><dfn>extra-expanded</dfn></li>
  <li><dfn>ultra-expanded</dfn></li>
</ul>

<p>When a face does not exist
for a given width, normal or condensed values map to a narrower face,
otherwise a wider face.  Conversely, expanded values map to a wider
face, otherwise a narrower face.  The figure below shows how the nine
font-stretch property settings affect font selection for font family
containing a variety of widths, grey indicates a width for which no
face exists and a different width is substituted:
</p>

<div class="figure"><img alt="width mappings for a family with condensed, normal and expanded faces" src="universwidths.png" /><p class="caption">Width mappings for a font family with condensed, normal and expanded width faces</p></div>

<p id="font-stretch-animation">Animation of font stretch:  Font stretch is
interpolated in discrete steps.  The interpolation happens as though the
ordered values are equally spaced real numbers.  The interpolation result
is rounded to the nearest value, with values exactly halfway between two
values rounded towards the later value in the list above.</p>

<!-- prop: font-style -->

<h3 id="font-style-prop">Font style: the <a href="#propdef-font-style">font-style</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-style" title="font-style!!property">font-style</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-style">normal</span> | <span>italic</span> | <span>oblique</span></td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>The <span title="font-style!!property">'font-style'</span> property allows
italic or oblique faces to be selected. Italic forms are generally cursive in nature while oblique faces are
typically sloped versions of the regular face.  Oblique faces can be simulated by artificially sloping the
glyphs of the regular face. Compare the artificially sloped renderings of Palatino 'a' and Baskerville 'N'
in grey with the actual italic versions:</p>

<div class="figure"><img alt="artificial sloping vs. real italics" src="realvsfakeitalics.png" /><p class="caption">Artificial sloping versus real italics</p></div>

<p>Values have the following meanings:</p>

<dl>
  <dt><dfn id="font-style-normal-value" title="normal!!font-style">normal</dfn></dt>
  <dd>selects a face that is classified as a normal face, one that is neither italic or obliqued</dd>
  <dt><dfn>italic</dfn></dt>
  <dd>selects a font that is labeled as an italic face, or an oblique face if one is not</dd>
  <dt><dfn>oblique</dfn></dt>
  <dd>selects a font that is labeled as an oblique face, or an italic face if one is not</dd>
</dl>

<p>If no italic or oblique face is available, oblique faces can be
synthesized by rendering non-obliqued faces with an artificial
obliquing operation.  The use of these artificially obliqued faces
can be disabled using the 'font-synthesis' property.  The details
of the obliquing operation are not explicitly defined.</p>

<p class="note">Authors should also be aware that synthesized
approaches may not be suitable for scripts like Cyrillic, where italic
forms are very different in shape.  It is always better to use an actual
italic font rather than rely on a synthetic version.</p>

<!-- resolution on the "undefined" nature of synthetics: https://www.w3.org/2013/06/06-css-minutes.html#item03 -->

<p>Many scripts lack the tradition of mixing a cursive form within
text rendered with a normal face.  Chinese, Japanese and Korean fonts
almost always lack italic or oblique faces.  Fonts that support a
mixture of scripts will sometimes omit specific scripts such as Arabic
from the set of glyphs supported in the italic face. User agents
should be careful about making <em>character map</em> assumptions across
faces when implementing support for <em>system font fallback</em>.</p>

<!-- prop: font-size -->

<h3 id="font-size-prop">Font size: the <a href="#propdef-font-size">font-size</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-size">font-size</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><var>&lt;absolute-size&gt;</var> | <var>&lt;relative-size&gt;</var> | <var>&lt;length-percentage&gt;</var></td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>medium</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>refer to parent element's font size</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>absolute length</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>as <a href="https://drafts.csswg.org/css-transitions/#animtype-length">length</a></td>
    </tr>
  </tbody>
</table>

<p>This property indicates the desired height of glyphs from the
font. For scalable fonts, the font-size is a scale factor applied to the EM unit
of the font. (Note that certain glyphs may bleed outside their EM box.) For
non-scalable fonts, the font-size is converted into absolute units and matched
against the declared font-size of the font, using the same absolute coordinate
space for both of the matched values.
Values have the following meanings:</p>

<dl>
    <dt><dfn id="absolute-size-value"><var>&lt;absolute-size&gt;</var></dfn>
    <dd> An <var>&lt;absolute-size&gt;</var> keyword refers to an entry
in a table of font sizes computed and kept by the user agent. Possible values
are:

    <p> [ xx-small | x-small | small | medium | large | x-large | xx-large ]</p>

    <dt><dfn id="relative-size-value"><var>&lt;relative-size&gt;</var></dfn>

    <dd> A <var>&lt;relative-size&gt;</var> keyword is interpreted
    relative to the table of font sizes and the computed 'font-size' of the
    parent element. Possible values are:

    <p> [ larger | smaller ]

    <p> For example, if the parent element has a font size of
    'medium', a value of 'larger' will make the font size of the
    current element be 'large'.  If the parent element's size is not
    close to a table entry, the user agent is free to interpolate
    between table entries or round off to the closest one. The user
    agent may have to extrapolate table values if the numerical value
    goes beyond the keywords.

    <dt><dfn data-dfn-type=value data-dfn-for=font-size id="length-percentage-size-value"><var>&lt;length-percentage&gt;</var></dfn>
    <dd><p>A length value specifies an absolute font size
        (independent of the user agent's font table).
        Negative lengths are invalid.
    <p>A percentage value specifies an absolute font size relative
        to the parent element's font size. Use of percentage values, or
	  values in 'em's, leads to more robust and cascadable style sheets.
      Negative percentages are invalid.
  </dl>

<p>The following table provides user agent guidelines for the
absolute-size scaling factor and their mapping to HTML heading and
absolute font-sizes. The 'medium' value is used as the reference
middle value. The user agent may fine-tune these values for different
fonts or different types of display devices.</p>

<table class="data">
<thead>
  <th>CSS absolute-size values</th>
  <th>xx-small</td>
  <th>x-small</td>
  <th>small</td>
  <th>medium</td>
  <th>large</td>
  <th>x-large</td>
  <th>xx-large</td>
  <th>&nbsp;</td>
</thead>
<tbody>
  <tr>
    <th>scaling factor</th>
    <td>3/5</td>
    <td>3/4</td>
    <td>8/9</td>
    <td>1</td>
    <td>6/5</td>
    <td>3/2</td>
    <td>2/1</td>
    <td>3/1</td>
  </tr>
  <tr>
    <th>HTML headings</th>
    <td>h6</td>
    <td>&nbsp;</td>
    <td>h5</td>
    <td>h4</td>
    <td>h3</td>
    <td>h2</td>
    <td>h1</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <th>HTML font sizes</th>
    <td>1</td>
    <td>&nbsp;</td>
    <td>2</td>
    <td>3</td>
    <td>4</td>
    <td>5</td>
    <td>6</td>
    <td>7</td>
  </tr>
</tbody>
</table>

<p class="note"><em><strong>Note 1.</strong> To preserve readability, an UA applying
these guidelines should nevertheless avoid creating font-size resulting
in less than 9 device pixels per EM unit on a computer display.</em></p>

<p class="note"><em><strong>Note 2.</strong> In CSS1, the suggested
scaling factor between adjacent indexes was 1.5 which user experience
proved to be too large. In CSS2, the suggested scaling factor for computer
screen between adjacent indexes was 1.2 which still created issues for the small
sizes. The new scaling factor varies between each index to provide a better
readability.</em></p>

<p>The actual value of this property may differ from the computed
value due a numerical value on 'font-size-adjust' and the
unavailability of certain font sizes.</p>

<p>Child elements inherit the computed <a href="#font-size-prop" class="noxref">
<span class="property">'font-size'</span></a> value (otherwise, the
effect of <a href="#font-size-adjust-prop" class="noxref"><span
class="property">'font-size-adjust'</span></a> would compound).</p>

<div class="example"><p style="display:none">Example(s):</p>

<pre>p { font-size: 12pt; }
blockquote { font-size: larger }
em { font-size: 150% }
em { font-size: 1.5em }
</pre>
</div>


<!-- prop: font-size-adjust -->

<h3 id="font-size-adjust-prop">Relative sizing: the <a href="#propdef-font-size-adjust">font-size-adjust</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-size-adjust">font-size-adjust</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="none!!font-size-adjust">none</span> | <var>&lt;number&gt;</var></td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>none</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>as <a href="https://drafts.csswg.org/css-transitions/#animtype-number">number</a></td>
    </tr>
  </tbody>
</table>

<p>For any given font size, the apparent size and legibility of text
varies across fonts. For scripts such as Latin or Cyrillic that
distinguish between upper and lowercase letters, the relative height
of lowercase letters compared to their uppercase counterparts is a
determining factor of legibility. This is commonly referred to as the
<span class="index-def" title="aspect value"><dfn>aspect value</dfn></span>.
Precisely defined, it is equal to the x-height of a font divided by
the font size.</p>

<p>In situations where font fallback occurs, fallback fonts may not
share the same aspect value as the desired font family and will thus
appear less readable.  The 'font-size-adjust' property is a way to
preserve the readability of text when font fallback occurs.  It does
this by adjusting the font-size so that the x-height is the same
regardless of the font used.</p>

<div class="example">
<p>The style defined below defines Verdana as the desired font family, but if Verdana is not available Futura or Times
will be used.</p>

<pre>p {
    font-family: Verdana, Futura, Times;
}

&lt;p>Lorem ipsum dolor sit amet, ...&lt;/p>
</pre>

<p>Verdana has a relatively high aspect value, lowercase letters are relatively tall compared to uppercase
letters, so at small sizes text appears legible.  Times has a lower aspect value and so if fallback occurs,
the text will be less legible at small sizes than Verdana.</p>
</div>

<p>How text rendered in each of these fonts compares is shown below, the columns show text rendered in Verdana, Futura and Times.
The same font-size value is used across cells
within each row and red lines are included to show the differences in x-height.  In the upper half each row is rendered in the same font-size value.  The same is true
for the lower half but in this half the 'font-size-adjust' property is also set so that the actual font size is adjusted
to preserve the x-height across each row.  Note how small text remains relatively legible across each row in the lower half.</p>

<div class="figure"><img alt="text with and without 'font-size-adjust'" src="fontsizeadjust.png" /><p class="caption">Text with and without the use of 'font-size-adjust'</p></div>

<p>This property allows authors to specify an <i>aspect value</i> for an element that
will effectively preserve the x-height of the first choice font, whether it is substituted
or not. Values have the following meanings:

<dl>
<dt><dfn id="font-size-adjust-none-value" title="none!!font-size-adjust">none</dfn>
<dd>Do not preserve the font's x-height.

<dt><dfn data-dfn-type=value data-dfn-for=font-size-adjust id="aspect-ratio-value"><var>&lt;number&gt;</var></dfn>

<dd>Specifies the <i>aspect value</i> used in the calculation below to calculate the adjusted
font size:

<pre>c  =  ( a / a' ) s
</pre>

<p>where:</p>

<pre>s  =  font-size value
a  =  <i>aspect value</i> as specified by the 'font-size-adjust' property
a' =  <i>aspect value</i> of actual font
c  =  adjusted font-size to use
</pre>

<p>Negative values are invalid.</p>

<p>This value applies to any font that is selected but in typical usage it should be based
on the <i>aspect value</i> of the first font in the font-family list.  If this is specified accurately,
the <tt>(a/a')</tt> term in the formula above is effectively 1 for the first font and no adjustment occurs.
If the value is specified inaccurately, text rendered using the first font in the family
list will display differently in older user agents that don't support 'font-size-adjust'.</p>
</dl>

<p>The value of 'font-size-adjust' affects the used value of 'font-size' but
does not affect the computed value.  It affects the size of relative units
that are based on font metrics of the <i>first available font</i> such
as <code>ex</code> and <code>ch</code> but does not affect the size of
<code>em</code> units.  Since numeric values of
<a href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height">'line-height'</a>
refer to the computed size of 'font-size', 'font-size-adjust' does not affect the used value of
<a href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height">'line-height'</a>.
</p>

<p class="note">In CSS, authors often specify
<a href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height">'line-height'</a>
as a multiple of the 'font-size'.  Since the 'font-size-adjust'
property affects the used value of 'font-size', authors should take
care setting the line height when 'font-size-adjust' is used. Setting
the line height too tightly can result in overlapping lines of text
in this situation.</p>

<p>Authors can calculate the
<i>aspect value</i> for a given font by comparing spans with the same content but
different 'font-size-adjust' properties.  If the same font-size is used, the spans will match when the 'font-size-adjust'
value is accurate for the given font.</p>

<div class="example">
<p>Two spans with borders are used to determine the <i>aspect value</i> of a font.  The 'font-size' is the same for both spans but the
'font-size-adjust' property is specified only for the right span.  Starting with a value of 0.5, the aspect
 value can be adjusted until the borders around the two letters line up.</p>

<pre>p {
    font-family: Futura;
    font-size: 500px;
}

span {
    border: solid 1px red;
}

.adjust {
    font-size-adjust: 0.5;
}

&lt;p>&lt;span>b&lt;/span>&lt;span class="adjust">b&lt;/span>&lt;/p>
</pre>
<div class="figure"><img alt="Futura with an <i>aspect value</i> of 0.5" src="beforefontsizeadjust.png" /><p class="caption">Futura with an <i>aspect value</i> of 0.5</p></div>

<p>The box on the right is a bit bigger than the one on the left, so the <i>aspect value</i> of this font is something less than 0.5.
Adjust the value until the boxes align.</p>
</div>

<!-- prop: font -->

<h3 id="font-prop">Shorthand font property: the <a href="#propdef-font">font</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font">font</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>[ [ <var>&lt;<span title="font-style!!property">'font-style'</span>&gt;</var> || <var>&lt;font-variant-css21&gt;</var> ||
              <var>&lt;<span title="font-weight!!property">'font-weight'</span>&gt;</var> ||
              <var>&lt;<span title="font-stretch!!property">'font-stretch'</span>&gt;</var> ]? <var>&lt;'font-size'&gt;</var> [ / <var>&lt;'line-height'&gt;</var> ]? <var>&lt;<span title="font-family!!property">'font-family'</span>&gt;</var> ] | caption | icon | menu | message-box | small-caption | status-bar</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>see individual properties</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>see individual properties</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>see individual properties</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>see individual properties</td>
    </tr>
  </tbody>
</table>

<p>The <span class="property">'font'</span> property is, except as
described below, a shorthand property for setting <span title="font-style!!property">'font-style'</span>,
<span title="font-variant!!property">'font-variant'</span>,
<span title="font-weight!!property">'font-weight'</span>,
<span title="font-stretch!!property">'font-stretch'</span>,
<span class="property">'font-size'</span>, <a class="property" href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height">'line-height'</a>,
<span title="font-family!!property">'font-family'</span> at the same place in the
stylesheet.  Values for the <span title="font-variant!!property">'font-variant'</span>
property may also be included but only those supported in CSS 2.1, none
of the <span title="font-variant!!property">'font-variant'</span> values added in this specification can be used in
the <span class="property">'font'</span> shorthand:
</p>

<pre class="prod"><dfn id="font-variant-css21-values"><var>&lt;font-variant-css21&gt;</var></dfn> = [normal | small-caps]</pre>

<p>The syntax of this property is based on a traditional typographical
shorthand notation to set multiple properties related to fonts.
</p>

<p>All subproperties of the 'font' property are first reset to their initial values,
including those listed above plus
<span class="property">'font-size-adjust'</span>,
<span class="property">'font-kerning'</span>, subproperties of <span title="font-variant!!property">'font-variant'</span> and
and <span>'font-language-override'</span>.
Then, those properties that are given explicit values in the <span class="property">'font'</span>
shorthand are set to those values. For a definition of allowed and
initial values, see the previously defined properties. For reasons of
backwards compatibility, it is not possible to set <span class="property">'font-size-adjust'</span>
to anything other than its initial value using the <span class="property">'font'</span>
shorthand property; instead, use the individual property.
</p>

<div class="example"><p style="display:none">Example(s):</p>

<pre>p { font: 12pt/14pt sans-serif }
p { font: 80% sans-serif }
p { font: x-large/110% &quot;new century schoolbook&quot;, serif }
p { font: bold italic large Palatino, serif }
p { font: normal small-caps 120%/120% fantasy }
p { font: condensed oblique 12pt &quot;Helvetica Neue&quot;, serif; }
</pre>

<p> In the second rule, the font size percentage value ('80%') refers
to the computed 'font-size' of the parent element. In the third rule, the line
height percentage ('110%') refers to the font size of the element
itself.

<p>The first three rules do not specify the <span title="font-variant!!property">'font-variant'</span>
and <span title="font-weight!!property">'font-weight'</span> explicitly, so these properties
receive their initial values (<span title="normal value">'normal'</span>). Notice that the font family
name "new century schoolbook", which contains spaces, is enclosed in
quotes. The fourth rule sets the
<span title="font-weight!!property">'font-weight'</span> to 'bold', the
<span title="font-style!!property">'font-style'</span> to 'italic', and implicitly sets
<span title="font-variant!!property">'font-variant'</span> to <span title="normal!!font-variant">'normal'</span>.


<p> The fifth rule sets the <span title="font-variant!!property">'font-variant'</span> ('small-caps'),
the <span class="property">'font-size'</span> (120% of the
parent's font size), the <a class="property" href="https://www.w3.org/TR/CSS2/visudet.html#propdef-line-height">'line-height'</a> (120% of the font
size) and the <span title="font-family!!property">'font-family'</span>
('fantasy'). It follows that the keyword <span title="normal value">'normal'</span> applies to the two
remaining properties: <span title="font-style!!property">'font-style'</span> and <span title="font-weight!!property">'font-weight'</span>.


<p>The sixth rule sets the <span title="font-style!!property">'font-style'</span>, <span title="font-stretch!!property">'font-stretch'</span>,
<span class="property">'font-size'</span>, and <span title="font-family!!property">'font-family'</span>, the other font
properties being set to their initial values.
</div>

<p>Since the <span title="font-stretch!!property">'font-stretch'</span> property was not defined in CSS 2.1, when using <span title="font-stretch!!property">'font-stretch'</span>
values within 'font' rules, authors should include a extra version compatible with
older user agents:</p>

<pre>p {
  font: 80% sans-serif;   /* for older user agents */
  font: condensed 80% sans-serif;
}</pre>

<p>The following values refer to system fonts:</p>

<dl>
<dt><strong>caption</strong>
<dd>The font used for captioned controls (e.g., buttons, drop-downs, etc.).
<dt><strong>icon</strong>
<dd>The font used to label icons.
<dt><strong>menu</strong>
<dd>The font used in menus (e.g., dropdown menus and menu lists).
<dt><strong>message-box</strong>
<dd>The font used in dialog boxes.
<dt><strong>small-caption</strong>
<dd>The font used for labeling small controls.
<dt><strong>status-bar</strong>
<dd>The font used in window status bars.
</dl>

<p>System fonts may only be set as a whole; that is, the font
family, size, weight, style, etc. are all set at the same time.
These values may then be altered individually if desired.  If no
font with the indicated characteristics exists on a given platform,
the user agent should either intelligently substitute (e.g., a smaller
version of the 'caption' font might be used for the 'small-caption'
font), or substitute a user agent default font. As for regular fonts,
if, for a system font, any of the individual properties are not part
of the operating system's available user preferences, those properties
should be set to their initial values.

<p>That is why this property is "almost" a shorthand property: system
fonts can only be specified with this property, not with
<span title="font-family!!property">'font-family'</span> itself, so <span class="property">'font'</span>
allows authors to do more than the
sum of its subproperties. However, the individual properties such as
<span title="font-weight!!property">'font-weight'</span> are still given values
taken from the system font, which can be independently varied.</p>

<p>Note that the keywords used for the system fonts listed above are
only treated as keywords when they occur in the initial position, in
other positions the same string is treated as part of the font family
name:</p>

<pre>  font: menu;        /* use the font settings for system menus */
  font: large menu;  /* use a font family named "menu" */</pre>

<div class="example"><p style="display:none">Example(s):</p>

<pre>button { font: 300 italic 1.3em/1.7em &quot;FB Armada&quot;, sans-serif }
button p { font: menu }
button p em { font-weight: bolder }
</pre>

<p>If the font used for dropdown menus on a particular system
happened to be, for example, 9-point Charcoal, with a weight of 600, then P
elements that were descendants of BUTTON would be displayed as if
this rule were in effect:

<pre>button p { font: 600 9pt Charcoal }
</pre>

<p>Because the <span
class="property">'font'</span> shorthand resets to its initial value
any property not explicitly given a value, this has the same effect as
this declaration:

<pre>button p {
  font-style: normal;
  font-variant: normal;
  font-weight: 600;
  font-size: 9pt;
  line-height: normal;
  font-family: Charcoal
}
</pre>

</div>

<!-- prop: font-synthesis -->

<h3 id="font-synthesis-prop">Controlling synthetic faces: the <a href="#propdef-font-synthesis">font-synthesis</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-synthesis">font-synthesis</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>none | [ weight || style ]</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>weight style</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>This property controls whether user agents are allowed to synthesize bold or oblique font
faces when a font family lacks bold or italic faces.  If 'weight' is not specified, user agents
must not synthesize bold faces and if 'style' is not specified user agents must not synthesize
italic faces.  A value of 'none' disallows all synthetic faces.</p>

<div class="example">
<p>The style rule below disables the use of synthetically obliqued Arabic:</p>
</p>

<pre>*:lang(ar) { font-synthesis: none; }
</pre>

</div>

<h2 id="font-resources">Font Resources</h2>

<h3 id="font-face-rule">The <dfn id="at-font-face-rule" style="font-weight: inherit; font-style: inherit"><code>@font-face</code></dfn> rule</h3>

<p>The <code>@font-face</code> rule allows for linking to fonts that are
automatically fetched and activated when needed.  This allows authors to select
a font that closely matches the design goals for a given page
rather than limiting the font choice to a set of fonts available
on a given platform.  A set of font descriptors define the location of a font
resource, either locally or externally, along with the style characteristics of
an individual face.  Multiple <code>@font-face</code> rules can be used to construct
font families with a variety of faces.  Using CSS font matching rules, a
user agent can selectively download only those faces that are needed for
a given piece of text.
</p>

<p>The <code>@font-face</code> rule consists of the <code>@font-face</code> at-keyword followed
by a block of descriptor declarations. In terms of the grammar, this
specification defines the following productions:</p>

<pre><dfn>font_face_rule</dfn>
  : <i>FONT_FACE_SYM</i> <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* '{' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <i>descriptor_declaration</i>? [ ';' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <i>descriptor_declaration</i>? ]* '}' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>*
  ;

<dfn>descriptor_declaration</dfn>
  : <a href="https://www.w3.org/TR/CSS21/grammar.html#grammar"><i>property</i></a> ':' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <a href="https://www.w3.org/TR/CSS21/grammar.html#grammar"><i>expr</i></a>
  ;</pre>

<p>The following new definitions are introduced:</p>
<pre>-    -|\\0{0,4}2d(\r\n|[ \t\r\n\f])?
F    f|\\0{0,4}(46|66)(\r\n|[ \t\r\n\f])?</pre>

<p>The following new token is introduced:</p>

<pre>@{F}{O}{N}{T}{-}{F}{A}{C}{E} {return <dfn>FONT_FACE_SYM</dfn>;}</pre>

<p>Each <code>@font-face</code>
rule specifies a value for every font descriptor, either implicitly or
explicitly. Those not given explicit values in the rule take the initial
value listed with each descriptor in this specification. These
descriptors apply solely within the context of the <code>@font-face</code> rule in
which they are defined, and do not apply to document language elements.
There is no notion of which elements the descriptors apply to or whether
the values are inherited by child elements.  When a given descriptor occurs
multiple times in a given <code>@font-face</code> rule, only the last
descriptor declaration is used and all prior declarations for that
descriptor are ignored.</p>

<div class="example">
<p>To use a downloadable font called Gentium:</p>
<pre>
@font-face {
  font-family: Gentium;
  src: url(http://example.com/fonts/Gentium.woff);
}

p { font-family: Gentium, serif; }
</pre>

<p>The user agent will download Gentium and use it when rendering text
within paragraph elements.  If for some reason the site serving the font
is unavailable, the default serif font will be used.</p>
</div>

<p>A given set of <code>@font-face</code> rules define a set of fonts
available for use within the documents that contain these rules.
When font matching is done, fonts defined using these rules
are considered before other available fonts on a system.</p>

<p>Downloaded fonts are only available to documents that reference them.
The process of activating these fonts must not make them available to
other applications or to documents that don't directly link to the same
font. User agent implementers might consider it convenient to use
downloaded fonts when rendering characters in other documents for which no
other available font exists as part of the <em>system font fallback</em> procedure.
However, this would cause a security leak since the contents of one page would be
able to affect other pages, something an attacker could use as an attack
vector.  These restrictions do not affect caching behavior, fonts are
cached the same way other web resources are cached.
</p>

<p>This at-rule follows the forward-compatible parsing rules of CSS.
Like properties in a declaration block, declarations of any
descriptors that are not supported by the user agent must be ignored.
<code>@font-face</code> rules require a font-family and src
descriptor; if either of these are missing, the
<code>@font-face</code> rule is invalid and must be ignored
entirely.</p>

<p>In cases where user agents have limited platform resources or implement
the ability to disable downloadable font resources, <code>@font-face</code> rules must
simply be ignored; the behavior of individual descriptors as defined in this
specification should not be altered.
</p>

<h3 id="font-family-desc">Font family: the <a href="#descdef-font-family">font-family</a> descriptor</h3>
<table class="descdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="descdef-font-family" title="font-family!!descriptor">font-family</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><var>&lt;family-name&gt;</var></td>
    </tr>
    <tr>
      <td><em>Initial:</em></td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>

<p>This descriptor defines the font family name that will be used in
all CSS font family name matching.  It is required for the <code>@font-face</code>
rule to be valid. It overrides the font family names contained in the
underlying font data. If the font family name is the same as a font
family available in a given user's environment, it effectively hides
the underlying font for documents that use the stylesheet.  This
permits a web author to freely choose font-family names without
worrying about conflicts with font family names present in a given
user's environment. Likewise, platform substitutions for a given font
family name must not be used.</p>

<h3 id="src-desc">Font reference: the <a href="#descdef-src">src</a> descriptor</h3>
<table class="descdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="descdef-src">src</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>[ &lt;url> [format(&lt;string> #)]? | <var>&lt;font-face-name&gt;</var>  ] #</td>
    </tr>
    <tr>
      <td><em>Initial:</em></td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>

<p>This descriptor specifies the resource containing font data. It is
required for the <code>@font-face</code> rule to be valid. Its value
is a  prioritized, comma-separated list of external references or
locally-installed font face names. When a font is needed the user
agent iterates over the set of references listed, using the first one
it can successfully activate. Fonts containing invalid data or local
font faces that are not found are ignored and the user agent loads the
next font in the list.</p>

<p>As with other URLs in CSS, the URL may be relative, in which case it
is resolved relative to the location of the style sheet containing the
<code>@font-face</code> rule. In
the case of SVG fonts, the URL points to an element within a document
containing SVG font definitions.  If the element reference is omitted,
a reference to the first defined font is implied.  Similarly, font
container formats that can contain more than one font must load one
and only one of the fonts for a given <code>@font-face</code> rule. Fragment
identifiers are used to indicate which font to load.  If a container
format lacks a defined fragment identifier scheme, implementations
should use a simple 1-based indexing scheme (e.g. "font-collection#1"
for the first font, "font-collection#2" for the second font).</p>

<pre>
src: url(fonts/simple.woff);   /* load simple.woff relative to stylesheet location */
src: url(/fonts/simple.woff);  /* load simple.woff from absolute location */
src: url(fonts.svg#simple);    /* load SVG font with id 'simple' */
</pre>

<p>External references consist of a URL, followed by an optional hint
describing the format of the font resource referenced by that URL. The
format hint contains a comma-separated list of format strings that
denote well-known font formats. Conformant user agents must skip
downloading a font resource if the format hints indicate only
unsupported or unknown font formats.  If no format hints are supplied,
the user agent should download the font resource.</p>

<pre>
/* load WOFF font if possible, otherwise use OpenType font */
@font-face {
  font-family: bodytext;
  src: url(ideal-sans-serif.woff) format("woff"),
       url(basic-sans-serif.ttf) format("opentype");
}
</pre>

<p>Format strings defined by this specification:
</p>

<table class="data" id="fontformats">
<thead>
<tr>
  <th>String</th>
  <th>Font Format</th>
  <th>Common extensions</th>
</tr>
</thead>
<tbody>
<tr>
  <th>"woff"</th>
  <td><a href="https://www.w3.org/TR/WOFF/">WOFF (Web Open Font Format)</a></td>
  <td>.woff</td>
</tr>
<tr>
  <th>"truetype"</th>
  <td><a href="https://www.microsoft.com/typography/otspec/default.htm">TrueType</a></td>
  <td>.ttf</td>
</tr>
<tr>
  <th>"opentype"</th>
  <td><a href="https://www.microsoft.com/typography/otspec/default.htm">OpenType</a></td>
  <td>.ttf, .otf</td>
</tr>
<tr>
  <th>"embedded-opentype"</th>
  <td><a href="https://www.w3.org/Submission/2008/SUBM-EOT-20080305/">Embedded OpenType</a></td>
  <td>.eot</td>
</tr>
<tr>
  <th>"svg"</th>
  <td><a href="https://www.w3.org/TR/SVG/fonts.html">SVG Font</a></td>
  <td>.svg, .svgz</td>
</tr>
</tbody>
</table>

<p>Given the overlap in common usage between TrueType and OpenType, the
format hints "truetype" and "opentype" must be considered as synonymous;
a format hint of "opentype" does not imply that the font contains
Postscript CFF style glyph data or that it contains OpenType layout
information (see <a href="#platform-props-to-css">Appendix A</a> for more background on this).
</p>

<p>When authors would prefer to use a locally available
copy of a given font and download it if it's not, <code>local()</code>
can be used. The locally-installed <dfn id="font-face-name-value"><var>&lt;font-face-name&gt;</var></dfn>
argument to <code>local()</code> is a format-specific string that
uniquely identifies a single font face within a larger family.  The
syntax for a <var>&lt;font-face-name&gt;</var> is a unique font face
name enclosed by "local(" and ")".  The name can optionally be
enclosed in quotes.  If unquoted, the unquoted font family name
processing conventions apply; the name must be a sequence of
identifiers separated by <a href="https://www.w3.org/TR/css3-syntax/#whitespace">whitespace</a>
which is converted to a string by joining the identifiers together
separated by a single space.</p>

<pre>
/* regular face of Gentium */
@font-face {
  font-family: MyGentium;
  src: local(Gentium),    /* use locally available Gentium */
       url(Gentium.woff); /* otherwise, download it */
}
</pre>

<p>For OpenType and TrueType fonts, this string is used to match only
the Postscript name or the full font name in the name table of locally
available fonts. Which type of name is used varies by platform and
font, so authors should include both of these names to assure proper
matching across platforms. Platform substitutions for a given font
name must not be used.</p>

<pre>
/* bold face of Gentium */
@font-face {
  font-family: MyGentium;
  src: local(Gentium Bold),    /* full font name */
       local(Gentium-Bold),    /* Postscript name */
       url(GentiumBold.woff);  /* otherwise, download it */
  font-weight: bold;
}
</pre>

<p>Just as a <code>@font-face</code> rule specifies the characteristics of a single font
within a family, the unique name used with <code>local()</code> specifies a single
font, not an entire font family. Defined in terms of
OpenType font data, the Postscript name is found in the font's
<a href="https://www.microsoft.com/typography/otspec/name.htm">name table</a>,
in the name record with nameID = 6 (see
[[!OPENTYPE]] for more details).  The Postscript name is the commonly
used key for all fonts on OSX and for Postscript CFF fonts under
Windows. The full font name (nameID = 4) is used as a unique key for
fonts with TrueType glyphs on Windows.
</p>

<p>For OpenType fonts with multiple localizations of the full font name, the US
English version is used (language ID = 0x409 for Windows and language ID = 0 for Macintosh)
or the first localization
when a US English full font name is not available (the OpenType
specification recommends that <a
href="https://www.microsoft.com/typography/otspec/recom.htm">all fonts
minimally include US English names</a>). User agents that also match
other full font names, e.g. matching the Dutch name when the current
system locale is set to Dutch, are considered non-conformant. This is
done not to prefer English but to avoid matching inconsistencies across
font versions and OS localizations, since font style names (e.g. "Bold")
are frequently localized into many languages and the set of
localizations available varies widely across platform and font version.
User agents that match a concatenation of family name (nameID = 1) with
style name (nameID = 2) are considered non-conformant.
</p>

<p>This also allows for referencing faces that belong to larger
families that cannot otherwise be referenced.
</p>

<div class="example">
<p>Use a local font or reference an SVG font in another document:</p>
<pre>
@font-face {
  font-family: Headline;
  src: local(Futura-Medium),
       url(fonts.svg#MyGeometricModern) format("svg");
}
</pre>
<p>Create an alias for local Japanese fonts on different platforms:</p>
<pre>
@font-face {
  font-family: jpgothic;
  src: local(HiraKakuPro-W3), local(Meiryo), local(IPAPGothic);
}
</pre>
<p>Reference a font face that cannot be matched within a larger family:</p>
<pre>
@font-face {
  font-family: Hoefler Text Ornaments;
  /* has the same font properties as Hoefler Text Regular */
  src: local(HoeflerText-Ornaments);
}
</pre>

<p>Since localized fullnames never match, a document with the header
style rules below would always render using the default serif font, regardless
whether a particular system locale parameter is set to Finnish or not:</p>
<pre>
@font-face {
  font-family: SectionHeader;
  src: local("Arial Lihavoitu");  /* Finnish fullname for Arial Bold, should fail */
  font-weight: bold;
}

h2 { font-family: SectionHeader, serif; }
</pre>

<p>A conformant user agent would never load the font 'gentium.eot' in the
example below, since it is included in the first definition of the 'src' descriptor
which is overridden by the second definition in the same <code>@font-face</code> rule:</p>

<pre>
@font-face {
  font-family: MainText;
  src: url(gentium.eot);                     /* for use with older user agents */
  src: local("Gentium"), url(gentium.woff);  /* Overrides src definition */
}
</pre>
</div>

<h3 id="font-prop-desc">Font property descriptors: the
<a href="#descdef-font-style">font-style</a>, <a href="#descdef-font-weight">font-weight</a>,
<a href="#descdef-font-stretch">font-stretch</a> descriptors</h3>
<table class="descdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="descdef-font-style" title="font-style!!descriptor">font-style</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>normal | italic | oblique</td>
    </tr>
    <tr>
      <td><em>Initial:</em></td>
      <td>normal</td>
    </tr>
  </tbody>
</table>

<table class="descdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="descdef-font-weight" title="font-weight!!descriptor">font-weight</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>normal | bold | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900</td>
    </tr>
    <tr>
      <td><em>Initial:</em></td>
      <td>normal</td>
    </tr>
  </tbody>
</table>

<table class="descdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="descdef-font-stretch" title="font-stretch!!descriptor">font-stretch</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>normal | ultra-condensed | extra-condensed | condensed | semi-condensed |
          semi-expanded | expanded | extra-expanded | ultra-expanded</td>
    </tr>
    <tr>
      <td><em>Initial:</em></td>
      <td>normal</td>
    </tr>
  </tbody>
</table>

<p>These descriptors define the characteristics of a font face and are
used in the process of matching styles to specific faces.  For a font
family defined with several <code>@font-face</code> rules, user agents can either
download all faces in the family or use these descriptors to selectively
download font faces that match actual styles used in document.  The
values for these descriptors are the same as those for the corresponding
font properties except that relative keywords are not allowed, 'bolder' and
'lighter'.  If these descriptors are omitted, initial
values are assumed.
</p>

<p>The value for these font face style attributes is used in place of
the style implied by the underlying font data.  This allows authors to
combine faces in flexible combinations, even in situations where the
original font data was arranged differently. User agents that implement
synthetic bolding and obliquing must only apply synthetic styling in
cases where the font descriptors imply this is needed, rather than based
on the style attributes implied by the font data.
</p>

<div class="example">
<p>The font descriptors defined in this section are used for selecting a font
from within the set of fonts defined by <code>@font-face</code> rules for
a given family.</p>

<p>Consider a family containing a single, regular face:</p>

<pre>
@font-face {
  font-family: BaskervilleSimple;
  src: url(baskerville-regular.woff);
}
</pre>

<p>Unstyled text would display using the regular face defined in the
<code>@font-face</code> rule:</p>

<div class="figure"><img alt="regular face display" src="fiddlesticks-regular.png" width="373" /></div>

<p>However, italic text would display in most user agents using synthetically
obliqued glyphs from the regular face, since a separate italic face is not defined:</p>

<div class="figure"><img alt="synthetic italics display" src="fiddlesticks-synitalics.png" width="373" /></div>

<p>Now consider a family for which an actual italic face is defined:</p>
<pre>
@font-face {
  font-family: BaskervilleFull;
  src: url(baskerville-regular.woff);
}

@font-face {
  font-family: BaskervilleFull;
  src: url(baskerville-italic.woff);
  font-style: italic;
}
</pre>

<p>The second <code>@font-face</code> rule defines the font resource
<code>baskerville-italic.woff</code> to have style attributes of
normal weight, normal stretch and italic style. When displaying italic
text, the user agent will use this font, since it's the closest
match for italic text. Thus, the text will display using glyphs
designed by a type designer rather than using synthetically obliqued
glyphs from the regular face:</p>

<div class="figure"><img alt="real italics display" src="fiddlesticks-italics.png" width="373" /></div>

<p>See the section on <a href="#font-style-matching">font matching</a>
for more complete details of the process used to select a particular
face within a font family.</p>
</div>

<h3 id="unicode-range-desc">Character range: the <a href="#descdef-unicode-range">unicode-range</a> descriptor</h3>
<table class="descdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="descdef-unicode-range">unicode-range</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><var>&lt;urange&gt;</var> #</td>
    </tr>
    <tr>
      <td><em>Initial:</em></td>
      <td>U+0-10FFFF</td>
    </tr>
  </tbody>
</table>

<p>This descriptor defines the set of Unicode codepoints that may be
supported by the font face for which it is declared.  The descriptor
value is a comma-delimited list of Unicode range (<var>&lt;urange&gt;</var>)
values. The union of these ranges defines the set of codepoints that
serves as a hint for user agents when deciding whether or not to
download a font resource for a given text run.</p>

<p>Each <dfn data-dfn-type=value data-dfn-for=unicode-range id="urange-value"><var>&lt;urange&gt;</var></dfn> value is a
<a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><code title="UNICODE-RANGE token">UNICODE-RANGE</code></a>
token made up of a "U+" or "u+" prefix
followed by a codepoint range in one of the three forms listed below.
Ranges that do not fit one of the these forms are invalid
and cause the declaration to be ignored.</p>

<dl>
  <dt>single codepoint (e.g. U+416)</dt>
  <dd>a Unicode codepoint, represented as one to six hexadecimal digits</dd>
  <dt>interval range (e.g. U+400-4ff)</dt>
  <dd>represented as two hyphen-separated Unicode codepoints
    indicating the inclusive start and end codepoints of a range</dd>
  <dt>wildcard range (e.g. U+4??)</dt>
  <dd>defined by the set of codepoints implied when
      trailing '?' characters signify any hexadeximal digit</dd>
</dl>

<p>Individual codepoints are written using hexadecimal values that correspond to
<a href="https://www.unicode.org/charts/">Unicode character codepoints</a>.
Unicode codepoint values must be between 0 and 10FFFF inclusive. Digit
values of codepoints are ASCII case-insensitive.  For interval ranges,
the start and end codepoints must be within the range noted above and
the end codepoint must be greater than or equal to the start
codepoint.</p>

<p>Wildcard ranges specified with ‘?’ that lack an
initial digit (e.g. "U+???") are valid and equivalent
to a wildcard range with an initial zero digit (e.g. "U+0???" = "U+0000-0FFF").
Wildcard ranges that extend beyond the range of
Unicode codepoints are invalid.  Because of this, the maximum
number of trailing '?' wildcard characters is five, even though the
<a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><code title="UNICODE-RANGE token">UNICODE-RANGE</code></a>
token accepts six.</p>

<p>Within the comma-delimited list of Unicode ranges in a
'unicode-range' descriptor declaration, ranges may overlap. The union
of these ranges defines the set of codepoints for which the
corresponding font may be used. User agents must not download or use
the font for codepoints outside this set.  User agents may normalize
the list of ranges into a list that is different but represents the
same set of codepoints.</p>

<p>The associated font might not contain glyphs for the entire set of
codepoints defined by the 'unicode-range' descriptor.  When the font
is used, the <dfn>effective character map</dfn> is the intersection of the
codepoints defined by 'unicode-range' with the font's <em>character map</em>.
This allows authors to define supported ranges in terms of broad
ranges without worrying about the precise codepoint ranges supported
by the underlying font.</p>

<h3 id="composite-fonts">Using character ranges to define composite fonts</h3>

<p>Multiple <code>@font-face</code> rules with different unicode ranges for the same
family and style descriptor values can be used to create composite fonts
that mix the glyphs from different fonts for different scripts.  This
can be used to combine fonts that only contain glyphs for a single
script (e.g. Latin, Greek, Cyrillic) or it can be used by authors as a
way of segmenting a font into fonts for commonly used characters and
less frequently used characters. Since the user agent will only pull
down the fonts it needs this helps reduce page bandwidth.
</p>

<p>If the unicode ranges overlap for a set of <code>@font-face</code> rules with the
same family and style descriptor values, the rules are ordered in the
reverse order they were defined; the last rule defined is the first to
be checked for a given character.
</p>


<p>Example ranges for specific languages or characters:</p>

<dl>
  <dt>unicode-range: U+A5;</dt>
  <dd>a single code point, the yen/yuan symbol</dd>

  <dt>unicode-range: U+0-7F;</dt>
  <dd>code range for basic ASCII characters</dd>

  <dt>unicode-range: U+590-5ff;</dt>
  <dd>code range for Hebrew characters</dd>

  <dt>unicode-range: U+A5, U+4E00-9FFF, U+30??, U+FF00-FF9F;</dt>
  <dd>code range for Japanese kanji, hiragana and katakana characters plus yen/yuan symbol</dd>
</dl>

<div class="example">
<p>The BBC provides news services in a wide variety of languages, many
that are not well supported across all platforms. Using an <code>@font-face</code>
rule, the BBC could provide a font for any of these languages, as it
already does via a manual font download.</p>
<pre>
@font-face {
  font-family: BBCBengali;
  src: url(fonts/BBCBengali.woff) format("woff");
  unicode-range: U+00-FF, U+980-9FF;
}
</pre>
</div>

<div class="example">
<p>Technical documents often require a wide range of symbols.  The STIX
Fonts project is one project aimed at providing fonts to support a wide
range of technical typesetting in a standardized way.  The example below
shows the use of a font that provides glyphs for many of the
mathematical and technical symbol ranges within Unicode:
</p>
<pre>
@font-face {
  font-family: STIXGeneral;
  src: local(STIXGeneral), url(/stixfonts/STIXGeneral.otf);
  unicode-range: U+000-49F, U+2000-27FF, U+2900-2BFF, U+1D400-1D7FF;
}
</pre>
</div>

<div class="example">
<p>This example shows how an author can override the glyphs used for
Latin characters in a Japanese font with glyphs from a different font.
The first rule specifies no range so it defaults to the entire range.
The range specified in the second rule overlaps but takes precedence
because it is defined later.
</p>

<pre>
@font-face {
  font-family: JapaneseWithGentium;
  src: local(MSMincho);
  /* no range specified, defaults to entire range */
}

@font-face {
  font-family: JapaneseWithGentium;
  src: url(../fonts/Gentium.woff);
  unicode-range: U+0-2FF;
}
</pre>
</div>

<div class="example">
<p>Consider a family constructed to optimize bandwidth by separating out
Latin, Japanese and other characters into different font files:
</p>

<pre>
/* fallback font - size: 4.5MB */
@font-face {
  font-family: DroidSans;
  src: url(DroidSansFallback.woff);
  /* no range specified, defaults to entire range */
}

/* Japanese glyphs - size: 1.2MB */
@font-face {
  font-family: DroidSans;
  src: url(DroidSansJapanese.woff);
  unicode-range: U+3000-9FFF, U+ff??;
}

/* Latin, Greek, Cyrillic along with some
   punctuation and symbols - size: 190KB */
@font-face {
  font-family: DroidSans;
  src: url(DroidSans.woff);
  unicode-range: U+000-5FF, U+1e00-1fff, U+2000-2300;
}
</pre>

<p>For simple Latin text, only the font for Latin characters is downloaded:</p>

<pre>
body { font-family: DroidSans; }

&lt;p>This is that&lt;/p>
</pre>

<p>In this case the user agent first checks the unicode-range for the
font containing Latin characters (DroidSans.woff).  Since all the
characters above are in the range U+0-5FF, the user agent downloads the
font and renders the text with that font.
</p>

<p>Next, consider text that makes use of an arrow character (&#x21e8;):</p>

<pre>
&lt;p>This &amp;#x21e8; that&lt;p>
</pre>

<p>The user agent again first checks the unicode-range of the font
containing Latin characters.  Since U+2000-2300 includes the arrow
code point (U+21E8), the user agent downloads the font.  For this
character however the Latin font does not have a matching glyph, so the
effective unicode-range used for font matching excludes this code point.
Next, the user agent evaluates the Japanese font.  The unicode-range for
the Japanese font, U+3000-9FFF and U+ff??, does not include U+21E8, so
the user agent does not download the Japanese font.
Next the fallback font is considered.  The <code>@font-face</code> rule for the
fallback font does not define unicode-range so its value defaults to
the range of all Unicode code points. The fallback font is downloaded and
used to render the arrow character.
</p>

</div>

<h3 id="font-rend-desc">Font features: the <a href="#descdef-font-variant">font-variant</a> and <a href="#descdef-font-feature-settings">font-feature-settings</a> descriptors</h3>
<table class="descdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="descdef-font-variant" title="font-variant!!descriptor">font-variant</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-variant">normal</span> | <span title="none!!font-variant">none</span> |
        [ <var>&lt;common-lig-values&gt;</var> || <var>&lt;discretionary-lig-values&gt;</var> || <var>&lt;historical-lig-values&gt;</var> ||
        <var>&lt;contextual-alt-values&gt;</var> || <var title="stylistic">stylistic(&lt;feature-value-name&gt;)</var> || <var>historical-forms</var> ||
        <var title="styleset">styleset(&lt;feature-value-name&gt; #)</var> ||
        <var title="character-variant">character-variant(&lt;feature-value-name&gt; #)</var> ||
        <var title="swash">swash(&lt;feature-value-name&gt;)</var> || <var title="ornaments">ornaments(&lt;feature-value-name&gt;)</var> ||
        <var title="annotation">annotation(&lt;feature-value-name&gt;)</var> ||
        [ <i>small-caps</i> | <i>all-small-caps</i> | <i>petite-caps</i> | <i>all-petite-caps</i> | <i>unicase</i> | <i>titling-caps</i> ] ||
        <var>&lt;numeric-figure-values&gt;</var> || <var>&lt;numeric-spacing-values&gt;</var> || <var>&lt;numeric-fraction-values&gt;</var> || <i>ordinal</i> || <i>slashed-zero</i> ||
        <var>&lt;east-asian-variant-values&gt;</var> || <var>&lt;east-asian-width-values&gt;</var> || <i>ruby</i> ||
        [ <i>sub</i> | <i>super</i> ] ]</td>
    </tr>
    <tr>
      <td><em>Initial:</em></td>
      <td>normal</td>
    </tr>
  </tbody>
</table>

<table class="descdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="descdef-font-feature-settings" title="font-feature-settings!!descriptor">font-feature-settings</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-feature-settings">normal</span> | <var>&lt;feature-tag-value&gt;</var> #</td>
    </tr>
    <tr>
      <td><em>Initial:</em></td>
      <td>normal</td>
    </tr>
  </tbody>
</table>

<p>These descriptors define initial settings that apply when the font defined by
an <code>@font-face</code> rule is rendered.  They do not affect font selection.
Values are identical to those defined for the corresponding
<span title="font-variant!!property">'font-variant'</span> and <span title="font-feature-settings!!property">'font-feature-settings'</span> properties defined below
except that the value 'inherit' is omitted.  When multiple font
feature descriptors or properties are used, the cumulative effect on
text rendering is detailed in the section
<a href="#font-feature-resolution">Font Feature Resolution</a> below.
In cases where specific values define synthesized fallback for certain
<span title="font-variant!!property">'font-variant'</span> subproperties, the same synthesized fallback
applies when used within those values are used with the
<span title="font-style!!descriptor">'font-variant'</span> descriptor.
</p>

<h3 id="font-face-loading">Font loading guidelines</h3>

<p>The <code>@font-face</code> rule is designed to allow lazy loading
of font resources that are only downloaded when used within a
document.  A stylesheet can include <code>@font-face</code> rules for
a library of fonts of which only a select set are used; user agents
must only download those fonts that are referred to within the style
rules applicable to a given page.  User agents that download all fonts
defined in <code>@font-face</code> rules without considering whether
those fonts are in fact used within a page are considered
non-conformant. In cases where a font might be downloaded in character
fallback cases, user agents may download a font if it's contained within
the computed value of <span title="font-family!!property">'font-family'</span>
for a given text run.
</p>

<pre>
@font-face {
  font-family: GeometricModern;
  src: url(font.woff);
}

p {
  /* font will be downloaded for pages with p elements */
  font-family: GeometricModern, sans-serif;
}

h2 {
  /* font may be downloaded for pages with h2 elements, even if Futura is available locally */
  font-family: Futura, GeometricModern, sans-serif;
}
</pre>

<p>In cases where textual content is loaded before downloadable fonts
are available, user agents may render text as it would be rendered if
downloadable font resources are not available or they may render text
transparently with fallback fonts to avoid a flash of text using a
fallback font.  In cases where the font download fails user agents must
display text, simply leaving transparent text is considered
non-conformant behavior.  Authors are advised to use fallback fonts in
their font lists that closely match the metrics of the
downloadable fonts to avoid large page reflows where possible.
</p>

<a id="same-origin-restriction">
<a id="allowing-cross-origin-font-loading">
<h3 id="font-fetching-requirements">Font fetching requirements</h3>

<!-- TPAC 2011 Resolution to require same-origin restriction for loading fonts:
  http://lists.w3.org/Archives/Public/www-style/2011Nov/0711.html
  http://www.w3.org/2011/10/31-webapps-minutes.html#item02
-->

<p>For font loads, user agents must use the
<a href="https://www.w3.org/TR/html5/infrastructure.html#cors-enabled-fetch">potentially CORS-enabled fetch</a>
method defined by the [[!HTML5]] specification for URL's defined
within @font-face rules. When fetching, user agents must use
"Anonymous" mode, set the referrer source to the stylesheet's URL and
set the origin to the URL of the containing document.</p>

<p class="note">The implications of this for authors are that fonts
will typically not be loaded cross-origin unless authors specifically
takes steps to permit cross-origin loads. Sites can explicitly allow
cross-site loading of font data using the <code>Access-Control-Allow-Origin</code>
HTTP header.  For other schemes, no explicit mechanism to allow
cross-origin loading, beyond what is permitted by the
<a href="https://www.w3.org/TR/html5/infrastructure.html#cors-enabled-fetch">potentially CORS-enabled fetch</a>
method, is defined or required.</p>

<div class="example">
For the examples given below, assume that a document is located at
<code>https://example.com/page.html</code> and all URL's link to valid
font resources supported by the user agent.

Fonts defined with the 'src' descriptor values below will be loaded:

<pre>/* same origin (i.e. domain, scheme, port match document) */
src: url(fonts/simple.woff);

/* data url's with no redirects are treated as same origin */
src: url("data:application/font-woff;base64,...");

/* cross origin, different domain */
/* Access-Control-Allow-Origin response header set to '*' */
src: url(http://another.example.com/fonts/simple.woff);
</pre>

Fonts defined with the 'src' descriptor values below will fail to load:

<pre>/* cross origin, different scheme */
/* no Access-Control-xxx headers in response */
src: url(https://example.com/fonts/simple.woff);

/* cross origin, different domain */
/* no Access-Control-xxx headers in response */
src: url(http://another.example.com/fonts/simple.woff);
</pre>
</div>

<h2 id="font-matching-algorithm">Font Matching Algorithm</h2>

<p>The algorithm below describes how fonts are associated with
individual runs of text.  For each character in the run a font
family is chosen and a particular font face is selected
containing a glyph for that character.</p>

<h3 id="font-family-casing">Case sensitivity of font family names</h3>

<p>As part of the font matching algorithm outlined below, user agents must
match font family names used in style rules with actual font family names
contained in fonts available in a given environment or with font family names defined in
<code>@font-face</code> rules.  User agents must match these names case
insensitively, using the "Default Caseless Matching" algorithm outlined
in the Unicode specification [[!UNICODE]].  This algorithm is detailed
in section 3.13 entitled "Default Case Algorithms".  Specifically, the
algorithm must be applied without normalizing the strings involved and
without applying any language-specific tailorings.  The case folding
method specified by this algorithm uses the case mappings with status field
'C' or 'F' in the CaseFolding.txt file of the Unicode Character Database.
</p>

<p class="note">
For authors this means that font family names are matched case
insensitively, whether those names exist in a platform font or
in the <code>@font-face</code> rules contained in a stylesheet.
Authors should take care to ensure that names use a character sequence
consistent with the actual font family name, particularly when using
combining characters such as diacritical marks. For example, a family
name that contains a lowercase a (U+0061) followed by a combining
ring (U+030A) will <strong>not</strong> match a name that looks
identical but which uses the precomposed lowercase a-ring character
(U+00E5) instead of the combining sequence.</p>

<p class="note">
Implementors should take care to verify that a given caseless string comparison
implementation uses this precise algorithm and not assume that a given
platform string matching routine follows it, as many of these have
locale-specific behavior or use some level of string normalization.</p>

<h3 id="font-style-matching">Matching font styles</h3>

<p>The procedure for choosing a font for a given character in a run of
text consists of iterating over the font families named by the <span
title="font-family!!property">'font-family'</span> property, selecting
a font face with the appropriate style based on other font properties
and then determining whether a glyph exists for the given character.
This is done using the <dfn>character map</dfn> of the font, data
which maps characters to the default glyph for that character. A font
is considered to <dfn>support</dfn> a given character if (1) the
character is contained in the font's <em>character map</em> and (2) if
required by the containing script, shaping information is available
for that character.</p>

<p>Some legacy fonts may include a given character
in the <em>character map</em> but lack the shaping information (e.g.
<a href="https://www.microsoft.com/typography/otspec/ttochap1.htm">OpenType layout tables</a> or
<a href="https://scripts.sil.org/cms/scripts/page.php?site_id=projects&amp;item_id=graphite_techAbout">Graphite tables</a>)
necessary for correctly rendering text runs containing that character.</p>

<p>Codepoint sequences consisting of a base character followed by a
sequence of combining characters are treated slightly differently, see
the section on <a href="#cluster-matching">cluster matching</a>
below.</p>

<p>For this procedure, the <dfn>default face</dfn> for a given font
family is defined to be the face that would be selected if all font
style properties were set to their initial value.</p>

<ol id="fontmatchingalg">

  <li>Using the computed font property values for a given element,
  the user agent starts with the first family name
  specified by the <span title="font-family!!property">'font-family'</span> property.
  </li>

  <li>If the family name is a generic family keyword, the user agent
  looks up the appropriate font family name to be used.  User
  agents may choose the generic font family to use based on the
  language of the containing element or the Unicode range of the
  character.
  </li>

  <li>For other family names, the user agent attempts to find the
  family name among fonts defined via <code>@font-face</code> rules and then
  among available system fonts, matching names with a
  <a href="#font-family-casing">case-insensitive comparison</a> as outlined
  in the section above.
  On systems containing fonts with multiple localized font family
  names, user agents must match any of these names independent of the
  underlying system locale or platform API used.  If the font
  resources defined for a given face in an <code>@font-face</code> rule are either
  not available or contain invalid font data, then the face should be
  treated as not present in the family. If no faces are present for a
  family defined via <code>@font-face</code> rules, the family should be treated as
  missing; matching a platform font with the same name must not occur
  in this case.
  </li>

  <li>If a font family match occurs, the user agent assembles the set
  of font faces in that family and then narrows the set to a single
  face using other font properties in the order given below.  A group
  of faces defined via <code>@font-face</code> rules with identical font
  descriptor values but differing 'unicode-range' values are considered to be
  a single <dfn>composite face</dfn> for this step:

  <ol id="fontstylematchingalg">

    <li><span title="font-stretch!!property">'font-stretch'</span> is tried
    first. If the matching set contains faces with width values
    matching the <span title="font-stretch!!property">'font-stretch'</span> value, faces with other width
    values are removed from the matching set. If there is no face
    that exactly matches the width value the nearest width is
    used instead.  If the value of <span title="font-stretch!!property">'font-stretch'</span> is <span title="normal!!font-stretch">'normal'</span> or
    one of the condensed values, narrower width values are
    checked first, then wider values.  If the value of
    <span title="font-stretch!!property">'font-stretch'</span> is one of the expanded values, wider values
    are checked first, followed by narrower values. Once the
    closest matching width has been determined by this process,
    faces with other widths are removed from the matching set.
    </li>

    <li><span title="font-style!!property">'font-style'</span> is tried next.
    If the value of <span title="font-style!!property">'font-style'</span> is 'italic', italic faces are
    checked first, then oblique, then normal faces.  If the value
    is 'oblique', oblique faces are checked first, then italic
    faces and then normal faces.  If the value is <span title="normal!!font-style">'normal'</span>,
    normal faces are checked first, then oblique faces, then
    italic faces.  Faces with other style values are excluded
    from the matching set. User agents are permitted to
    distinguish between italic and oblique faces within platform
    font families but this is not required, so all
    italic or oblique faces may be treated as italic faces. However, within font
    families defined via <code>@font-face</code> rules, italic and oblique
    faces must be distinguished using the value of the
    <span title="font-style!!descriptor">'font-style'</span> descriptor.
    For families that lack any italic or oblique faces, users agents
    may create artificial oblique faces, if this is permitted by the
    value of the 'font-synthesis' property.
    </li>

    <li><span title="font-weight!!property">'font-weight'</span> is matched
    next, so it will always reduce the matching set to a single font
    face. If bolder/lighter relative weights are used, the
    effective weight is calculated based on the inherited weight
    value, as described in the definition of the <span title="font-weight!!property">'font-weight'</span>
    property. Given the desired weight and the weights of faces
    in the matching set after the steps above, if the desired
    weight is available that face matches.  Otherwise, a weight
    is chosen using the rules below:
      <ul>
        <li>If the desired weight is less than 400, weights below the
        desired weight are checked in descending order followed by
        weights above the desired weight in ascending order until a
        match is found.</li>
        <li>If the desired weight is greater than 500, weights above the
        desired weight are checked in ascending order followed by
        weights below the desired weight in descending order until a
        match is found.</li>
        <li>If the desired weight is 400, 500 is checked first and then
        the rule for desired weights less than 400 is used.</li>
        <li>If the desired weight is 500, 400 is checked first and then
        the rule for desired weights less than 400 is used.</li>
      </ul>
    </li>

    <li><span class="property">'font-size'</span> must be
    matched within a UA-dependent margin of tolerance. (Typically, sizes
    for scalable fonts are rounded to the nearest whole pixel, while the
    tolerance for bitmapped fonts could be as large as 20%.) Further
    computations, e.g., by 'em' values in other properties, are based on
    the <span class="property">'font-size'</span> value that
    is used, not the one that is specified.
    </li>

  </ol>
  </li>

  <li><p>If the matched face is defined via <code>@font-face</code>
  rules, user agents must use the procedure below to select a single
  font:

    <ol>
    <li>If the font resource has not been loaded and the range of
    characters defined by the 'unicode-range' descriptor value
    includes the character in question, load the font.</li>
    <li>After downloading, if the <em>effective character map</em>
    supports the character in question, select that font.</li>
    </ol>

  <p>When the matched face is a <em>composite face</em>, user agents must use
  the procedure above on each of the faces in the <em>composite face</em> in
  reverse order of <code>@font-face</code> rule definition.</p>

  <p>While the download occurs, user agents may either wait until the
  font is downloaded or render once with substituted font metrics and
  render again once the font is downloaded.</p>
  </li>

  <li><p>If no matching face exists or the matched face does not contain
  a glyph for the character to be rendered, the next family name is
  selected and the previous three steps repeated.  Glyphs from other
  faces in the family are not considered.  The only exception is that
  user agents may optionally substitute a synthetically obliqued version of the
  <em>default face</em> if that face supports a given glyph and synthesis
  of these faces is permitted by the value of the 'font-synthesis' property.
  For example, a synthetic italic version of the regular face may be used if the
  italic face doesn't support glyphs for Arabic.</p>

  <!-- resolution on the above: http://lists.w3.org/Archives/Public/www-style/2012Nov/0292.html -->

  <li>If there are no more font families to be evaluated and no matching
  face has been found, then the user agent performs a <dfn>system font
  fallback</dfn> procedure to find the best match for the character to be
  rendered.  The result of this procedure may vary across user agents.
  </li>

  <li>If a particular character cannot be displayed using any
  font, the user agent should indicate by some means that a
  character is not being displayed, displaying either a
  symbolic representation of the missing glyph (e.g. using a <a
  href="https://en.wikipedia.org/wiki/Last_resort_font">Last
  Resort Font</a>) or using the missing character glyph from
  a default font.
  </li>

</ol>

<p>Optimizations of this process are allowed provided that an
implementation behaves as if the algorithm had been followed exactly.
Matching occurs in a well-defined order to ensure that the results are
as consistent as possible across user agents, given an identical set
of available fonts and rendering technology.</p>

<p>The <dfn>first available font</dfn>, used in the definition of
<a href="https://www.w3.org/TR/css3-values/#font-relative-lengths"><em>font-relative lengths</em></a>
such as 'ex' and 'ch', is defined to be the first available font that
would match any character given font families in the 'font-family'
list (or a user agent's default font if none are available).</p>

<h3 id="cluster-matching">Cluster matching</h3>

<p>When text contains characters such as combining marks, ideally
the base character should be rendered using the same font as the
mark, this assures proper placement of the mark.  For this
reason, the font matching algorithm for clusters is more specialized
than the general case of matching a single character by itself.
For sequences containing variation selectors, which indicate the precise
glyph to be used for a given character, user agents always attempt
<em>system font fallback</em> to find the appropriate glyph before using the
default glyph of the base character.</p>

<p>A sequence of codepoints containing combining mark or other
modifiers is termed a grapheme cluster (see [[CSS3TEXT]] for a
more complete description).  For a given cluster containing
a base character, <em>b</em> and a sequence of combining characters
<em>c1, c2&hellip;</em>, the entire cluster is matched using these steps:</p>

<ol>

  <li>For each family in the font list, a face is chosen using the style
  selection rules defined in the previous section.

  <ol>

    <li>If all characters in the sequence <em>b + c1 + c2
    &hellip;</em> are completely supported by the font, select this
    font for the sequence.</li>

    <li>If a sequence of multiple codepoints is canonically equivalent
    to a single character and the font <em title="support">supports</em> that
    character, select this font for the sequence and use the glyph
    associated with the canonically equiavlent character for the
    entire cluster.</li>

  </ol>

  <li>If no font was found in the font list in step 1:

  <ol>

    <li>If <em>c1</em> is a variation selector, system fallback must be used
    to find a font that <em title="support">supports</em> the full sequence of <em>b + c1</em>.
    If no font on the system <em title="support">supports</em> the full sequence, match the single
    character <em>b</em> using the normal procedure for matching single
    characters and ignore the variation selector. Note: a sequence with
    more than one variation selector must be treated as an encoding error and
    the trailing selectors must be ignored. [[!UNICODE]]</li>

    <li>Otherwise, the user agent may optionally use system font
    fallback to match a font that <em title="support">supports</em> the entire cluster.</li>

  </ol>

  <li>If no font is found in step 2, use the matching sequence
  from step 1 to determine the longest sequence that is completely
  <em title="support">supported</em> by a font in the font list and attempt to match the remaining
  combining characters separately using the rules for single characters.</li>

</ol>

<h3 id="char-handling-issues">Character handling issues</h3>

<p>CSS font matching is always performed on text runs containing
Unicode characters, so documents using legacy encodings are assumed to
have been transcoded before matching fonts.  For fonts containing
<em title="character map">character maps</em> for both legacy encodings and Unicode, the contents of
the legacy encoding <em>character map</em> must have no effect on the results
of the font matching process. </p>

<p>The font matching process does not assume that text runs are in
either normalized or denormalized form (see [[CHARMOD-NORM]] for more
details).  Fonts may only support precomposed forms and not the
decomposed sequence of base character plus combining marks. Authors
should always tailor their choice of fonts to their content, including
whether that content contains normalized or denormalized character
streams. </p>

<p>If a given character is a Private-Use Area Unicode codepoint, user
agents must only match font families named in the 'font-family' list
that are not generic families. If none of the families named in the
'font-family' list contain a glyph for that codepoint, user agents
must display some form of missing glyph symbol for that character
rather than attempting <em>system font fallback</em> for that
codepoint.  When matching the replacement character U+FFFD, user
agents may skip the font matching process and immediately display some
form of missing glyph symbol, they are not required to display the
glyph from the font that would be selected by the font matching
process.</p>

<p>In general, the fonts for a given family will all have the same or
similar <em title="character map">character maps</em>.  The process
outlined here is designed to handle even font families containing
faces with widely variant <em title="character map">character
maps</em>. However, authors are cautioned that the use of such
families can lead to unexpected results. </p>

<h3 id="font-matching-changes">Font matching changes since CSS 2.1</h3>

<p>The algorithm above is different from CSS 2.1 in a number of key places.
These changes were made to better reflect actual font matching behavior
across user agent implementations.</p>

<p>Differences compared to the font matching algorithm in CSS 2.1:</p>

<ul>
  <li>The algorithm includes font-stretch matching.</li>
  <li>All possible font-style matching scenarios are delineated.</li>
  <li>Small-caps fonts are not matched as part of the font matching
  process, they are now handled via font features.</li>
  <li>Unicode variation selector matching is required.</li>
  <li>Cluster sequences are matched as a unit.</li>
</ul>

<h3 id="font-matching-examples">Font matching examples</h3>

<div class="example">
<p>It's useful to note that the CSS selector syntax  may be used to
create language-sensitive typography. For example, some Chinese and
Japanese characters are unified to have the same Unicode code point,
although the abstract glyphs are not the same in the two languages.

<pre>*:lang(ja) { font: 900 14pt/16pt &quot;Heisei Mincho W9&quot;, serif; }
*:lang(zh-Hant-TW) { font: 800 14pt/16.5pt &quot;Li Sung&quot;, serif; }
</pre>

<p>This selects any element that has the given
language&nbsp;&mdash; Japanese or Traditional Chinese as used in Taiwan&nbsp;&mdash;
and uses the appropriate font.
</div>

<h2 id="font-rend-props">Font Feature Properties</h2>

<p>Modern font technologies support a variety of advanced typographic
and language-specific font features.  Using these features, a single
font can provide glyphs for a wide range of ligatures, contextual and
stylistic alternates, tabular and old-style figures, small capitals,
automatic fractions, swashes, and alternates specific to a given
language. To allow authors control over these font capabilities, the
'font-variant' property has been expanded for CSS3. It now functions as
a shorthand for a set of properties that provide control over
stylistic font features.</p>

<h3 id="glyph-selection-positioning">Glyph selection and positioning</h3>

<p>Simple fonts used for displaying Latin text use a very basic
processing model. Fonts contain a <em>character map</em> which maps each
character to a glyph for that character.  Glyphs for subsequent
characters are simply placed one after the other along a run of text.  Modern font
formats such as OpenType and AAT (Apple Advanced Typography) use a
richer processing model. The glyph for a given character can be
chosen and positioned not just based on the codepoint of the character
itself, but also on adjacent characters as well as the language,
script, and features enabled for the text.  Font features may be
required for specific scripts, or recommended as enabled by default or
they might be stylistic features meant to be used under author
control.</p>

<p>For a good visual overview of these features, see the
[[OPENTYPE-FONT-GUIDE]].  For a detailed description of glyph processing for
OpenType fonts, see [[WINDOWS-GLYPH-PROC]].</p>

<p>Stylistic font features can be classified into two broad
categories: ones that affect the harmonization of glyph shapes with the
surrounding context, such as kerning and ligature features, and ones
such as the small-caps, subscript/superscript and alternate features
that affect shape selection.</p>

<p>The subproperties of <span title="font-variant!!property">'font-variant'</span> listed below are used to control
these stylistic font features. They do not control features that are
required for displaying certain scripts, such as the OpenType features
used when displaying Arabic or Indic language text.  They affect glyph
selection and positioning, but do not affect font selection as
described in the font matching section (except in cases required for
compatibility with CSS 2.1).</p>

<p>To assure consistent behavior across user agents, the equivalent
OpenType property settings are listed for individual properties and
are normative.  When using other font formats these
should be used as a guideline to map CSS font feature property values
to specific font features.</p>

<h3 id="language-specific-support">Language-specific display</h3>

<p>OpenType also supports language-specific glyph selection and
positioning, so that text can be displayed correctly in cases where
the language dictates a specific display behavior. Many languages
share a common script, but the shape of certain letters can vary
across those languages. For example, certain Cyrillic letters have
different shapes in Russian text than in Bulgarian. In Latin text,
it's common to render "fi" with an explicit fi-ligature that lacks a
dot on the "i". However, in languages such as Turkish which uses both
a dotted-i and a dotless-i, it's important to not use this ligature or
use a specialized version that contains a dot over the "i".  The
example below shows language-specific variations based on stylistic
traditions found in Spanish, Italian and French orthography:</p>

<div class="featex"><img alt="language specific forms, spanish" src="locl-1.png"></div>
<div class="featex"><img alt="language specific forms, italian" src="locl-2.png"></div>
<div class="featex"><img alt="language specific forms, french" src="locl-3.png"></div>

<p>If the content language of the element is known according to the
rules of the <a href="https://www.w3.org/TR/CSS21/conform.html#doclanguage">document language</a>,
user agents are required to infer the OpenType language system from
the content language and use that when selecting and positioning
glyphs using an OpenType font.</p>

<p>For OpenType fonts, in some cases it may be necessary to explicitly
declare the OpenType language to be used, for example when displaying
text in a given language that uses the typographic conventions of
another language or when the font does not explicitly support a given
language but supports a language that shares common typographic
conventions. The 'font-language-override' property is used for this
purpose.</p>

<!-- prop: font-kerning -->

<h3 id="font-kerning-prop">Kerning: the <a href="#propdef-font-kerning">font-kerning</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-kerning">font-kerning</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="auto!!font-kerning">auto</span> | <span title="normal!!font-kerning">normal</span> | <span title="none!!font-kerning">none</span></td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>auto</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>Kerning is the contextual adjustment of inter-glyph spacing. This
property controls metric kerning, kerning that utilizes adjustment
data contained in the font.</p>

<dl>
<dt><dfn id="font-kerning-auto-value" title="auto!!font-kerning">auto</dfn></dt>
<dd>Specifies that kerning is applied at the discretion of the user agent</dd>
<dt><dfn id="font-kerning-normal-value" title="normal!!font-kerning">normal</dfn></dt>
<dd>Specifies that kerning is applied</dd>
<dt><dfn id="font-kerning-none-value" title="none!!font-kerning">none</dfn></dt>
<dd>Specifies that kerning is not applied</dd>
</dl>

<p>For fonts that do not include kerning data this property will have no
visible effect.  When rendering with OpenType fonts, the [[!OPENTYPE]]
specification suggests that kerning be enabled by default.  When kerning is
enabled, the OpenType <span class="tag">kern</span> feature is enabled (for vertical
text runs the <span class="tag">vkrn</span> feature is enabled instead). User agents
must also support fonts that only support kerning via data contained in a
<span class="tag">kern</span> font table, as detailed in the OpenType
specification. If the 'letter-spacing' property is defined, kerning
adjustments are considered part of the default spacing and letter
spacing adjustments are made after kerning has been applied.</p>

<p>When set to 'auto', user agents can determine whether to apply
kerning or not based on a number of factors: text size, script, or
other factors that influence text processing speed.  Authors who want
proper kerning should use <span title="normal!!font-kerning">'normal'</span> to explicitly enable kerning.  Likewise,
some authors may prefer to disable kerning in situations where performance
is more important than precise appearance.  However, in well-designed
modern implementations the use of kerning generally does not have a
large impact on text rendering speed.</p>

<!-- prop: font-variant-ligatures -->

<h3 id="font-variant-ligatures-prop">Ligatures: the <a href="#propdef-font-variant-ligatures">font-variant-ligatures</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-variant-ligatures">font-variant-ligatures</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-variant-ligatures">normal</span> | <span title="none!!font-variant-ligatures">none</span> | [ <var>&lt;common-lig-values&gt;</var> || <var>&lt;discretionary-lig-values&gt;</var> || <var>&lt;historical-lig-values&gt;</var> || <var>&lt;contextual-alt-values&gt;</var> ]</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>Ligatures and contextual forms are ways of combining glyphs to produce more harmonized forms.</p>

<pre class="prod"><dfn id="common-lig-values"><var>&lt;common-lig-values&gt;</var></dfn>        = [ <span>common-ligatures</span> | <span>no-common-ligatures</span> ]</pre>

<pre class="prod"><dfn id="discretionary-lig-values"><var>&lt;discretionary-lig-values&gt;</var></dfn> = [ <span>discretionary-ligatures</span> | <span>no-discretionary-ligatures</span> ]</pre>

<pre class="prod"><dfn id="historical-lig-values"><var>&lt;historical-lig-values&gt;</var></dfn>    = [ <span>historical-ligatures</span> | <span>no-historical-ligatures</span> ]</pre>

<pre class="prod"><dfn id="contextual-alt-values"><var>&lt;contextual-alt-values&gt;</var></dfn>    = [ <span>contextual</span> | <span>no-contextual</span> ]</pre>

<p>Individual values have the following meanings:</p>

<dl>
  <dt><dfn id="font-variant-ligatures-normal-value" title="normal!!font-variant-ligatures">normal</dfn></dt>
  <dd>A value of <span title="normal!!font-variant-ligatures">'normal'</span> specifies that common default features are enabled, <a href="#font-feature-resolution">as
described in detail in the next section</a>.  For OpenType fonts, common ligatures
and contextual forms are on by default, discretionary and historical ligatures are not.</dd>

  <dt><dfn id="font-variant-ligatures-none-value" title="none!!font-variant-ligatures">none</var></dt>
  <dd>Specifies that all types of ligatures and contextual forms covered by this property are
explicitly disabled.  In situations where ligatures are not considered necessary, this may
improve the speed of text rendering.</dd>

  <dt><dfn>common-ligatures</dfn>
  <dd>Enables display of common ligatures (OpenType features: <span class="tag">liga, clig</span>).  For OpenType fonts,
  common ligatures are enabled by default.</dd>

  <div class="featex"><img alt="common ligature example" src="liga.png"></div>

  <dt><dfn>no-common-ligatures</dfn>
  <dd>Disables display of common ligatures (OpenType features: <span class="tag">liga, clig</span>).</dd>

  <dt><dfn>discretionary-ligatures</dfn>
  <dd>Enables display of discretionary ligatures (OpenType feature: <span class="tag">dlig</span>).  Which ligatures
  are discretionary or optional is decided by the type designer, so authors will need to refer to
  the documentation of a given font to understand which ligatures are considered discretionary.</dd>

  <div class="featex"><img alt="discretionary ligature example" src="dlig.png"></div>

  <dt><dfn>no-discretionary-ligatures</dfn>
  <dd>Disables display of discretionary ligatures (OpenType feature: <span class="tag">dlig</span>).</dd>

  <dt><dfn>historical-ligatures</dfn>
  <dd>Enables display of historical ligatures (OpenType feature: <span class="tag">hlig</span>).</dd>

  <div class="featex"><img alt="historical ligature example" src="hlig.png"></div>

  <dt><dfn>no-historical-ligatures</dfn>
  <dd>Disables display of historical ligatures (OpenType feature: <span class="tag">hlig</span>).</dd>

  <dt><dfn>contextual</dfn>
  <dd>Enables display of contextual alternates (OpenType feature: <span class="tag">calt</span>).  Although
  not strictly a ligature feature, like ligatures this feature is commonly used to harmonize
  the shapes of glyphs with the surrounding context.  For OpenType fonts, this feature is
  on by default.</dd>

  <div class="featex"><img alt="contextual alternate example" src="calt.png"></div>

  <dt><dfn>no-contextual</dfn>
  <dd>Disables display of contextual alternates (OpenType feature: <span class="tag">calt</span>).</dd>

</dl>

<p>Required ligatures, needed for correctly rendering complex scripts, are
not affected by the settings above, including 'none' (OpenType feature: <span class="tag">rlig</span>).</p>

<!-- prop: font-variant-position -->

<h3 id="font-variant-position-prop">Subscript and superscript forms: the <a href="#propdef-font-variant-position">font-variant-position</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-variant-position">font-variant-position</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-variant-position">normal</span> | <span>sub</span> | <span>super</span></td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>This property is used to enable typographic subscript and superscript
glyphs.  These are alternate glyphs designed within the same em-box as default
glyphs and are intended to be laid out on the same baseline as the default
glyphs, with no resizing or repositioning of the baseline.  They are explicitly
designed to match the surrounding text and to be more readable without affecting
the line height.</p>

<div class="figure"><img alt="comparison between real subscript glyphs and synthesized ones" src="realsubscripts.png" /><p class="caption">Subscript glyphs (top) vs. typical synthesized subscripts (bottom)</p></div>

<p>Individual values have the following meanings:</p>

<dl>
  <dt><dfn id="font-variant-position-normal-value" title="normal!!font-variant-position">normal</dfn></dt>
  <dd>None of the features listed below are enabled.</dd>
  <dt><dfn>sub</dfn></dt>
  <dd>Enables display of subscript variants (OpenType feature: <span class="tag">subs</span>).</dd>
  <dt><dfn>super</dfn></dt>
  <dd>Enables display of superscript variants (OpenType feature: <span class="tag">sups</span>).</dd>
</dl>

<p>Because of the semantic nature of subscripts and superscripts, when
the value is either 'sub' or 'super' for a given contiguous run of
text, if a variant glyph is not available for all the characters in
the run, simulated glyphs must be synthesized for all characters using
reduced forms of the glyphs that would be used without this feature
applied. This is done per run to avoid a mixture of variant glyphs and
synthesized ones that would not align correctly. In the case of OpenType
fonts that lack subscript or superscript glyphs for a given character,
user agents must synthesize appropriate subscript and superscript
glyphs.</p>

<div class="figure"><img alt="alternate superscripts vs. glyphs synthesized using superscript metrics" src="superscript-alt-synth.png" /><p class="caption">Superscript alternate glyph (left), synthesized superscript glyphs (middle),  and incorrect mixture of the two (right)</p></div>

<p>In situations where text decorations are only applied to runs
of text containing superscript or subscript glyphs, the synthesized
glyphs must be used to avoid problems with the placement of decorations.</p>

<p>In the past, user agents have used font-size and
vertical-align to simulate subscripts and superscripts for the
<code title="HTML sub element">sub</code> and <code title="HTML sup element">sup</code> elements. To allow a backwards
compatible way of defining subscripts and superscripts, it is recommended
that authors use conditional rules [[CSS3-CONDITIONAL]] so that
older user agents will still render subscripts and superscripts via
the older mechanism.</p>

<p>Because <code>font-size: smaller</code> is often used for these
elements,  the effective scaling factor applied to subscript and
superscript text varies depending upon the size. For larger text, the
font size is often reduced by a third but for smaller text sizes, the
reduction can be much less. This allows subscripts and superscripts to
remain readable even within elements using small text sizes. User agents
should consider this when deciding how to synthesize subscript and
superscript glyphs.</p>

<p class="note">The OpenType font format defines subscript and
superscript metrics in the
<a href="https://www.microsoft.com/typography/otspec/os2.htm#subxs">OS/2 table</a>
[[!OPENTYPE]] but these are not always accurate in practice and so
cannot be relied upon when synthesizing subscript and superscript
glyphs.</p>

<p>Authors should note that fonts typically only provide subscript and
superscript glyphs for a subset of all characters supported by the
font.  For example, while subscript and superscript glyphs are often
available for Latin numbers, glyphs for punctuation and letter
characters are less frequently provided.  The synthetic fallback rules
defined for this property assure that subscripts and superscripts will
always appear but the appearance may not match author expectations if
the font used does not provide the appropriate alternate glyph for all
characters contained in a subscript or superscript.</p>

<p>This property is not cumulative.  Applying it to elements within a
subscript or superscript won't nest the placement of a subscript or
superscript glyph. Images contained within text runs where the value
of this property is 'sub' or 'super' will be drawn just as they would
if the value was <span title="normal!!font-variant-position">'normal'</span>.</p>

<!-- due to lack of consensus, couldn't resolve on exact positioning of text decorations:
http://www.w3.org/2013/06/06-css-minutes.html#item03 -->

<p>Because of these limitations, 'font-variant-position' is not
recommended for use in user agent stylesheets. Authors should use it
in cases where subscripts or superscripts will only contain the narrow
range of characters supported by the fonts specified.</p>

<p class="note">The variant glyphs use the same baseline as the default
glyphs would use. There is no shift in the placement along the
baseline, so the use of variant glyphs doesn't affect the height of
the inline box or alter the height of the linebox.  This makes superscript
and subscript variants ideal for situations where it's important that leading
remain constant, such as in multi-column layout.</p>

<div class="example">
<p>A typical user agent default style for the <span class="tag">sub</span> element:</p>

<pre>sub {
  vertical-align: sub;
  font-size: smaller;
  line-height: normal;
}
</pre>

<p>Using font-variant-position to specify typographic subscripts in a way
that will still show subscripts in older user agents:</p>

<pre>@supports ( font-variant-position: sub ) {

  sub {
    vertical-align: baseline;
    font-size: 100%;
    line-height: inherit;
    font-variant-position: sub;
  }

}
</pre>

<p>User agents that support the 'font-variant-position' property will
select a subscript variant glyph and render this without adjusting the
baseline or font-size.  Older user agents will ignore the
'font-variant-position' property definition and use the standard
defaults for subscripts.
</p>
</div>


<!-- prop: font-variant-caps -->

<h3 id="font-variant-caps-prop">Capitalization: the <a href="#propdef-font-variant-caps">font-variant-caps</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-variant-caps">font-variant-caps</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-variant-caps">normal</span> | <span>small-caps</span> | <span>all-small-caps</span> | <span>petite-caps</span> | <span>all-petite-caps</span> | <span>unicase</span> | <span>titling-caps</span></td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>This property allows the selection of alternate glyphs used for
small or petite capitals or for titling.  These glyphs are specifically
designed to blend well with the surrounding normal glyphs, to maintain
the weight and readability which suffers when text is simply resized to
fit this purpose.</p>

<p>Individual values have the following meanings:</p>

<dl>
  <dt><dfn id="font-variant-caps-normal-value" title="normal!!font-variant-caps">normal</dfn>
  <dd>None of the features listed below are enabled.</dd>

  <dt><dfn>small-caps</dfn>
  <dd>Enables display of small capitals (OpenType feature: <span class="tag">smcp</span>).
  Small-caps glyphs typically use the form of uppercase letters but are reduced to the size of lowercase letters.</dd>

  <div class="featex"><img alt="small-caps example" src="smcp.png"></div>

  <dt><dfn>all-small-caps</dfn>
  <dd>Enables display of small capitals for both upper and lowercase letters (OpenType features: <span class="tag">c2sc, smcp</span>).</dd>

  <dt><dfn>petite-caps</dfn>
  <dd>Enables display of petite capitals (OpenType feature: <span class="tag">pcap</span>).</dd>

  <dt><dfn>all-petite-caps</dfn>
  <dd>Enables display of petite capitals for both upper and lowercase letters (OpenType features: <span class="tag">c2pc, pcap</span>).</dd>

  <dt><dfn>unicase</dfn>
  <dd>Enables display of mixture of small capitals for uppercase letters with normal lowercase letters (OpenType feature: <span class="tag">unic</span>).</dd>

  <dt><dfn>titling-caps</dfn>
  <dd>Enables display of titling capitals (OpenType feature: <span class="tag">titl</span>).  Uppercase
  letter glyphs are often designed for use with lowercase letters.  When used in all uppercase titling sequences
  they can appear too strong.  Titling capitals are designed specifically for this situation.</dd>
</dl>

<p>The availability of these glyphs is based on whether a given
feature is defined or not in the feature list of the font.  User
agents can optionally decide this on a per-script basis but should
explicitly not decide this on a per-character basis.</p>

<p>Some fonts may only support a subset or none of the features
described for this property.  For backwards compatibility with CSS
2.1, if 'small-caps' or 'all-small-caps' is specified but small-caps
glyphs are not available for a given font, user agents should simulate
a small-caps font, for example by taking a normal font and replacing
the glyphs for lowercase letters with scaled versions of the glyphs
for uppercase characters (replacing the glyphs for both upper and
lowercase letters in the case of 'all-small-caps').</p>

<div class="figure" style="padding: 0; margin: auto;"><img class="hires" width=512 alt="synthetic vs. real small-caps" src="synthetic-vs-real-small-caps.png"><p class="caption">Synthetic vs. real small-caps</p></div>

<p>The 'font-feature-settings' property does not affect the decision of
whether or not to use a simulated small-caps font.<p>

<div class="example">
<pre>#example1 { font-variant-caps: small-caps; }
#example2 { font-variant-caps: small-caps; font-feature-settings: 'smcp' 0; }</pre>
For fonts which don't support small caps, both #example1 and #example2
should be rendered with synthesized small caps. However, for fonts which
do support small caps, #example1 should be rendered with native small
caps, while #example2 should be rendered without any small-caps (native
or synthesized).
</div>

<p>To match the surrounding text, a font may provide alternate glyphs
for caseless characters when these features are enabled but when a
user agent simulates small capitals, it must not attempt to simulate
alternates for codepoints which are considered caseless.</p>

<div class="figure" style="padding: 0; margin: auto;"><img class="hires" width=418 alt="caseless characters with small-caps, all-small-caps enabled" src="small-capitals-variations.png"><p class="caption">Caseless characters with small-caps, all-small-caps enabled</p></div>

<p>If either 'petite-caps' or 'all-petite-caps' is specified for a
font that doesn't support these features, the property behaves as if
'small-caps' or 'all-small-caps', respectively, had been specified. If
'unicase' is specified for a font that doesn't support that feature,
the property behaves as if 'small-caps' was applied only to lowercased
uppercase letters.  If 'titling-caps' is specified with a font that
does not support this feature, this property has no visible effect.
When simulated small capital glyphs are used, for scripts that lack uppercase and
lowercase letters, 'small-caps', 'all-small-caps', 'petite-caps',
'all-petite-caps' and 'unicase' have no visible effect.</p>

<p>When casing transforms are used to simulate small capitals, the
casing transformations must match those used for the
<span class="property">'text-transform'</span> property.</p>

<p>As a last resort, unscaled uppercase letter glyphs in a
normal font may replace glyphs in a small-caps font so that the text
appears in all uppercase letters.</p>

<div class="figure" style="padding: 0; margin: auto;"><img class="hires" width=596 alt="using all-small-caps in acronym-laden text" src="acronym-laden-text.png"><p class="caption">Using small capitals to improve readability in acronym-laden text</p></div>

<div class="example">
<p>Quotes rendered italicised, with small-caps on the first line:</p>

<pre>blockquote            { font-style: italic; }
blockquote:first-line { font-variant: small-caps; }

&lt;blockquote><a href="https://lists.w3.org/Archives/Public/www-style/2009Dec/0036.html" style="text-decoration: none; border: none;">I'll be honor-bound to slap them like a haddock.</a>&lt;/blockquote>
</div>


<!-- prop: font-variant-numeric -->

<h3 id="font-variant-numeric-prop">Numerical formatting: the <a href="#propdef-font-variant-numeric">font-variant-numeric</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-variant-numeric">font-variant-numeric</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-variant-numeric">normal</span> | [ <var>&lt;numeric-figure-values&gt;</var> || <var>&lt;numeric-spacing-values&gt;</var> || <var>&lt;numeric-fraction-values&gt;</var> || <span>ordinal</span> || <span>slashed-zero</span> ]</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>Specifies control over numerical forms. The example below shows how
some of these values can be combined to influence the rendering of
tabular data with fonts that support these features. Within normal
paragraph text, proportional numbers are used while tabular numbers
are used so that columns of numbers line up properly:</p>

<div class="figure" style="padding: 0; margin: auto;"><img alt="combining number styles" src="numberstyles.png"><p class="caption">Using number styles</p></div>

<p>Possible combinations:</p>

<pre class="prod"><dfn id="numeric-figure-values"><var>&lt;numeric-figure-values&gt;</var></dfn>   = [ <span>lining-nums</span> | <span>oldstyle-nums</span> ]</pre>

<pre class="prod"><dfn id="numeric-spacing-values"><var>&lt;numeric-spacing-values&gt;</var></dfn>  = [ <span>proportional-nums</span> | <span>tabular-nums</span> ]</pre>

<pre class="prod"><dfn id="numeric-fraction-values"><var>&lt;numeric-fraction-values&gt;</var></dfn> = [ <span>diagonal-fractions</span> | <span>stacked-fractions</span> ]</pre>

<p>Individual values have the following meanings:</p>

<dl>
  <dt><dfn id="font-variant-numeric-normal-value" title="normal!!font-variant-numeric">normal</dfn>
  <dd>None of the features listed below are enabled.</dd>

  <dt><dfn>lining-nums</dfn>
  <dd>Enables display of lining numerals (OpenType feature: <span class="tag">lnum</span>).</dd>

  <dt><dfn>oldstyle-nums</dfn>
  <dd>Enables display of old-style numerals (OpenType feature: <span class="tag">onum</span>).</dd>

  <dt><dfn>proportional-nums</dfn>
  <dd>Enables display of proportional numerals (OpenType feature: <span class="tag">pnum</span>).</dd>

  <dt><dfn>tabular-nums</dfn>
  <dd>Enables display of tabular numerals (OpenType feature: <span class="tag">tnum</span>).</dd>

  <dt><dfn>diagonal-fractions</dfn>
  <dd>Enables display of lining diagonal fractions (OpenType feature: <span class="tag">frac</span>).</dd>

  <div class="featex"><img alt="diagonal fraction example" src="frac.png"></div>

  <dt><dfn>stacked-fractions</dfn>
  <dd>Enables display of lining stacked fractions (OpenType feature: <span class="tag">afrc</span>).</dd>

  <div class="featex"><img alt="stacked fraction example" src="afrc.png"></div>

  <dt><dfn>ordinal</dfn>
  <dd>Enables display of letter forms used with ordinal numbers (OpenType feature: <span class="tag">ordn</span>).</dd>
  <div class="featex"><img alt="ordinals example" src="ordinals.png"></div>
  <dt><dfn>slashed-zero</dfn>
  <dd>Enables display of slashed zeros (OpenType feature: <span class="tag">zero</span>).</dd>
  <div class="featex"><img alt="slashed zero example" src="zero.png"></div>

</dl>

<div id="ordinal-example" class="example">
<p>In the case of 'ordinal', although ordinal forms
are often the same as superscript forms, they are marked up
differently.</p>
<p>For superscripts, the variant property is only applied to the sub-element containing the superscript:</p>
<pre>
sup { font-variant-position: super; }
x&lt;sup&gt;2&lt;/sup&gt;
</pre>
<p>For ordinals, the variant property is applied to the entire ordinal number rather than
just to the suffix (or to the containing paragraph):</p>
<pre>
.ordinal { font-variant-numeric: ordinal; }
&lt;span class="ordinal"&gt;17th&lt;/span&gt;
</pre>
<p>In this case only the "th" will appear in ordinal form, the
digits will remain unchanged. Depending upon the typographic
traditions used in a given language, ordinal forms may differ from
superscript forms. In Italian, for example, ordinal forms sometimes
include an underline in the ordinal design.</p>
</div>

<div class="example" id="steak-marinade">
<p>A simple flank steak marinade recipe, rendered with automatic fractions and old-style numerals:</p>

<pre>.amount { font-variant-numeric: oldstyle-nums diagonal-fractions; }

&lt;h4>Steak marinade:&lt;/h4>
&lt;ul>
  &lt;li>&lt;span class="amount">2&lt;/span> tbsp olive oil&lt;/li>
  &lt;li>&lt;span class="amount">1&lt;/span> tbsp lemon juice&lt;/li>
  &lt;li>&lt;span class="amount">1&lt;/span> tbsp soy sauce&lt;/li>
  &lt;li>&lt;span class="amount">1 1/2&lt;/span> tbsp dry minced onion&lt;/li>
  &lt;li>&lt;span class="amount">2 1/2&lt;/span> tsp italian seasoning&lt;/li>
  &lt;li>Salt &amp;amp; pepper&lt;/li>
&lt;/ul>

&lt;p>Mix the meat with the marinade and let it sit covered in the refrigerator
for a few hours or overnight.&lt;/p>
</pre>

<p>Note that the fraction feature is only applied to values not the entire paragraph.
Fonts often implement this feature using contextual rules based on the use of the slash ('/')
character.  As such, it's not suitable for use as a paragraph-level style.</p>
</div>

<!-- prop: font-variant-alternates -->

<h3 id="font-variant-alternates-prop">Alternates and swashes: the <a href="#propdef-font-variant-alternates">font-variant-alternates</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-variant-alternates">font-variant-alternates</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td>normal | [ <span title="stylistic">stylistic(&lt;feature-value-name&gt;)</span>
      || <span>historical-forms</span>
      || <span title="styleset">styleset(&lt;feature-value-name&gt; #)</span>
      || <span title="character-variant">character-variant(&lt;feature-value-name&gt; #)</span>
      || <span title="swash">swash(&lt;feature-value-name&gt;)</span>
      || <span title="ornaments">ornaments(&lt;feature-value-name&gt;)</span>
      || <span title="annotation">annotation(&lt;feature-value-name&gt;)</span> ]
      </td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>For any given character, fonts can provide a variety of alternate
glyphs in addition to the default glyph for that character.  This
property provides control over the selection of these alternate
glyphs.</p>

<p>For many of the property values listed below, several different
alternate glyphs are available.  How many alternates are available
and what they represent is font-specific, so these are each marked
<dfn>font specific</dfn> in the value definitions below.  Because the nature
of these alternates is font-specific, the
<code>@font-feature-values</code> rule is used to define values for a
specific font family or set of families that associate a font-specific
numeric <code>&lt;feature-index&gt;</code> with a custom
<code>&lt;feature-value-name&gt;</code>, which is then used in this
property to select specific alternates:</p>

<pre>@font-feature-values Noble Script { @swash { swishy: 1; flowing: 2; } }

p {
  font-family: Noble Script;
  font-variant-alternates: swash(flowing); /* use swash alternate #2 */
}</pre>

<p>When a particular <code>&lt;feature-value-name&gt;</code> has not
been defined for a given family or for a particular feature type, the
computed value must be the same as if it had been defined.  However,
property values that contain these undefined <code>&lt;feature-value-name&gt;</code>
identifiers must be ignored when choosing glyphs.</p>

<pre>/* these two style rules are effectively the same */
p { font-variant-alternates: swash(unknown-value); } /* not a defined value, ignored */
p { font-variant-alternates: normal; }
</pre>

<p>This allows values to be defined and used for a given set of font
families but ignored if fallback occurs, since the font family name
would be different. If a given value is outside the range supported by
a given font, the value is ignored.  These values never apply to
generic font families. </p>

<p>Individual values have the following meanings:</p>

<dl>
  <dt><dfn id="font-variant-alternates-normal-value" title="normal!!font-variant-alternates">normal</dfn>
  <dd>None of the features listed below are enabled.</dd>

  <dt><dfn>historical-forms</dfn>
  <dd>Enables display of historical forms (OpenType feature: <span class="tag">hist</span>).</dd>

  <div class="featex"><img alt="historical form example" src="hist.png"></div>

  <dt><dfn id="stylistic" title="stylistic">stylistic(&lt;feature-value-name&gt;)</dfn>
  <dd>Enables display of stylistic alternates (<em>font specific</em>, OpenType feature: <span class="tag">salt &lt;feature-index&gt;</span>).</dd>

  <div class="featex"><img alt="stylistic alternate example" src="salt.png"></div>

  <dt><dfn id="styleset" title="styleset">styleset(&lt;feature-value-name&gt; #)</dfn>
  <dd>Enables display with stylistic sets (<em>font specific</em>, OpenType feature: <span class="tag">ss&lt;feature-index&gt;</span>
      OpenType currently defines <span class="tag">ss01</span> through <span class="tag">ss20</span>).</dd>

  <div class="featex"><img alt="styleset example" src="ssnn.png"></div>

  <dt><dfn id="character-variant" title="character-variant">character-variant(&lt;feature-value-name&gt; #)</dfn>
  <dd>Enables display of specific character variants (<em>font specific</em>, OpenType feature: <span class="tag">cv&lt;feature-index&gt;</span>
      OpenType currently defines <span class="tag">cv01</span> through <span class="tag">cv99</span>).</dd>

  <dt><dfn id="swash" title="swash">swash(&lt;feature-value-name&gt;)</dfn>
  <dd>Enables display of swash glyphs (<em>font specific</em>, OpenType feature: <span class="tag">swsh &lt;feature-index&gt;, cswh &lt;feature-index&gt;</span>).</dd>

  <div class="featex"><img alt="swash example" src="swsh.png"></div>

  <dt><dfn id="ornaments" title="ornaments">ornaments(&lt;feature-value-name&gt;)</dfn>
  <dd>Enables replacement of default glyphs with ornaments, if provided in the font (<em>font specific</em>, OpenType feature: <span class="tag">ornm &lt;feature-index&gt;</span>).
  Some fonts may offer ornament glyphs as alternates for a wide collection of characters; however, displaying arbitrary
  characters (e.g., alphanumerics) as ornaments is poor practice as it distorts the semantics of the data. Font designers
  are encouraged to encode all ornaments (except those explicitly encoded in the Unicode Dingbats blocks, etc.) as
  alternates for the bullet character (U+2022) to allow authors to select the desired glyph using 'ornaments'.
  </dd>

  <div class="featex"><img alt="ornaments example" src="ornm.png"></div>

  <dt><dfn id="annotation" title="annotation">annotation(&lt;feature-value-name&gt;)</dfn>
  <dd>Enables display of alternate annotation forms (<em>font specific</em>, OpenType feature: <span class="tag">nalt &lt;feature-index&gt;</span>).</dd>

  <div class="featex"><img alt="alternate annotation form example" src="nalt.png"></div>

</dl>

<h3 id="font-feature-values">Defining font specific alternates: the <dfn id="at-font-feature-values-rule" style="font-weight: inherit; font-style: inherit"><code>@font-feature-values</code></dfn> rule</h3>

<p>Several of the possible values of 'font-variant-alternates' listed
above are labeled as <em>font specific</em>.  For these features fonts may define
not just a single glyph but a set of alternate glyphs with an index to
select a given alternate.  Since these are font family specific, the
<code>@font-feature-values</code> rule is used to define named values for these indices
for a given family.

<p class="note">See the <a href="#om-fontfeaturevalues">object model reference section</a> for a
description of the interfaces used to modify these rules via the CSS
Object Model.</p>

<div class="example">
<p>In the case of the swash Q in the example shown above, the swash could
be specified using these style rules:
</p>

<pre>

@font-feature-values Jupiter Sans {
  @swash {
    delicate: 1;
    flowing: 2;
  }
}

h2 { font-family: Jupiter Sans, sans-serif; }

/* show the second swash variant in h2 headings */
h2:first-letter { font-variant-alternates: swash(flowing); }

&lt;h2>Quick&lt;/h2></pre>

<p>When Jupiter Sans is present, the second alternate swash alternate will
be displayed. When not present, no swash character will be shown, since the
specific named value "flowing" is only defined for the Jupiter Sans family.
The @-mark indicates the name of the property value for which a named value
can be used.  The name "flowing" is chosen by the author.  The index that
represents each alternate is defined within a given font's data.</p>
</div>

<h4>Basic syntax</h4>

<p>An <code>@font-feature-values</code> rule is composed of a list of
font families followed by a block containing individual
<i title="feature_value_block">feature value blocks</i> that take the
form of @-rules.  Each block defines a set of named values for a specific font feature
when a given set of font families is used. Effectively, they define a mapping
of &#x27e8;family, feature, ident&#x27e9; &rarr; &#x27e8;values&#x27e9;
where &#x27e8;values&#x27e9; are the numeric indices used for specific
features defined for a given font.</p>

<p>In terms of the grammar, this specification defines the following productions:</p>

<pre><dfn>font_feature_values_rule</dfn>
  : <i>FONT_FEATURE_VALUES_SYM</i> <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <i>font_family_name_list</i> <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>*
    '{' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <i>feature_value_block</i>? [ <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <i>feature_value_block</i>? ]* '}' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>*
  ;

<dfn>font_family_name_list</dfn>
  : <i>font_family_name</i> [ <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* ',' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <i>font_family_name</i> ]*
  ;

<dfn>font_family_name</dfn>
  : <a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><i>STRING</i></a> | [ <a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><i>IDENT</i></a> [ <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><i>IDENT</i></a> ]* ]
  ;

<dfn>feature_value_block</dfn>
  : <i>feature_type</i> <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>*
    '{' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <i>feature_value_definition</i>? [ <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* ';' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <i>feature_value_definition</i>? ]* '}' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>*
  ;

<dfn>feature_type</dfn>:
  <a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><i>ATKEYWORD</i></a>
  ;

<dfn>feature_value_definition</dfn>
  : <a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><i>IDENT</i></a> <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* ':' <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><i>NUMBER</i></a> [ <a href="https://www.w3.org/TR/CSS21/grammar.html#scanner"><i>S</i></a>* <a href="https://www.w3.org/TR/CSS21/syndata.html#tokenization"><i>NUMBER</i></a> ]*
  ;
</pre>

<p>The following new token is introduced:</p>

<pre>@{F}{O}{N}{T}{-}{F}{E}{A}{T}{U}{R}{E}{-}{V}{A}{L}{U}{E}{S}   {return <dfn>FONT_FEATURE_VALUES_SYM</dfn>;}
</pre>

<p><i title="feature_value_block">Feature value blocks</i> are handled as
<a href="https://www.w3.org/TR/CSS2/syndata.html#at-rules">at-rules</a>,
they consist of everything up to the next block or
semi-colon, whichever comes first.</p>

<p>The <i title="font_family_name_list">font family list</i> is a comma-delimited list of
<i title="font_family_name">font family names</i> that match the definition of <var>&lt;family-name&gt;</var>
for the <span title="font-family!!property">'font-family'</span> property.
This means that only named font families are allowed, rules that
include generic or system fonts in the list of font families are
syntax errors. However, if a user agent defines a generic font to be a
specific named font (e.g. Helvetica), the settings associated with
that family name will be used.  If syntax errors occur within the font
family list, the entire rule must be ignored.</p>

<p>Within <i title="feature_value_block">feature value blocks</i>,
the <i title="feature_type">feature type</i> is '@' followed by the
name of one of the <em>font specific</em> property values
of 'font-variant-alternates' (e.g. <code>@swash</code>). The
identifiers used within feature value definitions follow the rules of
CSS user identifiers and are case-sensitive. They are unique only for
a given set of font families and <i title="feature_type">feature type</i>.
The same identifier used with a different <i title="feature_type">feature type</i>
is treated as a separate and distinct value.  If the same identifier is defined
mulitple times for a given <i title="feature_type">feature type</i> and font family,
the last defined value is used. Values associated
with a given identifier are limited to integer values 0 or greater.</p>

<p>When syntax errors occur within a <i title="feature_value_definition">feature value
definition</i>, such as invalid identifiers or values, the entire <i title="feature_value_definition">feature value
definition</i> must be omitted, just as syntax errors in
style declarations are handled.  When the <i title="feature_type">feature type</i>
is invalid, the entire associated
<i title="feature_value_block">feature value block</i> must be ignored.</p>

<div class="example">
<p>Rules that are equivalent given syntax error handling:</p>
<pre>@font-feature-values Bongo {
  @swash { ornate: 1; }
  annotation { boxed: 4; } /* should be @annotation! */
  @swash { double-loops: 1; flowing: -1; } /* negative value */
  @ornaments ; /* incomplete definition */
  @styleset { double-W: 14; sharp-terminals: 16 1 } /* missing ; */
  <a style="text-decoration: none; border: none;" href="https://www.angryalien.com/0504/shiningbunnies.html">redrum</a>  /* random editing mistake */
}</pre>

<p>The example above is equivalent to:</p>

<pre>@font-feature-values Bongo {
  @swash { ornate: 1; }
  @swash { double-loops: 1; }
  @styleset { double-W: 14; sharp-terminals: 16 1; }
}</pre>
</div>

<p>If multiple <code>@font-feature-values</code> rules are defined for
a given family, the resulting values definitions are the union of the
definitions contained within these rules. This allows a set of named
values to be defined for a given font family globally for a site and
specific additions made per-page.
</p>

<div class="example">
<p>Using both site-wide and per-page feature values:</p>
<pre>
site.css:

  @font-feature-values Mercury Serif {
    @styleset {
      stacked-g: 3; /* "two-storey" versions of g, a */
      stacked-a: 4;
    }
  }

page.css:

  @font-feature-values Mercury Serif {
    @styleset {
      geometric-m: 7; /* alternate version of m */
    }
  }

  body {
    font-family: Mercury Serif, serif;

    /* enable both the use of stacked g and alternate m */
    font-variant-alternates: styleset(stacked-g, geometric-m);
  }</pre>
</div>

<div class="example">
<p>Using a commonly named value allows authors to use a single style rule
to cover a set of fonts for which the underlying selector is different for
each font. If either font in the example below is found, a circled number
glyph will be used:
</p>

<pre>@font-feature-values Taisho Gothic {
  @annotation { boxed: 1; circled: 4; }
}

@font-feature-values Otaru Kisa {
  @annotation { circled: 1; black-boxed: 3; }
}

h3.title {
  /* circled form defined for both fonts */
  font-family: Taisho Gothic, Otaru Kisa;
  font-variant: annotation(circled);
}</pre>
</div>

<h4>Multi-valued feature value definitions</h4>

<p>Most <em>font specific</em> 'font-variant-alternates' property
values take a single value (e.g. 'swash'). The 'character-variant'
property value allows two values and 'styleset' allows an unlimited
number.</p>

<p>For the styleset property value, multiple values indicate the style
sets to be enabled.  Values between 1 and 99 enable OpenType features
<span class="tag">ss01</span> through <span class="tag">ss99</span>.
However, the OpenType standard only officially defines
<span class="tag">ss01</span> through <span class="tag">ss20</span>.
For OpenType fonts, values greater than 99 or equal to 0 do not
generate a syntax error when parsed but enable no OpenType features.
</p>

<pre>@font-feature-values Mars Serif {
  @styleset {
    alt-g: 1;        /* implies ss01 = 1 */
    curly-quotes: 3; /* implies ss03 = 1 */
    code: 4 5;       /* implies ss04 = 1, ss05 = 1 */
  }

  @styleset {
    dumb: 125;        /* &gt;99, ignored */
  }

  @swash {
    swishy: 3 5;     /* more than 1 value for swash, syntax error */
  }
}

p.codeblock {
  /* implies ss03 = 1, ss04 = 1, ss05 = 1 */
  font-variant-alternates: styleset(curly-quotes, code);
}</pre>

<p>For character-variant, a single value between 1 and 99 indicates
the enabling of OpenType feature <span class="tag">cv01</span> through
<span class="tag">cv99</span>. For OpenType fonts, values greater than
99 or equal to 0 are ignored but do not generate a syntax error when parsed
but enable no OpenType features. When two values are listed, the first
value indicates the feature used and the second the value passed for
that feature.  If more than two values are assigned to a given name, a
syntax error occurs and the entire
<i title="feature_value_definition">feature value definition</i> is
ignored.</p>

<pre>@font-feature-values MM Greek {
  @character-variant { alpha-2: 1 2; }   /* implies cv01 = 2 */
  @character-variant { beta-3: 2 3; }    /* implies cv02 = 3 */
  @character-variant { epsilon: 5 3 6; } /* more than 2 values, syntax error, definition ignored */
  @character-variant { gamma: 12; }      /* implies cv12 = 1 */
  @character-variant { zeta:   20 3; }   /* implies cv20 = 3 */
  @character-variant { zeta-2: 20 2; }   /* implies cv20 = 2 */
  @character-variant { silly: 105; }     /* &gt;99, ignored */
  @character-variant { dumb: 323 3; }    /* &gt;99, ignored */
}

#title {
  /* use the third alternate beta, first alternate gamma */
  font-variant-alternates: character-variant(beta-3, gamma);
}

p {
  /* zeta-2 follows zeta, implies cv20 = 2  */
  font-variant-alternates: character-variant(zeta, zeta-2);
}

.special {
  /* zeta follows zeta-2, implies cv20 = 3  */
  font-variant-alternates: character-variant(zeta-2, zeta);
}</pre>

<div class="figure"><img alt="Matching text on Byzantine seals using character variants" src="byzantineseal.png" /><p class="caption">Byzantine seal text displayed with character variants</p></div>

<div class="example">
<p>In the figure above, the text in red is rendered using a font containing
character variants that mimic the character forms found on a Byzantine seal
from the 8th century A.D.  Two lines below is the same text displayed in
a font without variants.  Note the two variants for U and N used on the
seal.</p>

<pre>@font-feature-values Athena Ruby {
  @character-variant {
    leo-B: 2 1;
    leo-M: 13 3;
    leo-alt-N: 14 1;
    leo-N: 14 2;
    leo-T: 20 1;
    leo-U: 21 2;
    leo-alt-U: 21 4;
  }
}

p {
  font-variant: discretionary-ligatures
                character-variant(leo-B, leo-M, leo-N, leo-T, leo-U);
}

span.alt-N {
  font-variant-alternates: character-variant(leo-alt-N);
}

span.alt-U {
  font-variant-alternates: character-variant(leo-alt-U);
}

&lt;p>ENO....UP͞RSTU&lt;span class="alt-U">U&lt;/span>͞&lt;span class="alt-U">U&lt;/span>ΚΑΙTỤẠG̣IUPNS&lt;/p>

&lt;p>LEON|ΚΑΙCONSTA|NTI&lt;span class="alt-N">N&lt;/span>OS..|STOIBAṢ.|LIṢROM|AIO&lt;span class="alt-N">N&lt;/span>&lt;/p>
</pre>
</div>

<h3 id="font-variant-east-asian-prop">East Asian text rendering: the <a href="#propdef-font-variant-east-asian">font-variant-east-asian</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-variant-east-asian">font-variant-east-asian</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-variant-east-asian">normal</span> | [ <var>&lt;east-asian-variant-values&gt;</var> || <var>&lt;east-asian-width-values&gt;</var> || <span>ruby</span> ]</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>Allows control of glyph substitution and sizing in East Asian text.</p>


<pre class="prod"><dfn id="east-asian-variant-values"><var>&lt;east-asian-variant-values&gt;</var></dfn> = [ <span>jis78</span> | <span>jis83</span> | <span>jis90</span> | <span>jis04</span> | <span>simplified</span> | <span>traditional</span> ]</pre>

<pre class="prod"><dfn id="east-asian-width-values"><var>&lt;east-asian-width-values&gt;</var></dfn>   = [ <span>full-width</span> | <span>proportional-width</span> ]</pre>

<p>Individual values have the following meanings:</p>

<dl>
  <dt><dfn id="font-variant-east-asian-normal-value" title="normal!!font-variant-east-asian">normal</dfn>
  <dd>None of the features listed below are enabled.</dd>

  <dt><dfn>jis78</dfn>
  <dd>Enables rendering of JIS78 forms (OpenType feature: <span class="tag">jp78</span>).</dd>

  <div class="featex"><img alt="JIS78 form example" src="jp78.png"></div>

  <dt><dfn>jis83</dfn>
  <dd>Enables rendering of JIS83 forms (OpenType feature: <span class="tag">jp83</span>).</dd>

  <dt><dfn>jis90</dfn>
  <dd>Enables rendering of JIS90 forms (OpenType feature: <span class="tag">jp90</span>).</dd>

  <dt><dfn>jis04</dfn>
  <dd>Enables rendering of JIS2004 forms (OpenType feature: <span class="tag">jp04</span>).

  <p>The various JIS variants reflect the glyph forms defined in different
  Japanese national standards. Fonts generally include glyphs defined by the
  most recent national standard but it's sometimes necessary to use older
  variants, to match signage for example.</p>
  </dd>

  <dt><dfn>simplified</dfn>
  <dd>Enables rendering of simplified forms (OpenType feature: <span class="tag">smpl</span>).

  <dt><dfn>traditional</dfn>
  <dd>Enables rendering of traditional forms (OpenType feature: <span class="tag">trad</span>).</dd>

  <p>The 'simplified' and 'traditional' values allow control over the
  glyph forms for characters which have been simplified over time but
  for which the older, traditional form is still used in some
  contexts.  The exact set of characters and glyph forms will vary
  to some degree by context for which a given font was designed.</p>
  </dd>

  <div class="featex"><img alt="tradtional form example" src="trad.png"></div>

  <dt><dfn>full-width</dfn>
  <dd>Enables rendering of full-width variants (OpenType feature: <span class="tag">fwid</span>).</dd>

  <dt><dfn>proportional-width</dfn>
  <dd>Enables rendering of proportionally-spaced variants (OpenType feature: <span class="tag">pwid</span>).</dd>
  <div class="featex"><img alt="proportionally spaced Japanese example" src="pwid.png"></div>

  <dt><dfn>ruby</dfn>
  <dd>Enables display of ruby variant glyphs (OpenType feature: <span class="tag">&#x0072;uby</span>).
      Since ruby text is generally smaller than the associated body
      text, font designers can design special glyphs for use with ruby
      that are more readable than scaled down versions of the default
      glyphs.  Only glyph selection is affected, there is no
      associated font scaling or other change that affects line layout.
      The red ruby text below is shown with default glyphs (top) and
      with ruby variant glyphs (bottom).  Note the slight difference
      in stroke thickness.</dd>

  <div class="featex"><img alt="ruby variant example" src="rubyshinkansen.png"></div>

</dl>

<h3 id="font-variant-prop">Overall shorthand for font rendering: the <a href="#propdef-font-variant">font-variant</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-variant" title="font-variant!!property">font-variant</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-variant">normal</span> | <span title="none!!font-variant">none</span> |
        [ <var>&lt;common-lig-values&gt;</var> || <var>&lt;discretionary-lig-values&gt;</var> || <var>&lt;historical-lig-values&gt;</var> ||
        <var>&lt;contextual-alt-values&gt;</var> || <var title="stylistic">stylistic(&lt;feature-value-name&gt;)</var> || <var>historical-forms</var> ||
        <var title="styleset">styleset(&lt;feature-value-name&gt; #)</var> ||
        <var title="character-variant">character-variant(&lt;feature-value-name&gt; #)</var> ||
        <var title="swash">swash(&lt;feature-value-name&gt;)</var> || <var title="ornaments">ornaments(&lt;feature-value-name&gt;)</var> ||
        <var title="annotation">annotation(&lt;feature-value-name&gt;)</var> ||
        [ <i>small-caps</i> | <i>all-small-caps</i> | <i>petite-caps</i> | <i>all-petite-caps</i> | <i>unicase</i> | <i>titling-caps</i> ] ||
        <var>&lt;numeric-figure-values&gt;</var> || <var>&lt;numeric-spacing-values&gt;</var> || <var>&lt;numeric-fraction-values&gt;</var> || <i>ordinal</i> || <i>slashed-zero</i> ||
        <var>&lt;east-asian-variant-values&gt;</var> || <var>&lt;east-asian-width-values&gt;</var> || <i>ruby</i> ||
        [ <i>sub</i> | <i>super</i> ] ]
      </td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>see individual properties</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>see individual properties</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>see individual properties</td>
    </tr>
  </tbody>
</table>

<p>The <span title="font-variant!!property">'font-variant'</span> property is a shorthand for all font-variant subproperties.
The value <dfn id="font-variant-normal-value" title="normal!!font-variant">'normal'</dfn> resets all subproperties of <span title="font-variant!!property">'font-variant'</span> to their inital
value. The <dfn id="font-variant-none-value" title="none!!font-variant">'none'</dfn> value sets 'font-variant-ligatures' to 'none' and resets all other
font feature properties to their initial value.  Like other shorthands,
using <span title="font-variant!!property">'font-variant'</span> resets unspecified <span title="font-variant!!property">'font-variant'</span> subproperties to their initial
values.  It does not reset the values of either 'font-language-override' or
<span title="font-feature-settings!!property">'font-feature-settings'</span>.</p>


<h3 id="font-feature-settings-prop">Low-level font feature settings control: the <a href="#propdef-font-feature-settings">font-feature-settings</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-feature-settings" title="font-feature-settings!!property">font-feature-settings</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-feature-settings">normal</span> | <var>&lt;feature-tag-value&gt;</var> #</td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td>normal</td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>This property provides low-level control over OpenType font
features. It is intended as a way of providing access to font features
that are not widely used but are needed for a particular use case.

<p>Authors should generally use <span title="font-variant!!property">'font-variant'</span>
and its related subproperties whenever possible and only use this
property for special cases where its use is the only way of accessing
a particular infrequently used font feature.</p>

<pre>/* enable small caps and use second swash alternate */
font-feature-settings: "smcp", "swsh" 2;</pre>

<p>A value of <dfn id="font-feature-settings-normal-value"
title="normal!!font-feature-settings">'normal'</dfn> means that no
change in glyph selection or positioning occurs due to this property.</p>

<p>Feature tag values have the following syntax:</p>

<pre class="prod"><dfn id="feature-tag-value"><var>&lt;feature-tag-value&gt;</var></dfn> = &lt;string&gt; [ &lt;integer&gt; | on | off ]?</pre>

<p>The &lt;string&gt; is a case-sensitive OpenType feature tag. As
specified in the OpenType specification, feature tags contain four
ASCII characters. Tag strings longer or shorter than four characters,
or containing characters outside the U+20&ndash;7E codepoint range are
invalid.  Feature tags need only
match a feature tag defined in the font, so they are not limited to
explicitly registered OpenType features. Fonts defining custom feature
tags should follow the
<a href="https://www.microsoft.com/typography/otspec/featuretags.htm">tag name rules</a>
defined in the OpenType specification [[!OPENTYPE-FEATURES]].

<p>Feature tags not present in the font are ignored; a user agent must
not attempt to synthesize fallback behavior based on these feature
tags.  The one exception is that user agents may synthetically support
the <span class="tag">kern</span> feature with fonts that contain
kerning data in the form of a 'kern' table but lack
<span class="tag">kern</span> feature support in the 'GPOS' table.</p>

<p class="note">In general, authors should use the 'font-kerning' property to
explicitly enable or disable kerning since this property always affects
fonts with either type of kerning data.</p>

<p>If present, a value indicates an index used for glyph selection.
An &lt;integer&gt; value must be 0 or greater. A value of 0
indicates that the feature is disabled.  For boolean features, a
value of 1 enables the feature.  For non-boolean features, a value
of 1 or greater enables the feature and indicates the feature
selection index. A value of 'on' is synonymous with 1 and 'off' is
synonymous with 0. If the value is omitted, a value of 1 is assumed.
</p>

<pre>
font-feature-settings: "dlig" 1;       /* dlig=1 enable discretionary ligatures */
font-feature-settings: "smcp" on;      /* smcp=1 enable small caps */
font-feature-settings: 'c2sc';         /* c2sc=1 enable caps to small caps */
font-feature-settings: "liga" off;     /* liga=0 no common ligatures */
font-feature-settings: "tnum", 'hist'; /* tnum=1, hist=1 enable tabular numbers and historical forms */
font-feature-settings: "tnum" "hist";  /* invalid, need a comma-delimited list */
font-feature-settings: "silly" off;    /* invalid, tag too long */
font-feature-settings: "PKRN";         /* PKRN=1 enable custom feature */
font-feature-settings: dlig;           /* invalid, tag must be a string */
</pre>

<p>When values greater than the range supported by the font are
specified, the behavior is explicitly undefined.  For boolean
features, in general these will enable the feature.  For non-boolean
features, out of range values will in general be equivalent to a 0
value.  However, in both cases the exact behavior will depend upon the
way the font is designed (specifically, which type of lookup is used
to define the feature).</p>

<p>Although specifically defined for OpenType feature tags, feature
tags for other modern font formats that support font features may be
added in the future.  Where possible, features defined for other font
formats should attempt to follow the pattern of registered OpenType
tags.</p>

<div class="example">
<p>The Japanese text below will be rendered with half-width kana characters:</p>

<pre lang="ja">
body { font-feature-settings: "hwid"; /* Half-width OpenType feature */ }

&lt;p>毎日<a href="https://images.google.com/images?q=%E3%82%AB%E3%83%AC%E3%83%BC" style="text-decoration: none;">カレー</a>食べてるのに、飽きない&lt;/p>
</pre>
</div>

<h3 id="font-language-override-prop">Font language override: the <a href="#propdef-font-language-override">font-language-override</a> property</h3>
<table class="propdef">
  <tbody>
    <tr>
      <td>Name:</td>
      <td><dfn id="propdef-font-language-override">font-language-override</dfn></td>
    </tr>
    <tr>
      <td>Value:</td>
      <td><span title="normal!!font-language-override">normal</span> | <var>&lt;string&gt;</var></td>
    </tr>
    <tr>
      <td>Initial:</td>
      <td><span title="normal!!font-language-override">normal</span></td>
    </tr>
    <tr>
      <td>Applies to:</td>
      <td>all elements</td>
    </tr>
    <tr>
      <td>Inherited:</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Percentages:</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Media:</td>
      <td>visual</td>
    </tr>
    <tr>
      <td>Computed&nbsp;value:</td>
      <td>as specified</td>
    </tr>
    <tr>
      <td>Animatable:</td>
      <td>no</td>
    </tr>
  </tbody>
</table>

<p>Normally, authors can control the use of language-specific glyph substitutions and positioning
by setting the content language of an element, as <a href="#language-specific-support">described above</a>:</p>

<pre>&lt;!-- Display text using S'gaw Karen specific features -->
&lt;p lang="ksw">...&lt;/p></pre>

<p>In some cases, authors may need to specify a language system
that differs from the content language, for example due to the need to mimic another language's
typographic traditions.  The 'font-language-override' property allows authors to explicitly specify
the language system of the font, overriding the language system implied by the content language.</p>

<p>Values have the following meanings:</p>

<dl>
  <dt><dfn id="font-language-override-normal-value" title="normal!!font-language-override">normal</dfn></dt>
  <dd>specifies that when rendering with OpenType fonts,
      the content language of the element is used to infer the OpenType language system</dd>
  <dt><dfn data-dfn-type=value data-dfn-for=font-language-override id="font-language-override-string-value"><var>&lt;string&gt;</var></dfn></dt>
  <dd>single three-letter case-sensitive OpenType <a href="https://www.microsoft.com/typography/otspec/languagetags.htm">language system tag</a>,
      specifies the OpenType language system to be used instead of the language system implied by the language of the element</dd>
</dl>

<!-- For this level, string represents a single language code, there's no concept of "fallback"
https://www.w3.org/2013/06/07-css-minutes.html#item04 -->

<p>Use of invalid OpenType language system tags must not generate a
parse error but must be ignored when doing glyph selection and
placement.</p>

<div class="example">
<p>The <a href="https://www.un.org/en/documents/udhr/index.shtml">Universal Declaration of Human Rights</a> has
been translated into a wide variety of languages.  In Turkish, Article 9 of this document might be marked up as below:</p>

<pre lang="tr">&lt;body lang="tr">

&lt;h4>Madde 9&lt;/h4>
&lt;p>Hiç kimse keyfi olarak tutuklanamaz, alıkonulanamaz veya sürülemez.&lt;/p>
</pre>

<p>Here the user agent uses the value of the 'lang' attribute when rendering text and
appropriately renders this text without 'fi' ligatures.  There is no need
to use the 'font-language-override' property.</p>

<p>However, a given font may lack support for a specific language.  In this
situation authors may need to use the typographic conventions of a related language
that are supported by that font:</p>

<pre lang="mk">&lt;body lang="mk">     &lt;!-- Macedonian lang code --&gt;

body { font-language-override: "SRB"; /* Serbian OpenType language tag */ }

&lt;h4>Члeн 9&lt;/h4>
&lt;p>Никoj чoвeк нeмa дa бидe пoдлoжeн нa прoизвoлнo aпсeњe, притвoр или прoгoнувaњe.&lt;/p>

</pre>

<p>The Macedonian text here will be rendered using Serbian typographic conventions, with the
assumption that the font specified supports Serbian.</p>
</div>

<a id="rendering-considerations"></a>
<h2 id="font-feature-resolution">Font Feature Resolution</h3>

<p>As described in the previous section, font features can be enabled
in a variety of ways, either via the use of <span title="font-variant!!property">'font-variant'</span> or
<span title="font-feature-settings!!property">'font-feature-settings'</span> in a style rule or within an <code>@font-face</code> rule.
The resolution order for the union of these settings is defined below.
Features defined via CSS properties are applied on top of layout engine
default features.</p>

<h3 id="default-features">Default features</h3>

<p>For OpenType fonts, user agents must enable the default features defined
in the OpenType documentation for a given script and writing mode.  Required ligatures,
common ligatures and contextual forms must be enabled by default
(OpenType features: <span class="tag">rlig, liga, clig, calt</span>),
along with localized forms (OpenType feature: <span class="tag">locl</span>),
and features required for proper display of composed characters and marks
(OpenType features: <span class="tag">ccmp, mark, mkmk</span>).  These features
must always be enabled, even when the value of the
<span title="font-variant!!property">'font-variant'</span> and
<span title="font-feature-settings!!property">'font-feature-settings'</span> properties is
<span title="normal value">'normal'</span>.
Individual features are only disabled when explicitly overridden by the author, as when
'font-variant-ligatures' is set to 'no-common-ligatures'.
For handling complex scripts such as
<a href="https://www.microsoft.com/typography/otfntdev/arabicot/features.aspx">Arabic</a>,
<a href="https://www.microsoft.com/typography/otfntdev/mongolot/features.htm">Mongolian</a> or
<a href="https://www.microsoft.com/typography/otfntdev/devanot/features.aspx">Devanagari</a>
additional features are required.  For upright text within vertical text runs, vertical
alternates (OpenType feature: <span class="tag">vert</span>) must be enabled.</p>

<h3 id="feature-precedence">Feature precedence</h3>

<p>General and <em>font specific</em> font feature property settings are
resolved in the order below, in ascending order of precedence.  This ordering is
used to construct a combined list of font features that affect a given
text run.</p>

<ol>
  <li>Font features enabled by default, including features required for a given script.</li>

  <li>If the font is defined via an <code>@font-face</code> rule, the font features
  implied by the font-variant descriptor in the <code>@font-face</code> rule.</li>

  <li>If the font is defined via an <code>@font-face</code> rule, the font features
  implied by the font-feature-settings descriptor in the <code>@font-face</code> rule.</li>

  <li>Font features implied by the value of the <span title="font-variant!!property">'font-variant'</span> property,
  the related <span title="font-variant!!property">'font-variant'</span> subproperties and any other CSS property
  that uses OpenType features (e.g. the 'font-kerning' property).</li>

  <!-- other CSS props override 'font-variant' but not 'font-feature-settings' -->
  <!-- http://lists.w3.org/Archives/Public/www-style/2013Aug/0110.html -->

  <li>Feature settings determined by properties other than
  <span title="font-variant!!property">'font-variant'</span> or
  <span title="font-feature-settings!!property">'font-feature-settings'</span>.  For example, setting a
  non-default value for the 'letter-spacing' property disables common ligatures.</li>

  <li>Font features implied by the value of <span title="font-feature-settings!!property">'font-feature-settings'</span> property.</li>
</ol>

<p>This ordering allows authors to set up a general set of defaults
for fonts within their <code>@font-face</code> rules, then override them with
property settings for specific elements.  General property settings
override the settings in <code>@font-face</code> rules and low-level font feature
settings override <span title="font-variant!!property">'font-variant'</span> property settings.
</p>

<p>For situations where the combined list of font feature settings
contains more than one value for the same feature, the last value is
used. When a font lacks support for a given underlying font feature,
text is simply rendered as if that font feature was not enabled; font
fallback does not occur and no attempt is made to synthesize the
feature except where explicitly defined for specific properties.
</p>

<h3 id="feature-precedence-examples">Feature precedence examples</h3>

<div class="example">
<p>With the styles below, numbers are rendered proportionally when used within
a paragraph but are shown in tabular form within tables of prices:</p>

<pre>body {
  font-variant-numeric: proportional-nums;
}

table.prices td {
  font-variant-numeric: tabular-nums;
}
</pre>
</div>

<div class="example">
<p>When the <span title="font-variant!!descriptor">font-variant</span> descriptor
is used within an <code>@font-face</code> rule, it only
applies to the font defined by that rule.</p>

<pre>@font-face {
  font-family: MainText;
  src: url(http://example.com/font.woff);
  font-variant: oldstyle-nums proportional-nums styleset(1,3);
}

body {
  font-family: MainText, Helvetica;
}

table.prices td {
  font-variant-numeric: tabular-nums;
}
</pre>

<p>In this case, old-style numerals will be used throughout but only
where the font "MainText" is used. Just as in the previous example,
tabular values will be used in price tables since 'tabular-nums'
appears in a general style rule and its use is mutually exclusive with
'proportional-nums'.  Stylistic alternate sets will only be used where
MainText is used.</p> </div>

<div class="example">
<p>The <code>@font-face</code> rule can also be used to access font features in locally available
fonts via the use of <code>local()</code> in the 'src' descriptor of the <code>@font-face</code> definition:</p>

<pre>@font-face {
  font-family: BodyText;
  src: local("HiraMaruPro-W4");
  font-variant: proportional-width;
  font-feature-settings: "ital"; /* Latin italics within CJK text feature */
}

body { font-family: BodyText, serif; }
</pre>

<p>If available, a Japanese font "Hiragino Maru Gothic" will be used.  When text
rendering occurs, Japanese kana will be proportionally spaced and Latin text will
be italicised.  Text rendered with the fallback serif font will use default
rendering properties.</p>
</div>

<div class="example">
<p>In the example below, discretionary ligatures are enabled only for a downloadable font
but are disabled within spans of class "special":</p>

<pre>@font-face {
  font-family: main;
  src: url(fonts/ffmeta.woff) format("woff");
  font-variant: discretionary-ligatures;
}

body         { font-family: main, Helvetica; }
span.special { font-variant-ligatures: no-discretionary-ligatures; }
</pre>

<p>Suppose one adds a rule using 'font-feature-settings' to enable discretionary ligatures:</p>

<pre>body         { font-family: main, Helvetica; }
span         { font-feature-settings: "dlig"; }
span.special { font-variant-ligatures: no-discretionary-ligatures; }
</pre>

<p>In this case, discretionary ligatures <em>will</em> be rendered within spans of class "special".
This is because both the <span title="font-feature-settings!!property">'font-feature-settings'</span> and 'font-variant-ligatures' properties
apply to these spans.  Although the 'no-discretionary ligatures' setting of 'font-variant-ligatures'
effectively disables the OpenType <span class="tag">dlig</span> feature, because the <span title="font-feature-settings!!property">'font-feature-settings'</span>
is resolved after that, the 'dlig' value reenables discretionary ligatures.</p>
</div>

<h2 id="object-model">Object Model</h2>

<p>The contents of <code>@font-face</code> and <code>@font-feature-values</code> rules can be accessed via
the following extensions to the CSS Object Model.</p>

<h3 id="om-fontface">The <code>CSSFontFaceRule</code> interface</h3>

<p>The <dfn>CSSFontFaceRule</dfn> interface represents a <code>@font-face</code> rule.</p>

<pre class="idl">
interface CSSFontFaceRule : CSSRule {
  // Intentionally left blank in this specification.
}</pre>

<p class="note">The CSS Working Group would like <code>CSSFontFaceRule</code> to have
one attribute for each <code>@font-face</code> descriptor,
<a href="../css-fonts-4/#om-fontface">as specified in CSS Fonts Level 4</a>.
As of this writing however, no implementation implements these attributes
and instead implement the <code>style</code> attribute defined in
the DOM Level 2 Style specification [[DOM-LEVEL-2-STYLE]].

<h3 id="om-fontfeaturevalues">The <code>CSSFontFeatureValuesRule</code> interface</h3>

<p>The <code>CSSRule</code> interface is extended as follows:</p>

<pre class='idl'>partial interface CSSRule {
  const unsigned short FONT_FEATURE_VALUES_RULE = 14;
}</pre>

<p>The <dfn>CSSFontFeatureValuesRule</dfn> interface represents a <code>@font-feature-values</code> rule.</p>

<pre class='idl'>interface CSSFontFeatureValuesRule : CSSRule {
  attribute CSSOMString fontFamily;
  readonly attribute CSSFontFeatureValuesMap annotation;
  readonly attribute CSSFontFeatureValuesMap ornaments;
  readonly attribute CSSFontFeatureValuesMap stylistic;
  readonly attribute CSSFontFeatureValuesMap swash;
  readonly attribute CSSFontFeatureValuesMap characterVariant;
  readonly attribute CSSFontFeatureValuesMap styleset;
}

[MapClass(CSSOMString, sequence&lt;unsigned long&gt;)]
interface CSSFontFeatureValuesMap {
  void set(CSSOMString featureValueName,
           (unsigned long or sequence&lt;unsigned long&gt;) values);
}</pre>

<dl class='idl-attributes'>
<dt><var>fontFamily</var> of type <code>CSSOMString</code>
<dd>The list of one or more font families for which a given set of feature values is defined.</dd>
<dt>value maps of type <code>CSSFontFeatureValuesMap</code>, readonly
<dd>Maps of feature values associated with feature value names for a given 'font-variant-alternates' value type</dd>
</dl>

<p>Each value map attribute of <code>CSSFontFeatureValuesRule</code> reflects the values
defined via a corresponding <i title="feature_value_block">feature value block</i>.
Thus, the <var title="annotation attribute">annotation</var> attribute
contains the values contained within a <code title="&#64;annotation">@annotation</code>
<i title="feature_value_block">feature value block</i>, the
<var title="ornaments attribute">ornaments</var> attribute contains the
values contained with a <code title="&#64;ornaments">@ornaments</code>
<i title="feature_value_block">feature value block</i> and so forth.</p>

<p>The <code>CSSFontFeatureValuesMap</code> interface uses the
<a href="https://dev.w3.org/2006/webapi/WebIDL/#es-map-members">default map class methods</a>
but the <code>set</code> method has different behavior.  It takes a sequence of unsigned integers and
associates it with a given <code>featureValueName</code>. The method
behaves the same as the default map class method
except that a single unsigned long value is treated as a sequence of a
single value. The method throws an exception if an invalid number of
values is passed in.  If the associated
<i title="feature_value_block">feature value block</i>
only allows a limited number of values, the <code>set</code> method
throws an <code>InvalidAccessError</code> exception when the input
sequence to <code>set</code> contains more than the limited number of
values.  See the
description of <a href="#multi-valued-feature-value-definitions">multi-valued feature value definitions</a>
for details on the maximum number of values allowed for a given type
of <i title="feature_value_block">feature value block</i>.  The <code>get</code>
method always returns a sequence of values, even if the sequence only contains
a single value.</p>

<h2 id="platform-props-to-css" class="no-num">Appendix A: Mapping platform font properties to CSS properties</h2>

<em>This appendix is included as background for some of the problems and
situations that are described in other sections.  It should be viewed as
informative only.</em>

<p>Font properties in CSS are designed to be independent of the
underlying font formats used; they can be used to specify bitmap fonts,
Type1 fonts, SVG fonts in addition to the common TrueType and OpenType
fonts.  But there are facets of the TrueType and OpenType formats that often
cause confusion for authors and present challenges to implementers
on different platforms.</p>

<p>Originally developed at Apple, TrueType was designed as an outline
font format for both screen and print.  Microsoft joined Apple in
developing the TrueType format and both platforms have supported
TrueType fonts since then.  Font data in the TrueType format consists of
a set of tables distinguished with common four-letter tag names, each
containing a specific type of data.  For example, naming information,
including copyright and license information, is stored in the 'name'
table.  The <em>character map</em> ('cmap') table contains a mapping of character
encodings to glyphs.  Apple later added additional tables for supporting
enhanced typographic functionality; these are now called Apple Advanced
Typography, or AAT, fonts.  Microsoft and Adobe developed a separate set
of tables for advanced typography and called their format OpenType [[!OPENTYPE]].
</p>

<p>In many cases the font data used under Microsoft Windows or Linux
is slightly different from the data used under Apple's Mac OS X
because the TrueType format allowed for explicit variation across
platforms.  This includes font metrics, names and <em>character map</em>
data.</p>

<p>Specifically, font family name data is handled differently across
platforms. For TrueType and OpenType fonts these names are contained
in the 'name' table, in name records with name ID 1.  Mulitple names
can be stored for different locales, but Microsoft recommends fonts
always include at least a US English version of the name.  On Windows,
Microsoft made the decision for backwards compatibility to limit this
family name to a maximum of four faces; for larger groupings the
"preferred family" (name ID 16) or "WWS family" (name ID 21) can be
used.  Other platforms such as OSX don't have this limitation, so the
family name is used to define all possible groupings.</p>

<p>Other name table data provides names used to uniquely identify a
specific face within a family.  The full font name (name ID 4) and the
Postscript name (name ID 6) describe a single face uniquely.  For example, the bold
face of the Gill Sans family has a fullname of "Gill Sans Bold" and a
Postscript name of "GillSans-Bold". There can be multiple localized
versions of the fullname for a given face, but the Postscript name is
always a unique name made from a limited set of ASCII characters.</p>

<p>On various platforms, different names are used to search for a
font. For example, with the Windows GDI CreateIndirectFont API, either
a family or fullname can be used to lookup a face, while on Mac OS X
the CTFontCreateWithName API call is used to lookup a given face
using the fullname and Postscript name.  Under Linux, the fontconfig
API allows fonts to be searched using any of these names.  In
situations where platform API's automatically substitute other font
choices, it may be necessary to verify a returned font matches a given
name.</p>

<p>The weight of a given face can be determined via the usWeightClass
field of the OS/2 table or inferred from the style name (name ID 2).
Likewise, the width can be determined via the usWidthClass of the OS/2
table or inferred from the style name.  For historical reasons related
to synthetic bolding at weights 200 or lower with the Windows GDI API, font
designers have sometimes skewed values in the OS/2 table to avoid
these weights.</p>

<p>Rendering complex scripts that use contextual shaping such as Thai,
Arabic and Devanagari requires features present only in OpenType or AAT
fonts.  Currently, complex script rendering is supported on Windows and
Linux using OpenType font features while both OpenType and AAT font features are used
under Mac OS X.</p>

<h2 class="no-num" id="ch-ch-ch-changes">Changes</h2>
  <h3 class="no-num" id="recent-changes">
  Changes from the <a href="https://www.w3.org/TR/2013/CR-css-fonts-3-20131003/">October 2013 CSS3 Fonts Candidate Recommendation</a></h3>

  <ul>
    <li>add omitted 'font-variant-position' values to <span title="font-variant!!property">'font-variant'</span> shorthand</li>
    <li>make negative values for font-size-adjust invalid, along with negative percentage font-size values</li>
    <li>remove the requirement that user agents use OS/2 table subscript/superscript metrics</li>
    <li>minor editorial cleanups</li>
  </ul>

<h2 class=no-num id=acknowledgments>Acknowledgments</h2>

<p>I'd like to thank Tal Leming, Jonathan Kew and Christopher Slye for
all their help and feedback.  John Hudson was kind enough to take the
time to explain the subtleties of OpenType language tags and provided
the example of character variant usage for displaying text on
Byzantine seals. Ken Lunde and Eric Muller provided valuable feedback
on CJK OpenType features and Unicode variation selectors. The idea for
supporting font features by using <span title="font-variant!!property">'font-variant'</span> subproperties
originated with Håkon Wium Lie, Adam Twardoch and Tal Leming.  Elika
Etemad supplied some of the initial design ideas for the
<code>@font-feature-values</code> rule.  Thanks also to House Industries for
allowing the use of Ed Interlock in the discretionary ligatures
example.</p>

<p>A special thanks to Robert Bringhurst for the sublime mind expansion
that is <em>The Elements of Typographic Style</em>.</p>

<h2 id="conformance" class='no-num'>
Conformance</h2>

<h3 id="conventions" class='no-num'>
Document Conventions</h3>

	<p>Conformance requirements are expressed with a combination of
	descriptive assertions and RFC 2119 terminology. The key words “MUST”,
	“MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
	“RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
	document are to be interpreted as described in RFC 2119.
	However, for readability, these words do not appear in all uppercase
	letters in this specification.

	<p>All of the text of this specification is normative except sections
	explicitly marked as non-normative, examples, and notes. [[!RFC2119]]

	<p>Examples in this specification are introduced with the words “for example”
	or are set apart from the normative text with <code>class="example"</code>,
	like this:

	<div class="example">
		<p>This is an example of an informative example.
	</div>

	<p>Informative notes begin with the word “Note” and are set apart from the
	normative text with <code>class="note"</code>, like this:

	<p class="note">Note, this is an informative note.

<h3 id="conformance-classes" class='no-num'>
Conformance Classes</h3>

	<p>Conformance to CSS Fonts Level 3 Module
	is defined for three conformance classes:
	<dl>
		<dt><dfn title="style sheet!!as conformance class">style sheet</dfn>
			<dd>A <a href="https://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
			style sheet</a>.
		<dt><dfn>renderer</dfn></dt>
			<dd>A <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
			that interprets the semantics of a style sheet and renders
			documents that use them.
		<dt><dfn id="authoring-tool">authoring tool</dfn></dt>
			<dd>A <a href="https://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
			that writes a style sheet.
	</dl>

	<p>A style sheet is conformant to CSS Fonts Level 3 Module
	if all of its declarations that use properties defined in this module
	have values that are valid according to the generic CSS grammar and the
	individual grammars of each property as given in this module.

	<p>A renderer is conformant to CSS Fonts Level 3 Module
	if, in addition to interpreting the style sheet as defined by the
	appropriate specifications, it supports all the features defined
	by CSS Fonts Level 3 Module by parsing them correctly
	and rendering the document accordingly. However, the inability of a
	UA to correctly render a document due to limitations of the device
	does not make the UA non-conformant. (For example, a UA is not
	required to render color on a monochrome monitor.)

	<p>An authoring tool is conformant to CSS Fonts Level 3 Module
	if it writes style sheets that are syntactically correct according to the
	generic CSS grammar and the individual grammars of each feature in
	this module, and meet all other conformance requirements of style sheets
	as described in this module.

<h3 id="partial" class='no-num'>
Partial Implementations</h3>

	<p>So that authors can exploit the forward-compatible parsing rules to
	assign fallback values, CSS renderers <strong>must</strong>
	treat as invalid (and <a href="https://www.w3.org/TR/CSS21/conform.html#ignore">ignore
	as appropriate</a>) any at-rules, properties, property values, keywords,
	and other syntactic constructs for which they have no usable level of
	support. In particular, user agents <strong>must not</strong> selectively
	ignore unsupported component values and honor supported values in a single
	multi-value property declaration: if any value is considered invalid
	(as unsupported values must be), CSS requires that the entire declaration
	be ignored.

<h3 id="experimental" class='no-num'>
Experimental Implementations</h3>

	<p>To avoid clashes with future CSS features, the CSS2.1 specification
	reserves a <a href="https://www.w3.org/TR/CSS21/syndata.html#vendor-keywords">prefixed
	syntax</a> for proprietary and experimental extensions to CSS.

	<p>Prior to a specification reaching the Candidate Recommendation stage
	in the W3C process, all implementations of a CSS feature are considered
	experimental. The CSS Working Group recommends that implementations
	use a vendor-prefixed syntax for such features, including those in
	W3C Working Drafts. This avoids incompatibilities with future changes
	in the draft.


<h3 id="testing" class='no-num'>
Non-Experimental Implementations</h3>

	<p>Once a specification reaches the Candidate Recommendation stage,
	non-experimental implementations are possible, and implementors should
	release an unprefixed implementation of any CR-level feature they
	can demonstrate to be correctly implemented according to spec.

	<p>To establish and maintain the interoperability of CSS across
	implementations, the CSS Working Group requests that non-experimental
	CSS renderers submit an implementation report (and, if necessary, the
	testcases used for that implementation report) to the W3C before
	releasing an unprefixed implementation of any CSS features. Testcases
	submitted to W3C are subject to review and correction by the CSS
	Working Group.

	<p>Further information on submitting testcases and implementation reports
	can be found from on the CSS Working Group's website at
	<a href="https://www.w3.org/Style/CSS/Test/">https://www.w3.org/Style/CSS/Test/</a>.
	Questions should be directed to the
	<a href="https://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
	mailing list.

<h3 id="cr-exit-criteria" class='no-num'>CR Exit Criteria</h3>

  <p class="replaceme">Remove this section unless/until the module is in CR.</p>

  <!-- This text was <a href="http://www.w3.org/Style/CSS/Tracker/actions/44"> decided on 2008-06-04.</a> -->

  <p>
  For this specification to be advanced to Proposed Recommendation,
  there must be at least two independent, interoperable implementations
  of each feature. Each feature may be implemented by a different set of
  products, there is no requirement that all features be implemented by
  a single product. For the purposes of this criterion, we define the
  following terms:

  <dl>
    <dt>independent <dd>each implementation must be developed by a
    different party and cannot share, reuse, or derive from code
    used by another qualifying implementation. Sections of code that
    have no bearing on the implementation of this specification are
    exempt from this requirement.

    <dt>interoperable <dd>passing the respective test case(s) in the
    official CSS test suite, or, if the implementation is not a Web
    browser, an equivalent test. Every relevant test in the test
    suite should have an equivalent test created if such a user
    agent (UA) is to be used to claim interoperability. In addition
    if such a UA is to be used to claim interoperability, then there
    must one or more additional UAs which can also pass those
    equivalent tests in the same way for the purpose of
    interoperability. The equivalent tests must be made publicly
    available for the purposes of peer review.

    <dt>implementation <dd>a user agent which:

    <ol class=inline>
      <li>implements the specification.

      <li>is available to the general public. The implementation may
      be a shipping product or other publicly available version
      (i.e., beta version, preview release, or “nightly build”).
      Non-shipping product releases must have implemented the
      feature(s) for a period of at least one month in order to
      demonstrate stability.

      <li>is not experimental (i.e., a version specifically designed
      to pass the test suite and is not intended for normal usage
      going forward).
    </ol>
  </dl>

  <p>The specification will remain Candidate Recommendation for at least
  six months.


<h2 class="no-num" id=references>References</h2>

<h3 class="no-num" id="normative-references">Normative References</h3>

<!-- normative -->

<!--{{!CSS21}}-->

<!--{{!CSS3VAL}}-->

<!--{{!OPENTYPE}}-->

<!--{{!OPENTYPE-FEATURES}}-->

<!--{{!OPEN-FONT-FORMAT}}-->

<!--{{!UNICODE}}-->

<!--{{!UAX15}}-->

<!--{{!UAX29}}-->

<!--{{!CORS}}-->

<!--{{!HTML5}}-->

<!--{{!CHARMOD}}-->

<h3 class="no-num" id="other-references">Other References</h3>

<!-- informative -->

<!--{{ARABIC-TYPO}}-->

<!--{{CJKV-INFO-PROCESSING}}-->

<!--{{DIGITAL-TYPOGRAPHY}}-->

<!--{{DOM-LEVEL-2-STYLE}}-->

<!--{{ELEMTYPO}}-->

<!--{{LANGCULTTYPE}}-->

<!--{{OPENTYPE-FONT-GUIDE}}-->

<!--{{RASTER-TRAGEDY}}-->

<!--{{WINDOWS-GLYPH-PROC}}-->

<!--{{CHARMOD-NORM}}-->

<!--{{AAT-FEATURES}}-->

<!--{{CSS3-CONDITIONAL}}-->

<!--{{CSS3TEXT}}-->

<h2 class="no-num" id="index">Index</h2>
<!--index-->


<h2 class="no-num" id="property-index">Property index</h2>
<!-- properties -->
<!-- descriptors -->

<script type="text/javascript">
window.onload = function () {
  if (!("devicePixelRatio" in window && window.devicePixelRatio > 1)) return;
  var i, hiresElements = document.getElementsByClassName("hires");
  for (i = 0; i < hiresElements.length; i++) {
    var h = hiresElements[i];
    if (h.tagName != "IMG") continue;
    var src = h.getAttribute("src");
    var src2x = src.replace(/\.\w+$/, function(m) { return "@2x" + m; });
    h.src = src2x;
  }
}
</script>

</body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
