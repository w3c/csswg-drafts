<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="en">
<!-- $Id: page.src,v 1.10 1997-10-30 08:37:26 ian Exp $ -->
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<TITLE>Paged media</TITLE>
<LINK rel="next" href="colors.html">
<LINK rel="previous" href="flowobj2.html">
<LINK rel="STYLESHEET" href="style/default.css" type="text/css">
</HEAD>
<BODY>
<H1 align="center"><a name="the-page">Paged media</a></H1>

<H2>Introduction to paged media</H2>

<P>Paged media -- paper, transparencies, computer screens that display
pages, etc. -- differ from <a
href="./media.html#scrolled-media">scrolled media</a> in that
formatting algorithms for pages must account for <a
href="./#page-breaks">page breaks.</a> 

<P>To handle page breaks, CSS2 extends two previous models:

<ol>
<li>The <span class="index-def" title="page box"><dfn>page
box</dfn></span> extends the <a href="box.html#box-model">box model</a>
to allow authors to specify the size of a page, its margins, etc.
<li>The <span class="index-def" title="page model"><dfn>page
model</dfn></span> extends the  <a
href="flowobj.html#flow-model">visual flow model</a> to 
account for <a href="#page-breaks">page breaks.</a>
In the page model, the <a href="media.html#canvas">canvas</a>
is the page box.
</ol>

<P>The <a name="page-model">page model</a> specifies how a document is
formatted within a rectangular area -- the <a name="page-box">page
box</a> -- that has a finite width and height. The <a
href="#page-boxes">page box</a> is an abstract rectangle that does not
necessarily correspond to the <span class="index-def" title="sheet">
<dfn>sheet</dfn></span> where the document will ultimately be rendered
(paper, transparency, screen, etc.).

<P>The CSS page model specifies formatting in the page box, but it is
the user agent's responsibility to transfer the page box to the
sheet. Some transfer possibilities include:

<ul>
<li>Transferring one page box to one sheet (e.g., single-sided printing).
<li>Transferring two page boxes to both sides of the same sheet (e.g.,
double-sided printing).
<li>Transferring N (small) page boxes to one sheet (called <span
	    class="index-def" title="n-up"><em>n-up</em></span>
	  printing).
<li>Transferring one (large) page box to N x M sheets (called "tiling").
<li>Printing signatures (a group of pages
printed on a sheet, which, when folded and trimmed like a book, appear in their
proper sequence).
<li>Printing one document to several output trays.
<li>Transferring to a file.
</ul>

<P>This document does not specify how user agents transfer page boxes
to sheets. It does allow users to provide the user agent (often
through a dialog box) with information about the size of the sheet and
the orientation of the transfer (see the <span
class="propinst-size">'size'</span> property).

<H2><a name="page-breaks">Page breaks</a></H2>

<P>The following sections explain page formatting in CSS2. Four
properties indicate where the user agent may or should break pages,
and on what page (left or right) the subsequent content should resume.
Each page break ends the current page box and begins the next.

<P>These properties have been designed to support the <span
class="index-def" title="print medium|medium, print">PRINT</span>
medium, but can also be applied to other <a
href="media.html#media-types">paged media</a>, for example <span
class="index-def" title="projector medium|medium,
projector">PROJECTOR</span> medium.

<h3>Page break properties: <span
class="propinst-page-break-before">'page-break-before'</span>,
<span class="propinst-page-break-after">'page-break-after'</span>, 
<span class="propinst-orphans">'orphans'</span>, and
<span class="propinst-widows">'widows'</span>
</h3>

<!-- #include src=properties/page-break-before.srb -->

<!-- #include src=properties/page-break-after.srb -->

<P>Values for these properties have the following meanings:

<dl>
<dt><strong>auto</strong></dt>
<dd>Neither force nor forbid a page break before (resp., after) the element
<dt><strong>always</strong></dt>
<dd>Always force a page break before (resp., after) the element </dd>
<dt><strong>avoid</strong></dt>
<dd>Avoid a page break before (resp., after) the element.
<dt><strong>left</strong></dt>
<dd>Force one or two page breaks before (resp., after) the element
so that the next page to be formatted is a left page.</dd>
<dt><strong>right</strong></dt>
<dd>Force one or two page breaks before (resp., after) the element 
so that the next page to be formatted is a right page.</dd>
</dl>

<P>When both properties apply, 'always', 'left', and 'right' take
precedence over 'avoid'.  See the section on <a
href="#allowed-page-breaks">allowed page breaks</a> for the exact
rules on how these values force or suppress a page break.

<!-- #include src=properties/orphans.srb -->

<!-- #include src=properties/widows.srb -->

<P>These properties specify the minimum number of lines of a paragraph
that must be left at the bottom (<span
class="propinst-orphans">'orphans'</span>) and top (<span
class="propinst-widows">'widows'</span>) of a page.


<h3><a name="allowed-page-breaks">Allowed page breaks</a></h3>

<p>In the normal flow, page breaks can occur at the following places:

<ol>
<li>
In the vertical margin between block-level elements. When a page
break occurs here, the margin disappears (becomes zero).
<li>
Between lines inside a block-level element.
</ol>

<p>These breaks are subject to the following rules:

<ol style="list-style-type: upper-alpha">
<li>Breaking at (1) is only allowed if the <span
class="propinst-break-after">'break-after'</span> and <span
class="propinst-break-before">'break-before'</span> properties of all
the elements that meet at this margin allow it, which is when at least
one of them has the value 'always', 'left', or 'right', or when all of them are
'auto'.
<li>
Breaking at (2) is only allowed if the number of lines between the
break and the start of the block is <span
class="propinst-orphans">'orphans'</span> or more, and the number of
lines between the break and the end of the block is <span
class="propinst-widows">'widows'</span> or more.
</ol>

<p>There is an exception to both rules:

<ol start="3" style="list-style-type: upper-alpha">
<li>
Breaking at (1) and (2) is also allowed if, between the last page break
and the next one that would be allowed under (A) and (B), there is so
much content that it can't fit on a page.
</ol>

<P>Page breaks cannot occur inside positioned elements. 

<h3>Forced page breaks</h3>

<p>A page break <em>must</em> occur at (1) if, among the <span
class="propinst-break-after">'break-after'</span> and <span
class="propinst-break-before">'break-before'</span> properties of all
the elements that meet at this margin, there is at least one with the value
'always', 'left', or 'right'.

<h3>"Best" page breaks</h3>

<p>CSS does <em>not</em> define which of the page breaks allowed by
(A), (B), or (C) should be used. In particular, CSS does not forbid a
UA from breaking at every possible break point, or not to break at all. But
CSS does recommend that UAs observe the following heuristics (while
recognizing that they are sometimes contradictory):

<ul>
<li>
Break as few times as possible.
<li>
Make all pages that don't end with a forced break appear to have about
the same height.
<li>
Avoid breaking inside a block that has a border.
<li>
Avoid breaking inside a table.
<li>
Avoid breaking inside a floating element
</ul>

<div class="example"><P> 
Suppose, for example, that <span
class="propinst-orphans">'orphans'</span>=4, <span
class="propinst-widows">'widows'</span>=2, and 
there are 20 lines available at the bottom of the current page:

<ul>

<li>If a paragraph at the end of the current page contains 20 lines or fewer,
it should be placed on the current page.

<li>If the paragraph contains 21 - 22 lines, the second part of the
paragraph must not violate the <span
class="propinst-widows">'widows'</span> constraint, and so the
second part must contain exactly two lines

<li>If the paragraph contains 23 lines or more, the first part should
contain 20 lines and the second part the remaining lines.
						    
</ul>

<P>Now suppose that <span class="propinst-orphans">'orphans'</span>=10,
<span class="propinst-widows">'widows'</span>=20, 
and there are 8 lines available at the bottom of the current page:

<ul>

<li>If a paragraph at the end of the current page contains 8 lines or
less, it should be placed on the current page.

<li>If the paragraph contains 9 or more lines, it cannot be split
(that would violate the orphan constraint), so it should move 
as a block to the next page.
</ul>
</div>

<H2><a name="page-boxes">Page boxes</a>: the @page rule</H2>

<P>CSS2 allows authors to specify the dimensions of the page box, the
margins, and several other properties relative to each page. However,
since some document languages (e.g., HTML) do not define elements that
represent "the page", these properties are specified for an entire
document via the <span class="index-def" title="@page">@page</span>
rule.

<div class="example"><P>
For example, the following @page rule sets the margins of the page to 2cm.

<pre>
   @page { margin: 2cm }
</pre>
</div>

<p>Declarations inside the curly braces of the @page rule apply to
every page of a document. These declarations are said to be in the
<span class="index-def" title="page-context"><em>page
context</em></span>, and they describe the <a href="#page-box">page
box</a> into which the elements of the document are flowed according
to the <a href="#page-model">page model.</a>

<p>The page context allows the <span
class="propinst-size">'size'</span> property to set the size of the
page box and the <span class="propinst-marks">'marks'</span> property
to set crop and cross marks.

<h3><a name="page-margins">Page margins</a></h3>

<P>In addition, the following page margin properties, defined for the
<a href="box.html#box-model">box</a> that surrounds each element,
apply within the page context:

<ul>
<li><span class="propinst-margin-top">'margin-top'</span>
<li><span class="propinst-margin-right">'margin-right'</span>
<li><span class="propinst-margin-bottom">'margin-bottom'</span>
<li><span class="propinst-margin-left">'margin-left'</span>
<li><span class="propinst-margin">'margin'</span>
</ul>

<P>The diagram below shows the relationships between the sheet, page
box, and page margins:</P>

<img src="./images/page-info.gif" alt="Illustration of sheet, page box, and margin.">

<p>Note that the page margins are included in the page box.

<div class="note"><P> 
<em><strong>Note.</strong> In the future, <a
href="./box.html#border-properties">border properties</a> and <a
href="./box.html#padding-properties">padding properties</a> may
also be allowed in the page context.
</em>
</div>

<P>The CSS2 rules for <a
href="flowobj2.html#collapsing-margins">collapsing vertical
margins</a> apply to page margins as well. For example, the margin of
the first element box on a page will collapse with the page margin.

<p>The page context has no notion of fonts, so 'em' and 'ex' units are
not allowed. Percentage values on the margin properties are relative
to the dimensions of the page box.  All other units associated with
the respective CSS2 properties are allowed.

<P>Due to negative margin values (either on the page box or on
elements) or <a href="flowobj.html#absolute-positioning">absolute
positioning</a> content may end up outside the page box, but this
content may be cut -- by the user agent, the printer, or ultimately 
the paper cutter.

<h3>Page size: the <span class="propinst-size">'size'</span> property</h3>

<!-- #include src=properties/size.srb -->

<P>This property specifies the size and orientation of a page box.

<P>The size of a page box may either be "absolute" (fixed size) or
"relative" (scalable, i.e., fitting available sheet sizes). Relative
page boxes allow user agents to scale a document and make optimal use
of the target size. Absolute page boxes ensure precise formatting when
that is the author's prerogative.

<P>Three values for the <span class="propinst-size">'size'</span>
property create a relative page box:

<DL>
<DT>auto

<DD>The page box will be set to the size and orientation of the
target sheet. This is the initial value of the property.

<div class="example"><P>
<pre>
  @page {
    size: auto;
    margin: 10%;
  }
</pre>

<p>In the above example, the outer edges of the page box will align
with the target. (Since 'auto' is the initial value on <span
class="propinst-size">'size'</span>, it is normally not necessary to
set this value.) The percentage value on the <span
class="propinst-margin">'margin'</span> property is relative to the
target size so if the target is 21.0cm x 29.7cm (i.e., A4), the
margins are 2.10cm and 2.97cm.
</div>

<DT>landscape

<DD>The page box will have the same size as the target, and the normal
direction of print occurs across the largest dimension of the target.
Thus, the target orientation will be ignored.

<DT>portrait

<DD>the page box will have the same size as the target, and the normal
direction of print occurs across the shortest dimension of the target.
Thus, the target orientation will be ignored.

</DL>

<P>Explicit length values for the <span
class="propinst-size">'size'</span> property create an absolute page
box. If only one length value is specified, it sets both the width and
height of the page box (i.e., the box is a square). Since the page box
has no "parent", percentage values are not allowed on the <span
class="propinst-size">'size'</span> property.

<div class="example"><P>
For example:

<PRE>
  @page {
    size: 8.5in 11in;  /* width height */
  }
</PRE>

<P>The above example set the width of the page box to be 8.5in and the
height to be 11in. The page box in this example requires a target
size of 8.5&quot;x11&quot; or bigger to be printed.
</div>

<P>User agents may allow users to control the transfer of the page
box to the sheet (e.g., rotating an absolute page box that's
being printed).

<h4>Rendering page boxes that do not fit a target sheet</h4>

<P>If page box does not fit the target sheet dimensions, the 
user agent may choose to:

<UL>
<LI>Rotate the page box 90° if this will make the page box fit.
<LI>Scale the page to fit the target.
</UL>

<P>The user agent should consult the user before performing these
operations.

<P>When the page box is smaller than the target size, the user agent
is free to place the page box anywhere on the sheet. However, it is
recommended that the page box be centered on the sheet since this will
align double-sided pages and avoid accidental loss of information that
is printed near the edge of the sheet.

<div class="note"><P>
<em><strong>Note.</strong>
Typically, 8.5&quot;x11&quot; sheet size will be available in North
America, while printers in other parts of the world are more likely to
have the A4 sheet size available. 
</em>
</div>

<h3>Crop marks: the <span class="propinst-marks">'marks</span>
property</h3>

<!-- #include src=properties/marks.srb -->

<p>In high-quality printing, various marks are often added outside the
page box. <span class="index-def" title="crop marks"><EM>Crop
marks</EM></span> indicate where the page should be cut and <span
class="index-def" title="cross marks"><EM>cross marks</em></span>
(also known as register marks or registration marks) are used to align
sheets. This property describes what marks should be printed on the
page outside the outer edges of the page box.

<P>Marks are only visible on absolute page boxes. In relative page
boxes, the page box will be aligned with the target and the marks
will be outside the printable area.

<P>The size, style, and position of cross marks depends on the user
agent.

<h3>Left and right pages</H3>

<P>When printing double-sided documents, the page boxes on left and
right pages should be different. This can be expressed through two CSS
pseudo-classes that may be defined in the page context.

<P>All pages are automatically classified by user agents into either
the <span class="index-def" title=":left|pseudo-class,
:left">:left</span> or <span class="index-def"
title=":right|pseudo-class, :right">:right</span> pseudo-class.

<div class="example"><P>
<PRE>
  @page :left {
    margin-left: 4cm;
    margin-right: 3cm;
  }

  @page :right {
    margin-left: 3cm;
    margin-right: 4cm;
  }
</PRE>
</div>

<P>If different declarations have been given for left and right pages,
the user agent must honor these declarations even if the user agent
does not transfer the page boxes to left and right sheets (e.g., a
printer that only prints single-sided). 

<P>Whether the first page of a document is :left or :right depends on
the major writing direction of the document and is outside the scope
of this document. However, to force a :left or :right first page,
authors may insert a page break before the element at the top of the
document tree (e.g., the HTML element in HTML).

<div class="note"><P>
<em><strong>Note.</strong>
Adding declarations to the :left or :right pseudo-class does not
influence whether the document comes out of the printer double- or
single-sided (which is outside the scope of this specification). 
</em>
</div>

<div class="note"><P>
<em><strong>Note.</strong>
Future versions of CSS may include other page pseudo-classes (e.g.,
:first).
</em>
</div>

<h3>Running headers and footers</h3>

<p>It is customary in printed documents to put navigation aids at the
top and/or bottom of the page. Often you'll find a page number, the
name of the book, and the title of the current chapter there.

<p>CSS defines two areas of the page for holding this kind of
information. They are referred to as the <span class="index-def"
title=":header">:header</span> and <span class="index-def"
title=":footer">:footer</span> pseudo-elements, since their default
position is above (resp., below) the content of the page. Their content
and other properties are defined inside an @page rule:

<pre>
@page :footer {... footer properties... }
@page :header {... header properties... }
</pre>

<p>Since left and right pages often have different headers and
footers, the following defines them individually:

<pre>
@page :left :footer {...}    /* footer of the left page  */
@page :right :footer {...}   /* footer of the right page */
@page :left :header {...}    /* header of the left page  */
@page :right :header {...}   /* header of the right page */
</pre>

<p>The <a href="cascade.html">cascading rules</a> determine what the
values for properties are in case the same property is set on various
@page rules. The specificity of @page is 0, every :left, :right,
:footer, and :header adds 1 to the specificity.

<p>The :footer and :header areas behave very similar to <span
class="index-inst" title="fixed"> <span
class="value-inst-fixed">'fixed'</span></span> elements. The only
difference is in their content: in headers and footers the content is
limited to one line, and it may vary from page to page, since it can
include variables. The page content is the <a
href="flowobj.html#reference-box">reference box</a> for the header and
footer. See section <a href="flowobj.html#fixed-positioning">"fixed
positioning"</a> for a description of fixed elements.

<p>The initial values for <span class="propinst-top">'top'</span>,
<span class="propinst-bottom">'bottom'</span> and <span
class="propinst-height">'height'</span> are different for :footer and
:header than for normal fixed elements:

<ul>
<li><p><span class="propinst-top">'top'</span> in :header has a UA-dependent initial value. A suggested
value is -3em.
<li><p><span class="propinst-bottom">'bottom'</span> in :footer has a UA-dependent initial value. A
suggested value is -3em.
<li><p><span class="propinst-height">'height'</span> in both :header and :footer has a UA-dependent initial
value. A suggested value is 1em.
</ul>

<p>The suggested values make the header and footer as wide as the page
content, and about two lines above (resp., below) it.

<p>The content of the header and footer is specified with the <span
class="propinst-content">'content'</span> property. The content is
always rendered as a single line. (If the content is too long, the UA
should cut it off in some way.) The value is a comma-separated list of
1, 2, or 3 values. Depending on the <span
class="propinst-direction">'direction'</span> property, the first of
these is left- or right-aligned, the second is centered, and the third
is right- or left-aligned.

<p>The content is a concatenation of fixed strings and variable
parts. The following variable parts are allowed:

<p>[Are these the right names for the variables?]

<dl>
<dt>lower-roman(pageno), upper-roman(pageno), decimal(pageno),
lower-alpha(pageno), upper-alpha(pageno)
<dd>This expands to the page number, in the specified notation.</dd>

<dt>lower-roman(pages), upper-roman(pages), decimal(pages),
lower-alpha(pages), upper-alpha(pages)
<dd>This expands to the total number of pages, in the specified
notation.</dd>

<dt>first(<var>X</var>), last(<var>X</var>), previous(<var>X</var>)
<dd><var>X</var> can be one of 'title', 'chapter', or
'section'. First(<var>X</var>) expands to the content of the first
element on the page that has a <span
class="propinst-running-head">'running-head:<var>X</var>'</span>
property. If there is none, 'first()' is the same as
'previous()'. 'Last(<var>X</var>)' expands to the content of the last
element on the page with a 'running-head:<var>X</var> property. If
there is none, 'last' is the same as
'previous'. 'Previous(<var>X</var>)' expands to the contents of the
last element with 'running-head:<var>X</var>' on all pages before this
one. If there is none, the result is the empty string.</dd>

<dt>url
<dd>This expands to the URL of the document (not of the style sheet).</dd>

<dt>date
<dd>This expands to the current date, in the user's locale and format.</dd>
</dl>

<p>The "contents" is the text content of the element and all its
children, excluding the content of elements that have <span
class="propinst-display">'display:none'</span>.

<div class="example">
<p>This example creates two running headers, the one on the left page
has a page number on the left, and the content of the first element
marked as 'chapter' on the right. The right header has the content of
the last element marked as 'section' on the left and the page number
on the right. Both headers are in 10pt small-caps.

<pre>
@page :left: header {
    content: "Page " decimal(pageno), , first(chapter);
    font-variant: small-caps
}
@page :right :header {
    content: last(section), , "Page " decimal(pageno);
    font-variant: small-caps
}
</pre>
</div>

<h3>Marking elements for the running headers &amp; footers</h3>

<p>To put a copy of the content of an element in the header or footer,
the element must be marked. The property 'running-head' is used for
that.

<!-- #include src=properties/running-head.srb -->

The value 'none' means that the element is not marked. 'Title',
'chapter' and 'section' say that the element is marked as a title,
chapter or section, resp. and that the content can be used in the
running header or footer.

<div class="example">
<p>This style sheet marks H2 elements as 'chapter' and DT elements as
'section'. This can be used, e.g., in combination with the running
headers of the previous example.

<pre>
H2 {running-head: chapter}
DT {running-head: section}
</pre>
</div>

<h3>Content outside the page box</h3>

<P>When formatting content in the page model, some content may end up
outside the page box. For example, an element with 'white-space: pre'
may be wider than the page box. Also, when elements are positioned
outside the <a href="../flowobj.html#flow-model">flow model</a>, they
may end up in inconvenient locations. For example, images may be
placed on the edge of the page box or 100,000 inches below the page
box.

<P>A specification for the exact formatting of such elements lies
outside the scope of this document. However, we recommend that authors
and user agents observe the following general principles concerning
content outside the page box:

<ul>
<li>Content should be formatted slightly beyond the page box to allow
   pages to "bleed".

<li>User agents should avoid printing large numbers of blank pages to
honor positioning of elements. Note, however, that printing small
numbers of blank pages may be necessary to honor the 'left' and
'right' values for <span
class="propinst-page-break-before">'page-break-before'</span> and
<span class="propinst-page-break-after">'page-break-after'</span>.

<li>Authors should not position elements in inconvenient locations 
as a means to avoid printing them. Authors should use the
<span class="propinst-display">'display'</span> or
<span class="propinst-visibility">'visibility'</span> properties
for this purpose.

<LI>User agents may handle elements positioned outside the page box in
several ways, including discarding them or printing them at the end of
the document.
</ul>

<h2>Cascading in the page context</H2>

<P>Declarations in the page context cascade just like normal CSS2
declarations.

<div class="example"><P>
Consider the following example:

<PRE>
  @page {
    margin-left: 3cm;
  }

  @page :left {
    margin-left: 4cm;
  }
</PRE>

<P>Due to the higher specificity of the pseudo-class selector (see the
section on <a href="cascade.html#cascading-order">cascading order</a>
for details), the left margin on left pages will be '4cm' and all
other pages (i.e., the right pages) will have a left margin of '3cm'.
</div>
</body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
End:
-->
