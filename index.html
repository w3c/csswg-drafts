<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Spatial Navigation</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li li { font-size:   85%;    }

	.toc > li             { margin: 1.5rem 0;    }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	.toc .secno {
		float: left;
		width: 4rem;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 150b038a54cb926cf8e3d36fd8b108c226cb94b8" name="generator">
  <link href="http://wicg.github.io/spatial-navigation" rel="canonical">
  <meta content="5e819434439cc5565bfacf4933291a39557bfef5" name="document-revision">
<style>
code.key {
    border: solid 1px;
    border-radius: 0.5ch;
    padding: 1px 5px;
}
.output {
    background: white;
    padding: 1em;
}
</style>
<style>
#seq-check:checked ~ .sequential,
#seq-check:checked ~ * .sequential {
	display: none;
}
#api-check:checked ~ .api,
#api-check:checked ~ * .api {
	display: none;
}
#cssapi-check:checked ~ .cssapi,
#cssapi-check:checked ~ * .cssapi {
	display: none;
}
#verbose-check:checked ~ .verbose,
#verbose-check:checked ~ * .verbose {
	display: none;
}
</style>
<style>
        #example-cal table, #example-cal td, #example-cal th {
            border-collapse: collapse;
            border: solid 1px;
        }
        #example-cal th { text-align: center; }
        #example-cal td { width: 12.5%; }
        #example-cal {
            display: grid;
            grid-template-columns: auto 1fr auto;
        }
        #example-cal button { align-self: center; }

        /* For browsers that don’t support grid */
        #example-cal table {
            display:inline-table
            vertical-align: middle;
        }
        </style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: hsl(60deg, 50%, 90%); }
    var.selected1 { background-color: hsl(0deg, 50%, 90%); }
    var.selected2 { background-color: hsl(120deg, 50%, 90%); }
    var.selected3 { background-color: hsl(180deg, 50%, 90%); }
    var.selected4 { background-color: hsl(30deg, 50%, 90%); }
    var.selected5 { background-color: hsl(240deg, 50%, 90%); }
    var.selected6 { background-color: hsl(330deg, 80%, 93%); }
    </style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
.highlight .c { color: #708090 } /* Comment */
.highlight .k { color: #990055 } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #0077aa } /* Name */
.highlight .o { color: #999999 } /* Operator */
.highlight .p { color: #999999 } /* Punctuation */
.highlight .cm { color: #708090 } /* Comment.Multiline */
.highlight .cp { color: #708090 } /* Comment.Preproc */
.highlight .c1 { color: #708090 } /* Comment.Single */
.highlight .cs { color: #708090 } /* Comment.Special */
.highlight .kc { color: #990055 } /* Keyword.Constant */
.highlight .kd { color: #990055 } /* Keyword.Declaration */
.highlight .kn { color: #990055 } /* Keyword.Namespace */
.highlight .kp { color: #990055 } /* Keyword.Pseudo */
.highlight .kr { color: #990055 } /* Keyword.Reserved */
.highlight .kt { color: #990055 } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #000000 } /* Literal.Number */
.highlight .s { color: #a67f59 } /* Literal.String */
.highlight .na { color: #0077aa } /* Name.Attribute */
.highlight .nc { color: #0077aa } /* Name.Class */
.highlight .no { color: #0077aa } /* Name.Constant */
.highlight .nd { color: #0077aa } /* Name.Decorator */
.highlight .ni { color: #0077aa } /* Name.Entity */
.highlight .ne { color: #0077aa } /* Name.Exception */
.highlight .nf { color: #0077aa } /* Name.Function */
.highlight .nl { color: #0077aa } /* Name.Label */
.highlight .nn { color: #0077aa } /* Name.Namespace */
.highlight .py { color: #0077aa } /* Name.Property */
.highlight .nt { color: #669900 } /* Name.Tag */
.highlight .nv { color: #222222 } /* Name.Variable */
.highlight .ow { color: #999999 } /* Operator.Word */
.highlight .mb { color: #000000 } /* Literal.Number.Bin */
.highlight .mf { color: #000000 } /* Literal.Number.Float */
.highlight .mh { color: #000000 } /* Literal.Number.Hex */
.highlight .mi { color: #000000 } /* Literal.Number.Integer */
.highlight .mo { color: #000000 } /* Literal.Number.Oct */
.highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
.highlight .sc { color: #a67f59 } /* Literal.String.Char */
.highlight .sd { color: #a67f59 } /* Literal.String.Doc */
.highlight .s2 { color: #a67f59 } /* Literal.String.Double */
.highlight .se { color: #a67f59 } /* Literal.String.Escape */
.highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
.highlight .si { color: #a67f59 } /* Literal.String.Interpol */
.highlight .sx { color: #a67f59 } /* Literal.String.Other */
.highlight .sr { color: #a67f59 } /* Literal.String.Regex */
.highlight .s1 { color: #a67f59 } /* Literal.String.Single */
.highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
.highlight .vc { color: #0077aa } /* Name.Variable.Class */
.highlight .vg { color: #0077aa } /* Name.Variable.Global */
.highlight .vi { color: #0077aa } /* Name.Variable.Instance */
.highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Spatial Navigation</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2018-05-29">29 May 2018</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://wicg.github.io/spatial-navigation">http://wicg.github.io/spatial-navigation</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/wicg/spatial-navigation/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:jh.hong@lge.com">Jihye Hong</a> (<span class="p-org org">LG Electronics</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="https://florian.rivoal.net">Florian Rivoal</a> (<span class="p-org org">Invited Expert</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2018 the Contributors to the Spatial Navigation Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines a general model for navigating the focus using the arrow keys,

as well as related CSS and JavaScript features.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk">
   <p>The following features are at-risk, and may be dropped during the CR period: </p>
   <ul>
    <li><code class="idl"><a data-link-type="idl" href="#dom-element-getspatnavcontainer" id="ref-for-dom-element-getspatnavcontainer">getSpatnavContainer()</a></code>
    <li><code class="idl"><a data-link-type="idl" href="#dom-element-focusableareas" id="ref-for-dom-element-focusableareas">focusableAreas()</a></code>
    <li><a class="property" data-link-type="propdesc" href="#propdef-spatial-navigation-contain" id="ref-for-propdef-spatial-navigation-contain">spatial-navigation-contain</a>
   </ul>
   <p>“At-risk” is a W3C Process term-of-art, and does not necessarily imply that the feature is in danger of being dropped or delayed. It means that the WG believes the feature may have difficulty being interoperably implemented in a timely manner, and marking it as such allows the WG to drop the feature if necessary when transitioning to the Proposed Rec stage, without having to publish a new Candidate Rec without the feature first.</p>
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content"> Introduction</span></a>
    <li><a href="#interaction"><span class="secno">2</span> <span class="content"> Module interaction</span></a>
    <li><a href="#overview"><span class="secno">3</span> <span class="content"> Overview</span></a>
    <li><a href="#triggering"><span class="secno">4</span> <span class="content"> Triggering Spatial Navigation</span></a>
    <li>
     <a href="#js-api"><span class="secno">5</span> <span class="content"> JavaScript API</span></a>
     <ol class="toc">
      <li><a href="#high-level-api"><span class="secno">5.1</span> <span class="content"> Triggering Navigation Programmatically</span></a>
      <li><a href="#low-level-api"><span class="secno">5.2</span> <span class="content"> Low level APIs</span></a>
     </ol>
    <li>
     <a href="#events-navigationevent"><span class="secno">6</span> <span class="content"> Navigation Events</span></a>
     <ol class="toc">
      <li><a href="#interface-focusevent"><span class="secno">6.1</span> <span class="content"> Interface NavigationEvent</span></a>
      <li>
       <a href="#events-nav-type"><span class="secno">6.2</span> <span class="content"> Navigation Event Types</span></a>
       <ol class="toc">
        <li><a href="#event-type-navbeforefocus"><span class="secno">6.2.1</span> <span class="content"> <span><code>navbeforefocus</code></span></span></a>
        <li><a href="#event-type-navbeforescroll"><span class="secno">6.2.2</span> <span class="content"> <span><code>navbeforescroll</code></span></span></a>
        <li><a href="#event-type-navnotarget"><span class="secno">6.2.3</span> <span class="content"> <span><code>navnotarget</code></span></span></a>
       </ol>
     </ol>
    <li>
     <a href="#processing-model"><span class="secno">7</span> <span class="content"> Processing Model</span></a>
     <ol class="toc">
      <li><a href="#grouping"><span class="secno">7.1</span> <span class="content"> Groupings of elements</span></a>
      <li><a href="#nav"><span class="secno">7.2</span> <span class="content"> Navigation</span></a>
      <li><a href="#heuristics"><span class="secno">7.3</span> <span class="content"> Focus Navigation Heuristics</span></a>
     </ol>
    <li>
     <a href="#declarative"><span class="secno">8</span> <span class="content"> Controlling spatial navigation through declarative means</span></a>
     <ol class="toc">
      <li><a href="#container"><span class="secno">8.1</span> <span class="content"> Creating additional spatnav containers: the <span class="property">spatial-navigation-contain</span> property</span></a>
     </ol>
    <li><a href="#scrolling"><span class="secno"></span> <span class="content">Appendix A. Scroll extensions</span></a>
    <li><a href="#ack"><span class="secno"></span> <span class="content">Acknowledgements</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#property-index"><span class="secno"></span> <span class="content">Property Index</span></a>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <p>This specificaiton is rather long.
To make it easier to read and focus on a particular area,
a few checkboxes are provided below.
Checking them hides part of the specification.
This is only meant as a reading aid,
the specification remains the full document.</p>
   <input id="seq-check" type="checkbox">
   <label for="seq-check">Hide features that relate to sequential navigation, and related information</label>
   <br> 
   <input id="api-check" type="checkbox">
   <label for="api-check">Hide JavaScript APIs, including events</label>
   <br> 
   <input id="cssapi-check" type="checkbox">
   <label for="cssapi-check">Hide CSS properties that enable selecting behavior variants, and related information</label>
   <br> 
   <input id="verbose-check" type="checkbox">
   <label for="verbose-check">Hide informative sections that explain and summarise normative sections without adding more information</label>
   <br> 
   <h2 class="non-normative heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content"> Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>Historically, most browsers have not offered features to let users move the focus directionally.
Some, such as TV browsers, have enabled users to move the focus using the arrow keys out of necessity,
since no other input mechanism is available on a typical TV remote control.</p>
   <p>Others, have enabled different key combinations to control spatial navigation,
such as pressing the <code class="key">Shift</code> key together with arrow keys.</p>
   <p>This ability to move around the page directionally is called <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" data-lt="spatial navigation | spatnav" id="spatial-navigation">spatial navigation</dfn> (or <strong>spatnav</strong> for short).</p>
   <p><a data-link-type="dfn" href="#spatial-navigation" id="ref-for-spatial-navigation">Spatial navigation</a> can be useful for a webpage built using a grid-like layout,
or other predominantly non linear layouts.
The figure below represents a photo gallery arranged in a grid layout.
If the user presses the <code class="key">Tab</code> key to move focus,
they need to press the key many times to reach the desired element.
Also, the grid layout may arrange the layout of elements independently of their source order.
Therefore sequential navigation using the <code class="key">Tab</code> key makes focus navigation unpredictable.
In contrast, <a data-link-type="dfn" href="#spatial-navigation" id="ref-for-spatial-navigation①">spatial navigation</a> moves the focus among focusable elements
depending on their position
allowing it to address problems encountered with sequential navigation.</p>
   <figure>
     <img alt="When elements are laid out in a grid pattern, spatial navigation makes it much easier to predict and control where focus should move to." src="images/spatnav-enable.png" style="width: 500px;"> 
    <figcaption>Application using a grid-like layout.</figcaption>
   </figure>
   <p>While arrow keys are naturally suited to control spatial navigation,
no previous specification describes how that should work,
or how it may be controlled. <span class="api">This specification introduces a processing model for spatial navigation,
as well as APIs
enabling authors to control and override how spatial navigation works.</span></p>
   <div class="sequential api"> Some aspects of this specification, such as the JavaScript Events,
also extends how sequential navigation work,
in order to make sure that keyboard navigation in general
has a consistent and well defined model. </div>
   <p class="note" role="note"><span>Note:</span> As a general principle,
keyboard navigation,
and spatial navigation in particular,
should be possible to use and control without JavaScript<span class="cssapi">,
and declarative solutions are therefore preferred.
Since spatial navigation depends on layout,
that means CSS is typically the right mechanism to define
spatial navigation related controls</span>. <span class="api">However, in the spirit of the <a href="https://github.com/extensibleweb/manifesto">Extensible Web Manifesto</a> <a data-link-type="biblio" href="#biblio-extensible">[EXTENSIBLE]</a>,
we feel it is important to provide the right JavaScript primitives
to let authors experiment and explore the problem space.
More declarative features may be added later,
based on feedback and experience acquired through such JavaScript usage.</span></p>
   <p class="note" role="note"><span>Note:</span> A few features are marked <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="at-risk">at-risk</dfn>.
The editors of this specification believe
they represent an important part of the user or author experience
of the features defined in specification.
At the same time, the core functionality of this specification
can be implemented without implementing these
so it seems possible that implementors may choose to down-prioritize them
to reduce the scope of a first implementation.
While it is hoped that these features will be implemented as well,
they are marked at-risk in recognition that they might not be at first.</p>
   <h2 class="heading settled" data-level="2" id="interaction"><span class="secno">2. </span><span class="content"> Module interaction</span><a class="self-link" href="#interaction"></a></h2>
   <p>This document depends on the Infra Standard <a data-link-type="biblio" href="#biblio-infra">[infra]</a>.</p>
   <p>The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" are to be interpreted as described in RFC 2119. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
   <div class="verbose">
    <h2 class="non-normative heading settled" data-level="3" id="overview"><span class="secno">3. </span><span class="content"> Overview</span><a class="self-link" href="#overview"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>Using a UA-defined mechanism
(typically arrow keys, possibly in combination with modifier keys like <code class="key">Shift</code> or <code class="key">Control</code>),
the user may ask the User Agent to navigate in a particular direction.
This will either
move the focus from its current location to a new focusable item in the direction requested,
or scroll if there is no appropriate item.</p>
    <p>More specifically,
the User Agent will first search for visible and focusable items
in the direction indicated
within the current <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container">spatial navigation focus container</a> (<span class="cssapi">by default </span>the root element, scrollable elements, and iframes<span class="cssapi">,
but other elements can be made into <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①">spatial navigation focus containers</a> using the <a class="property" data-link-type="propdesc" href="#propdef-spatial-navigation-contain" id="ref-for-propdef-spatial-navigation-contain①">spatial-navigation-contain</a> property</span>).</p>
    <p>If it finds any, it will pick the best one for that direction,
and move the focus there.</p>
    <p>If it does not, it will scroll the <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container②">spatial navigation focus container</a> in the requested direction
instead of moving focus.
Doing so may uncover focusable elements
which would then be eligible targets to move the focus to
next time spatial navigation in the same direction is requested.</p>
    <p>If the <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container③">spatial navigation focus container</a> cannot be scrolled,
either because it is not a scrollable element
or because it is already scrolled to the maximum in that direction,
the User Agent will select the next <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container④">spatial navigation focus container</a> up the ancestry chain,
and repeat the process of
looking for eligible focus targets,
selecting the best one if there’s any,
scrolling if not,
going up the ancestry chain if it cannot scroll,
until it has either moved focus,
scrolled,
or reached the root.</p>
    <div class="api">
      At key points during this search for the appropriate response to the spatial navigation request,
the User Agent will fires events.
These enable authors to prevent the upcoming action
(by calling <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-preventdefault" id="ref-for-dom-event-preventdefault">preventDefault()</a></code>),
and if desired to provide an alternate action,
such as using calling the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/interaction.html#dom-focus" id="ref-for-dom-focus">focus()</a></code> method on a different
element of the author’s choosing. 
     <p>To help authors write such alternate actions,
and as part of exposing underlying platform primitives as per the <a href="https://github.com/extensibleweb/manifesto">Extensible Web</a> principles,
this specification also defines JavaScript APIs
that expose key constructs of the underlying model.</p>
     <p>See <a href="#events-nav-type">§6.2 Navigation Event Types</a> for details about the various events,
and <a href="#js-api">§5 JavaScript API</a> for details about the JavaScript API.</p>
    </div>
    <div class="example" id="example-432f0de7">
     <a class="self-link" href="#example-432f0de7"></a> In this example, shows how a series of focusable elements
    arranged in a scrollable element
    would be navigated when using spatial navigation.
    For the sake of keeping the description simple,
    this example assumes a UA where spatial navigation is triggered using arrow keys. 
     <figure>
       <img alt="" src="images/spatnav-scroll-visible-1.png" style="width: 200px;"> <img alt="" src="images/spatnav-scroll-visible-2.png" style="width: 200px;"> 
      <figcaption>Moving focus to the visible element in the <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container⑤">spatial navigation focus container</a>.</figcaption>
     </figure>
     <p>On the left of figure 2, "Box 2" is focused.
    Pressing the <code class="key">ArrowDown</code> key moves focus to
    "Box 3" without scrolling because "Box 3" is visible in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollport" id="ref-for-scrollport">scrollport</a> of the <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container⑥">spatial navigation focus container</a>.</p>
     <figure>
       <img alt="" src="images/spatnav-scroll-invisible-1.png" style="width: 160px;"> <img alt="" src="images/spatnav-scroll-invisible-2.png" style="width: 160px;"> <img alt="" src="images/spatnav-scroll-invisible-3.png" style="width: 160px;"> <img alt="" src="images/spatnav-scroll-invisible-4.png" style="width: 160px;"> 
      <figcaption>Moving focus to the hidden element in the <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container⑦">spatial navigation focus container</a>.</figcaption>
     </figure>
     <p>On the first of figure 3, under "Box 3", there isn’t any visible element in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollport" id="ref-for-scrollport①">scrollport</a>.
    Therefore, the effect of pressing the <code class="key">ArrowDown</code> is to scroll down, as shown in the second.
    The next press of the <code class="key">ArrowDown</code> key makes "Box 4" come into the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollport" id="ref-for-scrollport②">scrollport</a>,
    and the focus will move to it when there is additional pressing the <code class="key">ArrowDown</code>, as the fourth.</p>
     <p>This example uses the markup as follows:</p>
<pre class="lang-css highlight"><span class="nt">#scroller </span><span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="m">700</span><span class="l">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="m">700</span><span class="l">px</span><span class="p">;</span>
    <span class="k">overflow-x</span><span class="p">:</span> hidden<span class="p">;</span>
    <span class="k">overflow-y</span><span class="p">:</span> auto<span class="p">;</span>
<span class="p">}</span>

<span class="nt">.box </span><span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="m">150</span><span class="l">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="m">110</span><span class="l">px</span><span class="p">;</span>
    <span class="k">background-color</span><span class="p">:</span> blue<span class="p">;</span>
<span class="p">}</span>

<span class="nt">.box:focus </span><span class="p">{</span>
    <span class="k">background-color</span><span class="p">:</span> red<span class="p">;</span>
<span class="p">}</span>
</pre>
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"scroller"</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"box"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 1<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"box"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 2<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"box"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 3<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"box"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 4<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
    </div>
   </div>
   <h2 class="heading settled" data-level="4" id="triggering"><span class="secno">4. </span><span class="content"> Triggering Spatial Navigation</span><a class="self-link" href="#triggering"></a></h2>
   <p>When the user triggers spatial navigation in a given direction,
the User Agent must run the <a data-link-type="dfn" href="#spatial-navigation-steps" id="ref-for-spatial-navigation-steps">spatial navigation steps</a> in that direction.</p>
   <p>This specification does not define what UI mechanism User Agents should offer to users to trigger spatial navigation.
This intentionally left for User Agents to decide.</p>
   <div class="note" role="note">Note:
    It is expected that User Agents on devices with limited input capabilities,
    such as TVs operated with a remote control,
    or devices operated with a game controller,
    will use spatial navigation as their primary or exclusive navigation mechanism. </div>
   <p>Although it is possible for User Agents
to implement the processing model and APIs defined by the specification
without giving any direct means to the user to trigger spatial navigation themselves,
this specification recommends not to do so:
User Agents should offer a means for users to trigger spatial navigation directly,
without having to use the APIs.</p>
   <p class="note" role="note"><span>Note:</span> Conversely, authors should assume that spatial navigation may be triggered
by the UA in response to user actions
even if the author has not invoked any of the APIs.</p>
   <p>Regardless of the actual mechanism chosen to trigger spatial navigation,
the following requirements apply:</p>
   <ul>
    <li data-md="">
     <p>If the mechanism the user must use to trigger spatial navigation
would normally fire a <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/uievents/#uievent-uievent" id="ref-for-uievent-uievent">UIEvent</a></code>,
then that event must be fired prior to running the <a data-link-type="dfn" href="#spatial-navigation-steps" id="ref-for-spatial-navigation-steps①">spatial navigation steps</a> and these steps must not be run if that event’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#canceled-flag" id="ref-for-canceled-flag">canceled flag</a> gets set.</p>
     <div class="example" id="example-71b5d5f5">
      <a class="self-link" href="#example-71b5d5f5"></a> Gaming devices may trigger spatial navigation based on pressing the D-pad.
    This would result in firing a <a class="idl-code" data-link-type="event" href="https://w3c.github.io/uievents/#keydown" id="ref-for-keydown">keydown</a> event
    with the key set to one of <code class="key">ArrowDown</code>, <code class="key">ArrowLeft</code>, <code class="key">ArrowRight</code>,
    or <code class="key">ArrowUp</code>,
    followed if not canceled by running the <a data-link-type="dfn" href="#spatial-navigation-steps" id="ref-for-spatial-navigation-steps②">spatial navigation steps</a><span class="api">,
    including firing the relevant <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent">NavigationEvent</a></code>s</span>. 
      <p>A User Agent on a desktop computer that triggers spatial navigation
    using the arrow keys of the keyboard
    would follow the same sequence.</p>
     </div>
    <li data-md="">
     <p>If the mechanism the user must use to trigger spatial navigation
would in some contexts trigger other actions,
the User Agent should in these contexts
give priority to these other actions
and execute them instead of spatial navigation.
It must not trigger both.</p>
     <div class="example" id="example-53f90cd4"><a class="self-link" href="#example-53f90cd4"></a> In a User Agent that triggers spatial navigation
    using the arrow keys without modifier keys,
    and uses these same arrow keys to move
    the text insertion caret when an editable element is focused,
    the arrow keys should by default to moving the caret.
    Spatial navigation would only be triggered by the arrow keys
    when the focused element is not editable,
    or when it is editable but the caret cannot move any further in the requested direction. </div>
     <p>An exception is made for scrolling:
since spatial navigation itself handles scrolling
(in addition to moving the focus)
User Agents should not offer the same mechanism to trigger both spatial navigation
and a scrolling behavior separate from spatial navigation.
UAs may however, offer a way for the user to switch between different modes,
or offer both based on different UI mechanism.</p>
     <div class="example" id="example-812cd513"><a class="self-link" href="#example-812cd513"></a> A User Agent may have a setting to let the user choose
    between using the arrow keys without modifier keys
    for spatial navigation or for scrolling.
    Another one may offer scrolling on arrow keys without modifiers,
    and spatial navigation on arrow keys when pressed together
    with the <code class="key">Shift</code> key,
    or on the <code class="key">W</code> <code class="key">A</code> <code class="key">S</code> <code class="key">D</code> keys.
    Offering only spatial navigation or only scrolling
    as responses to pressing arrow keys would also be possibilities. </div>
   </ul>
   <div class="api">
    <h2 class="heading settled" data-level="5" id="js-api"><span class="secno">5. </span><span class="content"> JavaScript API</span><a class="self-link" href="#js-api"></a></h2>
    <h3 class="heading settled" data-level="5.1" id="high-level-api"><span class="secno">5.1. </span><span class="content"> Triggering Navigation Programmatically</span><a class="self-link" href="#high-level-api"></a></h3>
    <p class="issue" id="issue-ffca3146"><a class="self-link" href="#issue-ffca3146"></a> This api is clearly useful for testing purposes.
It may also be useful for authors,
but the use cases are less strong.
Maybe this should be moved to WebDriver and be a testing-only api.
Maybe it is fine as is.</p>
<pre class="idl highlight def"><span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-navigationdirection"><code>NavigationDirection</code></dfn> {
      <dfn class="s idl-code" data-dfn-for="NavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-navigationdirection-up"><code>"up"</code><a class="self-link" href="#dom-navigationdirection-up"></a></dfn>,
      <dfn class="s idl-code" data-dfn-for="NavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-navigationdirection-down"><code>"down"</code><a class="self-link" href="#dom-navigationdirection-down"></a></dfn>,
      <dfn class="s idl-code" data-dfn-for="NavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-navigationdirection-left"><code>"left"</code><a class="self-link" href="#dom-navigationdirection-left"></a></dfn>,
      <dfn class="s idl-code" data-dfn-for="NavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-navigationdirection-right"><code>"right"</code><a class="self-link" href="#dom-navigationdirection-right"></a></dfn>,
      <dfn class="s idl-code" data-dfn-for="NavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-navigationdirection-forward"><code>"forward"</code><a class="self-link" href="#dom-navigationdirection-forward"></a></dfn>,
      <dfn class="s idl-code" data-dfn-for="NavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-navigationdirection-backward"><code>"backward"</code><a class="self-link" href="#dom-navigationdirection-backward"></a></dfn>
};
<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window">Window</a> {
    <span class="kt">void</span> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Window" data-dfn-type="method" data-export="" data-lt="navigate(dir)" id="dom-window-navigate"><code>navigate</code></dfn>(<a class="n" data-link-type="idl-name" href="#enumdef-navigationdirection" id="ref-for-enumdef-navigationdirection">NavigationDirection</a> <dfn class="nv idl-code" data-dfn-for="Window/navigate(dir)" data-dfn-type="argument" data-export="" id="dom-window-navigate-dir-dir"><code>dir</code><a class="self-link" href="#dom-window-navigate-dir-dir"></a></dfn>);
};
</pre>
    <div class="algorithm" data-algorithm="windowNavigate steps">
      The <code class="idl"><a data-link-type="idl" href="#dom-window-navigate" id="ref-for-dom-window-navigate">navigate()</a></code> method must follow these steps: 
     <ol>
      <li data-md="">
       <p>If <var>dir</var> is <code>"up"</code>, <code>"down"</code>, <code>"left"</code>, or <code>"right"</code>,
run the <a data-link-type="dfn" href="#spatial-navigation-steps" id="ref-for-spatial-navigation-steps③">spatial navigation steps</a> in direction <var>dir</var>.</p>
      <li data-md="">
       <p>Else if <var>dir</var> is <code>"forward"</code> run the <a data-link-type="dfn" href="#sequential-navigation-steps" id="ref-for-sequential-navigation-steps">sequential navigation steps</a> requesting the next control.</p>
      <li data-md="">
       <p>Else if <var>dir</var> is <code>"backward"</code>,
run the <a data-link-type="dfn" href="#sequential-navigation-steps" id="ref-for-sequential-navigation-steps①">sequential navigation steps</a> requesting the previous control.</p>
     </ol>
    </div>
    <h3 class="heading settled" data-level="5.2" id="low-level-api"><span class="secno">5.2. </span><span class="content"> Low level APIs</span><a class="self-link" href="#low-level-api"></a></h3>
    <p class="note" role="note"><span>Note:</span> These APIs are designed to be low level constructs following the processing model closely.
As such, they should be easy to use by authors who want to extend or override the way spatial navigation works.</p>
<pre class="idl highlight def"><span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-spatialnavigationdirection"><code>SpatialNavigationDirection</code></dfn> {
    <dfn class="s idl-code" data-dfn-for="SpatialNavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-spatialnavigationdirection-up"><code>"up"</code><a class="self-link" href="#dom-spatialnavigationdirection-up"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="SpatialNavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-spatialnavigationdirection-down"><code>"down"</code><a class="self-link" href="#dom-spatialnavigationdirection-down"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="SpatialNavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-spatialnavigationdirection-left"><code>"left"</code><a class="self-link" href="#dom-spatialnavigationdirection-left"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="SpatialNavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-spatialnavigationdirection-right"><code>"right"</code><a class="self-link" href="#dom-spatialnavigationdirection-right"></a></dfn>,
};

<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-focusableareasearchmode"><code>FocusableAreaSearchMode</code></dfn> {
    <dfn class="s idl-code" data-dfn-for="FocusableAreaSearchMode" data-dfn-type="enum-value" data-export="" id="dom-focusableareasearchmode-visible"><code>"visible"</code><a class="self-link" href="#dom-focusableareasearchmode-visible"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="FocusableAreaSearchMode" data-dfn-type="enum-value" data-export="" id="dom-focusableareasearchmode-all"><code>"all"</code><a class="self-link" href="#dom-focusableareasearchmode-all"></a></dfn>
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-focusableareasoptions"><code>FocusableAreasOptions</code></dfn> {
    <a class="n" data-link-type="idl-name" href="#enumdef-focusableareasearchmode" id="ref-for-enumdef-focusableareasearchmode">FocusableAreaSearchMode</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="FocusableAreasOptions" data-dfn-type="dict-member" data-export="" data-type="FocusableAreaSearchMode " id="dom-focusableareasoptions-mode"><code>mode</code></dfn>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-spatnavsearchoptions"><code>SpatNavSearchOptions</code></dfn> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-spatialnavigationdirection" id="ref-for-enumdef-spatialnavigationdirection">SpatialNavigationDirection</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="SpatNavSearchOptions" data-dfn-type="dict-member" data-export="" data-type="SpatialNavigationDirection " id="dom-spatnavsearchoptions-dir"><code>dir</code></dfn>;
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node">Node</a>>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="SpatNavSearchOptions" data-dfn-type="dict-member" data-export="" data-type="sequence<Node>? " id="dom-spatnavsearchoptions-candidates"><code>candidates</code></dfn>;
    <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node①">Node</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="SpatNavSearchOptions" data-dfn-type="dict-member" data-export="" data-type="Node? " id="dom-spatnavsearchoptions-container"><code>container</code></dfn>;
};

<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#element" id="ref-for-element">Element</a> {
    <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node②">Node</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Element" data-dfn-type="method" data-export="" data-lt="getSpatnavContainer()" id="dom-element-getspatnavcontainer"><code>getSpatnavContainer</code></dfn>();
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node③">Node</a>> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Element" data-dfn-type="method" data-export="" data-lt="focusableAreas(arg)|focusableAreas()" id="dom-element-focusableareas"><code>focusableAreas</code></dfn>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-focusableareasoptions" id="ref-for-dictdef-focusableareasoptions">FocusableAreasOptions</a> <dfn class="nv idl-code" data-dfn-for="Element/focusableAreas(arg), Element/focusableAreas()" data-dfn-type="argument" data-export="" id="dom-element-focusableareas-arg-arg"><code>arg</code><a class="self-link" href="#dom-element-focusableareas-arg-arg"></a></dfn>);
    <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node④">Node</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="Element" data-dfn-type="method" data-export="" data-lt="spatNavSearch(arg)" id="dom-element-spatnavsearch"><code>spatNavSearch</code></dfn>(<a class="n" data-link-type="idl-name" href="#dictdef-spatnavsearchoptions" id="ref-for-dictdef-spatnavsearchoptions">SpatNavSearchOptions</a> <dfn class="nv idl-code" data-dfn-for="Element/spatNavSearch(arg)" data-dfn-type="argument" data-export="" id="dom-element-spatnavsearch-arg-arg"><code>arg</code><a class="self-link" href="#dom-element-spatnavsearch-arg-arg"></a></dfn>);
};
</pre>
<pre class="idl sequential highlight def"><span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-sequentialnavigationdirection"><code>SequentialNavigationDirection</code></dfn> {
    <dfn class="s idl-code" data-dfn-for="SequentialNavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-sequentialnavigationdirection-forward"><code>"forward"</code><a class="self-link" href="#dom-sequentialnavigationdirection-forward"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="SequentialNavigationDirection" data-dfn-type="enum-value" data-export="" id="dom-sequentialnavigationdirection-backward"><code>"backward"</code><a class="self-link" href="#dom-sequentialnavigationdirection-backward"></a></dfn>
};
<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①">Element</a> {
    <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node⑤">Node</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="Element" data-dfn-type="method" data-export="" data-lt="seqNavSearch(dir)" id="dom-element-seqnavsearch"><code>seqNavSearch</code></dfn>(<a class="n" data-link-type="idl-name" href="#enumdef-sequentialnavigationdirection" id="ref-for-enumdef-sequentialnavigationdirection">SequentialNavigationDirection</a> <dfn class="nv idl-code" data-dfn-for="Element/seqNavSearch(dir)" data-dfn-type="argument" data-export="" id="dom-element-seqnavsearch-dir-dir"><code>dir</code><a class="self-link" href="#dom-element-seqnavsearch-dir-dir"></a></dfn>);
};
</pre>
    <p class="note" role="note"><span>Note:</span> The way the direction is expressed allows us to expand to more than 4-way navigation
later of if this is found necessary.
More directional keywords or a numerical angle could be added.</p>
    <p class="note" role="note"><span>Note:</span> the <code class="idl"><a data-link-type="idl" href="#dom-element-focusableareas" id="ref-for-dom-element-focusableareas①">focusableAreas()</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-element-getspatnavcontainer" id="ref-for-dom-element-getspatnavcontainer①">getSpatnavContainer()</a></code> methods are <a data-link-type="dfn" href="#at-risk" id="ref-for-at-risk">at-risk</a>.</p>
    <div class="algorithm" data-algorithm="getSpatnavContainer steps">
      The <code class="idl"><a data-link-type="idl" href="#dom-element-getspatnavcontainer" id="ref-for-dom-element-getspatnavcontainer②">getSpatnavContainer()</a></code> method must follow these steps: 
     <ol>
      <li data-md="">
       <p>Return the element if it is a <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container⑧">spatnav container</a>,
or the nearest ancestor of the element that is a <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container⑨">spatnav container</a>,
or the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document">document</a> if the nearest <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①⓪">spatnav container</a> is the viewport.</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="focusableAreas steps">
      The <code class="idl"><a data-link-type="idl" href="#dom-element-focusableareas" id="ref-for-dom-element-focusableareas②">focusableAreas()</a></code> method must follow these steps: 
     <ol>
      <li data-md="">
       <p>Let <var>v</var> be <code>false</code> if the argument’s <code class="idl"><a data-link-type="idl" href="#dom-focusableareasoptions-mode" id="ref-for-dom-focusableareasoptions-mode">mode</a></code> attribute if present and equal to <code>"all"</code>,
or <code>true</code> otherwise.</p>
      <li data-md="">
       <p>Let <var>areas</var> be the result of <a data-link-type="dfn" href="#find-focusable-areas" id="ref-for-find-focusable-areas">finding focusable areas</a> within the element with the visibleOnly argument set to <var>v</var></p>
      <li data-md="">
       <p>Let <var>anchors</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-clone" id="ref-for-list-clone">clone</a> of <var>areas</var>,
with every <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#focusable-area" id="ref-for-focusable-area">focusable area</a> which is not itself a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#boundary-point-node" id="ref-for-boundary-point-node">Node</a> replaced with its <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#dom-anchor" id="ref-for-dom-anchor">DOM anchor</a>.</p>
      <li data-md="">
       <p>Return <var>anchors</var></p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="spatNavSearch steps">
      The <code class="idl"><a data-link-type="idl" href="#dom-element-spatnavsearch" id="ref-for-dom-element-spatnavsearch">spatNavSearch()</a></code> method must follow these steps: 
     <ol>
      <li data-md="">
       <p>Let <var>d</var> be the argument’s <code class="idl"><a data-link-type="idl" href="#dom-spatnavsearchoptions-dir" id="ref-for-dom-spatnavsearchoptions-dir">dir</a></code> attribute</p>
      <li data-md="">
       <p>If the argument’s <code class="idl"><a data-link-type="idl" href="#dom-spatnavsearchoptions-candidates" id="ref-for-dom-spatnavsearchoptions-candidates">candidates</a></code> attribute is not <code>null</code>,
then let <var>areas</var> be that attribute,
else, let <var>areas</var> be the result of <a data-link-type="dfn" href="#find-focusable-areas" id="ref-for-find-focusable-areas①">finding focusable areas</a> within the argument’s <code class="idl"><a data-link-type="idl" href="#dom-spatnavsearchoptions-container" id="ref-for-dom-spatnavsearchoptions-container">container</a></code> attribute is not <code>null</code>,
or the element’s nearest <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①①">spatnav container</a> ancestor</p>
      <li data-md="">
       <p>Return the result of <a data-link-type="dfn" href="#select-the-best-candidate" id="ref-for-select-the-best-candidate">selecting the best candidate</a> within <var>areas</var> in direction <var>d</var> from the element</p>
     </ol>
     <p class="note" role="note"><span>Note:</span> When neither a container nor a list of candidates is provided,
this only searches through the visible focusable areas of the nearest <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①②">spatnav container</a> ancestor. <strong>If none are found, this does not climb further up the ancestry chain,
and the result will be <code>null</code>.</strong></p>
    </div>
    <div class="sequential algorithm" data-algorithm="seqNavSearch steps">
      The <code class="idl"><a data-link-type="idl" href="#dom-element-seqnavsearch" id="ref-for-dom-element-seqnavsearch">seqNavSearch()</a></code> method must follow these steps: 
     <ol>
      <li data-md="">
       <p>Let <var>d</var> be the argument</p>
      <li data-md="">
       <p>Let <var>s</var> be <code>sequential</code> if the element is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context">browsing context</a> or if the element is in its <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#control-group" id="ref-for-control-group">control group</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation-order" id="ref-for-sequential-focus-navigation-order">sequential focus navigation order</a>;
otherwise, let <var>s</var> be <code>DOM</code>.</p>
      <li data-md="">
       <p>Return the result of running the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-navigation-search-algorithm" id="ref-for-sequential-navigation-search-algorithm">sequential navigation search algorithm</a> with the element as its starting point argument, <var>d</var> as its direction argument,
and <var>s</var> as the selection mechanism argument.</p>
     </ol>
    </div>
    <div class="example" id="focus-only">
     <a class="self-link" href="#focus-only"></a> The following code changes the behavior of spatial navigation
    from scrolling when there is no focusable element visible,
    to jumping to focusable elements even when they are not visible. 
<pre><code class="highlight">document<span class="p">.</span>addEventListener<span class="p">(</span><span class="s2">"navbeforescroll"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span>e<span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> container <span class="o">=</span> e<span class="p">.</span>relatedTarget<span class="p">;</span>
    <span class="kd">var</span> areas <span class="o">=</span> container<span class="p">.</span>focusableAreas<span class="p">({</span> mode<span class="o">:</span> <span class="s2">"all"</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span>areas<span class="p">.</span>length <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>

    e<span class="p">.</span>preventDefault<span class="p">();</span>
    <span class="kd">var</span> t <span class="o">=</span> e<span class="p">.</span>target<span class="p">.</span>spatNavSearch<span class="p">({</span>
        dir<span class="o">:</span> e<span class="p">.</span>dir<span class="p">,</span>
        candidates<span class="o">:</span> areas
    <span class="p">});</span>
    t<span class="p">.</span>focus<span class="p">();</span>
<span class="p">});</span>
</code></pre>
    </div>
    <div class="example" id="delegation">
     <a class="self-link" href="#delegation"></a> The following code changes the behavior of spatial navigation
    so that when a scroll container would get focused,
    if it has at least one visible focusable descendant,
    the focus is automatically transfered to it. 
<pre><code class="highlight">document<span class="p">.</span>addEventListener<span class="p">(</span><span class="s2">"navbeforefocus"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span>e<span class="p">)</span> <span class="p">{</span>
    e<span class="p">.</span>preventDefault<span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span>e<span class="p">.</span>dir <span class="o">===</span> <span class="s2">"forward"</span> <span class="o">||</span> e<span class="p">.</span>dir <span class="o">===</span> <span class="s2">"backward"</span> <span class="p">)</span> <span class="p">{</span>
        e<span class="p">.</span>dir<span class="o">=</span><span class="s2">"top"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> t <span class="o">=</span> e<span class="p">.</span>relatedTarget<span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span>t<span class="p">.</span>isSameNode<span class="p">(</span>t<span class="p">.</span>getSpatnavContainer<span class="p">()))</span> <span class="p">{</span>
        <span class="kd">var</span> areas <span class="o">=</span> t<span class="p">.</span>focusableAreas<span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span>areas<span class="p">.</span>length <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>

        t <span class="o">=</span> t<span class="p">.</span>spatNavSearch<span class="p">({</span>
            dir<span class="o">:</span>  e<span class="p">.</span>dir<span class="p">,</span>
            candidates<span class="o">:</span> areas
        <span class="p">});</span>
    <span class="p">}</span>
    t<span class="p">.</span>focus<span class="p">();</span>
<span class="p">});</span>
</code></pre>
    </div>
    <div class="example" id="loop">
     <a class="self-link" href="#loop"></a> The following code changes the behavior of spatial navigation
    to trap the focus within a spatnav container:
    when no further focusable elements can be found in the requested direcition
    and the spatnav container cannot be scrolled any futher,
    we loop back to the other side instead of searching outside of it,
    either by focusing or scrolling depending on what is available. 
     <p>The focus can still be moved outside by sequential navigation,
    mouse interaction,
    programatic calls to <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/interaction.html#dom-focus" id="ref-for-dom-focus①">focus()</a></code>…</p>
<pre><code class="highlight">document<span class="p">.</span>addEventListener<span class="p">(</span><span class="s2">"navnotarget"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span>e<span class="p">)</span> <span class="p">{</span>
    e<span class="p">.</span>preventDefault<span class="p">();</span>

    <span class="kd">var</span> c <span class="o">=</span> e<span class="p">.</span>relatedTarget<span class="p">;</span>
    <span class="kd">var</span> areas <span class="o">=</span> c<span class="p">.</span>focusableAreas<span class="p">({</span>mode<span class="o">:</span> <span class="s2">"all"</span><span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span>areas<span class="p">.</span>length <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">switch</span><span class="p">(</span>e<span class="p">.</span>dir<span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s2">"down"</span><span class="o">:</span>
                c<span class="p">.</span>scrollTop<span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">"up"</span><span class="o">:</span>
                c<span class="p">.</span>scrollTop<span class="o">=</span>c<span class="p">.</span>scrollHeight<span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">"right"</span><span class="o">:</span>
                c<span class="p">.</span>scrollLeft<span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">"left"</span><span class="o">:</span>
                c<span class="p">.</span>scrollLeft<span class="o">=</span>c<span class="p">.</span>scrollWidth<span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">var</span> t <span class="o">=</span> c<span class="p">.</span>spatNavSearch<span class="p">({</span>
            dir<span class="o">:</span> e<span class="p">.</span>dir<span class="p">,</span>
            candidates<span class="o">:</span> areas
        <span class="p">});</span>
        t<span class="p">.</span>focus<span class="p">();</span>
<span class="p">});</span>
</code></pre>
    </div>
   </div>
   <div class="api">
    <h2 class="heading settled" data-level="6" id="events-navigationevent"><span class="secno">6. </span><span class="content"> Navigation Events</span><a class="self-link" href="#events-navigationevent"></a></h2>
    <h3 class="heading settled" data-level="6.1" id="interface-focusevent"><span class="secno">6.1. </span><span class="content"> Interface NavigationEvent</span><a class="self-link" href="#interface-focusevent"></a></h3>
    <p>The <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①">NavigationEvent</a></code> interface provides specific contextual information associated with sequential or spatial navigation.</p>
    <p>To create an instance of the <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent②">NavigationEvent</a></code> interface, use the <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent③">NavigationEvent</a></code> constructor,
passing an optional <code class="idl"><a data-link-type="idl" href="#dictdef-navigationeventinit" id="ref-for-dictdef-navigationeventinit">NavigationEventInit</a></code> dictionary.</p>
<pre class="idl highlight def">[<dfn class="nv idl-code" data-dfn-for="NavigationEvent" data-dfn-type="constructor" data-export="" data-lt="NavigationEvent(type, eventInitDict)|NavigationEvent(type)" id="dom-navigationevent-navigationevent"><code>Constructor</code><a class="self-link" href="#dom-navigationevent-navigationevent"></a></dfn>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><span class="kt">DOMString</span></a> <dfn class="nv idl-code" data-dfn-for="NavigationEvent/NavigationEvent(type, eventInitDict)" data-dfn-type="argument" data-export="" id="dom-navigationevent-navigationevent-type-eventinitdict-type"><code>type</code><a class="self-link" href="#dom-navigationevent-navigationevent-type-eventinitdict-type"></a></dfn>, <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-navigationeventinit" id="ref-for-dictdef-navigationeventinit①">NavigationEventInit</a> <dfn class="nv idl-code" data-dfn-for="NavigationEvent/NavigationEvent(type, eventInitDict)" data-dfn-type="argument" data-export="" id="dom-navigationevent-navigationevent-type-eventinitdict-eventinitdict"><code>eventInitDict</code><a class="self-link" href="#dom-navigationevent-navigationevent-type-eventinitdict-eventinitdict"></a></dfn>)]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="navigationevent"><code>NavigationEvent</code></dfn> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/uievents/#uievent-uievent" id="ref-for-uievent-uievent①">UIEvent</a> {
      <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-navigationdirection" id="ref-for-enumdef-navigationdirection①">NavigationDirection</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="NavigationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="NavigationDirection" id="dom-navigationevent-dir"><code>dir</code></dfn>;
      <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget">EventTarget</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="NavigationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="EventTarget?" id="dom-navigationevent-relatedtarget"><code>relatedTarget</code></dfn>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-navigationeventinit"><code>NavigationEventInit</code></dfn> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/uievents/#dictdef-uieventinit-uieventinit" id="ref-for-dictdef-uieventinit-uieventinit">UIEventInit</a> {
      <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-navigationdirection" id="ref-for-enumdef-navigationdirection②">NavigationDirection</a> <dfn class="nv idl-code" data-dfn-for="NavigationEventInit" data-dfn-type="dict-member" data-export="" data-type="NavigationDirection " id="dom-navigationeventinit-dir"><code>dir</code><a class="self-link" href="#dom-navigationeventinit-dir"></a></dfn>;
      <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①">EventTarget</a>? <dfn class="nv idl-code" data-default="null" data-dfn-for="NavigationEventInit" data-dfn-type="dict-member" data-export="" data-type="EventTarget? " id="dom-navigationeventinit-relatedtarget"><code>relatedTarget</code><a class="self-link" href="#dom-navigationeventinit-relatedtarget"></a></dfn> = <span class="kt">null</span>;
};
</pre>
    <div class="verbose">
     <h3 class="non-normative heading settled" data-level="6.2" id="events-nav-type"><span class="secno">6.2. </span><span class="content"> Navigation Event Types</span><a class="self-link" href="#events-nav-type"></a></h3>
     <p><em>This section and its subsections are not normative.</em></p>
     <p>The Navigation event types are summarized below.
For full normative details, see <a href="#processing-model">§7 Processing Model</a>.</p>
     <h4 class="non-normative heading settled" data-level="6.2.1" id="event-type-navbeforefocus"><span class="secno">6.2.1. </span><span class="content"> <dfn class="dfn-paneled idl-code" data-dfn-for="NavigationEvent" data-dfn-type="event" data-export="" id="eventdef-navigationevent-navbeforefocus"><code>navbeforefocus</code></dfn></span><a class="self-link" href="#event-type-navbeforefocus"></a></h4>
     <p>The <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navbeforefocus" id="ref-for-eventdef-navigationevent-navbeforefocus">navbeforefocus</a> event occurs before spatial <span class="sequential"> or <a href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation">sequential</a></span> navigation changes the focus.</p>
     <table class="def">
      <tbody>
       <tr>
        <th>Type 
        <td><strong><code>navbeforefocus</code></strong> 
       <tr>
        <th>Interface 
        <td><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent④">NavigationEvent</a></code> 
       <tr>
        <th>Bubbles 
        <td>Yes 
       <tr>
        <th>Cancelable 
        <td>Yes 
       <tr>
        <th>Attributes of the event 
        <td>
         <dl>
          <dt><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent⑤">NavigationEvent</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget">relatedTarget</a></code> 
          <dd>The DOM anchor of the focusable area that will be focused 
          <dt><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent⑥">NavigationEvent</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir">dir</a></code> 
          <dd>The direction of the navigation as requested by the user 
         </dl>
     </table>
     <div class="example" id="example-30c5348c">
      <a class="self-link" href="#example-30c5348c"></a> This example shows the <a href="https://www.w3.org/TR/uievents/#event-order">UI Events §event-order</a> when pressing the <code class="key">ArrowRight</code> key.
    For the sake of keeping the description simple,
    this example assumes a UA where spatial navigation is triggered using arrow keys. 
      <table class="complex data">
       <thead>
        <tr>
         <th>
         <th>Event type 
         <th><code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/uievents/#keyboardevent-keyboardevent" id="ref-for-keyboardevent-keyboardevent">KeyboardEvent</a></code>.<code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/uievents/#dom-keyboardevent-key" id="ref-for-dom-keyboardevent-key">key</a></code> 
         <th>Notes 
       <tbody>
        <tr>
         <td>1 
         <td>keydown 
         <td><code class="key">ArrowRight</code> 
         <td>MUST be a key which can activate spatial navigation,
                    such as the arrow keys, or spatial navigation is not activated. 
        <tr>
         <td>2 
         <td>navbeforefocus 
         <td>
         <td>Sent if the candidates for spatial navigation is not <code>null</code>,
                    or this is not generated. 
        <tr>
         <td>3 
         <td>focusin 
         <td>
         <td>Sent before the target element receives focus. 
        <tr>
         <td>4 
         <td>focus 
         <td>
         <td>Sent after the target element receives focus. 
      </table>
     </div>
     <h4 class="non-normative heading settled" data-level="6.2.2" id="event-type-navbeforescroll"><span class="secno">6.2.2. </span><span class="content"> <dfn class="dfn-paneled idl-code" data-dfn-for="NavigationEvent" data-dfn-type="event" data-export="" id="eventdef-navigationevent-navbeforescroll"><code>navbeforescroll</code></dfn></span><a class="self-link" href="#event-type-navbeforescroll"></a></h4>
     <p>The <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navbeforescroll" id="ref-for-eventdef-navigationevent-navbeforescroll">navbeforescroll</a> event occurs before spatial navigation triggers scrolling.</p>
     <table class="def">
      <tbody>
       <tr>
        <th>Type 
        <td><strong><code>navbeforescroll</code></strong> 
       <tr>
        <th>Interface 
        <td><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent⑦">NavigationEvent</a></code> 
       <tr>
        <th>Bubbles 
        <td>Yes 
       <tr>
        <th>Cancelable 
        <td>Yes 
       <tr>
        <th>Attributes of the event 
        <td>
         <dl>
          <dt><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent⑧">NavigationEvent</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget①">relatedTarget</a></code> 
          <dd>The element that will be scrolled if the event is not canceled 
          <dt><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent⑨">NavigationEvent</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir①">dir</a></code> 
          <dd>The direction of the navigation as requested by the user 
         </dl>
     </table>
     <div class="example" id="example-6630856e">
      <a class="self-link" href="#example-6630856e"></a> This example shows the <a href="https://www.w3.org/TR/uievents/#event-order">UI Events §event-order</a> when pressing the <code class="key">ArrowDown</code> key in the situation like the following figure.
    For the sake of keeping the description simple,
    this example assumes a UA where spatial navigation is triggered using arrow keys. 
      <figure>
        <img alt="An image about navbeforescroll" src="images/navbeforescroll-example-1.png" style="width: 200px;"> 
       <figcaption>"Box 2" gains the focus and there isn’t any candidate in a downward direction
            in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollport" id="ref-for-scrollport③">scrollport</a>.</figcaption>
      </figure>
      <table class="complex data">
       <thead>
        <tr>
         <th>
         <th>Event type 
         <th>Event target 
         <th><code>relatedTarget</code> 
         <th>Notes 
       <tbody>
        <tr>
         <td>1 
         <td>keydown 
         <td><code>#box2</code> 
         <td>N/A 
         <td>MUST be a key which can activate spatial navigation,
                    such as the arrow keys,
                    otherwise spatial navigation is not triggered. 
        <tr>
         <td>2 
         <td>navbeforescroll 
         <td><code>#box2</code> 
         <td><code>#scrollContainer</code> 
         <td>Sent if <code>#scrollContainer</code> doesn’t contain any candidate in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollport" id="ref-for-scrollport④">scrollport</a>,
                otherwise this would not be generated. 
      </table>
      <p>After <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navbeforescroll" id="ref-for-eventdef-navigationevent-navbeforescroll①">navbeforescroll</a> is fired, pressing the <code class="key">ArrowDown</code> key triggers scrolling
    down the scrollbar like in the figure below:</p>
      <figure>
        <img alt="An image of the result about navnotarget" src="images/navbeforescroll-example-2.png" style="width: 200px;"> 
       <figcaption>The result of moving focus when there isn’t any candidate in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollport" id="ref-for-scrollport⑤">scrollport</a>.</figcaption>
      </figure>
      <p>This example uses the markup as follows:</p>
<pre class="lang-css highlight"><span class="nt">#scrollContainer </span><span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="m">700</span><span class="l">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="m">700</span><span class="l">px</span><span class="p">;</span>
    <span class="k">overflow-x</span><span class="p">:</span> hidden<span class="p">;</span>
    <span class="k">overflow-y</span><span class="p">:</span> auto<span class="p">;</span>
<span class="p">}</span>

<span class="nt">.item </span><span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="m">150</span><span class="l">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="m">110</span><span class="l">px</span><span class="p">;</span>
    <span class="k">background-color</span><span class="p">:</span> blue<span class="p">;</span>
<span class="p">}</span>

<span class="nt">.item:focus </span><span class="p">{</span>
    <span class="k">background-color</span><span class="p">:</span> red<span class="p">;</span>
<span class="p">}</span>
</pre>
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"scrollContainer"</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"box1"</span> <span class="na">class</span><span class="o">=</span><span class="s">"item"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 1<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"box2"</span> <span class="na">class</span><span class="o">=</span><span class="s">"item"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 2<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"box3"</span> <span class="na">class</span><span class="o">=</span><span class="s">"item"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 3<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
     </div>
     <h4 class="non-normative heading settled" data-level="6.2.3" id="event-type-navnotarget"><span class="secno">6.2.3. </span><span class="content"> <dfn class="dfn-paneled idl-code" data-dfn-for="NavigationEvent" data-dfn-type="event" data-export="" id="eventdef-navigationevent-navnotarget"><code>navnotarget</code></dfn></span><a class="self-link" href="#event-type-navnotarget"></a></h4>
     <p>The <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navnotarget" id="ref-for-eventdef-navigationevent-navnotarget">navnotarget</a> event occurs before going up the tree to search candidates in the
nearest ancestor <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①③">spatnav container</a> when spatial navigation has failed to find any candidate
within the current <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①④">spatnav container</a>.</p>
     <p>If the <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①⑤">spatnav container</a> is scrollable, the event occurs when there isn’t any candidate in it
and it cannot be scrolled at the same time.</p>
     <table class="def">
      <tbody>
       <tr>
        <th>Type 
        <td><strong><code>navnotarget</code></strong> 
       <tr>
        <th>Interface 
        <td><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①⓪">NavigationEvent</a></code> 
       <tr>
        <th>Bubbles 
        <td>Yes 
       <tr>
        <th>Cancelable 
        <td>Yes 
       <tr>
        <th>Attributes of the event 
        <td>
         <dl>
          <dt><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①①">NavigationEvent</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget②">relatedTarget</a></code> 
          <dd>The <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①⑥">spatnav container</a> that was searched in. 
          <dt><code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①②">NavigationEvent</a></code>.<code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir②">dir</a></code> 
          <dd>The direction of the navigation as requested by the user 
         </dl>
     </table>
     <div class="example" id="example-a6cbed5d">
      <a class="self-link" href="#example-a6cbed5d"></a> This example shows the <a href="https://www.w3.org/TR/uievents/#event-order">UI Events §event-order</a> when pressing the <code class="key">ArrowDown</code> key in the situation like the following figure.
    For the sake of keeping the description simple,
    this example assumes a UA where spatial navigation is triggered using arrow keys. 
      <figure>
        <img alt="An image about navnotarget" src="images/navnotarget-example-1.png" style="width: 200px;"> 
       <figcaption>Moving focus when there isn’t any candidate in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container">scroll container</a>.</figcaption>
      </figure>
      <table class="complex data">
       <thead>
        <tr>
         <th>
         <th>Event type 
         <th>Event target 
         <th><code>relatedTarget</code> 
         <th>Notes 
       <tbody>
        <tr>
         <td>1 
         <td>keydown 
         <td><code>#box2</code> 
         <td>N/A 
         <td>MUST be a key which can activate spatial navigation,
                    such as the arrow keys,
                    otherwise spatial navigation is not triggered. 
        <tr>
         <td>2 
         <td>navnotarget 
         <td><code>#box2</code> 
         <td><code>#scrollContainer</code> 
         <td>Sent if <code>#scrollContainer</code> doesn’t contain any candidate and
                cannot be scrolled,
                otherwise this would not be generated. 
        <tr>
         <td>3 
         <td>navbeforefocus 
         <td><code>#box2</code> 
         <td><code>#box3</code> 
         <td>Sent if the candidates in <code>#container</code> is not <code>null</code>,
                otherwise this would not be fired. 
        <tr>
         <td>4 
         <td>focusin 
         <td><code>#box3</code> 
         <td>N/A 
         <td>Sent before the target element receives focus. 
        <tr>
         <td>5 
         <td>focus 
         <td><code>#box3</code> 
         <td>N/A 
         <td>Sent after the target element receives focus. 
      </table>
      <p>The result of this example is the figure as follows:</p>
      <figure>
        <img alt="An image of the result about navnotarget" src="images/navnotarget-example-2.png" style="width: 200px;"> 
       <figcaption>The result of moving focus when there isn’t any candidate in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollport" id="ref-for-scrollport⑥">scrollport</a> and <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container①">scroll container</a> cannot be scrolled.</figcaption>
      </figure>
      <p>This example uses the markup as follows:</p>
<pre class="lang-css highlight"><span class="nt">#container </span><span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="m">900</span><span class="l">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="m">1400</span><span class="l">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">#scrollContainer </span><span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="m">700</span><span class="l">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="m">700</span><span class="l">px</span><span class="p">;</span>
    <span class="k">overflow-x</span><span class="p">:</span> hidden<span class="p">;</span>
    <span class="k">overflow-y</span><span class="p">:</span> auto<span class="p">;</span>
<span class="p">}</span>

<span class="nt">.item </span><span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="m">150</span><span class="l">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="m">110</span><span class="l">px</span><span class="p">;</span>
    <span class="k">background-color</span><span class="p">:</span> blue<span class="p">;</span>
<span class="p">}</span>

<span class="nt">.item:focus </span><span class="p">{</span>
    <span class="k">background-color</span><span class="p">:</span> red<span class="p">;</span>
<span class="p">}</span>
</pre>
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"scrollContainer"</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"box1"</span> <span class="na">class</span><span class="o">=</span><span class="s">"item"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 1<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"box2"</span> <span class="na">class</span><span class="o">=</span><span class="s">"item"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 2<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"box3"</span> <span class="na">class</span><span class="o">=</span><span class="s">"item"</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">"0"</span><span class="p">></span>Box 3<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
     </div>
    </div>
   </div>
   <h2 class="heading settled" data-level="7" id="processing-model"><span class="secno">7. </span><span class="content"> Processing Model</span><a class="self-link" href="#processing-model"></a></h2>
   <div class="verbose">
     The <a href="#overview">§3 Overview</a> section gives a high level idea of how spatial navigation works,
to help readers of this specification build a general mental model.
It uses intuitive but imprecise terminology,
and glosses over many details
for the sake of readability. 
    <p>This section defines the corresponding normative behavior
and aims for as much detail as necessary
to fully define the behavior.</p>
    <div class="sequential"> This includes integration with sequential navigation. </div>
   </div>
   <p class="issue" id="issue-e8431aa1"><a class="self-link" href="#issue-e8431aa1"></a> The following currently does not account
for <a href="https://github.com/WICG/overscroll-behavior">the proposed overscroll-behavior specification</a>. <a href="https://github.com/wicg/spatial-navigation/issues/19">&lt;https://github.com/wicg/spatial-navigation/issues/19></a></p>
   <p class="issue" id="issue-e0cc24e0"><a class="self-link" href="#issue-e0cc24e0"></a> The following does not take shadow dom into account. <a href="https://github.com/wicg/spatial-navigation/issues/21">&lt;https://github.com/wicg/spatial-navigation/issues/21></a></p>
   <h3 class="heading settled" data-level="7.1" id="grouping"><span class="secno">7.1. </span><span class="content"> Groupings of elements</span><a class="self-link" href="#grouping"></a></h3>
   <p>While the general model for spatial navigation
is to work from the layout of the document
and the relative position of focusable elements,
the User Agent is required to prioritize finding elements
from a local logical grouping,
only looking for focusable elements outside of the grouping
if a suitable one cannot be found inside it (see <a href="#nav">§7.2 Navigation</a> for details).</p>
   <p>Such groupings are called <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="spatial navigation focus container | spatial navigation focus containers | spatnav container | spatnav containers" data-noexport="" id="spatial-navigation-focus-container">spatial navigation focus containers</dfn> (or <strong>spatnav containers</strong> for short).</p>
   <p><span class="cssapi">By default, </span><a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①⑦">spatnav containers</a> are established by:</p>
   <ul>
    <li data-md="">
     <p>The viewport of a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context①">browsing context</a> (not limited to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context">top-level browsing context</a>)</p>
    <li data-md="">
     <p><a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container②">scroll containers</a></p>
   </ul>
   <div class="cssapi"> Additional <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①⑧">spatnav containers</a> can be created using the <a class="property" data-link-type="propdesc" href="#propdef-spatial-navigation-contain" id="ref-for-propdef-spatial-navigation-contain②">spatial-navigation-contain</a> property (see <a href="#container">§8.1 Creating additional spatnav containers: the spatial-navigation-contain property</a>). </div>
   <h3 class="heading settled" data-level="7.2" id="nav"><span class="secno">7.2. </span><span class="content"> Navigation</span><a class="self-link" href="#nav"></a></h3>
   <figure class="verbose non-normative">
    <figcaption>This figure is not normative. It gives an overview of the processing model further defined in this section.</figcaption>
     <img alt="Flow chart summarizing the processing model" src="images/spatnv_processing_model_diagram.svg"> 
   </figure>
   <p>There can be a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="spatial-navigation-starting-point">spatial navigation starting point</dfn>. It is initially unset.
The user agent may set it when the user indicates that it should be moved.</p>
   <p class="note" role="note"><span>Note:</span> For example, the user agent could set it to the position of the user’s click if the user clicks on the document contents.</p>
   <p>If the UA sets both a <a data-link-type="dfn" href="#spatial-navigation-starting-point" id="ref-for-spatial-navigation-starting-point">spatial navigation starting point</a> and a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation-starting-point" id="ref-for-sequential-focus-navigation-starting-point">sequential focus navigation starting point</a>,
they must not be set differently.</p>
   <p class="issue" id="issue-8aa511b3"><a class="self-link" href="#issue-8aa511b3"></a> The focusing steps should probably reset the <a data-link-type="dfn" href="#spatial-navigation-starting-point" id="ref-for-spatial-navigation-starting-point①">spatial navigation starting point</a> <a href="https://github.com/wicg/spatial-navigation/issues/23">&lt;https://github.com/wicg/spatial-navigation/issues/23></a></p>
   <div class="algorithm" data-algorithm="to run the spatial navigation steps">
     To run the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="spatial-navigation-steps">spatial navigation steps</dfn> in <var>direction</var>, do the following: 
    <ol>
     <li data-md="">
      <p>Let <var>startingPoint</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#dom-anchor" id="ref-for-dom-anchor①">DOM anchor</a> of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#currently-focused-area-of-a-top-level-browsing-context" id="ref-for-currently-focused-area-of-a-top-level-browsing-context">currently focused area of a top-level browsing context</a>.</p>
     <li data-md="">
      <p>If the <a data-link-type="dfn" href="#spatial-navigation-starting-point" id="ref-for-spatial-navigation-starting-point②">spatial navigation starting point</a> is not <code>null</code> and it is inside <var>startingPoint</var> then set <var>startingPoint</var> to the <a data-link-type="dfn" href="#spatial-navigation-starting-point" id="ref-for-spatial-navigation-starting-point③">spatial navigation starting point</a></p>
     <li data-md="">
      <ul>
       <li data-md="">
        <p>If <var>startingPoint</var> is an <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#boundary-point-node" id="ref-for-boundary-point-node①">node</a>,
let <var>eventTarget</var> be <var>startingPoint</var></p>
       <li data-md="">
        <p>else (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">assert</a>: the starting point is a position)
let <var>eventTarget</var> be the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#boundary-point-node" id="ref-for-boundary-point-node②">node</a> which contains <var>startingPoint</var></p>
      </ul>
     <li data-md="">
      <p>If <var>eventTarget</var> is the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document①">Document</a> or the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#document-element" id="ref-for-document-element">document element</a>,
    set <var>eventTarget</var> be <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#the-body-element-2" id="ref-for-the-body-element-2">the body element</a> if it is not <code>null</code> or to the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#document-element" id="ref-for-document-element①">document element</a> otherwise.</p>
     <li data-md="">
      <p>If <var>startingPoint</var> is either a <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container③">scroll container</a> or the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document②">document</a></p>
      <ol>
       <li data-md="">
        <p>Let <var>candidates</var> be the result of <a data-link-type="dfn" href="#find-focusable-areas" id="ref-for-find-focusable-areas②">finding focusable areas</a> within <var>startingPoint</var></p>
       <li data-md="">
        <ul>
         <li data-md="">
          <p>If <var>candidates</var> contains at least 1 item:</p>
          <ol>
           <li data-md="">
            <p>Let <var>bestCandidate</var> be the result of <a data-link-type="dfn" href="#select-the-best-candidate" id="ref-for-select-the-best-candidate①">selecting the best candidate</a> within <var>candidates</var> in <var>direction</var> starting from <var>startingPoint</var></p>
           <li data-md="">
            <p><span class="api"><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire">Fire an event</a> named <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navbeforefocus" id="ref-for-eventdef-navigationevent-navbeforefocus①">navbeforefocus</a> at <var>eventTarget</var> using <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①③">NavigationEvent</a></code> with its <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir③">dir</a></code> set to <var>direction</var> and <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget③">relatedTarget</a></code> set to <var>bestCandidate</var> and with it’s <code>bubbles</code> and <code>cancelable</code> attributes set to <code>true</code>,
and return if the result is <code>false</code></span></p>
           <li data-md="">
            <p>Run the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps" id="ref-for-focusing-steps">focusing steps</a> for <var>bestCandidate</var> and return</p>
          </ol>
         <li data-md="">
          <p>Else if <var>eventTarget</var> <a data-link-type="dfn" href="#can-be-manually-scrolled" id="ref-for-can-be-manually-scrolled">can be manually scrolled</a>:</p>
          <ol>
           <li data-md="">
            <p><span class="api"><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire①">Fire an event</a> named <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navbeforescroll" id="ref-for-eventdef-navigationevent-navbeforescroll②">navbeforescroll</a> at <var>eventTarget</var> using <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①④">NavigationEvent</a></code> with its <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir④">dir</a></code> set to <var>direction</var> and <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget④">relatedTarget</a></code> set to <var>eventTarget</var> and with it’s <code>bubbles</code> and <code>cancelable</code> attributes set to <code>true</code>,
and return if the result is <code>false</code></span></p>
           <li data-md="">
            <p><a data-link-type="dfn" href="#directionally-scroll-an-element" id="ref-for-directionally-scroll-an-element">Directionally scroll the element</a> <var>eventTarget</var> in <var>direction</var> and return.</p>
          </ol>
         <li data-md="">
          <p>Else, fallback to the next step</p>
        </ul>
      </ol>
     <li data-md="">
      <p>Let <var>container</var> be the nearest ancestor of <var>eventTarget</var> that is a <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container①⑨">spatnav container</a>.</p>
     <li data-md="">
      <p><i>Loop</i>: Let <var>candidates</var> be the result of <a data-link-type="dfn" href="#find-focusable-areas" id="ref-for-find-focusable-areas③">finding focusable areas</a> within <var>container</var></p>
     <li data-md="">
      <p>If <var>candidates</var> is <code>null</code>:</p>
      <ul>
       <li data-md="">
        <p>If <var>container</var> is a <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container④">scroll container</a> that <a data-link-type="dfn" href="#can-be-manually-scrolled" id="ref-for-can-be-manually-scrolled①">can be manually scrolled</a>:</p>
        <ol>
         <li data-md="">
          <p><span class="api"><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire②">Fire an event</a> named <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navbeforescroll" id="ref-for-eventdef-navigationevent-navbeforescroll③">navbeforescroll</a> at <var>eventTarget</var> using <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①⑤">NavigationEvent</a></code> with its <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir⑤">dir</a></code> set to <var>direction</var> and <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget⑤">relatedTarget</a></code> set to <var>container</var> and with it’s <code>bubbles</code> and <code>cancelable</code> attributes set to <code>true</code>,
and return if the result is <code>false</code></span></p>
         <li data-md="">
          <p><a data-link-type="dfn" href="#directionally-scroll-an-element" id="ref-for-directionally-scroll-an-element①">Directionally scroll the element</a> <var>container</var> in <var>direction</var> and return.</p>
        </ol>
       <li data-md="">
        <p>Else,</p>
        <ol>
         <li data-md="">
          <p><span class="api"><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire③">Fire an event</a> named <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navnotarget" id="ref-for-eventdef-navigationevent-navnotarget①">navnotarget</a> at <var>eventTarget</var> using <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①⑥">NavigationEvent</a></code> with its <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir⑥">dir</a></code> set to <var>direction</var> and <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget⑥">relatedTarget</a></code> set to <var>container</var> and with it’s <code>bubbles</code> and <code>cancelable</code> attributes set to <code>true</code>,
and return if the result is <code>false</code>.</span></p>
         <li data-md="">
          <ul>
           <li data-md="">
            <p>If <var>container</var> is the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#document-element" id="ref-for-document-element②">document element</a> of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context①">top-level browsing context</a>,
then return.
The User Agent may transfer focus to its own controls (if any) honouring <var>direction</var>.</p>
           <li data-md="">
            <p>Else, if <var>container</var> is the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#document-element" id="ref-for-document-element③">document element</a> of a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#nested-browsing-context" id="ref-for-nested-browsing-context">nested browsing context</a> then:</p>
            <ol>
             <li data-md="">
              <p>Set <var>startingPoint</var> to <var>container</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-container" id="ref-for-browsing-context-container">browsing context container</a></p>
             <li data-md="">
              <p>Set <var>eventTarget</var> be <var>startingPoint</var></p>
             <li data-md="">
              <p>Set <var>container</var> to the nearest ancestor of <var>startingPoint</var> that is a <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container②⓪">spatnav container</a>.</p>
             <li data-md="">
              <p>Return to the step labeled <i>loop</i>.</p>
            </ol>
            <p class="issue" id="issue-d6bc89a9"><a class="self-link" href="#issue-d6bc89a9"></a> is it sane from a security standpoint that this propagates up from iframes? <a href="https://github.com/wicg/spatial-navigation/issues/28">&lt;https://github.com/wicg/spatial-navigation/issues/28></a></p>
           <li data-md="">
            <p>Else, set <var>container</var> to its closest ancestor that is itself a <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container②①">spatnav container</a> and return to the step labeled <i>loop</i>.</p>
          </ul>
        </ol>
      </ul>
     <li data-md="">
      <p>Let <var>bestCandidate</var> be the result of <a data-link-type="dfn" href="#select-the-best-candidate" id="ref-for-select-the-best-candidate②">selecting the best candidate</a> within <var>candidates</var> in <var>direction</var> starting from <var>startingPoint</var></p>
     <li data-md="">
      <p><span class="api"><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire④">Fire an event</a> named <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navbeforefocus" id="ref-for-eventdef-navigationevent-navbeforefocus②">navbeforefocus</a> at <var>eventTarget</var> using <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①⑦">NavigationEvent</a></code> with its <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir⑦">dir</a></code> set to <var>direction</var> and <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget⑦">relatedTarget</a></code> set to <var>bestCandidate</var> and with it’s <code>bubbles</code> and <code>cancelable</code> attributes set to <code>true</code>,
and return if the result is <code>false</code></span></p>
     <li data-md="">
      <p>Run the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps" id="ref-for-focusing-steps①">focusing steps</a> for <var>bestCandidate</var> and return</p>
    </ol>
   </div>
   <div class="sequential api">
     For consistency between <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation" id="ref-for-sequential-focus-navigation">sequential focus navigation</a> and the model defined above,
the following is also defined: 
    <div class="algorithm" data-algorithm="to run the sequential navigation steps">
      To run the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="sequential-navigation-steps">sequential navigation steps</dfn> run step 1 through 9 of <a href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation">the HTML steps for sequential navigation</a>,
with one change:
between step 5 and 6, add the following: 
     <blockquote>
      <p>5.5. if <var>candidate</var> is not <code>null</code>, <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire⑤">Fire an event</a> named <a class="idl-code" data-link-type="event" href="#eventdef-navigationevent-navbeforefocus" id="ref-for-eventdef-navigationevent-navbeforefocus③">navbeforefocus</a> at <var>eventTarget</var> using <code class="idl"><a data-link-type="idl" href="#navigationevent" id="ref-for-navigationevent①⑧">NavigationEvent</a></code> with its <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-dir" id="ref-for-dom-navigationevent-dir⑧">dir</a></code> set to <var>direction</var> and <code class="idl"><a data-link-type="idl" href="#dom-navigationevent-relatedtarget" id="ref-for-dom-navigationevent-relatedtarget⑧">relatedTarget</a></code> set to <var>candidate</var> and return if the result is false</p>
     </blockquote>
     <p class="issue" id="issue-dd365682"><a class="self-link" href="#issue-dd365682"></a> This is a monkeypatch on <a data-link-type="biblio" href="#biblio-html">[HTML]</a>.
Eventually this should be upstreamed. <a href="https://github.com/wicg/spatial-navigation/issues/27">&lt;https://github.com/wicg/spatial-navigation/issues/27></a></p>
    </div>
   </div>
   <h3 class="heading settled" data-level="7.3" id="heuristics"><span class="secno">7.3. </span><span class="content"> Focus Navigation Heuristics</span><a class="self-link" href="#heuristics"></a></h3>
   <p class="note" role="note"><span>Note:</span> The following algorithms are inspired from Chrome’s implementation
as well as from the <a href="https://www.w3.org/TR/WICD/#focus-handling">old WICD Spec</a>.
Implementors who find better approaches or refinements to these approaches are strongly
encouraged to provide feedback and help improve this specification
in order to maximize interoperability.
In particular, divergences in how User Agents <a data-link-type="dfn" href="#find-focusable-areas" id="ref-for-find-focusable-areas④">find focusable areas</a> may cause some elements to be focusable in some User Agents but not in others,
which would be bad for users.</p>
   <p>All geometrical operations in this section are defined to work on the result of CSS layout,
including all graphical transformations, such as <a data-link-type="dfn" href="https://drafts.csswg.org/css-position-3/#relative-position" id="ref-for-relative-position">relative positioning</a> or <a data-link-type="biblio" href="#biblio-css-transforms-1">[CSS-TRANSFORMS-1]</a>.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="boundary-box">boundary box</dfn> of an object is defined as follows:</p>
   <ul>
    <li data-md="">
     <p>if the object is a point, the boundary box is that point</p>
    <li data-md="">
     <p>if the object is an element, the boundary box is the <a data-link-type="dfn" href="https://drafts.csswg.org/css2/box.html#x14" id="ref-for-x14">border box</a> of the element’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#principal-box" id="ref-for-principal-box">principal box</a>.</p>
    <li data-md="">
     <p>if the object is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#focusable-area" id="ref-for-focusable-area①">focusable area</a> which is not an element, the boundary box is the axis-aligned the bounding box of that <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#focusable-area" id="ref-for-focusable-area②">focusable area</a></p>
   </ul>
   <p class="issue" id="issue-c7f6d991"><a class="self-link" href="#issue-c7f6d991"></a> CSS should have a term for “border box taking into account corner shaping properties like border-radius”. <a href="https://github.com/w3c/csswg-drafts/issues/2324">&lt;https://github.com/w3c/csswg-drafts/issues/2324></a></p>
   <div class="algorithm" data-algorithm="to find focusable areas">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="find focusable areas | finding focusable areas" data-noexport="" id="find-focusable-areas">find candidates</dfn> within a containing element <var>C</var>,
with an optional <var>visibleOnly</var> argument that defaults to <code>true</code>,
follow the following steps:</p>
    <ol>
     <li data-md="">
      <p>Let <var>focusables</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">set</a> of all the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#focusable-area" id="ref-for-focusable-area③">focusable areas</a> that are descendants of <var>C</var>.</p>
     <li data-md="">
      <p>The UA should <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">remove</a> from <var>focusables</var> elements whose <a data-link-type="element-attr" href="https://html.spec.whatwg.org/multipage/interaction.html#attr-tabindex" id="ref-for-attr-tabindex"><code>tabindex</code></a> attribute is set to a negative value.</p>
      <p class="note" role="note"><span>Note:</span> This is a "SHOULD" in order to mirror the exclusion of elements with negative tabindex
from the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation-order" id="ref-for-sequential-focus-navigation-order①">sequential focus navigation order</a> as defined in <a href="https://html.spec.whatwg.org/multipage/#the-tabindex-attribute">HTML Standard §the-tabindex-attribute</a>.</p>
     <li data-md="">
      <p>If <var>visibleOnly</var> is <code>false</code>,
return <var>focusables</var>.</p>
      <p class="note" role="note"><span>Note:</span> <var>focusables</var> may be empty</p>
     <li data-md="">
      <p>Let <var>insideArea</var> be</p>
      <ul>
       <li data-md="">
        <p>the <a data-link-type="dfn" href="https://drafts.csswg.org/css-scroll-snap-1/#optimal-viewing-region" id="ref-for-optimal-viewing-region">optimal viewing region</a> of <var>C</var> if <var>C</var> is a <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container⑤">scroll container</a>,</p>
       <li data-md="">
        <p>the viewport of C’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context②">browsing context</a> if <var>C</var> is a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document③">Document</a>,</p>
       <li data-md="">
        <p>the <a data-link-type="dfn" href="https://drafts.csswg.org/css2/box.html#x14" id="ref-for-x14①">border box</a> of <var>C</var> otherwise.</p>
      </ul>
     <li data-md="">
      <p>Let <var>visibles</var> be the subset of items in <var>focusables</var> whose <a data-link-type="dfn" href="#boundary-box" id="ref-for-boundary-box">boundary box</a> is at least partly within <var>insideArea</var>.</p>
      <div class="advisement non-normative"> Excect for elements that are in the currently non visible part of a scroller,
spatial navigation does not automatically exclude
elements which cannot be clicked on,
for example due to being obscured by some other element.
To avoid breaking assumptions in
the application logic if a user actually focuses and activates such an element,
and to avoid confusing users by focusing invisible or apparently unreachable elements,
authors should use make these elements unreachable to spatial navigation
using the same best practices as for making elements unreachable to sequential navigation,
such as using <code>tab-index="-1"</code> or the <a href="https://github.com/WICG/inert"><code>inert</code></a> attribute. </div>
     <li data-md="">
      <p>Return <var>visibles</var>.</p>
      <p class="note" role="note"><span>Note:</span> <var>visibles</var> may be empty</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="to select the best candidate">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="select the best candidate | selecting the best candidate" data-noexport="" id="select-the-best-candidate">select the best candidate</dfn> within a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">set</a> of <var>candidates</var> in a direction <var>dir</var>,
starting from <var>starting point</var>,
follow the following steps:</p>
    <ol>
     <li data-md="">
      <p>If <var>candidates</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty">empty</a>, return <code>null</code></p>
     <li data-md="">
      <p>If <var>candidates</var> contains a single item, return that item</p>
     <li data-md="">
      <p>Let <var>insideArea</var> be</p>
      <ul>
       <li data-md="">
        <p>the <a data-link-type="dfn" href="https://drafts.csswg.org/css-scroll-snap-1/#optimal-viewing-region" id="ref-for-optimal-viewing-region①">optimal viewing region</a> of <var>starting point</var> if <var>starting point</var> is a <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container⑥">scroll container</a>,</p>
       <li data-md="">
        <p>the viewport if <var>starting point</var> is a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document④">Document</a>,</p>
       <li data-md="">
        <p>the <a data-link-type="dfn" href="https://drafts.csswg.org/css2/box.html#x14" id="ref-for-x14②">border box</a> of <var>starting point</var> otherwise.</p>
      </ul>
     <li data-md="">
      <p>Let <var>insiders</var> be the subset of <var>candidates</var> items
who are descendants of <var>starting point</var> and whose <a data-link-type="dfn" href="#boundary-box" id="ref-for-boundary-box①">boundary box</a>’s</p>
      <ul>
       <li data-md="">
        <p>top edge is below the top edge of <var>insideArea</var> if <var>D</var> is <code>down</code></p>
       <li data-md="">
        <p>bottom edge is above the bottom edge of <var>insideArea</var> if <var>D</var> is <code>up</code></p>
       <li data-md="">
        <p>right edge is left of the right edge of <var>insideArea</var> if <var>D</var> is <code>left</code></p>
       <li data-md="">
        <p>left edge is right of the left edge of <var>insideArea</var> if <var>D</var> is <code>right</code></p>
      </ul>
      <p class="note" role="note"><span>Note:</span> this sub-setting is necessary to avoid going in the opposite direction than the one requested.</p>
     <li data-md="">
      <ul>
       <li data-md="">
        <p>If <var>insiders</var> is non empty</p>
        <ol>
         <li data-md="">
          <p>Let <var>closest subset</var> be the subset of <var>insiders</var> whose <a data-link-type="dfn" href="#boundary-box" id="ref-for-boundary-box②">boundary box</a>’s</p>
          <ul>
           <li data-md="">
            <p>top edge is closest to the top edge of <var>insideArea</var> if <var>D</var> is <code>down</code></p>
           <li data-md="">
            <p>bottom edge is closest to the bottom edge of <var>insideArea</var> if <var>D</var> is <code>up</code></p>
           <li data-md="">
            <p>right edge is closest to the right edge of <var>insideArea</var> if <var>D</var> is <code>left</code></p>
           <li data-md="">
            <p>left edge is closest to the left edge of <var>insideArea</var> if <var>D</var> is <code>right</code></p>
          </ul>
         <li data-md="">
          <p>If <var>closest subset</var> contains a single item,
return that item,
else return the first item of <var>closest subset</var> in document order</p>
        </ol>
       <li data-md="">
        <p>Else</p>
        <ol>
         <li data-md="">
          <p>Set <var>candidates</var> be the subset of its items
whose <a data-link-type="dfn" href="#boundary-box" id="ref-for-boundary-box③">boundary box</a>’s geometric center is within the closed half plane
whose boundary goes through the geometric center of the <var>starting point</var> and is perpendicular to <var>D</var>.</p>
         <li data-md="">
          <p>For each <var>candidate</var> in <var>candidates</var>,
find the points <var>P1</var> inside the <a data-link-type="dfn" href="#boundary-box" id="ref-for-boundary-box④">boundary box</a> of <var>starting point</var> and <var>P2</var> inside the <a data-link-type="dfn" href="#boundary-box" id="ref-for-boundary-box⑤">boundary box</a> of <var>candidate</var> that minimize the <var>distance</var> between these two points,
when <var>distance</var> is defined as follows:</p>
          <dl>
           <dt><var>distance</var>: 
           <dd><var>A</var> + <var>B</var> + <var>C</var> - <var>D</var> 
           <dt><var>A</var>: 
           <dd>The euclidian distance between <var>P1</var> and <var>P2</var> 
           <dt><var>B</var>: 
           <dd>The absolute distance in the <var>dir</var> direction between <var>P1</var> and <var>P2</var> 
           <dt><var>C</var>: 
           <dd>The absolute distance in the direction which is orthogonal to <var>dir</var> between <var>P1</var> and <var>P2</var> 
           <dt><var>D</var>: 
           <dd>The square root of the area of intersection between the <a data-link-type="dfn" href="#boundary-box" id="ref-for-boundary-box⑥">boundary boxes</a> of <var>candidate</var> and <var>starting point</var> 
          </dl>
         <li data-md="">
          <p>Return the item of the <var>candidates</var> set that has the smallest <var>distance</var>.</p>
        </ol>
      </ul>
    </ol>
   </div>
   <div class="cssapi">
    <h2 class="heading settled" data-level="8" id="declarative"><span class="secno">8. </span><span class="content"> Controlling spatial navigation through declarative means</span><a class="self-link" href="#declarative"></a></h2>
    <h3 class="heading settled" data-level="8.1" id="container"><span class="secno">8.1. </span><span class="content"> Creating additional spatnav containers: the <a class="property" data-link-type="propdesc" href="#propdef-spatial-navigation-contain" id="ref-for-propdef-spatial-navigation-contain③">spatial-navigation-contain</a> property</span><a class="self-link" href="#container"></a></h3>
    <table class="def propdef" data-link-for-hint="spatial-navigation-contain">
     <tbody>
      <tr>
       <th>Name:
       <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export="" id="propdef-spatial-navigation-contain">spatial-navigation-contain</dfn>
      <tr class="value">
       <th><a href="https://drafts.csswg.org/css-values/#value-defs">Value:</a>
       <td class="prod">auto <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-one" id="ref-for-comb-one">|</a> contain
      <tr>
       <th><a href="https://drafts.csswg.org/css-cascade/#initial-values">Initial:</a>
       <td>auto
      <tr>
       <th>Applies to:
       <td><a href="https://drafts.csswg.org/css-pseudo/#generated-content" title="Includes ::before and ::after pseudo-elements.">all elements</a>
      <tr>
       <th><a href="https://drafts.csswg.org/css-cascade/#inherited-property">Inherited:</a>
       <td>no
      <tr>
       <th><a href="https://drafts.csswg.org/css-values/#percentages">Percentages:</a>
       <td>n/a
      <tr>
       <th>Media:
       <td>visual
      <tr>
       <th><a href="https://drafts.csswg.org/css-cascade/#computed">Computed value:</a>
       <td>as specified
      <tr>
       <th>Canonical order:
       <td>per grammar
      <tr>
       <th><a href="https://drafts.csswg.org/css-transitions/#animatable-properties">Animation type:</a>
       <td>discrete
    </table>
    <dl>
     <dt><dfn class="css" data-dfn-for="spatial-navigation-contain" data-dfn-type="value" data-export="" id="valdef-spatial-navigation-contain-auto">auto<a class="self-link" href="#valdef-spatial-navigation-contain-auto"></a></dfn> 
     <dd>If the element is a <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container⑦">scroll container</a> then it establishes a <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container②②">spatial navigation focus container</a>,
        otherwise it does not. 
     <dt><dfn class="css" data-dfn-for="spatial-navigation-contain" data-dfn-type="value" data-export="" id="valdef-spatial-navigation-contain-contain">contain<a class="self-link" href="#valdef-spatial-navigation-contain-contain"></a></dfn> 
     <dd>The element establishes a <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container②③">spatial navigation focus container</a> 
    </dl>
    <p class="note" role="note"><span>Note:</span> In addition, as per <a href="#grouping">§7.1 Groupings of elements</a>, the viewport of a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context③">browsing context</a> (not limited to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context②">top-level browsing context</a>)
        also establishes a <a data-link-type="dfn" href="#spatial-navigation-focus-container" id="ref-for-spatial-navigation-focus-container②④">spatial navigation focus container</a>.</p>
    <div class="example" id="example-34c13432">
     <a class="self-link" href="#example-34c13432"></a> The following example shows a simplified TV program schedule or calendar.
    It has a grid of elements representing TV shows or calendar entries,
    and some UI buttons around it. 
     <p>In this case, the grid is quite sparse,
    so if the user tries to move down from "Foo",
    focus would be moved to "Next Week",
    as it is objectively closer in the down direction.
    The same is true for going down from "Bar":
    the focus would be moved to "Previous Week".</p>
     <div class="output">
      <div id="example-cal">
       <button>Previous Week</button>
       <table>
        <tbody>
         <tr>
          <td>
          <th>M
          <th>T
          <th>W
          <th>T
          <th>F
          <th>S
          <th>S 
         <tr>
          <td>0-6
          <td>
          <td>
          <td>
          <td>
          <td>
          <td>
          <td><a href="#">Foo</a> 
         <tr>
          <td>6-9
          <td><a href="#">Bar</a>
          <td>
          <td>
          <td>
          <td>
          <td>
          <td>
         <tr>
          <td>9-12
          <td>
          <td>
          <td>
          <td>
          <td>
          <td>
          <td>
         <tr>
          <td>12-18
          <td>
          <td>
          <td>
          <td>
          <td>
          <td>
          <td>
         <tr>
          <td>18-21
          <td>
          <td>
          <td>
          <td>
          <td>
          <td>
          <td>
         <tr>
          <td>21-24
          <td>
          <td>
          <td>
          <td>
          <td>
          <td><a href="#">Baz</a>
          <td>
       </table>
       <button>Next Week</button>
      </div>
     </div>
<pre><code class="highlight"><span class="p">&lt;</span><span class="nt">div</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">button</span><span class="p">></span>Previous Week<span class="p">&lt;/</span><span class="nt">button</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">table</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">th</span><span class="p">></span>M<span class="p">&lt;</span><span class="nt">th</span><span class="p">></span>T<span class="p">&lt;</span><span class="nt">th</span><span class="p">></span>W<span class="p">&lt;</span><span class="nt">th</span><span class="p">></span>T<span class="p">&lt;</span><span class="nt">th</span><span class="p">></span>F<span class="p">&lt;</span><span class="nt">th</span><span class="p">></span>S<span class="p">&lt;</span><span class="nt">th</span><span class="p">></span>S
        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>0-6<span class="p">&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">></span>Foo<span class="p">&lt;/</span><span class="nt">a</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>6-9<span class="p">&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">></span>Bar<span class="p">&lt;/</span><span class="nt">a</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>9-12<span class="p">&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>12-18<span class="p">&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>18-21<span class="p">&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>
        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>21-24<span class="p">&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">>&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span><span class="p">></span>Baz<span class="p">&lt;/</span><span class="nt">a</span><span class="p">>&lt;</span><span class="nt">td</span><span class="p">></span>
    <span class="p">&lt;/</span><span class="nt">table</span><span class="p">></span>
    <span class="p">&lt;</span><span class="nt">button</span><span class="p">></span>Next Week<span class="p">&lt;/</span><span class="nt">button</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</code></pre>
<pre><code class="highlight"><span class="nt">table, td, th </span><span class="p">{</span>
    <span class="k">border-collapse</span><span class="p">:</span> collapse<span class="p">;</span>
    <span class="k">border</span><span class="p">:</span> solid <span class="m">1</span><span class="l">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">td </span><span class="p">{</span> <span class="k">width</span><span class="p">:</span> <span class="m">12.5</span><span class="l">%</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">div </span><span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> grid<span class="p">;</span>
    <span class="k">grid-template-columns</span><span class="p">:</span> auto <span class="m">1</span><span class="l">fr</span> auto<span class="p">;</span>
<span class="p">}</span>
<span class="nt">button </span><span class="p">{</span> <span class="k">align-self</span><span class="p">:</span> center<span class="p">;</span> <span class="p">}</span>
</code></pre>
     <p>Because the elements in the table are semantically related to eachother,
    the author may want to provide a different navigation experience
    giving priority to movements inside the grid once you have focused one of its items.</p>
     <p>Adding <code class="highlight"><span class="nt">table </span><span class="p">{</span> <span class="k">spatial-navigation-contain</span><span class="p">:</span> contain<span class="p">;</span> <span class="p">}</span></code> to the stylesheet
    would result it this behavior.
    It would still be possible to move the focus out of the table,
    for example by going right from "Foo".
    Since there is nothing in the grid that is to the right,
    the focus would move to "Next week".</p>
     <p>However, if the user navigates down from "Foo",
    there is something inside the grid,
    so focus will move there without considering things that are outside.</p>
    </div>
    <p class="note" role="note"><span>Note:</span> the <a class="property" data-link-type="propdesc" href="#propdef-spatial-navigation-contain" id="ref-for-propdef-spatial-navigation-contain④">spatial-navigation-contain</a> property is <a data-link-type="dfn" href="#at-risk" id="ref-for-at-risk①">at-risk</a>.</p>
   </div>
   <h2 class="no-num heading settled" id="scrolling"><span class="content">Appendix A. Scroll extensions</span><a class="self-link" href="#scrolling"></a></h2>
   <p>This section proposes a few extensions to CSS
that should be integrated in upstream specifications,
but are hosted here until then.</p>
   <div class="algorithm" data-algorithm="can be manually scrolled">
    <p class="issue" id="issue-942e7041"><a class="self-link" href="#issue-942e7041"></a> Terminology like this should be in <a data-link-type="biblio" href="#biblio-cssom-view-1">[CSSOM-VIEW-1]</a>, <a data-link-type="biblio" href="#biblio-css-overflow-3">[CSS-OVERFLOW-3]</a>, <a data-link-type="biblio" href="#biblio-css-scroll-snap-1">[CSS-SCROLL-SNAP-1]</a>. <a href="https://github.com/w3c/csswg-drafts/issues/2322">&lt;https://github.com/w3c/csswg-drafts/issues/2322></a></p>
    <p>An element <var>e</var> <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="can be manually scrolled | can be scrolled manually | cannot be scrolled manually | cannot be manually scrolled" data-noexport="" id="can-be-manually-scrolled">can be manually scrolled</dfn> in a given direction <var>d</var> if:</p>
    <ul>
     <li data-md="">
      <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#principal-box" id="ref-for-principal-box①">principal box</a> established by <var>e</var> is a <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scroll-container" id="ref-for-scroll-container⑧">scroll container</a>, and</p>
     <li data-md="">
      <p>if <var>d</var> is <code>up</code> or <code>down</code>, the computed value of the <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow-y" id="ref-for-propdef-overflow-y">overflow-y</a> property is not <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-overflow-3/#valdef-overflow-hidden" id="ref-for-valdef-overflow-hidden">hidden</a>, and</p>
     <li data-md="">
      <p>if <var>d</var> is <code>left</code> or <code>right</code>, the computed value of the <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow-x" id="ref-for-propdef-overflow-x">overflow-x</a> property is not <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-overflow-3/#valdef-overflow-hidden" id="ref-for-valdef-overflow-hidden①">hidden</a>, and</p>
     <li data-md="">
      <p><var>e</var> is not at the <a data-link-type="dfn" href="https://wicg.github.io/overscroll-behavior/#scroll-boundary" id="ref-for-scroll-boundary">scroll boundary</a> in the direction <var>d</var></p>
     <li data-md="">
      <p><var>e</var> is not snapped to the last <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-scroll-snap-1/#valdef-scroll-snap-type-mandatory" id="ref-for-valdef-scroll-snap-type-mandatory">mandatory</a> snap point in direction <var>d</var></p>
    </ul>
   </div>
   <div class="algorithm" data-algorithm="to directionally scroll an element">
    <p class="issue" id="issue-00706fa4"><a class="self-link" href="#issue-00706fa4"></a> <a data-link-type="biblio" href="#biblio-cssom-view-1">[CSSOM-VIEW-1]</a> should probably define
how to perform a scroll in a given direction without an explicit position.
Until then, we roll our own. <a href="https://github.com/w3c/csswg-drafts/issues/2323">&lt;https://github.com/w3c/csswg-drafts/issues/2323></a></p>
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="directionally scroll an element | directionally scroll the element" data-noexport="" id="directionally-scroll-an-element">directionally scroll an element</dfn> <var>e</var> in direction <var>dir</var>:</p>
    <ol>
     <li data-md="">
      <p>Let <var>d</var> be a User Agent defined distance.</p>
     <li data-md="">
      <p>Let <var>x</var> be <var>e</var>’s current scroll position on the x axis.</p>
     <li data-md="">
      <p>Let <var>y</var> be <var>e</var>’s current scroll position on the y axis.</p>
     <li data-md="">
      <p>Use the <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-view-1/#scroll-an-element" id="ref-for-scroll-an-element">scroll an element</a> algorithm from <a data-link-type="biblio" href="#biblio-cssom-view-1">[CSSOM-VIEW-1]</a> on <var>e</var> to</p>
      <ul>
       <li data-md="">
        <p>(<var>x</var>, <var>y</var> - <var>d</var>) if <var>dir</var> is <code>up</code></p>
       <li data-md="">
        <p>(<var>x</var>, <var>y</var> + <var>d</var>) if <var>dir</var> is <code>down</code></p>
       <li data-md="">
        <p>(<var>x</var> - <var>d</var>, <var>y</var>) if <var>dir</var> is <code>left</code></p>
       <li data-md="">
        <p>(<var>x</var> + <var>d</var>, <var>y</var>) if <var>dir</var> is <code>right</code></p>
      </ul>
    </ol>
   </div>
   <h2 class="no-num heading settled" id="ack"><span class="content">Acknowledgements</span><a class="self-link" href="#ack"></a></h2>
   <p>The editors of this specification would like to thank the following individuals for their feedback and contributions (in alphabetical order):</p>
   <ul>
    <li data-md="">
     <p>Alice Boxhall</p>
    <li data-md="">
     <p>Brial Kardell</p>
    <li data-md="">
     <p>Elika Etemad</p>
    <li data-md="">
     <p>Hugo Holgersson</p>
    <li data-md="">
     <p>Hyojin Song</p>
    <li data-md="">
     <p>Junho Seo</p>
    <li data-md="">
     <p>Rob Dodson</p>
    <li data-md="">
     <p>Seungcheon Baek</p>
   </ul>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words “for example”
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word “Note”
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note. </p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-focusableareasearchmode-all">"all"</a><span>, in §5.2</span>
   <li><a href="#at-risk">at-risk</a><span>, in §1</span>
   <li><a href="#valdef-spatial-navigation-contain-auto">auto</a><span>, in §8.1</span>
   <li>
    "backward"
    <ul>
     <li><a href="#dom-navigationdirection-backward">enum-value for NavigationDirection</a><span>, in §5.1</span>
     <li><a href="#dom-sequentialnavigationdirection-backward">enum-value for SequentialNavigationDirection</a><span>, in §5.2</span>
    </ul>
   <li><a href="#boundary-box">boundary box</a><span>, in §7.3</span>
   <li><a href="#can-be-manually-scrolled">can be manually scrolled</a><span>, in §Unnumbered section</span>
   <li><a href="#can-be-manually-scrolled">can be scrolled manually</a><span>, in §Unnumbered section</span>
   <li><a href="#dom-spatnavsearchoptions-candidates">candidates</a><span>, in §5.2</span>
   <li><a href="#can-be-manually-scrolled">cannot be manually scrolled</a><span>, in §Unnumbered section</span>
   <li><a href="#can-be-manually-scrolled">cannot be scrolled manually</a><span>, in §Unnumbered section</span>
   <li><a href="#valdef-spatial-navigation-contain-contain">contain</a><span>, in §8.1</span>
   <li><a href="#dom-spatnavsearchoptions-container">container</a><span>, in §5.2</span>
   <li>
    dir
    <ul>
     <li><a href="#dom-navigationevent-dir">attribute for NavigationEvent</a><span>, in §6.1</span>
     <li><a href="#dom-navigationeventinit-dir">dict-member for NavigationEventInit</a><span>, in §6.1</span>
     <li><a href="#dom-spatnavsearchoptions-dir">dict-member for SpatNavSearchOptions</a><span>, in §5.2</span>
    </ul>
   <li><a href="#directionally-scroll-an-element">directionally scroll an element</a><span>, in §Unnumbered section</span>
   <li><a href="#directionally-scroll-an-element">directionally scroll the element</a><span>, in §Unnumbered section</span>
   <li>
    "down"
    <ul>
     <li><a href="#dom-navigationdirection-down">enum-value for NavigationDirection</a><span>, in §5.1</span>
     <li><a href="#dom-spatialnavigationdirection-down">enum-value for SpatialNavigationDirection</a><span>, in §5.2</span>
    </ul>
   <li><a href="#find-focusable-areas">find focusable areas</a><span>, in §7.3</span>
   <li><a href="#find-focusable-areas">finding focusable areas</a><span>, in §7.3</span>
   <li><a href="#dom-element-focusableareas">focusableAreas()</a><span>, in §5.2</span>
   <li><a href="#dom-element-focusableareas">focusableAreas(arg)</a><span>, in §5.2</span>
   <li><a href="#enumdef-focusableareasearchmode">FocusableAreaSearchMode</a><span>, in §5.2</span>
   <li><a href="#dictdef-focusableareasoptions">FocusableAreasOptions</a><span>, in §5.2</span>
   <li>
    "forward"
    <ul>
     <li><a href="#dom-navigationdirection-forward">enum-value for NavigationDirection</a><span>, in §5.1</span>
     <li><a href="#dom-sequentialnavigationdirection-forward">enum-value for SequentialNavigationDirection</a><span>, in §5.2</span>
    </ul>
   <li><a href="#dom-element-getspatnavcontainer">getSpatnavContainer()</a><span>, in §5.2</span>
   <li>
    "left"
    <ul>
     <li><a href="#dom-navigationdirection-left">enum-value for NavigationDirection</a><span>, in §5.1</span>
     <li><a href="#dom-spatialnavigationdirection-left">enum-value for SpatialNavigationDirection</a><span>, in §5.2</span>
    </ul>
   <li><a href="#dom-focusableareasoptions-mode">mode</a><span>, in §5.2</span>
   <li><a href="#eventdef-navigationevent-navbeforefocus">navbeforefocus</a><span>, in §6.2.1</span>
   <li><a href="#eventdef-navigationevent-navbeforescroll">navbeforescroll</a><span>, in §6.2.2</span>
   <li><a href="#dom-window-navigate">navigate(dir)</a><span>, in §5.1</span>
   <li><a href="#enumdef-navigationdirection">NavigationDirection</a><span>, in §5.1</span>
   <li><a href="#navigationevent">NavigationEvent</a><span>, in §6.1</span>
   <li><a href="#dictdef-navigationeventinit">NavigationEventInit</a><span>, in §6.1</span>
   <li><a href="#dom-navigationevent-navigationevent">NavigationEvent(type)</a><span>, in §6.1</span>
   <li><a href="#dom-navigationevent-navigationevent">NavigationEvent(type, eventInitDict)</a><span>, in §6.1</span>
   <li><a href="#eventdef-navigationevent-navnotarget">navnotarget</a><span>, in §6.2.3</span>
   <li>
    relatedTarget
    <ul>
     <li><a href="#dom-navigationevent-relatedtarget">attribute for NavigationEvent</a><span>, in §6.1</span>
     <li><a href="#dom-navigationeventinit-relatedtarget">dict-member for NavigationEventInit</a><span>, in §6.1</span>
    </ul>
   <li>
    "right"
    <ul>
     <li><a href="#dom-navigationdirection-right">enum-value for NavigationDirection</a><span>, in §5.1</span>
     <li><a href="#dom-spatialnavigationdirection-right">enum-value for SpatialNavigationDirection</a><span>, in §5.2</span>
    </ul>
   <li><a href="#select-the-best-candidate">selecting the best candidate</a><span>, in §7.3</span>
   <li><a href="#select-the-best-candidate">select the best candidate</a><span>, in §7.3</span>
   <li><a href="#dom-element-seqnavsearch">seqNavSearch(dir)</a><span>, in §5.2</span>
   <li><a href="#enumdef-sequentialnavigationdirection">SequentialNavigationDirection</a><span>, in §5.2</span>
   <li><a href="#sequential-navigation-steps">sequential navigation steps</a><span>, in §7.2</span>
   <li><a href="#spatial-navigation">spatial navigation</a><span>, in §1</span>
   <li><a href="#propdef-spatial-navigation-contain">spatial-navigation-contain</a><span>, in §8.1</span>
   <li><a href="#enumdef-spatialnavigationdirection">SpatialNavigationDirection</a><span>, in §5.2</span>
   <li><a href="#spatial-navigation-focus-container">spatial navigation focus container</a><span>, in §7.1</span>
   <li><a href="#spatial-navigation-focus-container">spatial navigation focus containers</a><span>, in §7.1</span>
   <li><a href="#spatial-navigation-starting-point">spatial navigation starting point</a><span>, in §7.2</span>
   <li><a href="#spatial-navigation-steps">spatial navigation steps</a><span>, in §7.2</span>
   <li><a href="#spatial-navigation">spatnav</a><span>, in §1</span>
   <li><a href="#spatial-navigation-focus-container">spatnav container</a><span>, in §7.1</span>
   <li><a href="#spatial-navigation-focus-container">spatnav containers</a><span>, in §7.1</span>
   <li><a href="#dom-element-spatnavsearch">spatNavSearch(arg)</a><span>, in §5.2</span>
   <li><a href="#dictdef-spatnavsearchoptions">SpatNavSearchOptions</a><span>, in §5.2</span>
   <li>
    "up"
    <ul>
     <li><a href="#dom-navigationdirection-up">enum-value for NavigationDirection</a><span>, in §5.1</span>
     <li><a href="#dom-spatialnavigationdirection-up">enum-value for SpatialNavigationDirection</a><span>, in §5.2</span>
    </ul>
   <li><a href="#dom-focusableareasearchmode-visible">"visible"</a><span>, in §5.2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[css-display-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-display-3/#principal-box">principal box</a>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-OVERFLOW-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#valdef-overflow-hidden">hidden</a>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow-x">overflow-x</a>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow-y">overflow-y</a>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#scroll-container">scroll container</a>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#scrollport">scrollport</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-position-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-position-3/#relative-position">relative position</a>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-SCROLL-SNAP-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-scroll-snap-1/#valdef-scroll-snap-type-mandatory">mandatory</a>
     <li><a href="https://drafts.csswg.org/css-scroll-snap-1/#optimal-viewing-region">optimal viewing region</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-values-4]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-values-4/#comb-one">|</a>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS2]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css2/box.html#x14">border box</a>
    </ul>
   <li>
    <a data-link-type="biblio">[CSSOM-VIEW-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/cssom-view-1/#scroll-an-element">scroll an element</a>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#element">Element</a>
     <li><a href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>
     <li><a href="https://dom.spec.whatwg.org/#node">Node</a>
     <li><a href="https://dom.spec.whatwg.org/#canceled-flag">canceled flag</a>
     <li><a href="https://dom.spec.whatwg.org/#concept-document">document</a>
     <li><a href="https://dom.spec.whatwg.org/#document-element">document element</a>
     <li><a href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a>
     <li><a href="https://dom.spec.whatwg.org/#boundary-point-node">node</a>
     <li><a href="https://dom.spec.whatwg.org/#dom-event-preventdefault">preventDefault()</a>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/window-object.html#window">Window</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">browsing context</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context-container">browsing context container</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#control-group">control group</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#currently-focused-area-of-a-top-level-browsing-context">currently focused area of a top-level browsing context</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#dom-anchor">dom anchor</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#dom-focus">focus()</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#focusable-area">focusable area</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#focusing-steps">focusing steps</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#nested-browsing-context">nested browsing context</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation">sequential focus navigation</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation-order">sequential focus navigation order</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-focus-navigation-starting-point">sequential focus navigation starting point</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#sequential-navigation-search-algorithm">sequential navigation search algorithm</a>
     <li><a href="https://html.spec.whatwg.org/multipage/interaction.html#attr-tabindex">tabindex</a>
     <li><a href="https://html.spec.whatwg.org/multipage/dom.html#the-body-element-2">the body element</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a>
    </ul>
   <li>
    <a data-link-type="biblio">[infra]</a> defines the following terms:
    <ul>
     <li><a href="https://infra.spec.whatwg.org/#assert">assert</a>
     <li><a href="https://infra.spec.whatwg.org/#list-clone">clone</a>
     <li><a href="https://infra.spec.whatwg.org/#list-empty">empty</a>
     <li><a href="https://infra.spec.whatwg.org/#list-remove">remove</a>
     <li><a href="https://infra.spec.whatwg.org/#ordered-set">set</a>
    </ul>
   <li>
    <a data-link-type="biblio">[overscroll-behavior]</a> defines the following terms:
    <ul>
     <li><a href="https://wicg.github.io/overscroll-behavior/#scroll-boundary">scroll boundary</a>
    </ul>
   <li>
    <a data-link-type="biblio">[uievents]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/uievents/#keyboardevent-keyboardevent">KeyboardEvent</a>
     <li><a href="https://www.w3.org/TR/uievents/#uievent-uievent">UIEvent</a>
     <li><a href="https://www.w3.org/TR/uievents/#dictdef-uieventinit-uieventinit">UIEventInit</a>
     <li><a href="https://www.w3.org/TR/uievents/#dom-keyboardevent-key">key</a>
     <li><a href="https://w3c.github.io/uievents/#keydown">keydown</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-display-3">[CSS-DISPLAY-3]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-display-3/">CSS Display Module Level 3</a>. 20 April 2018. WD. URL: <a href="https://www.w3.org/TR/css-display-3/">https://www.w3.org/TR/css-display-3/</a>
   <dt id="biblio-css-overflow-3">[CSS-OVERFLOW-3]
   <dd>David Baron; Florian Rivoal. <a href="https://www.w3.org/TR/css-overflow-3/">CSS Overflow Module Level 3</a>. 31 May 2016. WD. URL: <a href="https://www.w3.org/TR/css-overflow-3/">https://www.w3.org/TR/css-overflow-3/</a>
   <dt id="biblio-css-position-3">[CSS-POSITION-3]
   <dd>Rossen Atanassov; Arron Eicholz. <a href="https://www.w3.org/TR/css-position-3/">CSS Positioned Layout Module Level 3</a>. 17 May 2016. WD. URL: <a href="https://www.w3.org/TR/css-position-3/">https://www.w3.org/TR/css-position-3/</a>
   <dt id="biblio-css-scroll-snap-1">[CSS-SCROLL-SNAP-1]
   <dd>Matt Rakow; et al. <a href="https://www.w3.org/TR/css-scroll-snap-1/">CSS Scroll Snap Module Level 1</a>. 14 December 2017. CR. URL: <a href="https://www.w3.org/TR/css-scroll-snap-1/">https://www.w3.org/TR/css-scroll-snap-1/</a>
   <dt id="biblio-css-values-4">[CSS-VALUES-4]
   <dd>CSS Values and Units Module Level 4 URL: <a href="https://drafts.csswg.org/css-values-4/">https://drafts.csswg.org/css-values-4/</a>
   <dt id="biblio-css2">[CSS2]
   <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS2/">Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. REC. URL: <a href="https://www.w3.org/TR/CSS2/">https://www.w3.org/TR/CSS2/</a>
   <dt id="biblio-cssom-view-1">[CSSOM-VIEW-1]
   <dd>Simon Pieters. <a href="https://www.w3.org/TR/cssom-view-1/">CSSOM View Module</a>. 17 March 2016. WD. URL: <a href="https://www.w3.org/TR/cssom-view-1/">https://www.w3.org/TR/cssom-view-1/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra Standard</a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-uievents">[UIEVENTS]
   <dd>Gary Kacmarcik; Travis Leithead. <a href="https://www.w3.org/TR/uievents/">UI Events</a>. 4 August 2016. WD. URL: <a href="https://www.w3.org/TR/uievents/">https://www.w3.org/TR/uievents/</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>. 15 December 2016. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-css-transforms-1">[CSS-TRANSFORMS-1]
   <dd>Simon Fraser; et al. <a href="https://www.w3.org/TR/css-transforms-1/">CSS Transforms Module Level 1</a>. 30 November 2017. WD. URL: <a href="https://www.w3.org/TR/css-transforms-1/">https://www.w3.org/TR/css-transforms-1/</a>
   <dt id="biblio-extensible">[EXTENSIBLE]
   <dd><a href="https://extensiblewebmanifesto.org/">The Extensible Web Manifesto</a>. 10 June 2013. URL: <a href="https://extensiblewebmanifesto.org/">https://extensiblewebmanifesto.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">Property Index</span><a class="self-link" href="#property-index"></a></h2>
  <div class="big-element-wrapper">
   <table class="index">
    <thead>
     <tr>
      <th scope="col">Name
      <th scope="col">Value
      <th scope="col">Initial
      <th scope="col">Applies to
      <th scope="col">Inh.
      <th scope="col">%ages
      <th scope="col">Media
      <th scope="col">Anim­ation type
      <th scope="col">Canonical order
      <th scope="col">Com­puted value
    <tbody>
     <tr>
      <th scope="row"><a class="css" data-link-type="property" href="#propdef-spatial-navigation-contain" id="ref-for-propdef-spatial-navigation-contain⑤">spatial-navigation-contain</a>
      <td>auto | contain
      <td>auto
      <td>all elements
      <td>no
      <td>n/a
      <td>visual
      <td>discrete
      <td>per grammar
      <td>as specified
   </table>
  </div>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><span class="kt">enum</span> <a class="nv" href="#enumdef-navigationdirection"><code>NavigationDirection</code></a> {
      <a class="s" href="#dom-navigationdirection-up"><code>"up"</code></a>,
      <a class="s" href="#dom-navigationdirection-down"><code>"down"</code></a>,
      <a class="s" href="#dom-navigationdirection-left"><code>"left"</code></a>,
      <a class="s" href="#dom-navigationdirection-right"><code>"right"</code></a>,
      <a class="s" href="#dom-navigationdirection-forward"><code>"forward"</code></a>,
      <a class="s" href="#dom-navigationdirection-backward"><code>"backward"</code></a>
};
<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window①">Window</a> {
    <span class="kt">void</span> <a class="nv" href="#dom-window-navigate"><code>navigate</code></a>(<a class="n" data-link-type="idl-name" href="#enumdef-navigationdirection" id="ref-for-enumdef-navigationdirection③">NavigationDirection</a> <a class="nv" href="#dom-window-navigate-dir-dir"><code>dir</code></a>);
};

<span class="kt">enum</span> <a class="nv" href="#enumdef-spatialnavigationdirection"><code>SpatialNavigationDirection</code></a> {
    <a class="s" href="#dom-spatialnavigationdirection-up"><code>"up"</code></a>,
    <a class="s" href="#dom-spatialnavigationdirection-down"><code>"down"</code></a>,
    <a class="s" href="#dom-spatialnavigationdirection-left"><code>"left"</code></a>,
    <a class="s" href="#dom-spatialnavigationdirection-right"><code>"right"</code></a>,
};

<span class="kt">enum</span> <a class="nv" href="#enumdef-focusableareasearchmode"><code>FocusableAreaSearchMode</code></a> {
    <a class="s" href="#dom-focusableareasearchmode-visible"><code>"visible"</code></a>,
    <a class="s" href="#dom-focusableareasearchmode-all"><code>"all"</code></a>
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-focusableareasoptions"><code>FocusableAreasOptions</code></a> {
    <a class="n" data-link-type="idl-name" href="#enumdef-focusableareasearchmode" id="ref-for-enumdef-focusableareasearchmode①">FocusableAreaSearchMode</a> <a class="nv" data-type="FocusableAreaSearchMode " href="#dom-focusableareasoptions-mode"><code>mode</code></a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-spatnavsearchoptions"><code>SpatNavSearchOptions</code></a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-spatialnavigationdirection" id="ref-for-enumdef-spatialnavigationdirection①">SpatialNavigationDirection</a> <a class="nv" data-type="SpatialNavigationDirection " href="#dom-spatnavsearchoptions-dir"><code>dir</code></a>;
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node⑥">Node</a>>? <a class="nv" data-type="sequence<Node>? " href="#dom-spatnavsearchoptions-candidates"><code>candidates</code></a>;
    <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node①①">Node</a>? <a class="nv" data-type="Node? " href="#dom-spatnavsearchoptions-container"><code>container</code></a>;
};

<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#element" id="ref-for-element②">Element</a> {
    <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node②①">Node</a> <a class="nv" href="#dom-element-getspatnavcontainer"><code>getSpatnavContainer</code></a>();
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node③①">Node</a>> <a class="nv" href="#dom-element-focusableareas"><code>focusableAreas</code></a>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-focusableareasoptions" id="ref-for-dictdef-focusableareasoptions①">FocusableAreasOptions</a> <a class="nv" href="#dom-element-focusableareas-arg-arg"><code>arg</code></a>);
    <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node④①">Node</a>? <a class="nv" href="#dom-element-spatnavsearch"><code>spatNavSearch</code></a>(<a class="n" data-link-type="idl-name" href="#dictdef-spatnavsearchoptions" id="ref-for-dictdef-spatnavsearchoptions①">SpatNavSearchOptions</a> <a class="nv" href="#dom-element-spatnavsearch-arg-arg"><code>arg</code></a>);
};

<span class="kt">enum</span> <a class="nv" href="#enumdef-sequentialnavigationdirection"><code>SequentialNavigationDirection</code></a> {
    <a class="s" href="#dom-sequentialnavigationdirection-forward"><code>"forward"</code></a>,
    <a class="s" href="#dom-sequentialnavigationdirection-backward"><code>"backward"</code></a>
};
<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①①">Element</a> {
    <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#node" id="ref-for-node⑤①">Node</a>? <a class="nv" href="#dom-element-seqnavsearch"><code>seqNavSearch</code></a>(<a class="n" data-link-type="idl-name" href="#enumdef-sequentialnavigationdirection" id="ref-for-enumdef-sequentialnavigationdirection①">SequentialNavigationDirection</a> <a class="nv" href="#dom-element-seqnavsearch-dir-dir"><code>dir</code></a>);
};

[<a class="nv" href="#dom-navigationevent-navigationevent"><code>Constructor</code></a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><span class="kt">DOMString</span></a> <a class="nv" href="#dom-navigationevent-navigationevent-type-eventinitdict-type"><code>type</code></a>, <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-navigationeventinit" id="ref-for-dictdef-navigationeventinit①①">NavigationEventInit</a> <a class="nv" href="#dom-navigationevent-navigationevent-type-eventinitdict-eventinitdict"><code>eventInitDict</code></a>)]
<span class="kt">interface</span> <a class="nv" href="#navigationevent"><code>NavigationEvent</code></a> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/uievents/#uievent-uievent" id="ref-for-uievent-uievent①①">UIEvent</a> {
      <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-navigationdirection" id="ref-for-enumdef-navigationdirection①①">NavigationDirection</a> <a class="nv" data-readonly="" data-type="NavigationDirection" href="#dom-navigationevent-dir"><code>dir</code></a>;
      <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget②">EventTarget</a>? <a class="nv" data-readonly="" data-type="EventTarget?" href="#dom-navigationevent-relatedtarget"><code>relatedTarget</code></a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-navigationeventinit"><code>NavigationEventInit</code></a> : <a class="n" data-link-type="idl-name" href="https://www.w3.org/TR/uievents/#dictdef-uieventinit-uieventinit" id="ref-for-dictdef-uieventinit-uieventinit①">UIEventInit</a> {
      <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-navigationdirection" id="ref-for-enumdef-navigationdirection②①">NavigationDirection</a> <a class="nv" data-type="NavigationDirection " href="#dom-navigationeventinit-dir"><code>dir</code></a>;
      <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①①">EventTarget</a>? <a class="nv" data-default="null" data-type="EventTarget? " href="#dom-navigationeventinit-relatedtarget"><code>relatedTarget</code></a> = <span class="kt">null</span>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> This api is clearly useful for testing purposes.
It may also be useful for authors,
but the use cases are less strong.
Maybe this should be moved to WebDriver and be a testing-only api.
Maybe it is fine as is.<a href="#issue-ffca3146"> ↵ </a></div>
   <div class="issue"> The following currently does not account
for <a href="https://github.com/WICG/overscroll-behavior">the proposed overscroll-behavior specification</a>. <a href="https://github.com/wicg/spatial-navigation/issues/19">&lt;https://github.com/wicg/spatial-navigation/issues/19></a><a href="#issue-e8431aa1"> ↵ </a></div>
   <div class="issue"> The following does not take shadow dom into account. <a href="https://github.com/wicg/spatial-navigation/issues/21">&lt;https://github.com/wicg/spatial-navigation/issues/21></a><a href="#issue-e0cc24e0"> ↵ </a></div>
   <div class="issue"> The focusing steps should probably reset the <a data-link-type="dfn" href="#spatial-navigation-starting-point">spatial navigation starting point</a> <a href="https://github.com/wicg/spatial-navigation/issues/23">&lt;https://github.com/wicg/spatial-navigation/issues/23></a><a href="#issue-8aa511b3"> ↵ </a></div>
   <div class="issue"> is it sane from a security standpoint that this propagates up from iframes? <a href="https://github.com/wicg/spatial-navigation/issues/28">&lt;https://github.com/wicg/spatial-navigation/issues/28></a><a href="#issue-d6bc89a9"> ↵ </a></div>
   <div class="issue"> This is a monkeypatch on <a data-link-type="biblio" href="#biblio-html">[HTML]</a>.
Eventually this should be upstreamed. <a href="https://github.com/wicg/spatial-navigation/issues/27">&lt;https://github.com/wicg/spatial-navigation/issues/27></a><a href="#issue-dd365682"> ↵ </a></div>
   <div class="issue"> CSS should have a term for “border box taking into account corner shaping properties like border-radius”. <a href="https://github.com/w3c/csswg-drafts/issues/2324">&lt;https://github.com/w3c/csswg-drafts/issues/2324></a><a href="#issue-c7f6d991"> ↵ </a></div>
   <div class="issue"> Terminology like this should be in <a data-link-type="biblio" href="#biblio-cssom-view-1">[CSSOM-VIEW-1]</a>, <a data-link-type="biblio" href="#biblio-css-overflow-3">[CSS-OVERFLOW-3]</a>, <a data-link-type="biblio" href="#biblio-css-scroll-snap-1">[CSS-SCROLL-SNAP-1]</a>. <a href="https://github.com/w3c/csswg-drafts/issues/2322">&lt;https://github.com/w3c/csswg-drafts/issues/2322></a><a href="#issue-942e7041"> ↵ </a></div>
   <div class="issue"> <a data-link-type="biblio" href="#biblio-cssom-view-1">[CSSOM-VIEW-1]</a> should probably define
how to perform a scroll in a given direction without an explicit position.
Until then, we roll our own. <a href="https://github.com/w3c/csswg-drafts/issues/2323">&lt;https://github.com/w3c/csswg-drafts/issues/2323></a><a href="#issue-00706fa4"> ↵ </a></div>
  </div>
  <aside class="dfn-panel" data-for="spatial-navigation">
   <b><a href="#spatial-navigation">#spatial-navigation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-spatial-navigation">1. 
Introduction</a> <a href="#ref-for-spatial-navigation①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="at-risk">
   <b><a href="#at-risk">#at-risk</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-at-risk">5.2. 
Low level APIs</a>
    <li><a href="#ref-for-at-risk①">8.1. 
Creating additional spatnav containers: the spatial-navigation-contain property</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-navigationdirection">
   <b><a href="#enumdef-navigationdirection">#enumdef-navigationdirection</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-navigationdirection">5.1. 
Triggering Navigation Programmatically</a>
    <li><a href="#ref-for-enumdef-navigationdirection①">6.1. 
Interface NavigationEvent</a> <a href="#ref-for-enumdef-navigationdirection②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-window-navigate">
   <b><a href="#dom-window-navigate">#dom-window-navigate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-window-navigate">5.1. 
Triggering Navigation Programmatically</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-spatialnavigationdirection">
   <b><a href="#enumdef-spatialnavigationdirection">#enumdef-spatialnavigationdirection</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-spatialnavigationdirection">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-focusableareasearchmode">
   <b><a href="#enumdef-focusableareasearchmode">#enumdef-focusableareasearchmode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-focusableareasearchmode">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-focusableareasoptions">
   <b><a href="#dictdef-focusableareasoptions">#dictdef-focusableareasoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-focusableareasoptions">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-focusableareasoptions-mode">
   <b><a href="#dom-focusableareasoptions-mode">#dom-focusableareasoptions-mode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-focusableareasoptions-mode">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-spatnavsearchoptions">
   <b><a href="#dictdef-spatnavsearchoptions">#dictdef-spatnavsearchoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-spatnavsearchoptions">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-spatnavsearchoptions-dir">
   <b><a href="#dom-spatnavsearchoptions-dir">#dom-spatnavsearchoptions-dir</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-spatnavsearchoptions-dir">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-spatnavsearchoptions-candidates">
   <b><a href="#dom-spatnavsearchoptions-candidates">#dom-spatnavsearchoptions-candidates</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-spatnavsearchoptions-candidates">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-spatnavsearchoptions-container">
   <b><a href="#dom-spatnavsearchoptions-container">#dom-spatnavsearchoptions-container</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-spatnavsearchoptions-container">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-element-getspatnavcontainer">
   <b><a href="#dom-element-getspatnavcontainer">#dom-element-getspatnavcontainer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-element-getspatnavcontainer①">5.2. 
Low level APIs</a> <a href="#ref-for-dom-element-getspatnavcontainer②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-element-focusableareas">
   <b><a href="#dom-element-focusableareas">#dom-element-focusableareas</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-element-focusableareas①">5.2. 
Low level APIs</a> <a href="#ref-for-dom-element-focusableareas②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-element-spatnavsearch">
   <b><a href="#dom-element-spatnavsearch">#dom-element-spatnavsearch</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-element-spatnavsearch">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-sequentialnavigationdirection">
   <b><a href="#enumdef-sequentialnavigationdirection">#enumdef-sequentialnavigationdirection</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-sequentialnavigationdirection">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-element-seqnavsearch">
   <b><a href="#dom-element-seqnavsearch">#dom-element-seqnavsearch</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-element-seqnavsearch">5.2. 
Low level APIs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="navigationevent">
   <b><a href="#navigationevent">#navigationevent</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigationevent">4. 
Triggering Spatial Navigation</a>
    <li><a href="#ref-for-navigationevent①">6.1. 
Interface NavigationEvent</a> <a href="#ref-for-navigationevent②">(2)</a> <a href="#ref-for-navigationevent③">(3)</a>
    <li><a href="#ref-for-navigationevent④">6.2.1. 
navbeforefocus</a> <a href="#ref-for-navigationevent⑤">(2)</a> <a href="#ref-for-navigationevent⑥">(3)</a>
    <li><a href="#ref-for-navigationevent⑦">6.2.2. 
navbeforescroll</a> <a href="#ref-for-navigationevent⑧">(2)</a> <a href="#ref-for-navigationevent⑨">(3)</a>
    <li><a href="#ref-for-navigationevent①⓪">6.2.3. 
navnotarget</a> <a href="#ref-for-navigationevent①①">(2)</a> <a href="#ref-for-navigationevent①②">(3)</a>
    <li><a href="#ref-for-navigationevent①③">7.2. 
Navigation</a> <a href="#ref-for-navigationevent①④">(2)</a> <a href="#ref-for-navigationevent①⑤">(3)</a> <a href="#ref-for-navigationevent①⑥">(4)</a> <a href="#ref-for-navigationevent①⑦">(5)</a> <a href="#ref-for-navigationevent①⑧">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigationevent-dir">
   <b><a href="#dom-navigationevent-dir">#dom-navigationevent-dir</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigationevent-dir">6.2.1. 
navbeforefocus</a>
    <li><a href="#ref-for-dom-navigationevent-dir①">6.2.2. 
navbeforescroll</a>
    <li><a href="#ref-for-dom-navigationevent-dir②">6.2.3. 
navnotarget</a>
    <li><a href="#ref-for-dom-navigationevent-dir③">7.2. 
Navigation</a> <a href="#ref-for-dom-navigationevent-dir④">(2)</a> <a href="#ref-for-dom-navigationevent-dir⑤">(3)</a> <a href="#ref-for-dom-navigationevent-dir⑥">(4)</a> <a href="#ref-for-dom-navigationevent-dir⑦">(5)</a> <a href="#ref-for-dom-navigationevent-dir⑧">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigationevent-relatedtarget">
   <b><a href="#dom-navigationevent-relatedtarget">#dom-navigationevent-relatedtarget</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigationevent-relatedtarget">6.2.1. 
navbeforefocus</a>
    <li><a href="#ref-for-dom-navigationevent-relatedtarget①">6.2.2. 
navbeforescroll</a>
    <li><a href="#ref-for-dom-navigationevent-relatedtarget②">6.2.3. 
navnotarget</a>
    <li><a href="#ref-for-dom-navigationevent-relatedtarget③">7.2. 
Navigation</a> <a href="#ref-for-dom-navigationevent-relatedtarget④">(2)</a> <a href="#ref-for-dom-navigationevent-relatedtarget⑤">(3)</a> <a href="#ref-for-dom-navigationevent-relatedtarget⑥">(4)</a> <a href="#ref-for-dom-navigationevent-relatedtarget⑦">(5)</a> <a href="#ref-for-dom-navigationevent-relatedtarget⑧">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-navigationeventinit">
   <b><a href="#dictdef-navigationeventinit">#dictdef-navigationeventinit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-navigationeventinit">6.1. 
Interface NavigationEvent</a> <a href="#ref-for-dictdef-navigationeventinit①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="eventdef-navigationevent-navbeforefocus">
   <b><a href="#eventdef-navigationevent-navbeforefocus">#eventdef-navigationevent-navbeforefocus</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventdef-navigationevent-navbeforefocus">6.2.1. 
navbeforefocus</a>
    <li><a href="#ref-for-eventdef-navigationevent-navbeforefocus①">7.2. 
Navigation</a> <a href="#ref-for-eventdef-navigationevent-navbeforefocus②">(2)</a> <a href="#ref-for-eventdef-navigationevent-navbeforefocus③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="eventdef-navigationevent-navbeforescroll">
   <b><a href="#eventdef-navigationevent-navbeforescroll">#eventdef-navigationevent-navbeforescroll</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventdef-navigationevent-navbeforescroll">6.2.2. 
navbeforescroll</a> <a href="#ref-for-eventdef-navigationevent-navbeforescroll①">(2)</a>
    <li><a href="#ref-for-eventdef-navigationevent-navbeforescroll②">7.2. 
Navigation</a> <a href="#ref-for-eventdef-navigationevent-navbeforescroll③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="eventdef-navigationevent-navnotarget">
   <b><a href="#eventdef-navigationevent-navnotarget">#eventdef-navigationevent-navnotarget</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventdef-navigationevent-navnotarget">6.2.3. 
navnotarget</a>
    <li><a href="#ref-for-eventdef-navigationevent-navnotarget①">7.2. 
Navigation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="spatial-navigation-focus-container">
   <b><a href="#spatial-navigation-focus-container">#spatial-navigation-focus-container</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-spatial-navigation-focus-container">3. 
Overview</a> <a href="#ref-for-spatial-navigation-focus-container①">(2)</a> <a href="#ref-for-spatial-navigation-focus-container②">(3)</a> <a href="#ref-for-spatial-navigation-focus-container③">(4)</a> <a href="#ref-for-spatial-navigation-focus-container④">(5)</a> <a href="#ref-for-spatial-navigation-focus-container⑤">(6)</a> <a href="#ref-for-spatial-navigation-focus-container⑥">(7)</a> <a href="#ref-for-spatial-navigation-focus-container⑦">(8)</a>
    <li><a href="#ref-for-spatial-navigation-focus-container⑧">5.2. 
Low level APIs</a> <a href="#ref-for-spatial-navigation-focus-container⑨">(2)</a> <a href="#ref-for-spatial-navigation-focus-container①⓪">(3)</a> <a href="#ref-for-spatial-navigation-focus-container①①">(4)</a> <a href="#ref-for-spatial-navigation-focus-container①②">(5)</a>
    <li><a href="#ref-for-spatial-navigation-focus-container①③">6.2.3. 
navnotarget</a> <a href="#ref-for-spatial-navigation-focus-container①④">(2)</a> <a href="#ref-for-spatial-navigation-focus-container①⑤">(3)</a> <a href="#ref-for-spatial-navigation-focus-container①⑥">(4)</a>
    <li><a href="#ref-for-spatial-navigation-focus-container①⑦">7.1. 
Groupings of elements</a> <a href="#ref-for-spatial-navigation-focus-container①⑧">(2)</a>
    <li><a href="#ref-for-spatial-navigation-focus-container①⑨">7.2. 
Navigation</a> <a href="#ref-for-spatial-navigation-focus-container②⓪">(2)</a> <a href="#ref-for-spatial-navigation-focus-container②①">(3)</a>
    <li><a href="#ref-for-spatial-navigation-focus-container②②">8.1. 
Creating additional spatnav containers: the spatial-navigation-contain property</a> <a href="#ref-for-spatial-navigation-focus-container②③">(2)</a> <a href="#ref-for-spatial-navigation-focus-container②④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="spatial-navigation-starting-point">
   <b><a href="#spatial-navigation-starting-point">#spatial-navigation-starting-point</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-spatial-navigation-starting-point">7.2. 
Navigation</a> <a href="#ref-for-spatial-navigation-starting-point①">(2)</a> <a href="#ref-for-spatial-navigation-starting-point②">(3)</a> <a href="#ref-for-spatial-navigation-starting-point③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="spatial-navigation-steps">
   <b><a href="#spatial-navigation-steps">#spatial-navigation-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-spatial-navigation-steps">4. 
Triggering Spatial Navigation</a> <a href="#ref-for-spatial-navigation-steps①">(2)</a> <a href="#ref-for-spatial-navigation-steps②">(3)</a>
    <li><a href="#ref-for-spatial-navigation-steps③">5.1. 
Triggering Navigation Programmatically</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="sequential-navigation-steps">
   <b><a href="#sequential-navigation-steps">#sequential-navigation-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sequential-navigation-steps">5.1. 
Triggering Navigation Programmatically</a> <a href="#ref-for-sequential-navigation-steps①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="boundary-box">
   <b><a href="#boundary-box">#boundary-box</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-boundary-box">7.3. 
Focus Navigation Heuristics</a> <a href="#ref-for-boundary-box①">(2)</a> <a href="#ref-for-boundary-box②">(3)</a> <a href="#ref-for-boundary-box③">(4)</a> <a href="#ref-for-boundary-box④">(5)</a> <a href="#ref-for-boundary-box⑤">(6)</a> <a href="#ref-for-boundary-box⑥">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="find-focusable-areas">
   <b><a href="#find-focusable-areas">#find-focusable-areas</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-find-focusable-areas">5.2. 
Low level APIs</a> <a href="#ref-for-find-focusable-areas①">(2)</a>
    <li><a href="#ref-for-find-focusable-areas②">7.2. 
Navigation</a> <a href="#ref-for-find-focusable-areas③">(2)</a>
    <li><a href="#ref-for-find-focusable-areas④">7.3. 
Focus Navigation Heuristics</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="select-the-best-candidate">
   <b><a href="#select-the-best-candidate">#select-the-best-candidate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-select-the-best-candidate">5.2. 
Low level APIs</a>
    <li><a href="#ref-for-select-the-best-candidate①">7.2. 
Navigation</a> <a href="#ref-for-select-the-best-candidate②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="propdef-spatial-navigation-contain">
   <b><a href="#propdef-spatial-navigation-contain">#propdef-spatial-navigation-contain</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-propdef-spatial-navigation-contain①">3. 
Overview</a>
    <li><a href="#ref-for-propdef-spatial-navigation-contain②">7.1. 
Groupings of elements</a>
    <li><a href="#ref-for-propdef-spatial-navigation-contain③">8.1. 
Creating additional spatnav containers: the spatial-navigation-contain property</a> <a href="#ref-for-propdef-spatial-navigation-contain④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="can-be-manually-scrolled">
   <b><a href="#can-be-manually-scrolled">#can-be-manually-scrolled</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-can-be-manually-scrolled">7.2. 
Navigation</a> <a href="#ref-for-can-be-manually-scrolled①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="directionally-scroll-an-element">
   <b><a href="#directionally-scroll-an-element">#directionally-scroll-an-element</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-directionally-scroll-an-element">7.2. 
Navigation</a> <a href="#ref-for-directionally-scroll-an-element①">(2)</a>
   </ul>
  </aside>
<script>/* script-var-click-highlighting */

    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    {
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = v.innerHTML;
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(el.innerHTML == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>