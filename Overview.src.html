<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en-US">
 <head>
  <title>CSSOM</title>

  <style type="text/css">
   pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
   pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
   dfn { font-weight:bold; font-style:normal }
   div.example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
   div.example table code { color:inherit }
   td, th { padding:.1em }
   .note {  margin-left:2em; color:green; font-style:italic; font-weight:bold }
   p.note::before { content:"Note: " }
   .XXX { padding:.5em; border:solid red }
   p.XXX::before { content:"Issue: " }
   em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
   code { color:orangered }
   code :link, code :visited { color:inherit }
  </style>

  <link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/W3C-[STATUS]">
 </head>

 <body class="draft">
  <div class="head">
   <h1 id="cssom">CSSOM</h1>
   <h2 class="no-num no-toc" id="">[LONGSTATUS] [DATE: 3 August 2002]</h2>

   <dl>

    <dt>This Version:</dt>
    <dd><a href="[VERSION]/">http://www.w3.org/TR/[YEAR]/ED-cssom-[CDATE]/</a></dd>

    <dt>Latest Version:</dt>
    <dd><a href="http://www.w3.org/TR/cssom/">http://www.w3.org/TR/cssom/</a></dd>
    
    <dt>Latest Editor's draft:</dt>
    <dd><a href="http://dev.w3.org/csswg/cssom/">http://dev.w3.org/csswg/cssom/</a></dd>

    <dt>Previous Version:</dt>
    <dd><a href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/">http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/</a></dd>

    <dt>Editor:</dt>
    <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a>
    (<a href="http://www.opera.com/">Opera Software ASA</a>)
    &lt;<a href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;</dd>
   </dl>
  </div>




  <h2 class="no-num no-toc" id="abstract">Abstract</h2>

  <p>CSSOM defines how style sheets interact with the DOM and defines an
  API for CSS style sheets.</p> 




  <h2 class="no-num no-toc" id="sotd">Status of this Document</h2>

  <p class="XXX">The plan is that this document provides the successor to
  DOM Level 2 Style.</p>

  <!--status-->




  <h2 class="no-num no-toc" id="toc">Table of Contents</h2>

  <!--toc-->





  <h2 id="introduction">Introduction</h2>

  <p class="issue">...</p>

  <h3 id="history">History</h3>

  <p>Several interfaces from DOM Level 2 Style
  <a href="http://www.w3.org/mid/Pine.LNX.4.05.10310302134070.1173-100000@lanalana.inria.fr" title="[CSSOM] CSSValue and related interfaces (message from the CSS WG)">have
  been obsoleted</a> because they where thought to be too awkward for
  frequent use. This specification no longer contains those features.
  <code>DOMImplementationCSS</code> and <code>CSSCharsetRule</code> have
  been removed as well as they were not deemed necessary.</p>




  <h2 id="conformance">Conformance Requirements</h2>

  <p>Everything in this specification is normative except for diagrams,
  examples, notes and sections marked non-normative.</p>

  <p>The key words <em class="ct">must</em>, <em class="ct">must not</em>,
  <em class="ct">required</em>, <em class="ct">shall</em>, <em class="ct">shall
  not</em>, <em class="ct">should</em>, <em class="ct">should not</em>,
  <em class="ct">recommended</em>, <em class="ct">may</em>, and
  <em class="ct">optional</em> in the normative parts of this document are to be
  interpreted as described in RFC 2119
  <a href="#ref-rfc2119">[RFC2119]</a>.</p>

<!-- XXX
  <p>The following conformance classes are defined (and considered) by this
  specification:</p>

  <dl>
   <dt><dfn id="conforming-implementation">conforming implementation</dfn></dt>

   <dd>A user agent that implements all interfaces described in this
   specification and follows all <em class="ct">must</em>-,
   <em class="ct">required</em>- and <em class="ct">shall</em>-level of criteria
   in this specification.</dd>

   <dt><dfn id="conforming-document">conforming document</dfn></dt>

   <dd>A document that follows all <em class="ct">must</em>-,
   <em class="ct">required</em>- and <em class="ct">shall</em>-level of criteria
   in this specification that apply to document authors.</dd>

   <dt><dfn id="conforming-authoring-tool">conforming authoring tool</dfn></dt>

   <dd>One that produces conforming documents.</dd>
  </dl>
-->

  <h2 id="terminology">Terminology</h2>
  
  <p class="XXX">
   <dfn>resolve a URL</dfn>,
   <dfn>case-sensitive</dfn>,
   <dfn>ASCII case-insensitive</dfn>,
   <dfn>URL</dfn>,
   <dfn>Content-Type metadata</dfn>,
   <dfn>supported styling language</dfn>,
   <dfn><code>xml-stylesheet</code> processing instruction</dfn>,
   <dfn>fetch</dfn>, ...
  </p>  

  <p>A <dfn>color component integer</dfn> is a base-ten integer in the range
  0-255 using digits 0-9, U+0030 to U+0039, in the shortest form possible.</p>

  <p>A <dfn>color component separator</dfn> is a literal U+002C COMMA followed
  by a U+0020 SPACE.</p>

  <p>When this specification talks about object <code><var>A</var></code>
  where <code><var>A</var></code> is actually an interface, it generally means
  an object implementing interface <code><var>A</var></code>.</p>

  <p>The term <dfn id="whitespace">whitespace</dfn> is used as defined in
  CSS. <!--XXX <a href="#ref-css">[CSS]</a>--></p>



  
  
  
  <h2>Media Queries</h2>

  <p><dfn id="media queries">Media queries</dfn> are defined by the
  Media Queries specification. This section defines various concepts around
  media queries, including their API and serialization form.</p>

  <!-- XXX maybe not a <dfn> -->
  <!-- XXX ref -->

  <h3>Parsing Media Queries</h3>

  <p>To
  <dfn id="parse-a-media-query">parse a media query</dfn> for a given string
  <var title="">s</var> means to follow the
  <span>parse a list of media queries</span> steps and return null if more
  than one media query is returned or a media query if a
  single media query is returned.</p>

  <p>To
  <dfn id="parse-a-list-of-media-queries">parse a list of media queries</dfn>
  for a given string <var>s</var> into a list of media queries is defined in
  the Media Queries specification. Return the list of one or more media
  queries that the algorithm defined there gives.</p> <!-- XXX ref -->
  
  <p class="note">If everything ends up being ignored the list will contain
  the media query "<code title="">not all</code>".</p>
  
  <h3>Serializing Media Queries</h3>

  <p>To 
  <dfn id="serialize-a-media-query">serialize a media query</dfn> run these
  steps:</p>

  <ol>
   <li><p>Let <var title="">s</var> be the empty string.</p></li>

   <li><p>If the media query is negated append the literal string
   "<code>not</code>", followed by a U+0020 SPACE character, to
   <var title="">s</var>.</p></li>
   
   <li><p>Let <var title="">type</var> be the media query,
   <span>converted to ASCII lowercase</span>.</p></li>

   <li><p>If the media query does not contain media features append
   <var title="">type</var>, to <var>s</var>,
   then return <var>s</var> and terminate this algorithm.</p></li>

   <li><p>If <var title="">type</var> is not "<code>all</code>" or if the
   media query is negated append <var title="">type</var>, followed by
   a U+0020 SPACE character, followed by "<code>and</code>", followed by a
   U+0020 SPACE character, to <var title="">s</var>.</p></li>

   <li><p>Sort the media features in lexicographical order.</p></li>

   <li>
    <p>Then, for each media feature:</p>

    <ol>
     <li>Append a U+0028 LEFT PARENTHESIS character, followed by the media
     feature name, <span>converted to ASCII lowercase</span>, to
     <var>s</var>.</p></li>

     <li><p>If a value is given append a U+003A COLON (:)
     character, followed by a U+0020 SPACE character, followed by the
     <span title="serialize a media feature value">serialized media feature value</span>,
     to <var>s</var>.</p>

     <li><p>Append a U+0029 RIGHT PARENTHESIS character to
     <var>s</var>.</p></li>
     
     <li><p>If this is not the last media feature append a U+0020 SPACE
     character, followed by the literal string "<code>and</code>", followed
     by a U+0020 SPACE character, to <var>s</var>.</p>
    </ol>
   </li>

   <li><p>Return <var>s</var>.</p></li>
  </ol>

  <div class="example">
   <p>Here are some examples of input (first column) and output (second
   column):</p>

   <table>
    <thead>
     <tr><th>Input<th>Output
    <tbody>
     <tr>
      <td><code>not screen and (min-WIDTH:5px) AND (max-width:40px  )</code>
      <td><code>not screen and (max-width: 40px) and (min-width: 5px)</code>
     <tr>
      <td><code>all and (color) and (color)</code>
      <td><code>(color)</code>
   </table>
  </div>

  <p>To
  <dfn id="serialize-a-list-of-media-queries">serialize a list of media queries</dfn>
  run these steps:</p>

  <ol>
   <li><p>Let <var>s</var> be the empty string.</p></li>

   <li><p>If the list is empty return <var>s</var> and terminate this
   algorithm.</p></li>

   <li>
    <p>For each media query in the list:</p>

    <ol>
     <li><p>Append the result of
     <span title="serializing-media-query">serializing the media
     query</span> to <var>s</var>.</p></li>

     <li><p>If this is not the last media query append a U+002C COMMA
     (,) character, followed by a U+0020 SPACE character to
     <var>s</var>.</p></li>
    </ol>
   </li>

   <li><p>Return <var>s</var>.</p></li>
  </ol>
  
  <h4>Serializing Media Feature Values</h4>
  
  <p class="XXX">This should probably be done in terms of mapping it to
  serializing CSS values as media features are defined in terms of CSS
  values after all.</p>
  
  <p>To <dfn id="serialize-a-media-feature-value">serialize a media feature value</dfn>
  named <var title="">v</var> locate <var title="">v</var> in the first
  column of the table below and use the serialization format described in
  the second column:</p>
  
  <table>
   <tr>
    <th>Media Feature
    <th>Serialization
   <tr>
    <td><code title="">width</code>
    <td>...
   <tr>
    <td><code title="">height</code>
    <td>...
   <tr>
    <td><code title="">device-width</code>
    <td>...
   <tr>
    <td><code title="">device-height</code>
    <td>...
   <tr>
    <td><code title="">orientation</code>
    <td>
     <p>If the value is `<code title="">portrait</code>`: "<code title="">portrait</code>".</p>
     <p>If the value is `<code title="">landscape</code>`: "<code title="">landscape</code>".</p>
   <tr>
    <td><code title="">aspect-ratio</code>
    <td>...
   <tr>
    <td><code title="">device-aspect-ratio</code>
    <td>...
   <tr>
    <td><code title="">color</code>
    <td>...
   <tr>
    <td><code title="">color-index</code>
    <td>...
   <tr>
    <td><code title="">monochrome</code>
    <td>...
   <tr>
    <td><code title="">resolution</code>
    <td>...
   <tr>
    <td><code title="">scan</code>
    <td>
     <p>If the value is `<code title="">progressive</code>`: "<code title="">progressive</code>".</p>
     <p>If the value is `<code title="">interlace</code>`: "<code title="">interlace</code>".</p>
   <tr>
    <td><code title="">grid</code>
    <td>...
  </table>

  <p>Other specifications can extend this table and vendor-prefixed media
  features can have custom serialization formats as well.</p>


  
  <h3>Comparing Media Queries</h3>

  <p>To
  <dfn id="compare-media-queries">compare media queries</dfn>
  <var>m1</var> and <var>m2</var> means to
  <span title="serializing media query">serialize</span> them both and
  return true if they are a <span>case-sensitive</span> match and false if
  they are not.</p>



  <h3>The <code title="">MediaList</code> Interface</h3>

  <p>An object that implements the <code>MediaList</code> interface has an
  associated <dfn>collection of media queries</dfn>.</p>

  <!-- http://dev.w3.org/2006/webapi/WebIDL/#idl-indexed-properties -->

  <pre class="idl">interface <dfn>MediaList</dfn> {
  stringifier attribute DOMString <span title="dom-MediaList-mediaText">mediaText</span>;
  readonly attribute unsigned long <span title="dom-MediaList-length">length</span>;
  getter DOMString <span title="dom-MediaList-item">item</span>(unsigned long <var title="">index</var>);
  void <span title="dom-MediaList-appendMedium">appendMedium</span>(DOMString <var title="">medium</var>)
  void <span title="dom-MediaList-deleteMedium">deleteMedium</span>(DOMString <var title="">medium</var>)
};</pre>

  <p>The
  <dfn id="dom-medialist-mediatext" title="dom-MediaList-mediaText"><code>mediaText</code></dfn>
  attribute <em class="ct">must</em>, on getting, return a
  <span title="serialize a list of media queries">serialization</span> of
  the <span>list of media qeuries</span>.</p>

  <p>On setting the <code title="dom-MediaList-mediaText">mediaText</code>
  attribute these steps <em class="ct">must</em> be run:</p>
  
  <ol>
   <li><p>Empty the <span>collection of media queries</span>.</p></li>

   <li><p>If the given value is the empty string terminate these
   steps.</p></li>
   
   <li><p>Append all the media queries as a result of
   <span title="parse a list of media queries">parsing</span> the given
   value to the <span>collection of media queries</span>.</p></li>
  </ol>

  <p>The
  <dfn id="dom-medialist-length" title="dom-MediaList-length"><code>length</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the number of media
  queries in the <span>collection of media queries</span>.</p>

  <p>The
  <dfn id="dom-medialist-item" title="dom-MediaList-item"><code>item(<var title="">index</var>)</code></dfn>
  method, when invoked, <em class="ct">must</em> return the item in the list
  given by <var>index</var>, or <code>null</code>, if <var>index</var> is
  greater than or equal to the number of items in the list.</p>
  <!-- XXX need consistency here WebIDL? list of media queries? -->

  <p>The
  <dfn id="dom-medialist-appendmedium" title="dom-MediaList-appendmedium"><code>appendMedium(<var title="">medium</var>)</code></dfn>
  method <em class="ct">must</em>, when invoked, run these steps:</p>
  
  <ol>
   <li><p>Let <var title="">m</var> be the result of
   <span title="parse a media query">parsing</span> the given
   value.</p></li>

   <li><p>If <var title="">m</var> is null terminate these steps.</p></li>

   <li><p>If <span title="compare media queries">comparing</span>
   <var title="">m</var> with any of the media queries in the
   <span>collection of media queries</span> returns true terminate these
   steps.</p></li>

   <li><p>Append <var title="">m</var> to the
   <span>collection of media queries</span>.</p></li>
  </ol>

  <p>The
  <dfn id="dom-medialist-deletemedium" title="dom-MediaList-deletemedium"><code>deleteMedium(<var title="">medium</var>)</code></dfn>
  method <em class="ct">must</em>, when invoked, run these steps:</p>
  
  <ol>
   <li><p>Let <var title="">m</var> be the result of
   <span title="parse a media query">parsing</span> the given
   value.</p></li>

   <li><p>If <var title="">m</var> is null terminate these steps.</p></li>

   <li><p>Remove any media query from the <span>collection of media queries</span>
   for which <span title="compare media queries">comparing</span> the media
   query with <var title="">m</var> returns true.</p></li>
  </ol>

  <h3>Creating a <code title="">MediaList</code> Object</h3>

  <p>To
  <dfn id="create-a-medialist-object">create a <code>MediaList</code> object</dfn>
  from <var title="">s</var> run these steps:</p>
  
  <ol>
   <li><p>Create a new <code>MediaList</code> object.</p></li>
   
   <li><p>Set its <span title="dom-MediaList-mediaText">mediaText</span>
   attribute to <var title="">s</var>.</p></li>
   
   <li><p>Return the newly created <code>MediaList</code> object.</p></li>
  </ol>






  <h2>Selectors</h2>
  
  <p>Selectors are defined in the Selectors specification. This section
  defines how to serialize them.</p> <!-- XXX ref -->

  <p>To
  <dfn id="parse-a-group-of-selectors">parse a group of selectors</dfn>
  means to parse the value using the <code title="">selectors_group</code>
  production defined in the Selectors specification and return either a
  group of selectors if parsing did not fail or null if parsing did
  fail.</p> <!-- XXX ref -->

  <p>To
  <dfn id="serialize-a-group-of-selectors">serialize a group of selectors</dfn>
  run these steps:</p>
  
  <!-- http://dump.testsuite.org/2009/cssom/serializing-selectors.htm -->

  <ol>
   <!-- XXX say something about CSS character escapes? -->

   <li><p>Remove leading and trailing <span>whitespace</span>.</p></li>

   <li><p>Replace one or more consecutive <span>whitespace</span> characters
   with a single U+0020 SPACE character.</p></li>

   <li><p>Make sure combinators other than the descendant combinator are
   preceded and followed by a single U+0020 SPACE character (and not
   more).</p></li>

   <li><p>Make sure each U+002C COMMA (,) character is followed by a
   single U+0020 SPACE character (and not more).</p></li>

   <li><p>If there is no default namespace and the namespace prefix of a
   <span>type selector</span> or <span>universal selector</span> is set to a
   U+002A ASTERISK (*) character remove the namespace component of that
   <span>type selector</span> or <span>universal selector</span>.</p></li>
   <!-- XXX namespace refs? -->

   <li><p>Remove any
   <span title="universal selector">universal selectors</span> that can be
   omitted.</p></li>

   
   <li>
    <p>Follow these rules for serializing attribute selectors:</p>
    
    <ul>
     <li><p>If there is no namespace prefix (which includes the asterisk)
     remove the U+007C VERTICAL LINE (|) before the attribute name if it is
     present.</p></li>
     <!-- XXX ref namespace prefix? -->
    
     <li><p>If an identifier was given as value insert a leading and
     trailing U+0022 QUOTATION MARK (") character around the identifier and
     escape any U+0022 QUOTATION MARK (") characters in the value by
     inserting a U+005C REVERSE SOLIDUS (\) character in front of
     them.</p></li>
     <!-- XXX or does this happen during parsing -->
    </ul>
   </li>

   <li>
    <p>Pseudo-classes without arguments and pseudo-elements are serialized
    to their canonical form as given in the specification.</p>

    <p class="note">E.g. <code>:HOver</code> becomes <code>:hover</code> and
    <code>:befoRe</code> becomes <code>::before</code>.</span></p>
   </li>
   
   <li>
    <p>The rules for pseudo-classes with arguments are to serialize their
    name to their canonical name as given in the specification, remove any
    leading and trailing <span>whitespace</span> around the argument, and
    serialize the value as follows:</p>
    
    <dl>
     <dt>If the pseudo-class is <code title="">:lang()</code></dt>
     <dd><p>The literal value.</p></dd>
     <dt>If the pseudo-class is <code title="">:nth-child()</code>,
     <code title="">:nth-last-child()</code>,
     <code title="">:nth-of-type()</code>, or
     <code title="">:nth-last-of-type()</code></dt>
     <dd>
      <ol>
       <li><p>If the value is odd let the value be
       "<code title="">2n+1</code>".</p></li>
       
       <li><p>If the value is even let the value be
       "<code title="">2n</code>".</p></li>

       <li><p>If <var title="">a</var> is zero let the value be
       <var title="">b</var> serialized as string.</p></li>
       <!-- XXX serialize integer -->

       <li><p>If <var title="">a</var> is one or minus one and
       <var title="">b</var> is zero let the value be
       "<code title="">n</code>".</p></li>

       <li><p>If <var title="">a</var> is one or minus one let the value be
       "<code title="">n</code>" followed by a U+002B PLUS SIGN (+)
       character if <var title="">b</var> is positive, followed by
       <var title="">b</var> serialized as string.</p></li>
       <!-- XXX serialize integer -->

       <li><p>If <var title="">b</var> is zero let the value be
       <var title="">a</var> serialized as string followed by
       "<code title="">n</code>".</p></li>
       <!-- XXX serialize integer -->

       <li><p>Otherwise let the value be
       <var title="">a</var> serialized as string followed by
       "<code title="">n</code>" followed by a U+002B PLUS SIGN (+)
       character if <var title="">b</var> is positive, followed by
       <var title="">b</var> serialized as string.</p></li>
       <!-- XXX serialize integer -->
      </ol>
     </dd>
     <dt>If the pseudo-class is <code title="">:not()</code></dt>
     <dd><p>The result of serializing the value using the rules for
     <span title="serialize a group of selectors">serializing a group of selectors</span>.</p></dd>
     <dt>Any other pseudo-class</dt>
     <dd><p class="XXX">Hopefully Selectors Level 4 defines serialization itself.</p></dd>
    </dl>
   </li>
  </ol>




  <h2>Style Sheets</h2>

  <h3>Style Sheet</h3>
  
  <!-- XXX
   element inserted into the DOM, style sheet created, element removed from
   the DOM, what happens to StyleSheet?
  -->

  <p>A <dfn id="style-sheet">style sheet</dfn> is an abstract concept that
  represents any kind of style sheet. In the DOM a <span>style sheet</span>
  is a <code>StyleSheet</code> object. A <span>style sheet</span> has a
  number of associated properties:</p>

  <dl>
   <dt><dfn id="style-sheet-type">style sheet type</dfn></dt>
   <dd><p>The <span>Content-Type metadata</span> of the
   <span>style sheet</span>.</p></dd>

   <dt><dfn id="style-sheet-location">style sheet location</dfn></dt>
   <dd><p>The <span>URL</span> of the <span>style sheet</span> or null if
   the <span>style sheet</span> was embedded.</p></dd>

   <dt><dfn id="style-sheet-node">style sheet node</dfn></dt>
   <dd><p>The DOM node associated with the <span>style sheet</span> or
   null if there is no associated DOM node.</p></dd>

   <dt><dfn id="style-sheet-parent">style sheet parent</dfn></dt>
   <dd><p>The <span>style sheet</span> that is the parent of the
   <span>style sheet</span>.</p></dd>

   <dt><dfn id="style-sheet-media">style sheet media</dfn></dt>
   <dd>
    <p>The <code>MediaList</code> object associated with the
    <span>style sheet</span>.</p>
    
    <p>If this property is set to a string run the
    <span>create a <code>MediaList</code> object</span> steps for that
    string and associate the returned object with the
    <span>style sheet</span>.</p>
   </dd>

   <dt><dfn id="style-sheet-title">style sheet title</dfn></dt>
   <dd>
    <p>The title of the <span>style sheet</span>. It is said to be empty
    if the title is the empty string.</p>
    
    <div class="example">
     <p>In these examples the <span>style sheet title</span> ends up being
     empty:</p>
     
     <pre>&lt;style title=""> body { background:papayawhip } &lt;/style></pre>

     <pre>&lt;style> body { background:orange } &lt;/style></pre>
    </div>    
   </dd>

   <dt><dfn id="style-sheet-alternate-flag">style sheet alternate flag</dfn></dt>
   <dd>
    <p>Either true or false. False by default.</p>

    <div class="example">
     <p>The following <span title="style sheet">style sheets</span> have
     their <span>style sheet alternate flag</span> set:</p>

     <pre><code>&lt;?xml-stylesheet alternate="yes" title="x" href="data:text/css,&hellip;"?></code></pre>

     <pre><code>&lt;link rel="alternate stylesheet" title="x" href="data:text/css,&hellip;"></code></pre>
    </div>
   </dd>

   <dt><dfn>style sheet disabled flag</dfn></dt>
   <dd>
    <p>Either true or false. False by default.</p>

    <p class="note">Even when false it does not necessarily mean that the
    <span>style sheet</span> is actually rendered.</p>
   </dd>
  </dl>

  <p>When you are to <span>create a style sheet</span> the above properties
  are to be set to their proper values.</p>

  <!-- same-origin restrictions -->


  <h4>The <code title="">StyleSheet</code> Interface</h4>

  <p>In the DOM a <span>style sheet</span> is represented by an object that
  implements the <code>StyleSheet</code> interface.</p>
  
  <pre class="idl">interface <dfn id="stylesheet">StyleSheet</dfn> {
  readonly attribute DOMString <span title="stylesheet-type">type</span>;
  readonly attribute DOMString <span title="stylesheet-href">href</span>;
  readonly attribute Node <span title="stylesheet-ownernode">ownerNode</span>;
  readonly attribute <span>StyleSheet</span> <span title="stylesheet-parentstylesheet">parentStyleSheet</span>;
  readonly attribute DOMString <span title="stylesheet-title">title</span>;
  [PutForwards=<span title="dom-MediaList-mediaText">mediaText</span>] readonly attribute <span>MediaList</span> <span title="stylesheet-media">media</span>;
           attribute boolean <span title="stylesheet-disabled">disabled</span>;
};</pre>

  <p>The
  <dfn id="stylesheet-type" title="stylesheet-type"><code>type</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>style sheet type</span>.</p>
  
  <p>The
  <dfn id="stylesheet-href" title="stylesheet-href"><code>href</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>style sheet location</span>.</p>
  
  <p>The
  <dfn id="stylesheet-ownernode" title="stylesheet-ownernode"><code>ownerNode</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>style sheet node</span>.</p>
  
  <p>The
  <dfn id="stylesheet-parentstylesheet" title="stylesheet-parentstylesheet"><code>parentStyleSheet</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>style sheet parent</span>.</p>

  <p>The
  <dfn id="stylesheet-title" title="stylesheet-title"><code>title</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>style sheet title</span>.</p>

  <p>The
  <dfn id="stylesheet-media" title="stylesheet-media"><code>media</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>style sheet media</span>.</p>

  <p>The
  <dfn id="stylesheet-disabled" title="stylesheet-disabled"><code>disabled</code></dfn>
  attribute <em class="ct">must</em>, on getting, return the
  <span>style sheet disabled flag</span>. On setting, it
  <em class="ct">must</em> set the <span>style sheet disabled flag</span> to
  the given value.</p>




  <h3>Style Sheet Collections</h3>
  
  <p>Below various new concepts are defined that are associated with each
  <code>Document</code> object.</p>

  <p>Each <code>Document</code> has an associated list of zero or more
  <span title="style sheet">style sheets</span>, named the
  <dfn id="document-style-sheets">document style sheets</dfn>. This is
  an ordered list that contains all
  <span title="style sheet">style sheets</span> associated with the
  <code>Document</code>, in <span>tree order</span>, with
  <span title="style sheet">style sheets</span> created from HTTP
  <code title="http-link">Link</code> headers first, if any, in header
  order.</p>
  
  <p>To <dfn id="create-a-style-sheet">create a style sheet</dfn>, run these
  steps:</p>

  <ol>
   <li><p>Create a new <span>style sheet</span> object and set its
   properties as specified.</p></li>
   
   <li><p>Then run the <span>add a style sheet</span> steps for the newly
   created <span>style sheet</span>.</p></li>
  </ol>
  
  <p>To <dfn id="add-a-style-sheet">add a style sheet</dfn>, run these
  steps:</p>
  
  <ol>
   <li><p>Add the <span>style sheet</span> to the list of
   <span>document style sheets</span> at the appropriate location. The
   remainder of these steps deal with the
   <span>style sheet disabled flag</span>.</p></li>

   <li><p>If the <span>style sheet disabled flag</span> is true terminate
   these steps.</p></li>

   <li><p>If the <span>style sheet title</span> is non-empty, the
   <span>style sheet alternate flag</span> is false, and
   <span>preferred style sheet set name</span> is the empty string
   <span>change the preferred style sheet set name</span> to the
   <span>style sheet title</span>.</p></li>
   
   <li>
    <p>If any of the following is true set the
    <span>style sheet disabled flag</span> to false and terminate these
    steps:</p>

    <ul>
     <li><p>The <span>style sheet title</span> is empty.</p></li>
     <li><p>The <span>last style sheet set name</span> is null and the
     <span>style sheet title</span> is a <span>case-sensitive</span> match
     for the <span>preferred style sheet set name</span>.</p></li>
     <li><p>The <span>style sheet title</span> is a
     <span>case-sensitive</span> match for the
     <span>last style sheet set name</span>.</p></li>
    </ul>
   </li>
   
   <li><p>Set the <span>style sheet disabled flag</span> to true.</p></li>
  </ol>

  <p>A <dfn id="persistent-style-sheet">persistent style sheet</dfn> is a
  <span>style sheet</span> from the <span>document style sheets</span>
  whose <span>style sheet title</span> is the empty string and whose
  <span>style sheet alternate flag</span> is false.</p>

  <p>A <dfn id="style-sheet-set">style sheet set</dfn> is an ordered
  collection of one or more <span title="style sheet">style sheets</span>
  from the <span>document style sheets</span> which have an identical
  <span>style sheet title</span> that is not the empty string.</p>

  <p>A <dfn id="style-sheet-set-name">style sheet set name</dfn> is the
  <span>style sheet title</span> the <span>style sheet set</span> has in
  common.</p>
  
  <p>An <dfn id="enabled-style-sheet-set">enabled style sheet set</dfn> is a
  <span>style sheet set</span> of which each <span>style sheet</span> has
  its <span>style sheet disabled flag</span> set to false.</p>
  
  <p>To <dfn id="enable-a-style-sheet-set">enable a style sheet set</dfn>
  with name <var title="">name</var>, run these steps:</p>
  
  <ol>
   <li><p>If <var title="">name</var> is the empty string set the
   <span>style sheet disabled flag</span> for each <span>style sheet</span>
   that is in a <span>style sheet set</span> to true and terminate these
   steps.</p></li>

   <li><p>Set the <span>style sheet disabled flag</span> for each
   <span>style sheet</span> in a <span>style sheet set</span> whose
   <span>style sheet set name</span> is a case-sensitive match for
   <var title="">name</var> to false and set it to true for all other
   <span title="style sheet">style sheets</span> in a
   <span>style sheet set</span>.</p></li>
  </ol>
  
  <p>To <dfn id="select-a-style-sheet-set">select a style sheet set</dfn>
  with name <var title="">name</var>, run these steps:</p>
  
  <ol>
   <li><p><span>Enable a style sheet set</span> with name
   <var title="">name</var>.</p></li>
   
   <li><p>Set <span>last style sheet set name</span> to
   <var title="">name</var>.</p></li>
  </ol>

  <p>A <dfn id="last-style-sheet-set-name">last style sheet set name</dfn>
  is a concept to determine what <span>style sheet set</span> was last
  <span title="select a style sheet set">selected</span>. Initially its
  value is null.</p>

  <p>A
  <dfn id="preferred-style-sheet-set-name">preferred style sheet set name</dfn>
  is a concept to determine which
  <span style="style sheet">style sheets</span> need to have their
  <span>style sheet disabled flag</span> set to false. Initially its value
  is the empty string.
  
  <p>To
  <dfn id="change-the-preferred-style-sheet-set-name">change the preferred style sheet set name</dfn>
  with name <var title="">name</var>, run these steps:</p>
  
  <ol>
   <li><p>Let the <span>preferred style sheet set name</span> be
   <var title="">current</var>.</p></li>

   <li><p>Set <span>preferred style sheet set name</span> to
   <var title="">name</var>.</p></li>

   <li><p>If <var title="">name</var> is not a <span>case-sensitive</span>
   match for <var title="">current</var> and
   <span>last style sheet set name</span> is null
   <span>enable a style sheet set</span> with name
   <var title="">new</var>.</p></li> 
  </ol>

  <!-- XXX ought to define "applied"
  
  thoughts:
    depends on disabled flag, alternate flag, media queries, sheesh
   -->


  <h4>The HTTP <code title="">Default-Style</code> Header</h4>
  
  <p>The HTTP <code title="http-default-style">Default-Style</code> header
  can be used to set the <span>preferred style sheet set name</span>
  influencing which <span>style sheet set</span> is (initially) the
  <span>enabled style sheet set</span>.</p>

  <p>For each HTTP <code title="http-default-style">Default-Style</code>
  header, in header order, the user agent <em class="ct">must</em>
  <span>change the preferred style sheet set name</span> with name being the
  value of the header.</p>




  <h4>The <code title="">StyleSheetList</code> Sequence</h4>

  <p>The sequence parameterized type represents an ordered collection of
  <span title="style sheet">style sheets</span>.</p>

  <pre class="idl">typedef sequence<<span>StyleSheet</span>> <dfn>StyleSheetList</dfn>;</pre>

<!--
  <pre class="idl">interface <dfn>StyleSheetList</dfn> {
  readonly attribute unsigned long <span title="stylesheetlist-length">length</span>;
  getter <span>StyleSheet</span> <span title="stylesheetlist-item">item</span>(unsigned long <var title="">index</var>);
};</pre>

  <p>The
  <dfn id="stylesheetlist-length" title="stylesheetlist-length"><code>length</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the number of
  objects currently in the list.</p>

  <p>The
  <dfn id="stylesheetlist-item" title="stylesheetlist-item"><code>item(<var title="">index</var>)</code></dfn>
  method, when invoked, <em class="ct">must</em> return the
  <code>StyleSheet</code> object in the list given by <var>index</var>, or
  <code>null</code>, if <var>index</var> is greater than or equal to the
  number of items in the list.</p>
-->


  <h4>The <code title="">DocumentStyle</code> Interface</h4>

  <!-- https://bugzilla.mozilla.org/show_bug.cgi?id=200930 (FIXED) -->
  <pre class="idl">interface <dfn>DocumentStyle</dfn> {
  readonly attribute <span>StyleSheetList</span> <span>styleSheets</span>;
           attribute DOMString? <span>selectedStyleSheetSet</span>;
  readonly attribute DOMString? <span>lastStyleSheetSet</span>;
  readonly attribute DOMString? <span>preferredStyleSheetSet</span>;
  readonly attribute DOMStringList <span>styleSheetSets</span>;
  void <span title="documentstyle-enablestylesheetsforset">enableStyleSheetsForSet</span>(DOMString? <var>name</var>);
};

<span>Document</span> implements <span>DocumentStyle</span>;</pre>
  <!-- XXX use Supplemental instead? -->

  <p>The
  <dfn id="documentstyle-stylesheets"><code>styleSheets</code></dfn>
  attribute <em class="ct">must</em> return a <code>StyleSheetList</code>
  sequence representing the <span>document style sheets</span>.</p

  <p>The
  <dfn id="documentstyle-selectedStyleSheetSet"><code>selectedStyleSheetSet</code></dfn>
  <em class="ct">must</em>, on getting, run these steps:</p>
  
  <ol>
   <li><p>If there is a single <span>enabled style sheet set</span> and no
   other <span>document style sheets</span> with a non-empty
   <span>style sheet title</span> have the
   <span>style sheet disabled flag</span> set to false return the
   <span>style sheet set name</span> of the
   <span>enabled style sheet set</span> and terminate this set of
   steps.</p></li>
   
   <li><p>Otherwise, if <span title="style sheet">style sheets</span> from
   different <span title="style sheet set">style sheet sets</span> have
   their <span>style sheet disabled flag</span> set to false return
   null and terminate this set of steps.</p></li>

   <li>
    <p>Otherwise, return the empty string.</p>
    
    <p class="note">At this point either all
    <span title="style sheet">style sheets</span> with a non-empty
    <span>style sheet title</span> have the
    <span>style sheet disabled flag</span> set to true or there are no such
    <span title="style sheet">style sheets</span>.</p>
   </li>
  </ol>

  <p>On setting the <code>selectedStyleSheetSet</code> attribute these steps
  <em class="ct">must</em> be run:</p>
  
  <ol>
   <li><p>If the value is null terminate this set of steps.</p></li>
   
   <li><p>Otherwise, <span>select a style sheet set</span> with as name the
   value passed.</p></li>
  </ol>

  <p>From the DOM's perspective, all views have the same
  <code>selectedStyleSheetSet</code>. If a user agent supports multiple
  views with different selected alternative style sheets, then this
  attribute (and the <code>StyleSheet</code> interface's
  <code>disabled</code> attribute) <em class="ct">must</em> return and set
  the value for the default view.</p>
  <!-- XXX clean up once we get rid of views -->

  <p>The
  <dfn id="documentstyle-lastStyleSheetSet"><code>lastStyleSheetSet</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>last style sheet set name</span>.</p>
  
  <p class="note">This attribute is initially null.</p>

  <p>The
  <dfn id="documentstyle-preferredStyleSheetSet"><code>preferredStyleSheetSet</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>preferred style sheet set name</span>.</p>
  
  <p class="note">Unlike <code>lastStyleSheetSet</code>, this attribute is
  initially the empty string.</p> <!-- XXX change? -->

  <p>The
  <dfn id="documentstyle-styleSheetSets"><code>styleSheetSets</code></dfn>
  attribute <em class="ct">must</em> return a list of the
  <span title="style sheet set name">style sheet set names</span> of the
  <span title="style sheet set">style sheet sets</span>, in order of the
  <span>document style sheets</span>.</p>

  <p>The
  <dfn id="documentstyle-enablestylesheetsforset" title="documentstyle-enablestylesheetsforset"><code>enableStyleSheetsForSet(<var title="">name</var>)</code></dfn>
  method <em class="ct">must</em>, when invoked, run these steps:</p>

  <ol>
   <li><p>If <var title="">name</var> is null terminate these
   steps.</p></li>
  
   <li><p><span>Enable a style sheet set</span> with name
   <var title="">name</var>.</p></li>
  </ol>

  <p class="note"><span title="Style sheet">Style sheets</span> with an
  empty <span>style sheet title</span> are never affected by this method.
  This method does not change the values of the
  <code>lastStyleSheetSet</code> or <code>preferredStyleSheetSet</code>
  attributes.</p>


  <h4>Interaction with the User Interface</h4>

  <p>The user interface of Web browsers that support style sheets
  <em class="ct">should</em> list the style sheet titles given in the
  <code>styleSheetSets</code> list, showing the
  <code>selectedStyleSheetSet</code> as the selected style sheet set,
  leaving none selected if it is <code>null</code> or the empty string, and
  selecting an extra option "Basic Page Style" (or similar) if it is
  the empty string and the <code>preferredStyleSheetSet</code> is the
  empty string as well.</p>

  <p>Selecting a style sheet from this list <em class="ct">should</em>
  use the <span>select a style sheet set</span> set of steps. This
  (by definition) affects the <code>lastStyleSheetSet</code> attribute.</p>

  <h5>Persisting the selected style sheet set</h5>

  <p>If a user agent persist the selected style sheet set, they should use
  the value of the <code>selectedStyleSheetSet</code> attribute, or if
  that is <code>null</code>, the <code>lastStyleSheetSet</code> attribute,
  when leaving the page (or at some other time) to determine the set name
  to store. If that is <code>null</code> then the style sheet set should not be
  persisted.</p>

  <p>When re-setting the style sheet set to the persisted value (which can
  happen at any time, typically at the first time the style sheets are
  needed for styling the document, after the <code>&lt;head&gt;</code> of
  the document has been parsed, after any scripts that are not dependent on
  computed style have executed), the style sheet set
  <em class="ct">should</em> be set by using the
  <span>select a style sheet set</span> set of steps as if the user had
  selected the set manually.</p>

  <p class="note">This specification does not give any suggestions on
  how user agents should decide to persist the style sheet set or whether or
  how to persist the selected set across pages.</p>
  
  <!-- XXX this UI section suggests we may want to introduce a few more
       idioms -->

  <h4>Examples</h4>

  <div class="example">
   <p>Thus, in the following HTML snippet:</p>

   <pre>&lt;link rel="alternate stylesheet" title="foo" href="a"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="b"&gt;
&lt;script&gt;

  document.selectedStyleSheetSet = 'foo';
  document.styleSheets[1].disabled = false;
&lt;/script&gt;
&lt;link rel="alternate stylesheet" title="foo" href="c"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="d"&gt;</pre>

   <p>...the style sheets that end up enabled are style sheets "a", "b",
   and "c", the <code>selectedStyleSheetSet</code> attribute would
   return null, <code>lastStyleSheetSet</code> would return "foo", and
   <code>preferredStyleSheetSet</code> would return "".</p>

   <p>Similarly, in the following HTML snippet:</p>

   <pre>&lt;link rel="alternate stylesheet" title="foo" href="a"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="b"&gt;
&lt;script&gt;
  var before = document.preferredStyleSheetSet;
  document.styleSheets[1].disabled = false;
&lt;/script&gt;
&lt;link rel="stylesheet" title="foo" href="c"&gt;

&lt;link rel="alternate stylesheet" title="bar" href="d"&gt;
&lt;script&gt;
  var after = document.preferredStyleSheetSet;
&lt;/script&gt;</pre>

   <p>...the "before" variable will be equal to the empty string, the
   "after" variable will be equal to "foo", and style sheets "a" and "c"
   will be enabled. This is the case even though the first script block
   sets style sheet "b" to be enabled, because upon parsing the
   following <code>&lt;link&gt;</code> element, the
   <code>preferredStyleSheetSet</code> is set and the
   <code title="documentstyle-enablestylesheetsforset">enableStyleSheetsForSet()</code>
   method is called (since <code>selectedStyleSheetSet</code> was never set
   explicitly, leaving <code>lastStyleSheetSet</code> at <code>null</code>
   throughout), which changes which style sheets are enabled and which are
   not.</p>
  </div>




  <h3>Style Sheet Association</h3>
  
  <p>This section defines the interface a <span>style sheet node</span> of a
  <span>style sheet</span> has to implement and defines the requirements for
  <span title="xml-stylesheet processing instruction">xml-stylesheet processing instructions</span>
  and HTTP <code title="http-link">Link</code> headers when the link
  releation type is an <span>ASCII case-insensitive</span> match for
  "<code title="">stylesheet</code>" since nobody else was interested in
  defining this.</p>

  <p>The editor is in good hope that HTML and SVG will define the
  appropriate processing in their respective specifications, in terms of
  this specification, in due course.</p>
  

  <h4>The <code title="">LinkStyle</code> Interface</h4>
  
  <p>The <dfn id="associated-style-sheet">associated style sheet</dfn> of a
  node is the <span>style sheet</span> in the list of
  <span>document style sheets</span> of which the
  <span>style sheet node</span>
  implements the <code>LinkStyle</code> interface.</p>

  <pre class="idl">interface <dfn>LinkStyle</dfn> {
  readonly attribute <span>StyleSheet</span> <span title="linkstyle-sheet">sheet</span>;
};</pre>

  <p>The
  <dfn id="linkstyle-sheet" title="linkstyle-sheet"><code>sheet</code></dfn>
  attribute <em class="ct">must</em> return the
  <span>associated style sheet</span> for the node, or null, if there is no
  <span>associated style sheet</span>.</p>

  <div class="example">
   <p>In the following HTML snippet the first HTML <code>style</code>
   element has a <code>sheet</code> attribute that returns a
   <code>StyleSheet</code> object representing the style sheet, but for
   the second <code>style</code> attribute it returns null.
   (Assuming the user agent supports CSS (<code>text/css</code>) and does
   not support ExampleSheets (<code>text/example-sheets</code>).</p>

   <pre>&lt;style type=text/css> body { background:lime } &lt;/style>
&lt;style type=text/example-sheets> $(body).background := lime &lt;/style></pre>
  </div>

  <p class="note">Whether or not the node refers to a style sheet is defined
  by the specification that defines the semantics of said node.</p>



  <h4>Requirements on specifications</h4>

  <p>Specifications introducing new ways of associating style sheets through
  the DOM <em class="ct">should</em> define which nodes implement the
  <code>LinkStyle</code> interface. When doing so, they
  <em class="ct">must</em> also define when a <span>style sheet</span> is
  <span title="create a style sheet">created</span>.</p>




  <h4>Requirements on User Agents Implementing the
  <span title=""><code>xml-stylesheet</code> processing instruction</span></h4>
  
  <!-- XXX ref, one day -->
  
  <!-- XXX load/error events, reparse --> 
  
  <pre class="idl"><span>ProcessingInstruction</span> implements <span>LinkStyle</span>;</pre>

  <p>For each
  <span><code>xml-stylesheet</code> processing instruction</span> that is
  not part of the <span>document type declaration</span> and has an
  <code title="">href</code> pseudo-attribute these steps
  <em class="ct">must</em> (unless otherwise stated) be run:</p>

  <ol>
   <li><p>Let <var title="">title</var> be the value of the
   <code title="">title</code> pseudo-attribute or the empty string if the
   <code title="">title</code> pseudo-attribute is not specified.</p></li>

   <li><p>If there is an <code title="">alternate</code> pseudo-attribute
   whose value is a <span>case-sensitive</span> match for
   "<code title="">yes</code>" and <var title="">title</var> is the empty
   string terminate these steps.</p></li>

   <li><p>If there is a <code title="">type</code> pseudo-attribute whose
   value is not a <span>supported styling language</span> the user agent
   <em class="ct">may</em> terminate these steps.</p></li>
   
   <li><p><span title="Resolve a URL">Resolve</span> the <span>URL</span>
   specified by the <code title="">href</code> pseudo-attribute and then
   <span>fetch</span> it.</p></li>

   <li>
    <p>When the resource is available, the document is in
    <span>quirks mode</span> and the <span>Content-Type metadata</span> of
    the resource is not a <span>supported styling language</span> change the
    <span>Content-Type metadata</span> of the resource to
    <code title="">text/css</code>.</p>

    <p class="note">This step might never actually happen, but is included
    here in case other specifications change, to keep things consistent.</p>
   </li>

   <li><p>If the resource is not in a
   <span>supported styling language</span> terminate these steps.</p></li>
   
   <li>
    <p><span>Create a style sheet</span> with the following properties:</p>

    <dl>
     <dt><span>style sheet type</span></dt>
     <dd><p>The <code>Content-Type metadata</code> of the resource.</p></dd> 

     <dt><span>style sheet location</span></dt>
     <dd><p>The <span>absolute URL</span> of the resource.</p></dd>

     <dt><span>style sheet node</span></dt>
     <dd><p>The node.</p></dd>

     <dt><span>style sheet parent</span></dt>
     <dd><p>null</p></dd>
   
     <dt><span>style sheet media</span></dt>
     <dd><p>The value of the <code title="">media</code> pseudo-attribute
     if any, or the empty string otherwise.</p></dd>
   
     <dt><span>style sheet title</span></dt>
     <dd><p><var title="">title</var></p></dd>

     <dt><span>style sheet alternate flag</span></dt>
     <dd><p>True if the <code title="">alternate</code> pseudo-attribute
     value is a <span>case-sensitive</span> match for "<code>yes</code>".
     Otherwise, false.</p></dd>
    </dl>
   </li>
  </ol>



  <h4>Requirements on User Agents Implementing the HTTP
  <code title="">Link</code> Header</h4>

  <!-- XXX ref, one day -->

  <!-- XXX deal with media param -->

  <p>For each HTTP <code title="http-link">Link</code> header of which one
  of the link relation types is an <span>ASCII case-insensitive</span> match
  for "<code title="">stylesheet</code>" these steps
  <em class="ct">must</em> be run:</p>
  
  <ol>
   <li><p>Let <var title="">title</var> be the value of the first of all the
   <code title="">title</code> and <code title="">title*</code> parameters.
   If there are no such parameters it is the empty string.</p></li>

   <li><p>If one of the (other) link relation types is an
   <span>ASCII case-insensitive</span> match for
   "<code title="">alternate</code>" and <var title="">title</var> is the
   empty string terminate these steps.</p></li>
   
   <li><p><span title="Resolve a URL">Resolve</span> the specified
   <span>URL</span> and <span>fetch</span> it.</p></li>
   
   <li><p>When the resource is available, the document is in
   <span>quirks mode</span> and the <span>Content-Type metadata</span> of
   the resource is not a <span>supported styling language</span> change the
   <span>Content-Type metadata</span> of the resource to
   <code title="">text/css</code>.</p></li>
   
   <li><p>If the resource is not in a
   <span>supported styling language</span> terminate these steps.</p></li>
   
   <li>
    <p><span>Create a style sheet</span> with the following properties:</p>

    <dl>
     <dt><span>style sheet type</span></dt>
     <dd><p>The <span>Content-Type metadata</span> of the resource.</p></dd> 

     <dt><span>style sheet location</span></dt>
     <dd><p>The <span>absolute URL</span> of the resource.</p></dd>

     <dt><span>style sheet node</span></dt>
     <dd><p>null</p></dd>
   
     <dt><span>style sheet parent</span></dt>
     <dd><p>null</p></dd>
   
     <dt><span>style sheet media</span></dt>
     <dd><p>The value of the first <code title="">media</code> parameter.</p></dd>
     <!-- XXX register media parameter? bah -->
   
     <dt><span>style sheet title</span></dt>
     <dd><p><var title="">title</var></p></dd>

     <dt><span>style sheet alternate flag</span></dt>
     <dd><p>True if one of the specified link relation type for this HTTP
     <code title="http-link">Link</code> header is an
     <span>ASCII case-insensitive</span> match for
     "<code title="">alternate</code>". Otherwise, false.</p></dd>
    </dl>
   </li>
  </ol>





  <h2>CSS Style Sheets</h2>

  <p><em>This section (and its subsections) are only applicable to user
  agents implementing CSS.</em></p>

  <p>This section defines an API for CSS style sheets.</p>

  <!--
   statement "[S|CDO|CDC]* [ import [S|CDO|CDC]* ]* [ [ ruleset | media | page ] [S|CDO|CDC]* ]*" ??

   selectors "*"
   page selectors "S* pseudo_page? S*"

   declaration "S* declaration" (properties, property values, property priority)

   property value "S* expr"
  -->
  

  <h3>CSS Style Sheet</h3>
  
  <p class="XXX"> define CSS style sheet </p>

  <h4>The <code title="">CSSStyleSheet</code> Interface</h4>

  <p>The <code>CSSStyleSheet</code> interface represents a <span>CSS style
  sheet</span>.</p>

  <!--
   IE exposes:
   owningElement, pages, id, type, href, disabled, cssText, readOnly, title,
   parentStyleSheet, imports, rules, media
  -->

  <pre class="idl">interface <dfn>CSSStyleSheet</dfn> : <span>StyleSheet</span> {
  readonly attribute <span>CSSRule</span> <span>ownerRule</span>;
  readonly attribute <span>CSSRuleList</span> <span title="cssstylesheet-cssrules">cssRules</span>;
  unsigned long <span title="cssstylesheet-insertrule">insertRule</span>(DOMString <var>rule</var>, unsigned long <var>index</var>);
  void <span title="cssstylesheet-deleterule">deleteRule</span>(unsigned long <var>index</var>);
};</pre>

  <p>The <dfn id="cssstylesheet-ownerrule"><code>ownerRule</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the
  <code>CSSImportRule</code> that caused this style sheet to be imported (if
  any). Otherwise, if no <code>CSSImportRule</code> caused it to be imported the
  attribute <em class="ct">must</em> return <code>null</code>.</p>

  <p>The
  <dfn id="cssstylesheet-cssrules" title="cssstylesheet-cssrules"><code>cssRules</code></dfn>
  attribute, on getting, <em class="ct">must</em> return a
  <code>CSSRuleList</code> object consisting of a list of rules in order
  they were found in the <span>CSS style sheet</span>.</p>
  
  <p class="note">Rules that were dropped during parsing can not be found
  using these APIs.</p>

  <p>The
  <dfn id="cssstylesheet-insertrule" title="cssstylesheet-insertrule"><code>insertRule(<var title="">rule</var>,
  <var title="">index</var>)</code></dfn> method, when invoked,
  <em class="ct">must</em> <span>insert a statement</span> where <var>rule</var>
  is <var>rule</var>, <var>index</var> is <var>index</var> and <var>rule
  list</var> is <code title="cssstylesheet-cssrules">cssRules</code>.</p>

  <p>The
  <dfn id="cssstylesheet-deleterule" title="cssstylesheet-deleterule"><code>deleteRule(<var title="">index</var>)</code></dfn>
  method, when invoked, <em class="ct">must</em> <span>remove a statement</span>
  where <var>index</var> is <var>index</var> and <var>rule list</var> is
  <code title="cssmediarule-cssrules">cssRules</code>.</p>
  
  
  <h3>CSS Rules</h3>

  <p class="XXX">Need to split this up in parsing and common algorithms.</p>

  <p>The rules for <dfn title="insert a statement">inserting a statement</dfn>
  are as given in the following algorithm. The variables <var>rule</var>,
  <var>rule list</var> and <var>index</var> are to be considered equivalent to
  the identically named variables used when invoking this algorithm. If an
  exception is raised the algorithm is to be aborted. The steps
  <em class="ct">must</em> be followed in order, as follows:</p>

  <ol>
   <li><p>If <var>index</var> is negative or greater than the length of the
   <var>rule list</var> an <code>INDEX_SIZE_ERR</code> exception
   <em class="ct">must</em> be raised.</p></li>

   <li><p>Parse <var>rule</var> as a CSS statement. If the <var>rule</var> is
   ignored by the CSS parser abort this algorithm (don't raise an exception).
   Otherwise, create an object that implements one of the inherited interfaces
   of <code>CSSStyle</code> appropriate for the parsed <var>rule</var>. Let
   <var>object</var> be the newly created object.</p></li>

   <li><p>If <var>object</var> can't be inserted within the <var>rule list</var>
   at the given <var>index</var> because that's not allowed per the CSS
   specification a <code>HIERARCHY_REQUEST_ERR</code> exception
   <em class="ct">must</em> be raised.</p></li>

   <li><p>Insert <var>object</var> at the given <var>index</var> within the
   <var>rule list</var>.</p></li>
  </ol>

  <p>The rules for <dfn title="remove a statement">removing a statement</dfn>
  are as given in the following algorithm. The variables <var>index</var> and
  <var>rule list</var> are to be considered equivalent to the identically
  named variables used when invoking this algorithm. If an exception is raised
  this algorithm is to be aborted. The steps <em class="ct">must</em> be
  followed in order, as follows:</p>

  <ol>
   <li><p>If <var>index</var> is negative or greater than the length of the
   <var>rule list</var> an <code>INDEX_SIZE_ERR</code> exception
   <em class="ct">must</em> be raised.</p></li>

   <li><p>Remove the object at <var>index</var> from <var>rule
   list</var>.</p></li>
  </ol>

  <p>The rules for <dfn title="replace a statement">replacing a statement</dfn> are as given in the following algorithm. The variable
  <var>rule</var> and <var>old object</var> are to be considered equivalent to
  the identically named variables used when invoking this algorithm. If an
  exception is raised this algorithm is to be aborted. The steps
  <em class="ct">must</em> be followed in order, as follows:</p>

  <ol>
   <li><p>Parse <var>rule</var> as a CSS statement. If the <var>rule</var> is
   ignored by the CSS parser abort this algorithm (don't raise an exception).
   Otherwise, create an object that implements one of the inherited interfaces
   of <code>CSSStyle</code> appropriate for the parsed <var>rule</var>. Let
   <var>object</var> be the newly created object.</p></li>

   <li><p>If the <code title="dom-CSSRule-type">type</code> of <var>object</var>
   does not match the <code title="dom-CSSRule-type">type</code> of <var>old
   object</var> it will replace user agents <em class="ct">must</em> raise an
   <code>INVALID_MODIFICATION_ERR</code> exception.</p></li>

   <li><p>Replace <var>old object</var> with <var>object</var>.</p></li>
  </ol>


  <h4>The <code title="">CSSRuleList</code> Sequence</h4>

  <p>The <code>CSSRuleList</code> object represents an ordered collection of
  CSS rules.</p>

  <pre class="idl">typedef sequence&lt;<span>CSSRule</span>> <dfn>CSSRuleList</dfn>;</pre>


  <h4>The <code title="">CSSRule</code> Interface</h4>
  
  <p>The <code>CSSRule</code> interface a base interface. Each specific CSS
  statement has an interface which inherits from this one.</p>

  <pre class="idl">interface <dfn>CSSRule</dfn> {
  // CSS statement type
  const unsigned short <span title="dom-CSSRule-STYLE_RULE">STYLE_RULE</span> = 1;
  const unsigned short <span title="dom-CSSRule-IMPORT_RULE">IMPORT_RULE</span> = 3;
  const unsigned short <span title="dom-CSSRule-MEDIA_RULE">MEDIA_RULE</span> = 4;
  const unsigned short <span title="dom-CSSRule-FONT_FACE_RULE">FONT_FACE_RULE</span> = 5;
  const unsigned short <span title="dom-CSSRule-PAGE_RULE">PAGE_RULE</span> = 6;
  const unsigned short <span title="dom-CSSRule-NAMESPACE_RULE">NAMESPACE_RULE</span> = 8;
  readonly attribute unsigned short <span title="dom-CSSRule-type">type</span>;

  // Textual representation
           attribute DOMString <span title="dom-CSSRule-cssText">cssText</span>;
  
  // Context information
  readonly attribute <span>CSSRule</span> <span title="dom-CSSRule-parentRule">parentRule</span>;
  readonly attribute <span>CSSStyleSheet</span> <span title="dom-CSSRule-parentStyleSheet">parentStyleSheet</span>;
};</pre>


  <p>The
  <dfn id="dom-cssrule-type" title="dom-CSSRule-type"><code>type</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the CSS statement
  type, as follows:</p>

  <dl>
   <dt><dfn id="dom-cssrule-style_rule" title="dom-CSSRule-STYLE_RULE"><code>STYLE_RULE</code></dfn> (numeric value 1)</dt>
   <dd>The object is a <code>CSSStyleRule</code>.</dd>
   <dt><dfn id="dom-cssrule-import_rule" title="dom-CSSRule-IMPORT_RULE"><code>IMPORT_RULE</code></dfn> (numeric value 3)</dt>
   <dd>The object is a <code>CSSImportRule</code>.</dd>
   <dt><dfn id="dom-cssrule-media_rule" title="dom-CSSRule-MEDIA_RULE"><code>MEDIA_RULE</code></dfn> (numeric value 4)</dt>
   <dd>The object is a <code>CSSMediaRule</code>.</dd>
   <dt><dfn id="dom-cssrule-font_face_rule" title="dom-CSSRule-FONT_FACE_RULE"><code>FONT_FACE_RULE</code></dfn> (numeric value 5)</dt>
   <dd>The object is a <code>CSSFontFaceRule</code>.</dd>
   <dt><dfn id="dom-cssrule-page_rule" title="dom-CSSRule-PAGE_RULE"><code>PAGE_RULE</code></dfn> (numeric value 6)</dt>
   <dd>The object is a <code>CSSPageRule</code>.</dd>
   <dt><dfn id="dom-cssrule-namespace_rule" title="dom-CSSRule-NAMESPACE_RULE"><code>NAMESPACE_RULE</code></dfn> (numeric value 8)</dt>
   <dd>The object is a <code>CSSNamespaceRule</code>.</dd>
  </dl>

  <p class="note">Constants with values 0 and 2 have been obsoleted by this
  specification. They might be re-allocated in the future. 7 is reserved for
  <code>@color-profile</code>.</p>


  <p>The
  <dfn id="dom-cssrule-csstext" title="dom-CSSRule-cssText"><code>cssText</code></dfn>
  attribute, on setting, <em class="ct">must</em>
  <span>replace a statement</span> where <var>rule</var> is the value being
  set and <var>old object</var> is the object of which this attribute is
  set.</p>

  <p>On getting the <code title="dom-CSSRule-cssText">cssText</code>
  attribute, <span class="issue">...</span>.</p>

  <!-- XXX the serialization depends on the type -->

  <p>The
  <dfn id="dom-cssrule-parentrule" title="dom-CSSRule-parentRule"><code>parentRule</code></dfn>
  attribute <em class="ct">must</em> return the nearest enclosing rule of the
  current rule or <code>null</code>, if there is no enclosing rule. For example,
  an <code title="">@media</code> block enclosing the current rule.</p>

  <p>The
  <dfn id="dom-cssrule-parentstylesheet" title="dom-CSSRule-parentStyleSheet"><code>parentStyleSheet</code></dfn>
  attribute <em class="ct">must</em> return the <code>CSSStyleSheet</code>
  object that contains the the current rule.</p>


  <h5>Extensibility</h5>

  <p>The constant values 0-1000 are reserved for future use by the CSS WG.</p>

  <p>Vendors are encouraged to use reasonably unique values outside this range
  so that they do not clash with extensions from other vendors. For example, the
  first value for Mozilla could be <code>0x0<strong>8EC0</strong>001</code> and
  <code>0x<strong>09E8A</strong>001</code> could be the first for Opera.</p>

  <p>Vendors are encouraged to prefix the new interface names with a vendor
  specific prefix. For example, "Example company" could have an interface called
  "ExampleCSSTestRule".</p>

  <p>In general, vendors are encouraged to discuss extensions on a public forum,
  such as <code>www-style@w3.org</code>.</p>


  <h4>CSS Style Rule (Rule Set)</h4>

  <p>The <code>CSSStyleRule</code> object represents a rule set, providing
  access to its associated <span>group of selectors</span> and
  <span>CSS declaration block</span>.</p> <!-- XXX ref -->

  <pre class="idl">interface <dfn>CSSStyleRule</dfn> : <span>CSSRule</span> {
           attribute DOMString <span title="dom-CSSStyleRule-selectorText">selectorText</span>;
  readonly attribute <span>CSSStyleDeclaration</span> <span title="dom-CSSStyleRule-style">style</span>;
};</pre>

  <p>The
  <dfn id="dom-cssstylerule-selectortext" title="dom-CSSStyleRule-selectorText"><code>selectorText</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the result of
  <span title="serialize a group of selectors">serializing</span> the
  associated <span>group of selectors</span>.</p>
  
  <p>On setting the
  <code title="dom-CSSStyleRule-selectorText">selectorText</code> attribute
  these steps <em class="ct">must</em> be run:</p>
  
  <ol>
   <li><p>Run the <span>parse a group of selectors</span> algorithm on the
   given value.</p></li>
   
   <li><p>If the algorithm returns a non-null value replace the associated
   <span>group of selectors</span> with the returned value.</p></li>
   
   <li><p>Otherwise, if the algorithm returns a null value, do
   nothing.</p></li>
  </ol>

  <p>The
  <dfn id="cssstylerule-style" title="cssstylerule-style"><code>style</code></dfn>
  attribute <em class="ct">must</em> return a live
  <code>CSSStyleDeclaration</code> object for the rule set.</p>


  <h4>CSS <code title="">@import</code> Rule</h4>

  <p>The <code>CSSImportRule</code> object represents an <code>@import</code>
  rule specified (if any) in a <span>CSS style sheet</span>.</p>

  <pre class="idl">interface <dfn>CSSImportRule</dfn> : <span>CSSRule</span> {
  readonly attribute DOMString <span title="cssimportrule-href">href</span>;
  [PutForwards=<span title="dom-MediaList-mediaText">mediaText</span>] readonly attribute <span>MediaList</span> <span title="cssimportrule-media">media</span>;
  readonly attribute <span>CSSStyleSheet</span> <span title="cssimportrule-stylesheet">styleSheet</span>;
};</pre>

  <p>The
  <dfn id="cssimportrule-href" title="cssimportrule-href"><code>href</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the <em>specified</em>
  URI of the style sheet referenced by the <code>@import</code> rule.</p>

  <p>The
  <dfn id="cssimportrule-media" title="cssimportrule-media"><code>media</code></dfn>
  attribute, on getting, <em class="ct">must</em> return a live
  <code>MediaList</code> object containing a list of media queries applicable to
  the imported style sheet as specified by the <code>@import</code> rule.</p>

  <p>The
  <dfn id="cssimportrule-stylesheet" title="cssimportrule-stylesheet"><code>styleSheet</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the
  <code>CSSStyleSheet</code> object that represents the referenced (parsed)
  style sheet from the <code>@import</code> rule.</p>
  
  <p class="note">If loading of the style sheet fails its
  <code title="cssstylesheet-cssrules">cssRules</code> list is simply empty.</p>


  <h4>CSS <code title="">@media</code> Rule</h4>

  <p>The <code>CSSMediaRule</code> object represents an
  <code title="">@media</code> rule specified (if any) in a <span>CSS style
  sheet</span>. It is a single statement that contains zero or more rulesets
  which are contrained by one or more media queries (unless one happens to be
  <code>all</code>).</p>

  <pre class="idl">interface <dfn>CSSMediaRule</dfn> : <span>CSSRule</span> {
  [PutForwards=<span title="dom-MediaList-mediaText">mediaText</span>] readonly attribute <span>MediaList</span> <span title="cssmediarule-media">media</span>;
  readonly attribute <span>CSSRuleList</span> <span title="cssmediarule-cssrules">cssRules</span>;
  unsigned long <span title="cssmediarule-insertrule">insertRule</span>(DOMString <var>rule</var>, in unsigned long <var>index</var>);
  void <span title="cssmediarule-deleterule">deleteRule</span>(unsigned long <var>index</var>);
};</pre>

  <p>The
  <dfn id="cssmediarule-media" title="cssmediarule-media"><code>media</code></dfn>
  attribute, on getting, <em class="ct">must</em> return a
  <code>MediaList</code> object containing a list of media queries specified
  with the <code title="">@media</code> rule.</p>

  <p>The
  <dfn id="cssmediarule-cssrules" title="cssmediarule-cssrules"><code>cssRules</code></dfn>
  attribute, on getting, <em class="ct">must</em> return a
  <code>CSSRuleList</code> object containing a list of all the rulesets
  specified within the <code title="">@media</code> rule.</p>

  <p>The
  <dfn id="cssmediarule-insertrule" title="cssmediarule-insertrule"><code>insertRule(<var title="">rule</var>,
  <var title="">index</var>)</code></dfn> method, when invoked,
  <em class="ct">must</em> <span>insert a statement</span> where <var>rule</var>
  is <var>rule</var>, <var>index</var> is <var>index</var> and <var>rule
  list</var> is <code title="cssmediarule-cssrules">cssRules</code>.</dd>

  <p>The
  <dfn id="cssmediarule-deleterule" title="cssmediarule-deleterule"><code>deleteRule(<var title="">index</var>)</code></dfn>
  method, when invoked, <em class="ct">must</em> <span>remove a statement</span>
  where <var>index</var> is <var>index</var> and <var>rule list</var> is
  <code title="cssmediarule-cssrules">cssRules</code>.</p>


  <h4>CSS <code title="">@font-face</code> Rule</h4>

  <p>The <code>CSSFontFaceRule</code> object represents an
  <code>@font-face</code> rule specified (if any) in a <span>CSS style
  sheet</span>.</p>

  <pre class="idl">interface <dfn>CSSFontFaceRule</dfn> : <span>CSSRule</span> {
  readonly attribute <span>CSSStyleDeclaration</span> <span title="cssfontfacerule-style">style</span>;
};</pre>

  <p>The
  <dfn id="cssfontfacerule-style" title="cssfontfacerule-style"><code>style</code></dfn>
  attribute <em class="ct">must</em> return a <code>CSSStyleDeclaration</code>
  block that contains the property declarations specified within the
  <code>@font-face</code> rule.</p>


  <h4>CSS <code title="">@page</code> Rule</h4>

  <p class="XXX">Need to define the rules for
  <dfn id="css-page-selectors-parsing" title="CSS page selectors parsing">parsing a CSS page selector</dfn> and
  <dfn id="css-page-selectors-serializing" title="CSS page selectors serializing">serializing a CSS page
  selector</dfn>.</p>

  <p>The <code>CSSPageRule</code> object represents an <code>@page</code> rule
  specified (if any) in a <span>CSS style sheet</span>.</p>

  <pre class="idl">interface <dfn>CSSPageRule</dfn> : <span>CSSRule</span> {
           attribute DOMString <span title="csspagerule-selectortext">selectorText</span>;
  readonly attribute <span>CSSStyleDeclaration</span> <span title="csspagerule-style">style</span>;
};</pre>

  <p>The
  <dfn id="csspagerule-selectortext" title="csspagerule-selectortext"><code>selectorText</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the result of
  <span title="CSS page selectors serializing">serializing CSS page
  selectors</span>. On setting, the setted value <em class="ct">must</em> be
  used as input for <span title="CSS page selectors parsing">parsing CSS
  page selectors</span> and if that returns a non-null value that is to be
  used as a selector for the <code>@page</code> rule. If it returns null
  setting <em class="ct">must not</em> have an effect.</p>

  <p>The
  <dfn id="csspagerule-style" title="csspagerule-style"><code>style</code></dfn>
  attribute, on getting, <em class="ct">must</em> return a
  <code>CSSStyleDeclaration</code> that contains the specified property
  declarations within the <code>@page</code> rule.</p>


  <h4>CSS <code title="">@namespace</code> Rule</h4>

  <p>The <code>CSSNamespaceRule</code> object represents an
  <code>@namespace</code> rule specified (if any) in a <span>CSS style
  sheet</span> that consists of a prefix and namespace.</p>

  <pre class="idl">interface <dfn>CSSNamespaceRule</dfn> : <span>CSSRule</span> {
  readonly attribute DOMString <span>namespaceURI</span>;
  readonly attribute DOMString <span>prefix</span>;
};</pre>

  <p>The <dfn id="cssnamespacerule-namespaceuri"><code>namespaceURI</code></dfn>
  attribute, on getting, <em class="ct">must</em> return specified namespace IRI
  from the <code>@namespace</code> rule.</p>

  <p>The <dfn id="cssnamespacerule-prefix"><code>prefix</code></dfn> attribute,
  on getting, <em class="ct">must</em> return the specified prefix from the
  <code>@namespace</code> rule or the empty string if there is no prefix.</p>
  <!-- XXX lowercased? -->




  <h3>CSS Declaration Blocks</h3>

  <p class="XXX">To
  <dfn id="parse-a-css-declaration-block">parse a CSS declaration block</dfn>
  ...</p>

  <p class="XXX">To
  <dfn id="serialize-a-css-declaration-block">serialize a CSS declaration block</dfn>
  ...</p> 



  <h4>The <code title="">CSSStyleDeclaration</code> Interface</h4>

  <p>Objects implementing the <code>CSSStyleDeclaration</code> interface
  give access to read and manipulate CSS properties and their values within
  a declaration block.</p>

  <p>Objects implementing the <code>CSSStyleDeclaration</code> interface
  have the following associated concepts:</p>
  
  <dl>
   <dt><dfn>CSS declaration block readonly flag</dfn></dt>
   <dd><p>Indicates whether or not the object can be modified (as detailed
   below). True when it cannot. False otherwise and by default.</p></dd>
   
   <!--
   <dt><dfn>CSS declaration block value type</dfn></dt>
   <dd><p>Indicates the type of value 
   
   -->
   
   <dt><dfn>collection of CSS declarations</dfn></dt>
   <dd><p>The CSS declarations associated with the object.</p></dd>
  </dl>

  <!-- XXX review nullable DOMString more carefully (DOMString?) -->

  <pre class="idl">interface <dfn>CSSStyleDeclaration</dfn> {
           attribute DOMString <span title="cssstyledeclaration-csstext">cssText</span>;
  DOMString <span title="cssstyledeclaration-getpropertyvalue">getPropertyValue</span>(DOMString <var title="">property</var>);
  DOMString <span title="cssstyledeclaration-getpropertypriority">getPropertyPriority</span>(DOMString <var title="">property</var>);
  DOMString <span title="cssstyledeclaration-removeproperty">removeProperty</span>(DOMString <var title="">property</var>);
  void <span title="cssstyledeclaration-setproperty">setProperty</span>(DOMString? <var title="">property</var>, DOMString? <var title="">value</var>);
  void <span title="cssstyledeclaration-setproperty">setProperty</span>(DOMString? <var title="">property</var>, DOMString? <var title="">value</var>, DOMString? <var title="">priority</var>);
  readonly attribute unsigned long <span title="cssstyledeclaration-length">length</span>;
  DOMString <span title="cssstyledeclaration-item">item</span>(unsigned long <var title="">index</var>);
  readonly attribute <span>CSSRule</span> <span title="cssstyledeclaration-parentrule">parentRule</span>;

  // CSS Properties
<!--CSSOM-PROPERTYIDL-->
};</pre>

  <p>The
  <dfn id="cssstyledeclaration-csstext" title="cssstyledeclaration-csstext"><code>cssText</code></dfn>
  attribute <em class="ct">must</em>, on getting, return the result of
  <span title="serialize a CSS declaration block">serializing</span> the
  <span>collection of CSS declarations</span>.</p>

  <p>On setting the <code title="">cssText</code> attribute these steps
  <em class="ct">must</em> be run:</p>
  
  <ol>
   <li><p>If the <span>CSS declaration block readonly flag</span> is true
   raise a <code>NO_MODIFICATION_ALLOWED_ERR</code> and terminate this
   algorithm.</p></li>
  
   <li><p>Empty the <span>collection of CSS declarations</span>.</p></li>
   
   <li><p><span title="Parse a CSS declaration block">Parse</span> the given
   value and, if the return value is not null, append it to the
   <span>collection of CSS declarations</span>.</p></li>
  </ol>
   
  <p>The
  <dfn id="cssstyledeclaration-getpropertyvalue" title="cssstyledeclaration-getpropertyvalue"><code>getPropertyValue(<var title="">property</var>)</code></dfn>
  method, when invoked, <span class="issue">...</span>.</p>
  <!-- Once we have defined how everything will be canonicalized we can start
  thinking about this... --></p>

  <p>The
  <dfn id="cssstyledeclaration-getpropertypriority" title="cssstyledeclaration-getpropertypriority"><code>getPropertyPriority(<var title="">property</var>)</code></dfn>
  method, when invoked, if <var title="">property</var> is an
  <span>ASCII case-insensitive</span> match for a property that has a
  priority user agents <em class="ct">must</em> return the canonical
  priority of that property as given in the syntax definition. Otherwise,
  the empty string <em class="ct">must</em> be returned.</p>

  <p class="example">E.g. for <code>background-color:lime !IMPORTANT</code>
  the return value would be "<code title="">important</code>".</p>

  <p>When the
  <dfn id="cssstyledeclaration-removeproperty" title="cssstyledeclaration-removeproperty"><code>removeProperty(<var title="">property</var>)</code></dfn>
  method is invoked these steps <em class="ct">must</em> be run:</p>
  
  <ol>
   <li><p>If the <span>CSS declaration block readonly flag</span> is true
   raise a <code>NO_MODIFICATION_ALLOWED_ERR</code> and terminate this
   algorithm.</p></li>
  
   <li><p>If <var title="">property</var> is an
   <span>ASCII case-insensitive</span> match for a
   property of a declaration in the
   <span>collection of CSS declarations</span> remove the declaration.</p>
  </ol>

  <p>When the
  <dfn id="cssstyledeclaration-setproperty" title="cssstyledeclaration-setproperty"><code>setProperty(<var title="">property</var>, <var title="">value</var>, <var title="">priority</var>)</code></dfn>
  method is invoked these steps <em class="ct">must</em> be run:</p>

  <ol>
   <li><p>If the <span>CSS declaration block readonly flag</span> is true
   raise a <code>NO_MODIFICATION_ALLOWED_ERR</code> and terminate this
   algorithm.</p></li>

   <li><p>If <var title="">property</var> does not case-insensitively match a
   supported property terminate this algorithm.</p></li>

   <li><p>If <var title="">value</var> is null or the empty string invoke
   <code title="cssstyledeclaration-removeproperty">removeProperty()</code>
   with <var title="">property</var> as argument and terminate this
   algorithm.</p></li>

   <li><p>If the <var title="">priority</var> argument has been omitted let
   <var title="">priority</var> be the empty string.</p></li>

   <li><p>If <var title="">priority</var> is neither a valid priority nor
   the empty string terminate this algorithm.</p></li>
   <!-- define valid priority somehow -->

   <li>
    <p>If <span title="parse a CSS value">parsing the
    <var title="">value</var></span> returns null abort this algorithm.</p>

    <p class="note"><var title="">value</var> can not include
    "<code title="">!important</code>".</p>
   </li>

   <li><p>Finally, set <var title="">property</var> to <var title="">value</var>
   with priority <var title="">priority</var> when <var title="">priority</var>
   is not the empty string. Otherwise set
   <var title="">property</var> to <var title="">value</var>.</p></li>
  </ol>


  <!-- XXX WebIDL work -->
  <p>The
  <dfn id="cssstyledeclaration-length" title="cssstyledeclaration-length"><code>length</code></dfn>
  attribute <em class="ct">must</em> return the number of declarations in
  the <span>collection of CSS declarations</span>.</p>

  <p>The
  <dfn id="cssstyledeclaration-item" title="cssstyledeclaration-item"><code>item(<var title="">index</var>)</code></dfn>
  method, when invoked, <span class="issue">...</span>.</p>
  <!-- returns the value of property x stored at position item. -->

  <p>The
  <dfn id="cssstyledeclaration-parentrule" title="cssstyledeclaration-parentrule"><code>parentRule</code></dfn>
  attribute, on getting, <em class="ct">must</em> return the
  <code>CSSrule</code> object the <code>CSSStyleDeclaration</code> is object is
  associated with or <code>null</code> if it is not associated with a
  <code>CSSrule</code> object.</p>
  <!-- XXX introduce a concept for this instead -->


  <p>For the table below, the IDL attribute in the first column
  <em class="ct">must</em>, on getting return the result of invoking
  <code title="cssstyledeclaration-getPropertyValue">getPropertyValue()</code>
  with as argument the CSS property given in the second column on the same
  row.</p>
  
  <p>Similarly for the table below, setting the IDL attribute in the
  first column  <em class="ct">must</em> invoke
  <code title="cssstyledeclaration-setProperty">setProperty()</code> with as
  first argument the CSS property given in the second column on the same
  row, as second argument the given value, and no third argument. Any
  exceptions raised <em class="ct">must</em> be re-raised.</p>

  <table>
   <thead>
    <tr>
     <th>IDL attribute
     <th>CSS property
   <tbody>
<!--CSSOM-PROPERTYTABLE-->
  </table>

<!--
  <h4>CSS Properties</h4>

  <p>The DOM attribute name of a CSS property can be found by using the
  following algorithm:</p>

  <ol>
   <li>Let <var title="">r</var> be the CSS property to be
   converted.</li>

   <li>Uppercase the first character after every U+002D (<code>-</code>) in
   <var title="">r</var>.</li>

   <li>Remove every U+002D (<code>-</code>) in <var title="">r</var>.</li>

   <li>Return <var title="">r</var>.</li>
  </ol>

  <p class="note">This means that
  <code>-<var title="">vendor</var>-<var title="">property</var></code>
  becomes
  <code><var title=""><strong>V</strong>endor</var><var title=""><strong>P</strong>roperty</var></code>
  for instance.</p>
-->


  <h3>CSS Values</h3>

  <h4>Parsing CSS Values</h4>

  <p>To <dfn id="parse-a-css-value">parse a CSS value</dfn> for a given
  <var title="">property</var> means to a parse the given value according to
  the definition of the property that is an
  <span>ASCII case-insensitive</span> match for <var title="">property</var>
  in the CSS specification. If the given value is <span>ignored</span>
  return null. Otherwise return the CSS value for the given
  <var title="">property</var>.</p>
  
  <p class="note">"<code title="">!important</code>" declarations are not
  part of the property value space and will therefore cause
  <span>parse a CSS value</span> to return null.</p>


  <h4>Serializing CSS Values</h4>
  
  <!-- based on http://damowmow.com/playground/canon.txt -->

  <p>To <dfn id="serialize-a-css-value">serialize a CSS value</dfn> run
  these steps:</p>

  <p class="XXX">This needs some work, obviously.</p>

  <p>To
  <dfn id="serialize-a-css-value-component">serialize a CSS value component</dfn>
  depends on the component, as follows:</p>
  
  <dl>
   <dt>keyword</dt>
   <dd><p>The keyword <span>converted to ASCII lowercase</span>.</p></dd>

   <dt>&lt;angle></dt>
   <dd><p>The number of degrees serialized as per &lt;number> followed by
   the literal string "<code>deg</code>".</p></dd>
   
   <dt>&lt;color></dt>
   <dd><p class=XXX>preserve system colors, maybe color keywords...</p></dd>
   
   <dt>&lt;frequency></dt>
   <dd><p>The frequency in hertz serialized as per &lt;number> followed by
   the literal string "<code>hz</code>".</dd>
   
   <dt>&lt;identifier></dt>
   <dd><p>The identifier
   <span title="escape an identifier">escaped</span>.</p></dd>

   <dt>&lt;integer></dt>
   <dd><p>A base-ten integer using digits 0-9 (U+0030 to U+0039) in the
   shortest form possible, preceded by a "<code>-</code>" (U+002D) if it is
   negative.</p></dd>

   <dt>&lt;length></dt>
   <dd>
    <p>A length of zero is represented by the literal string
    "<code>0px</code>".</p>

    <p>Absolute lengths: the number of millimeters serialized as per
    &lt;number> followed by the literal string "<code>mm</code>".
    <span class=XXX>Rumor has it absolute lengths will become relative
    lengths. If not, change to centimeters?</p>

    <p>Relative lengths: the &lt;number> component serialized as per
    &lt;number> followed by the unit in its canonical form as defined in its
    respective specification.</p>
   </dd>

   <dt>&lt;number></dt>
   <dd><p class=XXX>Browsers seem to use ToString(), but that might give a
   significand which according to some is teh evil (and also currently does
   not parse correctly).</p></dd>

   <dt>&lt;percentage></dt>
   <dd><p>The &lt;number> component serialized as per &lt;number> followed
   by the literal string "<code>%</code>" (U+0025).</p></dd>

   <dt>&lt;resolution></dt>
   <dd><p>The resolution in dots per centimeter serialized as per
   &lt;number> followed by the literal string "<code>dpcm</code>".</dd>

   <dt>&lt;string></dt>
   <dd><p>A literal '<code>"</code>' (U+0022), followed by the 
   <span title="escape a string">escaped</span> string value, followed by a
   literal '<code>"</code>' (U+0022).</p></dd>

   <dt>&lt;time></dt>
   <dd><p>The time in seconds serialized as per &lt;number> followed by
   the literal string "<code>s</code>".</dd>
   
   <dt>&lt;uri></dt>
   <dd><p>The literal string '<code title="">url("</code>', followed by the
   <span title="escape a string">escaped</span> <span>absolute URL</span>,
   followed by the literal string '<code>")</code>'.</p></dd>
  </dl>

  <p>To <dfn>escape a character</dfn> means to create a string of
  "<code>\</code>" (U+005C), followed by the character.</p>

  <p>To <dfn>escape a character as code point</dfn> means to create a string
  of "<code>\</code>" (U+005C), followed by the Unicode code point as the
  smallest possible number of hexadecimal digits in the range 0-9 a-f
  (U+0030 to U+0039 and U+0061 to U+0066) to represent the code point in
  base 16, followed by a space (U+0020).</p>

  <p>To <dfn>escape an identifier</dfn> means to create a string represented
  by the concatenation of, for each character of the identifier:</p>
  
  <ul>
   <li>If the character is in the range U+0000 to U+001F, the character
   <span title="escape a character as code point">escaped as code point</span>.</li>
   <li>If the character is the first character and is in the range 0-9
   (U+0030 to U+0039), the character
   <span title="escape a character as code point">escaped as code point</span>.</li>
   <li>If the character is the second character and is in the range 0-9
   (U+0030 to U+0039) and the first character is a "<code>-</code>"
   (U+002D), the character
   <span title="escape a character as code point">escaped as code point</span>.</li>
   <li>If the character is the second character and is "<code>-</code>"
   (U+002D) and the first character is "<code>-</code>" too, the
   <span title="escape a character">escaped</span> character.</li>
   <li>If the character is not handled by one of the above rules and is
   greater than or equal to U+0080, is "<code>-</code>" (U+002D) or
   "<code>_</code>" (U+005F), or is in one of the ranges 0-9 (U+0030 to
   U+0039), A-Z (U+0041 to U+005A), or a-z (U+0061 to U+007A), the character
   itself.</li>
   <li>Otherwise, the <span title="escape a character">escaped</span>
   character.</li>
  </ul>

  <p>To <dfn>escape a string</dfn> means to create a string represented by
  the concatenation of, for each character of the given string:</p>
  
  <ul>
   <li>If the character is in the range U+0000 to U+001F, the character
   <span title="escape a character as code point">escaped as code point</span>.</li>
   <li>If the character is '<code>"</code>' (U+0022) or '<code>\</code>'
   (U+005C), the <span title="escape a character">escaped</span> character.</li>
   <li>Otherwise, the character itself.</li>
  </ul>
  
  <p class="note">"<code>'</code>" (U+0027) is not escaped because strings
  are always serialized with '<code>"</code>' (U+0022).</p>
  
  <!--
  <ol>
   <li><p>Relative lengths (<code>em</code>, <code>ex</code>, <code>px</code>,
   all the font-size keywords and <code>%</code>) do not have their units
   changed. However, absolute lengths must be given in millimeters. For example,
   the canonical version of <code>+012.0pt</code> is <code>4.2333mm</code> (give
   or take a few significant figures). <span class="note"><em>Computed</em>
   values may well be in different units than the specified value. User agents
   are to use <code>px</code> as their final units for computed length
   values.</span></p></li>

   <li><p>When a <code>&lt;length></code> of zero is given change it to
   "<code>0px</code>"</p></li>
   
   <li>
    <p>A <code>&lt;color></code> value is canonicalized as follows:</p>

    <dl>
     <dt>It is a system color</dt>

     <dd>See below (you use the representation given in the specification that
     defines the keyword).</dd>

     <dt>Alpha component is equal to 1.0</dt>

     <dd>The color is an uppercase six-digit hexadecimal value, prefixed with a
     <code>#</code> character (U+0023 NUMBER SIGN), with the first two digits
     representing the red component, the next two digits representing the green
     component, and the last two digits representing the blue component, the
     digits being in the range 0-9 A-F (U+0030 to U+0039 and U+0041 to
     U+0046).</dd>

     <dt>Alpha component is less than 1.0</dt>

     <dd>The color is in the CSS <code>rgba()</code> functional-notation format:
     the literal string <code>rgba</code> (U+0072 U+0067 U+0062 U+0061) followed
     by a U+0028 LEFT PARENTHESIS, a <span>color component integer</span>
     representing the red component, a <span>color component separator</span>, a
     <span>color component integer</span> for the green component, a <span>color
     component separator</span>, a <span>color component integer</span> for the
     blue component, another <span>color component separator</span> a U+0030
     DIGIT ZERO, a U+002E FULL STOP (representing the decimal point), one or
     more digits in the range 0-9 (U+0030 to U+0039) representing the fractional
     part of the alpha value, and finally a U+0029 RIGHT PARENTHESIS.</dd>

     <dt>The keyword <code>transparent</code> is used</dt>

     <dd>The color is <code>rgba(0, 0, 0, 0)</code>.</dd>
    </dl>
   </li>
   
   <li><p>Angles are canonicalized to <code>deg</code> and normalized to the
   range of their property. For example, <code>azimuth: 700grad</code> would be
   canonicalized to <code>azimuth: 270deg</code>. This also applies to angle
   keywords as used in the <code>elevation</code> and <code>azimuth</code>
   properties, they are canonicalized to their value in degrees.</p></li>
   
   <li><p>Times are canonicalized to seconds (<code>s</code>).</p></li>
   
   <li><p>Frequencies are canonicalized to Hertz (<code>Hz</code>).</p></li>
   
   <li><p>For all integers and real numbers, including those with units, these
   canonicalization steps <em class="ct">must</em> be followed: If the number
   is <code>0</code>, the canonical result is the literal string <code>0</code>
   plus any units (for lengths, the unit identifier will have been removed
   before this step). Otherwise, leading <!- -and trailing - ->zeros
   <em class="ct">must</em> be omitted, any leading <code>+</code>
   <em class="ct">must</em> be omitted, the decimal point in a real number
   <em class="ct">must</em> be omitted unless there is a fractional part, and if
   the number is in the range <code>-1 &lt; <var>x</var> &lt; 1</code>, then one
   leading <code>0</code> <em class="ct">must</em> be inserted before the
   decimal point. The number of given significant figures is completely user
   agent dependent.</p></li>
   
   <li><p>Where multiple values may appear in any order without changing the
   meaning of the value (typically represented by a double bar <code>||</code>
   in the value syntax), user agents are to use the canonical order as given in
   the syntax (e.g. <code>&lt;border-width> &lt;border-style> &lt;color></code>
   for the <code>border</code> short-hand property).</p></li>
   
   <li><p>When repeated values may be omitted without changing the meaning of
   the value (e.g. as in the <code>margin</code> and <code>padding</code>
   properties), then the fewest number of values should be given.</p></li>
   
   <li><p>If whitespace may be removed without changing the meaning of the value
   it is to be removed.</p></li>
   
   <li><p><code>&lt;specific-voice></code> and <code>&lt;family-name</code>
   values are to be quoted.</p></li>
   
   <li><p>Double quotes (rather than single quotes) <em class="ct">shall</em> be
   used for string quotation. (When changing from single quotes to double
   quotes, double quotes already in the string are escaped.)</p></li>
   
   <li><p>The quotes in the <code>&lt;uri></code> form should be removed.
   (Parenthesises that were in the string, along with any other characters not
   legal when the string is not quoted (such as commas), must be
   escaped.)</p></li>
   
   <li><p>Unnecessary escapes should be removed. (For example, <code>\z</code>
   should be represented as <code>z</code>. This extends to unescaping UNICODE
   escapes, except, of course, if the encoding cannot contain those
   characters!)</p></li>
   
   <li><p>Where components of the value may be dropped without changing the
   meaning of the value (for example, initial values in shorthand properties),
   then they should be removed. If this would remove all the values, then the
   first allowed value must be given (For example, for <code>background</code>
   that would be <code>rgba(0, 0, 0, 0)</code> since
   <code>background-color</code> is the first component of the value; for
   <code>border</code> it would be <code>0</code> since the first component of
   that value is <code>border-width</code>).</p></li>
   
   <li>
    <p>A single space should be added after each comma that is not part of a
     string, except where that would change the meaning of the value. For
     example:</p>
    
    <pre>foo,bar,baz</pre>
    
    <p>should become:</p>
    
    <pre>foo, bar, baz</pre>
   </li>
   
   <li>
    <p>Whenever case is insensitive, for example in property or counter names,
     the text should be changed to the canonical case as given in the syntax
     definition. For example, the canonical value of:</p>
    
    <pre>COUNTER( PAR-NUM,UPPER-ROMAN ) DISC</pre>
    
    <p>is:</p>
    
    <pre>counter(par-num, upper-roman) disc</pre>
    
    <p>but the color <code>WINDOWTEXT</code> becomes
    <code>WindowText</code>.</p>
   </li>
  </ol>
  -->

  <h5>Examples</h5>

  <p>Here are some examples of before and after results on specified values.
  The before column could be what the author wrote in a style sheet, while
  the after column shows what querying the DOM would return.</p>

  <div class="example">
   <table>
    <thead>
     <tr><th>Before<th>After
    <tbody>
     <tr><td><code>background: none</code><td><code>background: rgba(0, 0, 0, 0)</code>
     <tr><td><code>outline: none</code><td><code>outline: invert</code>
     <tr><td><code>border: none</code><td><code>border: medium</code>
     <tr><td><code>list-style: none</code><td><code>list-style: disc</code>
     <tr><td><code>margin: 0 1px 1px 1px</code><td><code>margin: 0px 1px 1px</code>
     <tr><td><code>azimuth: behind left</code><td><code>azimuth: 220deg</code>
     <tr><td><code>font-family: a, 'b"', serif</code><td><code>font-family: "a", "b\"", serif</code>
     <tr><td><code>content: url('h)i') '\[\]'</code><td><code>content: url(h\)i) "[]"</code>
     <tr><td><code>azimuth: leftwards</code><td><code>azimuth: leftwards</code>
     <tr><td><code>color: rgb(18, 52, 86)</code><td><code>color: #123456</code>
     <tr><td><code>color: rgba(000001, 0, 0, 1)</code><td><code>color: #000000</code>
   </table>
  </div>




  <h2>DOM Access to CSS Declaration Blocks</h2>

  <h3>The <code>ElementCSSInlineStyle</code> Interface</h3>

  <pre class="idl">interface <dfn>ElementCSSInlineStyle</dfn> {
  readonly attribute <span>CSSStyleDeclaration</span> <span>style</span>;
};</pre>

  <p class="XXX">...</p>





  <h3>The <code title="">ViewCSS</code> Interface</h3>

  <p>Objects implementing the <code>Window</code> interface
  <em class="ct">must</em> also implement the <code>ViewCSS</code>
  interface.</p>

  <!-- XXX need to define the "resolved style" for each property
           define the serialized value for types of CSS values
           define mapping between properties and types of CSS values?
  -->

  <pre class="idl">interface <dfn>ViewCSS</dfn> {
  <span>CSSStyleDeclaration</span> <span>getComputedStyle</span>(Element <var title="">elt</var>);
  <span>CSSStyleDeclaration</span> <span>getComputedStyle</span>(Element <var title="">elt</var>, DOMString <var title="">pseudoElt</var>);
};</pre>

  <p>The
  <dfn id="viewcss-getcomputedstyle"><code>getComputedStyle</code></dfn>
  method <em class="ct">must</em> return a live
  <code>CSSStyleDeclaration</code> object that contains the computed style
  declaration block for <var title="">elt</var>, when the
  <var title="">pseudoElt</var> argument is <code>null</code>, the empty string
  or omitted. Otherwise, for the pseudo-element <var title="">pseudoElt</var>
  of <var title="">elt</var>.</p>

  <!-- XXX -->



  <h2>Resolved Values</h2>

  <p><code>getComputedStyle()</code> was historically defined to return the
  "computed value" of an element or pseudo-element. However, the concept of
  "computed value" changed between revisions of CSS while the implementation
  of <code>getComputedStyle()</code> had to remain the same for
  compatibility with deployed scripts. To address this issue this
  specification introduces the concept of a <dfn>resolved value</dfn>.</p>

  <p>Since CSS specifications never included the concept of
  <span>resolved value</span> this specification attempts to define it for
  the properties defined in CSS 2.1.</p>

  <p>The <span>resolved value</span> for a given property can be determined
  as follows:</p>
  
  <dl>
   <dt>'<code>background</code>'
   <dt>'<code>border</code>'
   <dt>'<code>border-collapse</code>'
   <dt>'<code>border-color</code>'
   <dt>'<code>border-spacing</code>'
   <dt>'<code>border-style</code>'
   <dt>'<code>border-top</code>'
   <dt>'<code>border-right</code>'
   <dt>'<code>border-bottom</code>'
   <dt>'<code>border-left</code>'
   <dt>'<code>border-width</code>'
   <dt>'<code>font</code>'
   <dt>'<code>list-style</code>'
   <dt>'<code>margin</code>'
   <dt>'<code>outline</code>'
   <!-- overflow is not -->
   <dt>'<code>padding</code>'
   <dt>'<code>pause</code>'
   <dd><p>There is no <span>resolved value</span>.</p></dd>

   <dt>'<code>line-height</code>'</dt>
   <dd><p>The <span>resolved value</span> is the used value.</p></dd>
   
   <dt>'<code>height</code>'</dt>
   <dt>'<code>margin-bottom</code>'</dt>
   <dt>'<code>margin-left</code>'</dt>
   <dt>'<code>margin-right</code>'</dt>
   <dt>'<code>margin-top</code>'</dt>
   <dt>'<code>padding-bottom</code>'</dt>
   <dt>'<code>padding-left</code>'</dt>
   <dt>'<code>padding-right</code>'</dt>
   <dt>'<code>padding-top</code>'</dt>
   <dt>'<code>width</code>'</dt>
   <dd><p>If the property applies to the element or pseudo-element and the
   <span>resolved value</span> of the '<code>display</code>' property is not
   <code>none</code>, the <span>resolved value</span> is the
   <span>used value</span>. Otherwise the <span>resolved value</span> is the
   computed value.</p></dd>

   <dt>Any other property</dt>
   <dd><p>The <span>resolved value</span> is the computed value.</p></dd>
  </dl>
  

  <h2 id="iana-considerations">IANA Considerations</h2>

  <h3><dfn title="http-default-style"><code>Default-Style</code></dfn></h5> 

  <p>This section describes a header field for registration in the Permanent
  Message Header Field Registry.
  <!--<a href="XXX">[RFC3864]</a>--></p> 

  <dl>
   <dt>Header field name</dt> 
   <dd>Default-Style</dd> 
   <dt>Applicable protocol</dt> 
   <dd>http</dd> 
   <dt>Status</dt> 
   <dd>standard</dd> 
   <dt>Author/Change controller</dt> 
   <dd>W3C and WHATWG</dd> 
   <dt>Specification document(s)</dt> 
   <dd>This document is the relevant specification.</dd> 
   <dt>Related information</dt> 
   <dd>None.</dd>   
  </dl>




  <h2 class="no-num" id="references">References</h2>

  <p class="issue">This section will be done when going to Last Call. Before
  that state please ask the author whenever a reference is unclear.</p>


  <h2 class="no-num" id="acknowledgements">Acknowledgements</h2>

  <p>The editor would like to thank

  Alexey Feldgendler,
  Bjrn Hhrmann,
  Christian Krebs,
  Daniel Glazman,
  David Baron,
  <i>fantasai</i>,
  Hallvord R. M. Steen,
  Ian Hickson,
  Lachlan Hunt,
  Morten Stenshorne,
  Robert O'Callahan,
  Sjoerd Visscher,
  Simon Pieters,
  Sylvain Galineau, and
  Tarquin Wilton-Jones

  for contributing to this specification.</p>

  <p>Even more thanks to Ian Hickson for writing up the the initial version
  of the alternative style sheets API and canonicalization rules for CSS
  values.</p>

  <!-- XXX NOTES

  <style type=text/css;charset=utf-8> does create a StyleSheet in Firefox
  and Opera, but does not create a StyleSheet in IE. I prefer IE.

  <style type=TEXT/CSS> sets the style sheet type to text/css in Firefox and
  TEXT/CSS in Opera and IE. I prefer Firefox.

  <style> sets the style sheet location to the document location Firefox,
  the empty string in IE, and null in Opera. I prefer Opera

  <style media="x"> invokes .sheet.media.mediaText = "x"

  <style title=""> does not "have" a title

  .cascadedStyle that returns less keywords than currentStyle, no inherit,
  etc.
  
  Markup style: http://krijnhoetmer.nl/irc-logs/whatwg/20100204#l-529
  -->
 </body>
</html>

