<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>CSS Image Values and Replaced Content Module Level 3</title>
  <link rel="stylesheet" type="text/css" href="http://dev.w3.org/csswg/default.css">
  <link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED">
  <style type=text/css>
  p { text-indent: 0 !important; margin: .5em 0; }
  </style>
</head>

<body>

<div class="head">
	<!--logo-->

	<h1>CSS Image Values and Replaced Content Module Level 3</h1>

	<h2 class="no-num no-toc">[LONGSTATUS] [DATE]</h2>
	<dl>
		<dt>Latest Version:</dt>
		<dd><a href="http://dev.w3.org/csswg/css3-images/">http://dev.w3.org/csswg/css3-images/</a>

		<dt>Latest Published Version:</dt>
		<dd><a href="http://www.w3.org/TR/css3-images/">http://www.w3.org/TR/css3-images/</a></dd>

		<dt>Previous Version:</dt>
		<dd><a href="http://www.w3.org/TR/2011/WD-css3-images-20110217/">http://www.w3.org/TR/2011/WD-css3-images-20110217/</a></dd>
		<dd><a href="http://www.w3.org/TR/2009/WD-css3-images-20090723/">http://www.w3.org/TR/2009/WD-css3-images-20090723/</a></dd>

		<dt>Editor:</dt>
		<dd><a href="http://fantasai.inkedblade.net/contact">Elika J. Etemad</a> (Invited Expert)</dd>
		<dd><a href="http://www.xanthir.com/contact">Tab Atkins Jr.</a> (Google)</dd>
	</dl>
	<!--begin-copyright-->
	<p>[Here will be included the file "../copyright.inc"]</p>
	<!--end-copyright-->

	<hr title="Separator for header">
</div>

<!-- ====================================================================== -->

<h2 class="no-num no-toc" id="abstract">
Abstract</h2>

	<p>This CSS Image Values and Replaced Content module has two parts:
	First, it defines the syntax for <i>&lt;image></i> values in CSS.
	<i>&lt;image></i> values can be a single URI to an image, a list of
	URIs denoting a series of fallbacks, a reference to an element in the document, or
	gradients. Second, it defines properties used to control the
	interaction of replaced content and the CSS layout algorithms.
	These properties can affect the used image resolution for bitmaps,
	the replaced object's orientation, and whether and how to preserve
	the object's aspect ratio.</p>

<!-- ====================================================================== -->

<h2 class="no-num no-toc" id="status">
Status of this document</h2>
<!--status-->

<!-- ====================================================================== -->

<h2 class="no-num no-toc" id="contents">
Table of contents</h2>
<!--toc-->

<!-- ====================================================================== -->

<h2 id="intro">
Introduction</h2>

	<p><em>This section is non-normative.</em></p>

	<p>In CSS Levels 1 and 2, image values, such as those used in the
	'background-image' property, could only be given by a single URI
	value. This module introduces additional notations that allow a
	2D image to be given as a list of URIs denoting fallbacks, as a
	reference to an element in the document, and as a gradient.</p>

<!-- ====================================================================== -->

<h2 id="conformance">
Conformance</h2>

	<p>A document or implementation cannot conform to CSS Image Values & Replaced Content Level 3
	 alone, but can claim conformance to CSS Image Values & Replaced Content Level 3 if it satisfies
	 the conformance requirements in this specification when implementing CSS or
	 another host language that normatively references this specification.</p>

	<p>Conformance to CSS Image Values & Replaced Content Level 3 is defined for three classes:
	<dl>
		<dt><dfn>minimal</dfn></dt>
		<dd>A device that does not implement CSS Transitions, CSS Animations, nor 
		CSSOM may ignore the chapters on Serializing and Interpolating values for
		the purpose of claiming conformance.</dd>

		<dt><dfn>transition-capable</dfn></dt>
		<dd>A device that implements CSS Transitions or CSS Animations must conform
		to the <i>minimal</i> class, and additionally must implement the chapter 
		on Interpolation.</dd>

		<dt><dfn>CSSOM-capable</dfn></dt>
		<dd>A device that implements CSSOM must conform to the <i>minimal</i> class, 
		and additionally must implement the chapter on Serialization.</dd>
	</dl>

	<p>The conformance requirements are expressed with a combination of
	descriptive assertions and RFC 2119 terminology. The key words "MUST",
	"MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
	"RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
	document are to be interpreted as described in RFC 2119.
	However, for readability, these words do not appear in all uppercase
	letters in this specification. All of the text of this specification is
	normative except sections explicitly marked as non-normative, examples,
	and notes. [[!RFC2119]]</p>

	<p>Examples in this specification are introduced with the words "for example"
	or are set apart from the normative text with <code>class="example"</code>,
	like this:

	<div class="example">
		<p>This is an example of an informative example.</p>
	</div>

	<p>Informative notes begin with the word "Note" and are set apart from the
	normative text with <code>class="note"</code>, like this:

	<p class="note">Note, this is an informative note.</p>

<!-- ====================================================================== -->

<h2 id='resolution-units'>
Resolution Units: the &lt;resolution&gt; value type</h2>

	<p>This specification defines the following units as part of the <dfn>&lt;resolution></dfn>
	value type:</p>

	<dl>
		<dt><dfn>dpi</dfn></dt>
		<dd>dots per inch</dd>

		<dt><dfn>dpcm</dfn></dt>
		<dd>dots per centimeter</dd>

		<dt><dfn>dppx</dfn></dt> 
		<dd>dots per ''px'' unit</dd>
	</dl>

	<p>The &lt;resolution> unit represents the size of a single "dot" of an image.  For raster images,
	a dot is an image pixel.  A &lt;resolution> defines how many of these dots fit in a CSS 'in', 'cm', or 'px' so that 
	images can be sized accordingly. The default resolution of raster images in CSS is ''1dppx'', 
	which is equivalent to ''96dpi''.  The concept of "resolution" does not apply to vector image
	formats like SVG; generally, this means that any attempt to change the resolution of a vector
	image is simply meaningless.  Individual uses of the &lt;resolution> value define precisely
	what effects they have on raster and vector images.</p>

	<div class='example'>
		<p>Printers tend to have substantially higher resolution than computer monitors; due to this,
		an image that looks fine on the screen may look pixellated when printed out.  A
		&lt;resolution> may be used in the 'image-resolution' property to embed a high-resolution
		image into the document that maintains an appropriate size, ensuring attractive display
		both on screen and on paper:</p>

		<pre class='css'><code>
img.high-res {
	image-resolution: 300dpi;
}</code></pre>

		<p>With this set, an image meant to be 5 inches wide that was saved at 300dpi will actually
		display as 5 inches wide; without this set, the image would display as approximately 15.6 inches
		wide since the image is 15000 image pixels across, and by default there are 96 image pixels per
		inch.</p>
	</div>

<!-- ====================================================================== -->

<h2 id="image">
Image Values: the &lt;image> value type</h2>

	<p>The &lt;image> value type denotes a 2D image. It is defined as

	<pre class="prod"><dfn>&lt;image></dfn> = &lt;url> | &lt;image-list> | &lt;element-reference> | &lt;image-combination> | &lt;gradient></pre>

	<p>Image values can be used in many CSS properties, including the
	'background-image', 'list-style-image', 'cursor' properties [[!CSS21]].

<!-- ====================================================================== -->

<h3 id="url">
Image References and Image Slices: the ''url()'' notation</h3>

	<p>The simplest way to indicate an image is to reference an image file
	by URI. This is done with the
	<a href="http://www.w3.org/TR/CSS21/syndata.html#uri">''url()'' notation</a>,
	defined in [[!CSS21]].

	<div class="example">
		<p>In the example below, a background image is specified with ''url()''
		syntax:</p>

		<pre>background-image: url(wavy.png);</pre>
	</div>

	<p>A portion of an image may be referenced (clipped out and used as a
	standalone image) by use of
	<a href="http://www.w3.org/TR/media-frags/#naming-space">media fragment identifiers</a>.
	[[!MEDIA-FRAGS]]

	<div class="example">
		<p>For example, given the following image* and CSS:</p>

		<a href="sprites.svg">
			<img src="sprites.svg" height="20" width="180" alt="[9 circles, with 0 to 8 eighths filled in]">
		</a>

		<pre>background-image: url('sprites.svg#xywh=40,0,20,20')</pre>

		<p>...the background of the element will be the portion of the image that starts at (40px,0px)
		and is 20px wide and tall, which is just the circle with a quarter filled in.</p>

		<p><small>* SVG-in-&lt;img> support required.  Click the picture to view the SVG directly.</small></p>
	</div>
	
	<p class="note">Note however that a UA that doesn't understand the media
	fragments notation will display the entirety an image specified with ''url''.
	However, since URLs with media fragment identifiers can also be used in the
	''image()'' notation defined below, authors can take advantage of CSS's
	forward-compatible parsing rules to provide a fallback when using an image
	fragment URL:

	<div class="example">
		<p>In the example below, the ''image()'' notation is used together with
		the media fragment syntax, so that UAs that don't support media fragments
		fail to parse the second declaration and use the first.</p>

		<pre>
<!-- -->background-image: url('swirl.png'); /* old UAs */
<!-- -->background-image: image('sprites.png#xywh=10,30,60,20'); /* new UAs */</pre>
	</div>

<!-- ====================================================================== -->

<h3 id="image-notation">
Image Annotations and Fallbacks: the ''image()'' notation</h3>

	<p>The ''image()'' notation allows an author to tag an image with a few types
	of useful processing instructions which can affect the rendering of the image
	and to declare fallback images to be used if the original image can't be
	decoded or is a type that the browser doesn't recognize.
	The author can specify the desired resolution the image should be rendered at,
	declare the directionality of an image so that it can be automatically be 
	reversed if used in text with a different directionality.</p>

	<p>So that authors can take advantage of CSS's forwards-compatible parsing
	rules to provide a fallback for image slices, implementations that support
	the ''image()'' notation <em>must</em> support the <code>xywh=#,#,#,#</code>
	form of media fragment identifiers for images. [[!MEDIA-FRAGS]]

	<p>The ''image()'' notation is defined as:

	<pre class='prod'><dfn>&lt;image-list></dfn> = 
	image( [ &lt;image-decl> , ]* [ &lt;image-decl> | &lt;color> ] )</pre>

	<p>where &lt;image-decl> is given by:</p>

	<pre class='prod'><dfn>&lt;image-decl></dfn> = 
	&lt;string> [ [ snap? && &lt;resolution> ] || [ ltr | rtl ] ]</pre>

	<p>Each <i>&lt;image-decl></i> represents the external image referenced
	by the URI given as the &lt;string> argument.</p>

	<p>If the image is a raster image and a &lt;resolution> is given, the image 
	must be rendered at that resolution.
	<span class='note'>Recall that the default resolution of raster images is ''1dppx'',
	so that one image pixel corresponds to one CSS ''px'' unit.</span>  If the 
	''snap'' keyword is also specified, and the specified resolution would make 
	one image pixel larger than one device pixel, the image must be rendered at 
	the specified resolution, rounded to the nearest value that would map one image 
	pixel to an integer number of device pixels; if the specified resolution would 
	make one image pixel smaller than one device pixel, the image must be rendered 
	at the specified resolution, rounded to the nearest value that would map an 
	integer number of image pixels to one device pixel.  If the image is a vector 
	image, specifying a resolution has no effect.</p>

	<p>If a directional keyword (''ltr'' or ''rtl'') is given, the image itself
	gains that directionality.  If the image is used in a property on an element
	with opposite directionality, is must be mirrored in the inline dimension
	when rendered.</p>

	<p>Multiple arguments can be given separated by commas, in which case the
	function represents the first &lt;image-decl> representing an image that
	the browser can successfully load and display.  The final argument can specify
	a &lt;color> to serve as an ultimate fallback; this can be used, e.g. for
	'background-image', to ensure adequate contrast if none of the preceding 
	&lt;image-decl>s can be used. If the final argument is a &lt;color>, it 
	represents a solid-color image of the given color with no <i>intrinsic
	dimensions</i>.

	<div class="example">
		<p>The rule below would tell the UA to load ''wavy.svg'' if
		it can; failing that to load ''wavy.png'' and display it at 150dpi;
		failing that to display ''wavy.gif''; and finally, if none of the images
		can be loaded and displayed, to use the color ''rgba(0,0,255,0.5)'' to create a
		dimensionless background image.  For example, the browser might not understand
		how to render SVG images, the PNG may be malformed, and the GIF might not 
		exist on the server and return 404 error instead of an image.</p>

		<pre>background-image: image(url(wavy.svg), 'wavy.png' 150dpi, "wavy.gif", rgba(0,0,255,0.5));</pre>

		<p>The 'background-size' property specifies that dimensionless images
		by default stretch to cover the entire background positioning area
		[[CSS3BG]], so if none of the specified images can be displayed
		the background will be painted semi-transparent blue. As with any image,
		this fallback will be painted over the 'background-color' (if any).</p>
	</div>

<!-- ====================================================================== -->

<h3 id='element-reference'>
Using Elements as Images: the ''element()'' notation</h3>

	<p>The ''element()'' function allows an author to reference an element in
	the document that should be used as an image.  As the referenced element 
	changes, for example, by the user typing into a &lt;textarea> element or 
	a script drawing into a &lt;canvas> element in HTML, the image produced by 
	the ''element()'' function stays in sync, allowing dynamic effects such as 
	script-animated background images or previews of the next slide in a slideshow.  
	The syntax for ''element()'' is defined as:</p>

	<pre class=prod><dfn>&lt;element-reference></dfn> = element( [&lt;id-selector> | &lt;identifier> ] )</pre>

	<p>where &lt;id-selector> is an ID selector [[!SELECT]], and &lt;identifier> 
	is an identifer [[!CSS3VAL]].</p>

	<p>If the argument to the ''element()'' function is an ID selector, the 
	function references the element matched by the selector.  If it's an identifier, 
	the function references the element whose <dfn>CSS element reference identifier</dfn> 
	is the given identifier.  (CSS does not define how an element acquires a 
	<i>CSS element reference identifier</i>; that is determined by the host language.)  
	If no element in the document matches the selector, or no element has the 
	identifier as its <i>CSS element reference identifier</i>, the function 
	represents a fully transparent image with no intrinsic dimensions, equivalent 
	to <code>image(transparent)</code>.  If the document changes so that which 
	element is matched, or whether an element is matched at all, changes, the 
	image represented by the function must change accordingly.</p>

	<p>If the ''element()'' function refers to an element, then it represents 
	an image with width and height equal to the width and height of the margin 
	box of the referenced element.  The image must be constructed by rendering 
	the referenced element and its descendants at the same size that the element 
	would be in its document, over an infinite transparent black background, 
	positioned so that the edges of the margin box of the element is flush with 
	the edges of the image.  <span class=note>If the element has decorations 
	or descendants that extend outside the margin box, these will be clipped 
	to the margin box in the generated image by default.  ''background-repeat:extend'' 
	may allow the author to override this behavior so that decorations and 
	descendants outside the margin box are still painted.</span>  If the 
	referenced element or an ancestor of the referenced element has a transform 
	applied to it, the transform must be ignored for the purpose of constructing 
	this image (transforms on descendants must be unaffected).</p>

	<p>If the argument passed to ''element()'' isn't an ID selector or an ident, 
	it is a syntax error.</p>

	<p>Implementations may either re-use existing bitmap data generated for the 
	referenced element or regenerate the display of the element to maximize quality 
	at the image's size (for example, if the implementation detects that the referenced 
	element is an SVG fragment); in the latter case, the layout of the referenced 
	element in the image must not be changed by the regeneration process.  That is, 
	the image must look identical to the referenced element, modulo rasterization 
	quality.</p>

	<div class=example>
		TODO: copy an example from the MozHacks article
	</div>

<!-- ====================================================================== -->

<h4 class="no-num no-toc" id='element-cycles'>
Detecting and Resolving Circular Relationships Introduced by ''element()''</h4>

	<p>The ''element()'' function can produce nonsensical circular relationships, 
	such as an element using itself as its own background.  These relationships 
	can be easily and reliably detected and resolved, however, by keeping 
	track of a dependency graph and using common cycle-detection algorithms.</p>

	<p>Populate the dependency graph initially by having every element depend 
	on each of its children.  Then, whenever a property on an element A uses 
	the ''element()'' function to refer to an element B, add an edge to the 
	graph by having A depend on B.  If a dependency cycle is detected, any 
	''element()'' functions that produced a dependency in the cycle represent 
	a fully transparent image with no intrinsic dimensions.</p>

	<p class=issue>Someone else needs to review this and make sure that I'm 
	not missing any cycles.</p>
</div>

<!-- ====================================================================== -->

<h3 id='cross-fade-function'>
Combining images: the ''cross-fade()'' notation</h3>

	<p>When transitioning between images, CSS requires a way to explicitly refer 
	to the intermediate image that is a combination of the start and end images.  
	This is accomplished with the ''cross-fade()'' function, which indicates 
	the two images to be combined and how far along in the transition the 
	combination is.

	<p class="note">Authors can also use the ''cross-fade()'' function for many 
	simple image manipulations, such as tinting an image with a solid color or 
	highlighting a particular area of the page by combining an image with a 
	radial gradient.

	<p>The syntax for ''cross-fade()'' is defined as:</p>

	<pre class=prod><dfn>&lt;image-combination></dfn> = cross-fade( &lt;image>, &lt;image>, &lt;percentage> )</pre>

	<p>The function represents an image generated by combining the first and 
	second image (referred to in this section as the "start" and "end" images, 
	respectively).  The percentage represents how far along the transformation 
	is, with 0% representing the start image, 100% representing the end image, 
	and percentages between that representing corresponding combinations of the 
	two images.  The <code>&lt;percentage></code> must be between 0% and 100% inclusive;
	any other value is invalid.</p>

	<p>More precisely, given ''cross-fade(A,B,p)'', where <var>A</var> and <var>B</var>
	are images and <var>p</var> is a percentage between 0% and 100%, the function represents
	an image with width equal to 
	<code>width<sub>A</sub> &times; (1-<var>p</var>) + width<sub>B</sub> &times; p</code>
	and height equal to
	<code>height<sub>A</sub> &times; (1-<var>p</var>) + height<sub>B</sub> &times; p</code>.
	The contents of the image must be constructed by first scaling <var>A</var> and <var>B</var> to the size of the 
	generated image, then applying
	<code>dissolve(<var>A</var>,1-<var>p</var>) plus dissolve(<var>B</var>,<var>p</var>)</code>.
	<span class='note'>The "dissolve()" function and "plus" compositing operator are defined
	in the literature by Porter-Duff.</span></p>

<!-- ====================================================================== -->

<h2 id="gradients">
Gradients</h2>

	<p>A gradient is an image that smoothly fades from one color to another.  These 
	are commonly used for subtle shading in background images, buttons, and many 
	other things.  The two functions described in this section allow an author to 
	specify such an image in a terse syntax, so that the UA can generate the image 
	automatically when rendering the page.  Gradients are a type of image, and can 
	be used anywhere an image can, such as in the 'background-image' or 
	'list-style-image' properties.  Gradients have no <i>intrinsic dimensions</i>.
	The syntax of a <i>&lt;gradient></i> is:</p>

	<pre class=prod><dfn>&lt;gradient></dfn> = [ &lt;linear-gradient> | &lt;radial-gradient> | &lt;repeating-linear-gradient> | &lt;repeating-radial-gradient> ]</pre>

	<p>where <i>&lt;linear-gradient></i>, <i>&lt;radial-gradient></i>,
	<i>&lt;repeating-linear-gradient></i>, and <i>&lt;repeating-radial-gradient></i> are 
	defined in their applicable sections below.</p>

	<div class=example>
		<p>As with the other <i>&lt;image></i> types defined in this specification, 
		gradients can be used in any property that accepts images.  For example:</p>
		<ul>
			<li><code>background: linear-gradient(white, gray);</code></li>
			<li><code>list-style-image: radial-gradient(circle, #006, #00a 90%, #0000af 100%, white 100%)</code></li>
		</ul>
	</div>

	<p class=note>In many places this section references a box, such as "the box's 
	top-left corner" or "the box's right side".  In all of these circumstances, 
	the "box" refers to a rectangle with the dimensions of the <i>concrete object size</i>. 
	 A gradient has no intrinsic dimensions.  This means that, for example, if you use a gradient in the 
	'background-image' property (with 'background-size' at the default value and 'background-repeat'
	not equal to 'round'), the "box" will simply be the size of the background sizing 
	area.  If you use a gradient in a list-style-image, the "box" will be a 1em 
	square.</p>

<!-- ====================================================================== -->

<h3 id='linear-gradients'>
Linear Gradients</h3>

	<p>A linear gradient is created by specifying a gradient-line and then several 
	colors placed along that line.  The image is constructed by creating an 
	infinite canvas and painting it with lines perdendicular to the gradient-line, 
	with the color of the painted line being the color of the gradient-line 
	where the two intersect.  This produces a smooth fade from each color to 
	the next, progressing in the specified direction.</p>

<!-- ====================================================================== -->

<h4 class='no-toc' id='linear-gradient-syntax'>
linear-gradient() syntax</h4>

	<pre class=prod><code><dfn>&lt;linear-gradient></dfn> = linear-gradient(
	[[ 
		[ [top | bottom] || [left | right] ] 
		| 
		&lt;angle>
	],]? 
	&lt;color-stop>[, &lt;color-stop>]+
	);</code></pre>

	<p>The first argument to the function specifies the <dfn>gradient-line</dfn>, 
	which gives the gradient a direction and determines how color-stops are 
	positioned.  It may be omitted; if so, it defaults to ''top''.</p>

	<p>The <i>gradient-line</i> may be specified in two different ways.  The 
	first is by specifying the angle the <i>gradient-line</i> should assume; 
	for the purposes of this property, 0deg points upwards, 90deg points toward
	the right, and positive angles go clockwise.  
	The starting-point and ending-point of the <i>gradient-line</i> are 
	determined by extending a line in both direction from the center of the 
	box at the angle specified.  In the direction of the angle, the ending-point 
	is the point on the <i>gradient-line</i> where a line drawn perpendicular 
	to the <i>gradient-line</i> would intersect the corner of the box in that 
	direction.  The starting-point is determined identically, except in the 
	opposite direction of the angle.</p>

	<p>The second way is to simply provide a side or corner of the box that 
	the gradient should start at; the gradient will then automatically angle 
	itself to extend from the specified side or corner to the opposite side 
	or corner in a straight line.  To be precise, the gradient is converted 
	to the angle form described in the previous paragraph at used-value time.  
	If a ''top'', ''right'', ''bottom'', or ''left'' is given, the used value 
	of the gradient is 180deg, 270deg, 0deg, or 90deg, respectively.  If 
	a corner is given, the used value of the gradient is the angle necessary 
	to place the starting-point of the gradient in that corner of the box.</p>

	<div class=example>
		<div style="overflow: hidden">
			<img style="float: right; margin-left: 1em;" src='gradient-diagram.png' alt="[An image showing a box with a background shading gradually from white in the bottom-left corner to black in the top-right corner.  There is a line, illustrating the gradient-line, angled at 45 degrees and passing through the center of the box.  The starting-point and ending-point of the gradient-line are indicated by the intersection of the gradient-line with two additional lines that pass through the bottom-left and top-right corners of the box.]">
			<p>This example illustrates visually how to calculate the 
			<i>gradient-line</i> from the rules above.  This shows the starting 
			and ending-point of the <i>gradient-line</i>, along with the actual 
			gradient, produced by an element with 
			''background: linear-gradient(45deg, white, black);''.</p>
			<p>Notice how, though the starting-point and ending-point are outside 
			of the box, they're positioned precisely right so that the gradient 
			is pure white <em>exactly</em> at the corner, and pure black 
			<em>exactly</em> at the opposite corner.  That's intentional, and 
			will always be true for linear gradients.</p>
		</div>
	</div>

	<p>The gradient's color stops are typically placed between the starting-point 
	and ending-point on the <i>gradient-line</i>, but this isn't required - the 
	<i>gradient-line</i> extends infinitely in both directions.  The starting-point 
	and ending-point are merely arbitrary distance markers - the starting-point 
	defines where 0%, 0px, etc are located when specifying color-stops, and 
	the ending-point defines where 100% is located.  Color-stops are allowed 
	to have positions before 0% or after 100%.</p>

<!-- ====================================================================== -->

<h4 class='no-toc' id='linear-gradient-examples'>
Linear Gradient Examples</h4>

	<p>All of the following ''linear-gradient()'' examples are presumed to be 
	backgrounds applied to a box that is 200px wide and 100px tall.</p>

	<div class=example>	
		<p>Below are various ways of specifying a basic vertical gradient:</p>

		<pre><code>linear-gradient(yellow, blue);
linear-gradient(top, yellow, blue);
linear-gradient(180deg, yellow, blue);
linear-gradient(bottom, blue, yellow);
linear-gradient(top, yellow 0%, blue 100%);</code></pre>

		<p><img src="linear1.png" alt="" ></p>
	</div>

	<div class=example>	
		<p>This gradient goes from the upper-left to the lower-right corner.</p>

		<pre><code>linear-gradient(top left, yellow, blue);</code></pre>

		<p><img src="linear2.png" alt="" ></p>
	</div>

	<div class=example>	
		<p>This demonstrates the use of an angle in the gradient.  Compare this 
		image with the previous example.  In both gradients, the top-left of the 
		box is pure yellow, and the bottom-right of the box is pure blue.  The 
		difference is in the angle that the gradient follows.</p>

		<pre><code>linear-gradient(135deg, yellow, blue);
linear-gradient(-45deg, blue, yellow);</code></pre>

		<p><img src="linear3.png" alt="" ></p>
	</div>

	<div class=example>	
		<p>This demonstrates a 3-color gradient, and how to specify the location of a stop explicitly:</p>

		<pre><code>linear-gradient(yellow, blue 20%, #0f0);</code></pre>

		<p><img src="linear4.png" alt="" ></p>
	</div>

<!-- ====================================================================== -->

<h3 id='radial-gradients'>
Radial Gradients</h3>

	<p>In a radial gradient, rather than colors smoothly fading from one side 
	of the box to the other as with linear gradients, they instead emerge from 
	a single point and smoothly spread outward in a circular or elliptical shape.</p>

	<p>A radial gradient is specified by first pinpointing the center of the 
	gradient, where the 0% ellipse will be, then specifying the size and shape 
	of the 100% ellipse, ending with a list of color-stops just like a linear-gradient.  
	Between the center and the ending-ellipse, and past the ending-ellipse, 
	concentric ellipses are drawn and colored according to the specified color-stops.</p>

<!-- ====================================================================== -->

<h4 class='no-toc' id='radial-gradient-syntax'>
radial-gradient() Syntax</h4>

	<pre class=prod>
<dfn>&lt;radial-gradient></dfn> = radial-gradient(
	[&lt;bg-position&gt;,]? 
	[[
		[&lt;shape&gt; || &lt;size&gt;]
		|
		[&lt;length> | &lt;percentage>]{2}
	],]? 
	&lt;color-stop&gt;[, &lt;color-stop&gt;]+
)
	</pre>

	<p>The first argument to the function specifies the center of the ellipse.  
	<i>&lt;bg-position></i> is taken from the Backgrounds and Borders Module, and 
	has the same definition.  It specifies the center of the gradient.  If omitted, 
	it defaults to ''center''.  Color-stop positions are measured along an 
	imaginary line extending from the center of the gradient to the right.</p>

	<p>The second argument to the function specifies the size and shape of the 
	ending-ellipse.  This can be specified in two ways, with different characteristics:</p>

	<dl>
		<dt>Implicitly</dt>
		<dd>
			<p>The size and shape of the ending-ellipse can be defined 
			<em>implicitly</em> with a size and shape keyword.  The <i>&lt;shape></i> 
			is defined as </p>

			<pre><code><dfn>&lt;shape></dfn> = [ circle | ellipse ]</code></pre>

			<p>''circle'' indicates that the ending-ellipse will be a circle with 
			a constant radius.  ''ellipse'' indicates that the gradient-shape 
			will be an axis-aligned ellipse (that is, its major and minor radiuses 
			will be horizontal and vertical, not necessarily in that order).</p>

			<p>The <i>&lt;size></i> keyword is defined as </p>

			<pre><code><dfn>&lt;size></dfn> = [ closest-side | closest-corner | farthest-side | farthest-corner | contain | cover ]</code></pre>

			<p>If <i>&lt;shape></i> is ''circle'' and <i>&lt;size></i> is ''closest-side'', 
			the ending-shape is a circle sized so that it exactly meets the side 
			of the box closest to its center.  For example, if the box was 100px 
			wide and 200px tall, and the center of the gradient was ''10% 10%'', 
			then the closest side is the left side of the box (it is 10px from 
			the starting-point, while the top is 20px from it, and the right and 
			bottom sides are much further).  The gradient-shape would thus be a 
			circle with a radius of 10px.  If <i>&lt;shape></i> is ''ellipse'' and 
			<i>&lt;size></i> is ''closest-side'', the gradient-shape is an ellipse 
			sized so that it exactly meets the vertical and horizontal sides of 
			the box closest to its center.  Using the same box and starting-point 
			as the previous example, the gradient-shape would be an ellipse with 
			a 20px vertical radius and a 10px horizontal radius.  (If necessary, 
			such as if the starting-point is outside of the box, extend the sides 
			of the box so that there is a line the ellipse can meet.)</p>

			<p>''farthest-side'' is identical to ''closest-side'', except that 
			the gradient-shape is sized to meet the side of the box that is farthest 
			from its center (or the farthest vertical and horizontal sides, if 
			the shape is ''ellipse'').  ''closest-corner'' and ''farthest-corner'' 
			size the gradient-shape so that it exactly meets the closest or farthest 
			corner of the box from its center, respectively.  If <i>&lt;shape></i>
			is ''ellipse'', the gradient-shape has the same ratio of width to height 
			that it would if ''closest-side'' or ''farthest-side'' were specified, 
			as appropriate.  ''contain'' is a synonym for ''closest-side'', and 
			''cover'' is a synonym for ''farthest-corner''.</p>

			<p>If this implicit form is used, then it is converted to an equivalent 
			explicit form (described below) at used-value time.</p>
		</dd>

		<dt>Explicitly</dt>
		<dd>
			<p>Alternately, the ending-shape's size and shape can be defined 
			explicitly, by providing two lengths or percentages.  These measure 
			the length of the horizontal and vertical axes of the ellipse, 
			respectively.  (The axis length is the length from the center of the 
			ellipse to the edge, similar to the radius of a circle, not the 
			diameter.)</p>

			<p>Percentages used in the first value are relative to the width of 
			the box, while percentages used in the second value are relative to 
			the height of the box.</p>

			<p>Both of the values must be positive - specifying either as zero 
			or negative is a syntax error.</p>
		</dd>
	</dt>

	<p>If this argument is omitted, it defaults to ''ellipse cover''.</p>

	<p>If only one argument is provided before the color-stops, and it could
	be interpreted as either a position or an explicit size (for example, in
	''radial-gradient(10% 10%, red, blue)''), it must be interpreted as a position.</p>

	<p>In certain circumstances the given parameters may define a degenerate 
	shape - a circle or ellipse with a radius of 0. In these instances the 
	gradient image is just a solid color equal to the color of the last color-stop 
	in the rule.  The following combinations of values will trigger this: 
	''closest-side'' if the starting-point is on a box edge, ''closest-corner'' 
	if the starting-point is on a box corner, and ''ellipse closest-corner'' 
	if the starting-point is on a box edge.</p>

	<p>Color-stops are placed on an imaginary line extending from the center 
	of the gradient toward the right, with the 0% point at the center of the 
	gradient, and 100% at the point where the line intersects the ending-ellipse.  
	The color of each ellipse is equal to the color of the line where the 
	ellipse intersects it.  Distances past 100% can be specified, and simply 
	indicate a color-stop placed on the line a corresponding distance from the 
	center.  Negative distances are allowed in a radial gradient and work the 
	same as in linear gradients with respect to setting the color of the 
	<i>gradient-line</i>, but colors before the starting-point of the <i>gradient-line</i> 
	are not displayed.  For example, ''radial-gradient(red -50px, yellow 100px)'' 
	would produce an elliptical gradient which starts with a reddish-orange color 
	in the center (the color 1/3 between red and yellow) and transitions to 
	yellow at 100px wide.</p>

<!-- ====================================================================== -->
	
<h4 class='no-toc' id='radial-gradient-examples'>
Radial Gradient Examples</h4>

	<p>All of the following examples are applied to a box that is 200px wide 
	and 100px tall.</p>

	<div class=example>	
		<p>These examples demonstrate the basic syntax for radial gradients:</p>

		<pre><code>radial-gradient(yellow, green);
radial-gradient(center, ellipse cover, yellow 0%, green 100%);
radial-gradient(50% 50%, farthest-corner, yellow, green);</code></pre>
		<p><img src="radial1.png" alt="" ></p>

		<pre><code>radial-gradient(circle, yellow, green);</code></pre>
		<p><img src="radial2.png" alt="" ></p>

		<pre><code>radial-gradient(red, yellow, green);</code></pre>
		<p><img src="radial3.png" alt="" ></p>
	</div>

	<div class=example>	
		<p>This image shows a gradient originating from somewhere other than the center of the box:</p>

		<pre><code>radial-gradient(bottom left, farthest-side, red, yellow 50px, green);</code></pre>
		<p><img src="radial4.png" alt="" ></p>
	</div>

	<div class=example>	
		<p>Here we illustrate a 'contain' gradient.</p>

		<pre><code>radial-gradient(20px 30px, contain, red, yellow, green);
radial-gradient(20px 30px, 20px 30px, red, yellow, green);</code></pre>
		<p><img src="radial6.png" alt="" ></p>

		<pre><code>radial-gradient(20px 30px, circle contain, red, yellow, green);
radial-gradient(20px 30px, 20px 20px, red, yellow, green);</code></pre>
		<p><img src="radial7.png" alt="" ></p>
	</div>

<!-- ====================================================================== -->

<h3 id='repeating-gradients'>
Repeating Gradients</h3>

	<p>In addition to the ''linear-gradient()'' and ''radial-gradient()'' functions, 
	this specification defines ''repeating-linear-gradient()'' and 
	''repeating-radial-gradient()'' functions.  These two functions take the 
	same values and are interpreted the same as their respective non-repeating 
	siblings defined previously:</p>

	<pre class=prod><code><dfn>&lt;repeating-linear-gradient></dfn> = repeating-linear-gradient(
	[[
		[ [top | bottom] || [left | right] ] 
		|| 
		&lt;angle>
	],]? 
	&lt;color-stop&gt;[, &lt;color-stop&gt;]+
)
<dfn>&lt;repeating-radial-gradient></dfn> = repeating-radial-gradient(
	[&lt;bg-position&gt;,]? 
	[[
		[&lt;shape&gt; || &lt;size&gt;]
		|
		[&lt;length> | &lt;percentage>]{2}
	],]? 
	&lt;color-stop&gt;[, &lt;color-stop&gt;]+
)</code></pre>

	<p>When rendered, however, the color-stops are repeated infinitely in both 
	directions, with their positions shifted by multiples of the difference 
	between the last specified color-stop's position and the first specified 
	color-stop's position.  For example, ''repeating-linear-gradient(red 10px, blue 50px)'' 
	is equivalent to ''linear-gradient(..., red -30px, blue 10px, red 10px, blue 50px, red 50px, blue 90px, ...)''.  
	Note that the last color-stop and first color-stop will always coincide at 
	the boundaries of each group, which will produce sharp transitions if the 
	gradient does not start and end with the same color.</p>

	<div class=example>
		<p>Repeating gradient syntax is basically identical to that of non-repeating gradients:</p>

		<pre><code>repeating-linear-gradient(red, blue 20px, red 40px)</code></pre>
		<p><img src="repeating1.png" alt=""></p>

		<pre><code>repeating-radial-gradient(red, blue 20px, red 40px)</code></pre>
		<p><img src="repeating2.png" alt=""></p>

		<pre><code>repeating-radial-gradient(20px 30px, circle contain, red, yellow, green 100%, yellow 150%, red 200%)</code></pre>
		<p><img src="repeating3.png" alt=""></p>
	</div>

	<p>If the difference in the positions of the first and last color-stops is 
	0 (for example, in the value ''repeating-linear-gradient(red 10px, blue 10px)''), the 
	gradient defines a solid-color image with the color of the last color-stop 
	in the rule (in this case, then, it would simply define a blue image).</p>

<!-- ====================================================================== -->

<h3 id='color-stop-syntax'>
Gradient Color-Stops</h3>

	<pre class=prod><code><dfn>&lt;color-stop></dfn> = &lt;color> [ &lt;percentage> | &lt;length> ]?</code></pre>

	<p>Color-stops are points placed along the line defined by the <i>gradient-line</i> 
	at the beginning of the rule.  Color-stops must be specified in order.  
	Percentages refer to the length of the gradient-line, with 0% being at the 
	starting point and 100% being at the ending point.  Lengths are measured 
	from the starting-point in the direction of the ending-point.  Color-stops 
	are usually placed between the starting-point and ending-point, but that's 
	not required; the gradient-line extends infinitely in both directions, and 
	a color-stop can be placed at any position on the line.</p>

	<p>At each color-stop, the line is the color of the color-stop.  Between 
	two color-stops, the line's color is linearly interpolated between the colors 
	of the two color-stops, with the interpolation taking place in premultiplied 
	RGBA space.  Before the first color-stop, the line is the color of the first 
	color-stop.  After the last color-stop, the line is the color of the last 
	color-stop.</p>

	<p>The following steps must be applied <em>in order</em> to process the list 
	of color-stops.  After applying these rules, all color-stops will have a 
	definite position and they will be in ascending order:</p>

	<ol>
		<li>If the first color-stop does not have a position, its position defaults 
		to 0%. If the last color-stop does not have a position, its position defaults 
		to 100%.</li>

		<li>If a color-stop has a position that is less than the specified position 
		of any color-stop before it in the list, its position is changed to be 
		equal to the largest specified position of any color-stop before it.</li>

		<li>If any color-stop still does not have a position, then, for each run 
		of adjacent color-stops without positions, set their positions so that 
		they are evenly spaced between the preceding and following color-stops 
		with positions.</li>
	</ol>

	<p>If multiple color-stops have the same position, they produce an infinitesimal 
	transition from the one specified first in the rule to the one specified 
	last.  In effect, the color suddenly changes at that position rather than 
	smoothly transitioning.</p>

	<p class=note>It is recommended that authors not mix different types of units, 
	such as px, em, or %, in a single rule, as this can cause a color-stop to 
	unintentionally try to move before an earlier one.  For example, the rule 
	''background-image: linear-gradient(red, yellow 100px, blue 50%)'' would 
	work as expected as long as the background area is at least 200px tall.  
	If it was 150px tall, however, the blue color-stop's position would be 
	equivalent to "75px", which precedes the yellow color-stop, and would be 
	corrected to a position of 100px.</p>

	<p class=note>The definition and implications of "premultiplied" color spaces 
	are given elsewhere in the technical literature, but a quick primer is given 
	here to illuminate the process.  Given a color expressed as an rgba() 4-tuple, 
	one can convert this to a premultiplied representation by multiplying the 
	red, green, and blue components by the alpha component.  For example, a 
	partially-transparent blue may be given as rgba(0,0,255,.5), which would 
	then be expressed as (0,0,127.5,.5) in its premultiplied representation.  
	Note that fully opaque colors have the same representation in rgba and 
	premultiplied-rgba (you multiply the components by 1), and all fully 
	transparent colors are expressed the same way in the premultiplied 
	representation (you multiply each component by 0, so no matter what the 
	source color was in rgba, the premultiplied representation is (0,0,0,0)).  
	Interpolating colors using the premultiplied representations rather than 
	the plain rgba representations tends to produce more attractive transitions, 
	particularly when transitioning from a fully opaque color to fully transparent.</p>

<!-- ====================================================================== -->

<h2 id="sizing">
Sizing Images and Objects in CSS</h2>

	<p>Images used in CSS may come from a number of sources, from defined image 
	formats (such as gif, jpeg, etc), dedicated markup formats (such as SVG), and 
	CSS-specific formats (such as the linear-gradient() value type defined in this 
	specification).  As well, a document may contain many other types of objects, 
	such as video, plugins, or nested documents.  These images and objects (just 
	<dfn>objects</dfn> hereafter) may offer many types of sizing information to CSS, or none 
	at all.  This section defines generically the size negotiation model between 
	the object and the CSS layout algorithms.</p>

<!-- ====================================================================== -->

<h3 id="sizing-terms">
Object-Sizing Terminology</h3>

	<p>In order to define this handling, we define a few terms, to make it 
	easier to refer to various concepts:</p>

	<dl>
		<dt><dfn>intrinsic dimensions</dfn></dt>
		<dd>
			<p>An object's intrinsic dimensions are its preferred, natural width,
			height, and aspect ratio, if they exist. There can be an <dfn>intrinsic height</dfn> 
			and <dfn>intrinsic width</dfn>, defining a definite rectangle. (Most bitmap 
			images fall into this category.) There can be an <dfn>intrinsic aspect ratio</dfn> 
			defining the relation of the width to the height, but no definite size. 
			(SVG images designed to scale may fall into this category.) There can be 
			just an intrinsic height or width. Or there can be no intrinsic dimensions 
			at all, implying that the object has no preferred size or aspect ratio. 
			(Embedded documents are often assumed to have no intrinsic size, as are 
			CSS gradients, defined in this specification.)</p>

			<p>If an object (such as an icon) has multiple sizes, then the largest 
			size is used. If it has multiple aspect ratios of that size (or of no 
			size), then the aspect ratio closest to the aspect ratio of the 
			<i>default object size</i> is used.</p>
		</dd>

		<dt><dfn>specified size</dfn></dt>
		<dd>The specified size of an object is given by CSS, such as through the 
		'object-fit' or 'background-size' properties. The specified size can be a 
		definite width and height, a set of constraints, or a combination thereof.</dd>

		<dt><dfn>concrete object size</dfn></dt>
		<dd>The <i>concrete object size</i> is the result of transforming the <i>intrinsic dimensions</i>
		into a concrete size, based on the <i>specified size</i> and the 
		<i>default object size</i>. A <i>concrete object size</i> always has a definite height 
		and width.</dd>

		<dt><dfn>default object size</dfn></dt>
		<dd>
			<p>The <i>default object size</i> is a rectangle with a definite height and 
			width used to determine the <i>concrete object size</i> when both the 
			<i>intrinsic dimensions</i> and <i>specified size</i> are missing dimensions.  
			It varies based on the context in which that the image is being laid out.</p>

			<div class="example">
				<p>Below are some examples of default object sizing areas:

				<dl>
					<dt>'background-image'</dt>
					<dd>The <i>default object size</i> is the size of the element's
					<a href="http://www.w3.org/TR/css3-background/#background-positioning-area">background
					positioning area</a>. [[CSS3BG]]</dd>

					<dt>'list-style-image'</dt>
					<dd>The <i>default object size</i> is a 1em square. [[!CSS21]]</dd>

					<dt>'border-image'</dt>
					<dd>The <i>default object size</i> is the size of the element's
					<a href="http://www.w3.org/TR/css3-background/#border-image-area">border image area</a>.
					[[CSS3BG]]</dd>

					<dt>'cursor'</dt>
					<dd>The <i>default object size</i> is a UA-defined size that should
					be based on the size of a typical cursor on the UA's operating system.
					[[!CSS21]]</dd>

					<dt>replaced elements</dt>
					<dd>The <i>default object size</i> is a rectangle 300px wide and 150px
					tall. [[!CSS21]]</dd>
				</dl>
				<p class=issue>The only reason these are examples is because the proper 
				place for the normative definitions of default object sizes is in the 
				definitions for the relevant properties.  These are the correct values,
				though.</p>
			</div>
		</dd>
	</dl>

<!-- ====================================================================== -->

<h3 id="object-negotiation">
CSSâ‡‹Object Negotiation</h3>

	<p>Objects in CSS are sized and rendered as follows:</p>

	<ol>
		<li>When an image or object is specified in a document, such as through a url() 
		value in a 'background-image' property or a @src attribute on an &lt;img> element, 
		CSS queries the object for its <i>intrinsic dimensions</i>.</li>

		<li>Using the <i>intrinsic dimensions</i> and the <i>specified size</i>, 
		CSS then computes a <i>concrete object size</i> that defines the size and 
		position of the region the object will render in (specified in the 
		following section).</li>

		<li>CSS asks the object to render itself at the <i>concrete object size</i>.  
		CSS does not define how objects render when the <i>concrete object size</i> 
		is different from the object's <i>intrinsic dimensions</i>.  The object may 
		adjust itself to match the <i>concrete object size</i> in some way, or even
		render itself larger or smaller than the <i>concrete object size</i> to 
		satisfy sizing constraints of its own.</li>

		<li>Unless otherwise specified by CSS, the object is then clipped to the
		<i>concrete object size</i>.</li>
	</ol>

<!-- ====================================================================== -->

<h3 id="default-sizing">
Concrete Object Size Resolution</h3>

	<p>In the absence of more specific rules, an object's
	<i>intrinsic dimensions</i> are resolved to a <i>concrete object size</i> as 
	follows:</p>

	<ul>
		<li>If the <i>specified size</i> is a definite width and height, the 
		<i>concrete object size</i> is given that width and height.</li>

		<li>If the <i>specified size</i> has only a width or height, but not both,
		then the <i>concrete object size</i> is given that specified width or height.
		The other dimension is calculated as follows:

			<ol>
				<li>If the object has an <i>intrinsic aspect ratio</i>, the missing
				dimension of the <i>concrete object size</i> is calculated using the
				<i>intrinsic aspect-ratio</i> and the present dimension.</li>

				<li>Otherwise, if the missing dimension is present in the object's
				<i>intrinsic dimensions</i>, the missing dimension is taken from the
				object's <i>intrinsic dimensions</i>.</li>

				<li>Otherwise, the missing dimension of the <i>concrete object size</i>
				is taken from the <i>default object size</i>.</li>
			</ol>
		</li>

		<li>If the <i>specified size</i> has neither a definite width nor height, and 
		has no additional contraints, the dimensions of the <i>concrete object size</i>
		are calculated as follows:

			<ol>
				<li>If the object has only an <i>intrinsic aspect ratio</i>, the 
				<i>concrete object size</i> must have that aspect ratio, and additionally 
				be as large as possible without either its height or width exceeding 
				the height or width of the <i>default object size</i>.  Otherwise, 
				the width and height of the <i>concrete object size</i> is the same
				as the object's <i>intrinsic width</i> and <i>intrinsic height</i>,
				if they exist.</li>

				<li>If the <i>concrete object size</i> is still missing a width or height,
				and the object has an <i>intrinsic aspect ratio</i>, the missing dimension
				is calculated from the present dimension and the <i>intrinsic aspect ratio</i>.
				Otherwise, the missing dimensions is taken from the <i>default object size</i>.</li>
			</ol>
		</li>
	</ul>

	<p>If the <i>specified size</i> has additional constraints, the 
	<i>concrete object size</i> must be sized to satisfy those constraints.
	For example, the 'min-width', 'min-height', 'max-width', and 'max-height'
	properties specify slightly more complex handling for sizing replaced
	elements, and ''background-repeat: round'' can further adjust
	the size calculated by 'background-size' so that the image fits a whole 
	number of times into the background positioning area.</p>

<!-- ====================================================================== -->

<h3 id="object-fit">
Sizing Objects: the 'object-fit' property</h3>

	<table class="propdef">
		<tr>
			<th>Name:
			<td><dfn>object-fit</dfn>
		<tr>
			<th>Value:
			<td>fill | contain | cover | none | scale-down
		<tr>
			<th>Initial:
			<td>fill
		<tr>
			<th>Applies to:
			<td>replaced elements
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Percentages:
			<td>N/A
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed value:
			<td>specified value
	</table>

	<p>The 'object-fit' property specifies how the contents of a replaced element
	should be scaled relative to the box established by its used height and width.
	It also enables scaling a replaced element's contents up to a specified maximum
	size or down to a specified minimum size while preserving its aspect ratio.
	This property never affects the size of the replaced element; it only affects
	the size of the contents of the replaced element.</p>

	<p>Not all replaced elements can be scaled, but images typically can.</p>

	<p>If the replaced element's content do not have an intrinsic aspect ratio
	(which may be derived from an intrinsic width and height), all of the values 
	for 'object-fit' are treated as ''fill''.  Otherwise, the contents are scaled
	as follows:</p>

	<dl>
		<dt>fill</dt>
		<dd>
			<p>Set the content's size to the <i>concrete object size</i> obtained 
			by running the <i title=default-sizing>object sizing algorithm</i> with 
			a <i>specified size</i> and a <i>default object size</i> equal to the 
			replaced element's used width and height.</p>

			<p>This will make the contents exactly fill the replaced element.</p>
		</dd>

		<dt>contain</dt>
		<dd>
			<p>Set the content's size to the largest width and height that has the
			same aspect ratio as the content's intrinsic aspect ratio, and additionally
			has neither width nor height larger than the replaced element's used
			width and height, respectively.</p>
		</dd>

		<dt>cover</dt>
		<dd>
			<p>Set the content's size to the smallest width and height that has
			the same aspect ratio as the content's intrinsic aspect ratio, and 
			additionally has neither width nor height smaller than the replaced
			element's used width and height, respectively.</p>
		</dd>

		<dt>none</dt>
		<dd>
			<p>Set the content's size to the <i>concrete object size</i> obtained
			by running the <i title=default-sizing>object sizing algorithm</i> with
			no <i>specified size</i>, and a <i>default object size</i> equal to 
			the replaced element's used width and height.</p>
		</dd>

		<dt>scale-down <b class=issue>better name?</i></dt>
		<dd>
			<p>Size the content as if 'none' or 'contain' were specified, whichever
			would result in a smaller size.</p>

			<p class=note>Note that both 'none' and 'contain' respect the content's
			intrinsic aspect ratio, so the concept of "smaller" is well-defined.</p>
		</dd>
	</dl>

	<p>If the content does not completely fill the replaced element, the unfilled
	space shows the replaced element's background. Replaced elements always clip
	their contents, similar to the effects of ''overflow:hidden'' on non-replaced elements,
	so any content that would extend beyond the edges of the box are simply not
	displayed.   See the 'object-position' property for positioning the object 
	with respect to the element's box.</p>

	<div class="figure">
		<p><img src="img_scale.png" style="border: thin solid black;" alt=""></p>
		
		<p class="caption">An example showing how four of the values of 
		'object-fit' cause the replaced element (blue figure) to be scaled to fit 
		its height/width box (shownwith a green background), using the initial 
		value for 'object-position'.  The fifth value, '<span class='css'>scale-down</span>, 
		in this case looks identical to '<span class='css'>contain</span>.</p>
	</div>

	<p class="note">Note: the 'object-fit' property has similar semantics to
	the fit attribute in [[SMIL10]].</p>

	<p class=note>Note: Per the <i title=object-negotiation>CSSâ‡‹Object Negotiation</i>
	algorithm, the <i>concrete object size</i> (or, in this case, the size of the
	content) does not directly scale the object itself - it is merely passed to
	the object as information about the size of the visible canvas.  How to then
	draw into that size is up to the image format.  In particular, raster images
	always scale to the given size, while SVG uses the given size as the size of
	the "SVG Viewport" (a term defined by SVG) and then uses the values of several
	attributes on the root &lt;svg> element to determine how to draw itself.</p>

	<p>User agents MAY accept 'image-fit' as an alias for 'object-fit', as a
	previous version of this specification used that name.  Authors must not
	use 'image-fit' in their stylesheets.</p>

<!-- ====================================================================== -->

<h3 id="object-position">
Positioning Objects: the 'object-position' property</h3>

	<table class="propdef">
		<tr>
			<th>Name:
			<td><dfn>object-position</dfn>
		<tr>
			<th>Value:
			<td>[ [ &lt;percentage> | &lt;length> | left | center | right ] [ &lt;percentage> | &lt;length> | top | center | bottom ]? ] | [
			[ left | center | right ] || [ top | center | bottom ] ]
		<tr>
			<th>Initial:
			<td>50% 50%
		<tr>
			<th>Applies to:
			<td>replaced elements
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Percentages:
			<td>refer to width and height of box itself
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed value:
			<td>specified value
	</table>

	<p>The 'object-position' property determines the alignment of the replaced
	element inside its box. The values have the same meaning as the values for
	the <a href="http://w3.org/TR/CSS21/colors.html#propdef-background-position">'background-position'</a>
	property, using the image as the image and the content box as the positioning
	area. [[!CSS21]]</p>

	<p class="note">Note that areas of the box not covered by the replaced
	element will show the element's background.</p>

	<p>User agents MAY accept 'image-position' as an alias for 'object-position', as a
	previous version of this specification used that name.  Authors must not
	use 'image-position' in their stylesheets.</p>

<!-- ====================================================================== -->

<h2 id="image-processing">
Image Processing</h2>

<h3 id="image-resolution">
Overriding Image Resolutions: the 'image-resolution' property</h3>

	<p>The <i>image resolution</i> is defined as the number of image
	pixels per unit length, e.g., pixels per inch. Some image formats can
	record information about the resolution of images. This information
	can be helpful when determining the actual size of the image in the
	formatting process. However, the information can also be wrong, in
	which case it should be ignored. By default, CSS assumes a resolution
	of one image pixel per CSS ''px'' unit; however, the 'image-resolution'
	property allows using some other resolution.

	<table class="propdef">
		<tr>
			<th>Name:
			<td><dfn>image-resolution</dfn>
		<tr>
			<th>Value:
			<td>from-image || &lt;resolution>
		<tr>
			<th>Initial:
			<td>1dppx
		<tr>
			<th>Applies to:
			<td>replaced elements
		<tr>
			<th>Inherited:
			<td>yes
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed value:
			<td>specified value
	</table>

	<p>The 'image-resolution' property specifies the resolution of images
	in content (i.e. replaced elements and generated content). It has no
	effect on background images, list markers, and other images that are
	not element content. <span class="issue">Or does this apply to all
	images unless otherwise overridden?</span>
	Values have the following meanings:</p>

	<dl>
		<dt>&lt;resolution></dt>
		<dd>The value sets the resolution of the image. In combination with
		''from-image'', the specified resolution is only used if the image
		does not have a resolution.</dd>

		<dt>from-image</dt>
		<dd>The UA must look for the resolution in the image itself. If the
		image does not have a resolution, the specified &lt;resolution>
		value is used, or ''1dppx'' if none is given.</dd>
	</dl>

	<p>This property must have no effect on vector images, as vector images
	do not have a concept of "resolution".</p>

	<div class="example">
		<p>This rule specifies that the UA should use the image resolution
		found in the image itself, falling back to 1 image pixel per CSS
		''px'' unit.</p>

		<pre class=css>img { image-resolution: from-image }</pre>
	</div>

	<div class="example">
		<p>Using this rule, the image resolution is set to 300dpi and the
		resolution in the image, if any, is ignored.</p>

		<pre>img { image-resolution: 300dpi }</pre>
	</div>


	<div class="example">
		<p>These rules both specify that the UA should use the image resolution
		found in the image itself. If the image has no resolution, the
		resolution is set to 300dpi.</p>

	  <pre>
img { image-resolution: from-image 300dpi }
img { image-resolution: 300dpi from-image }
	  </pre>
	</div>

<!-- ====================================================================== -->

<h3 id="image-orientation">
Orienting an Image on the Page: the 'image-orientation' property</h3>

	<p>Images from camera phones, digital cameras or scanners may be encoded sideways.
	For example, the first row of image data may represent the leftmost or
	rightmost column of image pixels. Furthermore, often such devices have limited
	resources, and do not have the capability to rotate the image into an upright
	orientation. However, this type of device may have internal knowledge or can
	accept input from its user as to the rotational correction to perform.</p>

	<p>The image-orientation property provides a way to specify an "out-of-band"
	rotation to be applied to image source data. This facility is not intended to
	specify layout transformations such as arbitrary rotation or flipping the image
	in the horizontal or vertical direction. It is not needed to correctly orient
	an image when printing in landscape versus portrait orientation, as that
	rotation is done as part of layout. It should only be used to correct
	incorrectly-oriented images.</p>

	<table class="propdef">
		<tr>
			<th>Name:
			<td><dfn>image-orientation</dfn>
		<tr>
			<th>Value:
			<td>&lt;angle>
		<tr>
			<th>Initial:
			<td>0deg
		<tr>
			<th>Applies to:
			<td>images
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed value:
			<td>specified value, rounded and normalized (see text)
	</table>

	<p>'image-orientation' specifies an orthogonal rotation to be applied to an image
	before it is laid out. CSS layout processing applies to the image <em>after</em>
	rotation. This implies, for example:</p>

	<ul>
		<li>The intrinsic height and width are derived from the rotated rather than the
		original image dimensions;</li>

		<li>The height (width) property applies to the vertical (horizontal) dimension
		of the image, <em>after</em> rotation.</li>
	</ul>

	<p>Positive values cause the image to be rotated to the right (in a clockwise
	direction), while negative values cause a rotation to the left.  The computed
	value of the property is calculated by rounding the specified angle to the 
	nearest quarter-turn	(90deg, 100grad, .25turn, etc.), rounding away from 0 
	(that is, 45deg is rounded	to 90deg, while -45deg is rounded to -90deg), then
	moduloing the value by 1 turn (360deg, 400grad, etc.).</p>

	<div class="example">
		<p>The following example rotates the image 90 degrees clockwise:</p>

		<pre>
img.ninety     { image-orientation: 90deg }
...
&lt;img class="ninety" src=... />
		</pre>

		<p>The same effect could be achieved with, for example, an angle of -270deg
		or 450deg.</p>
	</div>

<!-- ====================================================================== -->

<h3 id='image-rendering'>
Determining How to Scale an Image: the 'image-rendering' property</h3>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>image-rendering</dfn>
		<tr>
			<th>Value:
			<td>auto | crisp-edges
		<tr>
			<th>Initial:
			<td>auto
		<tr>
			<th>Applies to:
			<td>images
		<tr>
			<th>Inherited:
			<td>yes
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed Value:
			<td>specified value
	</table>

	<p>The 'image-rendering' property provides a hint to the user-agent about 
	what aspects of an image are most important to preserve when the image is 
	scaled, to aid the user-agent in the choice of an appropriate scaling algorithm.  
	When specified on an element, it applies to all images given in properties 
	for the element, such as background images, list-style images, or the content 
	of replaced elements when they represent an image that must be scaled.  The 
	values of the 'image-rendering' property are interpreted as follows:</p>

	<dl>
		<dt>auto</dt>
		<dd>The image should be scaled with an algorithm that maximizes the 
		appearance of the image.  In particular, scaling algorithms that 'smooth' 
		colors are acceptable, such as bilinear interpolation.  This is intended 
		for images such as photos.</dd>

		<dt>crisp-edges</dt>
		<dd>The image must be scaled with an algorithm that preserves contrast 
		and edges in the image, and which does not smooth colors or introduce 
		blur to the image in the process.  This is intended for images such as pixel 
		art.</dd>
	</dl>

	<p>This property does <em>not</em> dictate any particular scaling algorithm 
	to be used.  For example, with ''image-rendering:auto'', a user agent might 
	scale images with bilinear interpolation by default, switch to nearest-neighbor 
	interpolation in high-load situations, and switch to a high-quality scaling 
	algorithm like Lanczos interpolation for static images that aren't moving 
	or changing.  Similarly, with ''image-rendering:crisp-edges'', a user 
	agent might scale images with nearest-neighbor interpolation by default, and 
	switch to EPX interpolation in low-load situations.</p>

	<p>This property previously accepted the values ''optimizeSpeed'' and 
	''optimizeQuality''.  These are now deprecated; a user agent may accept them 
	as valid values, but must treat them as aliases for the ''auto'' value.</p>

<!-- ====================================================================== -->

<h2 id='serialization'>
Serialization</h2>

	<p>This section describes the serialization of all new properties and value 
	types introduced in this specification, for the purpose of interfacing with 
	the CSS Object Model [[CSSOM]].</p>

	<p>All of these algorithms refer to a variable "s".  For each, let s initially 
	be the empty string, run the steps described, and then return s.</p>

<!-- ====================================================================== -->

<h3 id='serializing-resolution'>
Serializing a &lt;resolution></h3>

	<p>The serialization of the <i>&lt;resolution></i> value type is defined in 
	the CSSOM spec.</p>

	<p class=note>This spec defines several new units for resolutions.  These 
	can all be converted to the canonical "dpcm" unit that CSSOM defines the 
	serialization in terms of.</p>

<!-- ====================================================================== -->

<h3 id='serializing-url-notation'>
Serializing the ''url()'' notation</h3>

	<p>The serialization of the url() function is defined in the CSSOM spec.</p>

<!-- ====================================================================== -->

<h3 id='serializing-image-notation'>
Serializing the ''image()'' / <i>&lt;image-list></i> notation</h3>

	<p>To serialize an <i>&lt;image-list></i>:</p>

	<ol>
		<li>Append "image(" to s.</li>

		<li>For each argument, serialize the argument as an &lt;image-decl> or 
		&lt;color> as appropriate, and  append it to s.  Then, if it is not the final 
		argument, append a comma and a space ", " to s.</li>

		<li>Append a close parenthesis ")" to s.</li>
	</ol>

	<p>To serialize an <i>&lt;image-decl></i>:</p>

	<ol>
		<li>Serialize the first part of the value (the &lt;string>) as a string.</li>

		<li>If a &lt;resolution> was provided, append a space " " to s.  Then 
		serialize the &lt;resolution> and append it to s.</li>

		<li>If the 'snap' keyword was provided, append a space " " and the literal 
		string "snap" to s.</li>

		<li>If a directional keyword was provided, append a space " " to s, then
		append the keyword to s.</li>
	</ol>

<!-- ====================================================================== -->

<h3 id='serializing-element-notation'>
Serializing the ''element()'' / <i>&lt;element-reference></i> notation</h3>

	<p>To serialize an <i>&lt;element-reference></i>:</p>

	<ol>
		<li>Append "element(" to s.</li>

		<li>Serialize the argument as a selector or identifier, as appropriate, 
		and append it to s.</li>

		<li>Append a close parenthesis ")" to s.</li>
	</ol>

<!-- ====================================================================== -->

<h3 id='serializing-cross-fade'>
Serializing the ''cross-fade()'' / <i>&lt;image-combination></i> notation</h3>

	<p>To serialize an <i>&lt;image-combination></i>:</p>

	<ol>
		<li>Append "cross-fade(" to s.</li>

		<li>Serialize the first argument to the function as an <i>&lt;image></i>, 
		and append it to s.</li>

		<li>Append a comma and a space ", " to s.</li>

		<li>Serialize the second argument to the function as an <i>&lt;image></i>, 
		and append it to s.</li>

		<li>Append a comma and a space ", " to s.</li>

		<li>Serialize the third argument to the function as a &lt;percentage>, 
		and append it to s.</li>

		<li>Append a close parenthesis ")" to s.</li>
	</ol>

<!-- ====================================================================== -->

<h3 id="serializing-gradients">
Serializing Gradients</h3>

	<p>To serialize a <i>&lt;linear-gradient></i>:</p>

	<ol>
		<li>Append "linear-gradient(" to s.</li>

		<li>
			<ul>
				<li>If the first argument to the gradient function was a single 
				keyword, serialize the keyword and append it to s.</li>

				<li>Otherwise, if the first argument to the gradient function was 
				two keywords, serialize the vertical keyword (''top'' or ''bottom'')
				and append it to s, then append a space " " to s, then serialize
				the horizontal keyword (''left'' or ''right'') and append it to s.</li>

				<li>Otherwise, if the first argument to the gradient function was 
				an &lt;angle>, serialize the &lt;angle> and append it to s.</li>

				<li>Otherwise, append "top" to s.</li>
			</ul>
		</li>

		<li>Append a comma and a space ", " to s.</li>

		<li>For each color-stop in the gradient, serialize the color-stop, and 
		append it to s.  Then, if it is not the final color-stop, append a comma 
		and a space ", " to s.</li>

		<li>Append a close parenthesis ")" to s.</li>
	</ol>

	<p>To serialize a <i>&lt;radial-gradient></i>:</p>

	<ol>
		<li>Append "radial-gradient(" to s.</li>

		<li>If a &lt;bg-position> was specified in the first argument to the 
		gradient function, serialize it and append it to s.  Otherwise, append 
		"center" to s.</li>

		<li>Append a comma and a space ", " to s.</li>

		<li>
			<ul>
				<li>If a &lt;shape> and/or &lt;size> was specified in the second 
				argument to the gradient function:

					<ol>
						<li>If a &lt;shape> was specified, serialize it as a keyword 
						and append it to s.  Otherwise, append "ellipse" to s.</li>

						<li>Append a space " " to s.</li>

						<li>If a &lt;size> was specified, serialize it as a keyword 
						and append it to s.  Otherwise, append "cover" to s.</li>
					</ol>
				</li>

				<li>Otherwise, if two &lt;length>s or &lt;percentage>s were specified 
				in the second argument to the gradient function:

					<ol>
						<li>Serialize the first &lt;length> or &lt;percentage> and 
						append it to s.</li>

						<li>Append a space " " to s.</li>

						<li>Serialize the second &lt;length> or &lt;percentage> and 
						append it to s.</li>
					</ol>
				</li>

				<li>Otherwise, append "ellipse cover" to s.</li>
			</ul>
		</li>

		<li>Append a comma and a space ", " to s.</li>

		<li>For each color-stop in the gradient, serialize the color-stop, and 
		append it to s.  Then, if it is not the final color-stop, append a comma 
		and a space ", " to s.</li>

		<li>Append a close parenthesis ")" to s.</li>
	</ol>

	<p>To serialize a <i>&lt;repeating-linear-gradient></i>:</p>

	<ol>
		<li>Append "repeating-linear-gradient(" to s.</li>

		<li>Follow the steps for serializing a <i>&lt;linear-gradient></i>, except 
		skip step 1.</li>
	</ol>

	<p>To serialize a <i>&lt;repeating-radial-gradient></i>:</p>

	<ol>
		<li>Append "repeating-radial-gradient(" to s.</li>

		<li>Follow the steps for serializing a <i>&lt;radial-gradient></i>, except 
		skip step 1.</li>
	</ol>

	<p>To serialize a <i>&lt;color-stop></i>:</p>

	<ol>
		<li>Serialize the &lt;color>, and append it to s.</li>

		<li>If a &lt;length> or &lt;percentage> was specified, append a space 
		" " to s, then serialize the &lt;length> or &lt;percentage> and append 
		it to s.</li>
	</ol>

<!-- ====================================================================== -->

<h3 id='serializing-properties'>
Serializing new properties</h3>

	<p>To serialize the 'image-resolution' property:

	<ol>
		<li>If the ''from-image'' keyword is specified in the property value, 
		append "from-image" to s.</li>

		<li>If both the ''from-image'' keyword and a &lt;resolution> are specified, 
		append a space " " to s.</li>

		<li>If a &lt;resolution> is specified, serialize it and append it to s.</li>
	</ol>

	<p>To serialize the 'image-orientation' property:</p>

	<ol>
		<li>Serialize the &lt;angle> and append it to s.</li>
	</ol>

	<p>To serialize the 'image-rendering' property:</p>

	<ol>
		<li>Serialize the keyword and append it to s.</li>
	</ol>

	<p>To serialize the 'object-fit' property:</p>

	<ol>
		<li>Serialize the keyword and append it to s.</li>
	</ol>

	<p>To serialize the 'object-position' property:</li>

	<ol>
		<li>Serialize the value as a &lt;bg-position> and append it to s.</li>
	</ol>

<!-- ====================================================================== -->

<h2 id='interpolation'>
Interpolation</h2>

	<p>This section describes how to interpolate between new value types defined 
	in this specification, for use with modules such as CSS Transitions and CSS 
	Animations.</p>

	<p>If an algorithm below simply states that two values should be "interpolated" 
	or "transitioned" without further details, then the value should be interpolated 
	as described by the Transitions spec.  Otherwise, the algorithm may reference 
	a variable "t" in its detailed description of the interpolation.  This is a 
	number which starts at 0% and goes to 100%, and is set to a value that represents 
	the progress through the transition, based on the duration of the transition, 
	the elapsed time, and the timing function in use.  For example, with a linear 
	timing function and a 1s duration, after .3s t is equal to .3.</p>

<!-- ====================================================================== -->

<h3 id='interpolating-images'>
Interpolating <i>&lt;image></i></h3>

	<p>All images can be interpolated, though some special types of images (like 
	some gradients) have their own special interpolation rules.  In general terms, 
	images are interpolated by scaling them to the size of the start image and 
	cross-fading the two while they transition to the size of the end image.</p>

	<p>In specific terms, at each point in the interpolation the image is equal 
	to <code>cross-fade(&lt;start image>, &lt;end image>, t)</code>.</p>

<!-- ====================================================================== -->

<h3 id='interpolating-gradients'>
Interpolating <i>&lt;gradient></i></h3>

	<p>Gradient images can be interpolated directly in CSS transitions and 
	animations, smoothly animating from one gradient to another.  There are only 
	a few restrictions on what gradients are allowed to be interpolated:</p>

	<ol>
		<li>Both the starting and ending gradient must be expressed with the same 
		function.  (For example, you can transition from a linear-gradient() to 
		a linear-gradient(), but not from a linear-gradient() to a radial-gradient() 
		or a repeating-linear-gradient().)</li>

		<li>Both the starting and ending gradient must have the same number of 
		color-stops.  For this purpose, a repeating gradient is considered to 
		have infinite color-stops, and thus all repeating gradients have the same 
		number of color-stops.  (Note that one may pad a gradient with additional 
		color-stops placed atop each other, if necessary to make two gradients 
		have the same number of color-stops.)</li>
	</ol>

	<p>If the two gradients satisfy both of those constraints, they must be 
	interpolated as described below.  If not, they must be interpolated as a 
	generic image.</p>

	<ol>
		<li>Convert both the start and end gradients to their used value.</li>

		<li>Interpolate each component and color-stop of the gradients independently.  
		For linear gradients, the only component is the angle.  For radial gradients, 
		the components are the horizontal and vertical position of the center 
		and the horizontal and vertical axis lengths.</li>

		<li>To interpolate a color-stop, first match each color-stop in the start 
		gradient to the corresponding color-stop at the same index in the end 
		gradient.  For repeating gradients, the first specified color-stop in 
		the start and end gradients are considered to be at the same index, and 
		all other color-stops following and preceding are indexed appropriately.  
		Then, for each pair of color-stops, interpolate the position and color 
		independently.</li>
	</ol>

<!-- ====================================================================== -->

<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<h2 class="no-num" id="references">References</h2>
<h3 class="no-num" id="normative-references">Normative references</h3>
<!--normative-->
<h3 class="no-num" id="informative-references">Informative references</h3>
<!--informative-->

</body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
